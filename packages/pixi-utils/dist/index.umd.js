(function(p,te){typeof exports=="object"&&typeof module<"u"?te(exports):typeof define=="function"&&define.amd?define(["exports"],te):(p=typeof globalThis<"u"?globalThis:p||self,te((p.dxMyth=p.dxMyth||{},p.dxMyth.pixi={})))})(this,function(p){"use strict";const Ui={grad:.9,turn:360,rad:360/(Math.PI*2)},it=i=>typeof i=="string"?i.length>0:typeof i=="number",N=(i,t=0,e=Math.pow(10,t))=>Math.round(e*i)/e+0,K=(i,t=0,e=1)=>i>e?e:i>t?i:t,us=i=>(i=isFinite(i)?i%360:0,i>0?i:i+360),Xi=(i,t="deg")=>Number(i)*(Ui[t]||1),ds=i=>({r:K(i.r,0,255),g:K(i.g,0,255),b:K(i.b,0,255),a:K(i.a)}),Te=i=>({r:N(i.r),g:N(i.g),b:N(i.b),a:N(i.a,3)}),Yi=({r:i,g:t,b:e,a:s=1})=>!it(i)||!it(t)||!it(e)?null:ds({r:Number(i),g:Number(t),b:Number(e),a:Number(s)}),Ni=/^#([0-9a-f]{3,8})$/i,Hi=i=>{const t=Ni.exec(i);return t?(i=t[1],i.length<=4?{r:parseInt(i[0]+i[0],16),g:parseInt(i[1]+i[1],16),b:parseInt(i[2]+i[2],16),a:i.length===4?N(parseInt(i[3]+i[3],16)/255,2):1}:i.length===6||i.length===8?{r:parseInt(i.substr(0,2),16),g:parseInt(i.substr(2,2),16),b:parseInt(i.substr(4,2),16),a:i.length===8?N(parseInt(i.substr(6,2),16)/255,2):1}:null):null},ee=i=>{const t=i.toString(16);return t.length<2?"0"+t:t},$i=i=>{const{r:t,g:e,b:s,a:n}=Te(i),r=n<1?ee(N(n*255)):"";return"#"+ee(t)+ee(e)+ee(s)+r},Wi=i=>({h:us(i.h),s:K(i.s,0,100),v:K(i.v,0,100),a:K(i.a)}),Gi=i=>({h:N(i.h),s:N(i.s),v:N(i.v),a:N(i.a,3)}),Vi=({h:i,s:t,v:e,a:s=1})=>{if(!it(i)||!it(t)||!it(e))return null;const n=Wi({h:Number(i),s:Number(t),v:Number(e),a:Number(s)});return ps(n)},fs=({r:i,g:t,b:e,a:s})=>{const n=Math.max(i,t,e),r=n-Math.min(i,t,e),o=r?n===i?(t-e)/r:n===t?2+(e-i)/r:4+(i-t)/r:0;return{h:60*(o<0?o+6:o),s:n?r/n*100:0,v:n/255*100,a:s}},ps=({h:i,s:t,v:e,a:s})=>{i=i/360*6,t=t/100,e=e/100;const n=Math.floor(i),r=e*(1-t),o=e*(1-(i-n)*t),a=e*(1-(1-i+n)*t),h=n%6;return{r:[e,o,r,r,a,e][h]*255,g:[a,e,e,o,r,r][h]*255,b:[r,r,a,e,e,o][h]*255,a:s}},ms=i=>({h:us(i.h),s:K(i.s,0,100),l:K(i.l,0,100),a:K(i.a)}),ys=i=>({h:N(i.h),s:N(i.s),l:N(i.l),a:N(i.a,3)}),qi=({h:i,s:t,l:e,a:s=1})=>{if(!it(i)||!it(t)||!it(e))return null;const n=ms({h:Number(i),s:Number(t),l:Number(e),a:Number(s)});return gs(n)},ji=({h:i,s:t,l:e,a:s})=>(t*=(e<50?e:100-e)/100,{h:i,s:t>0?2*t/(e+t)*100:0,v:e+t,a:s}),zi=({h:i,s:t,v:e,a:s})=>{const n=(200-t)*e/100;return{h:i,s:n>0&&n<200?t*e/100/(n<=100?n:200-n)*100:0,l:n/2,a:s}},gs=i=>ps(ji(i)),Ct=i=>zi(fs(i)),Zi=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ki=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Qi=i=>{const t=Zi.exec(i)||Ki.exec(i);if(!t)return null;const e=ms({h:Xi(t[1],t[2]),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return gs(e)},Ji=i=>{const{h:t,s:e,l:s,a:n}=ys(Ct(i));return n<1?`hsla(${t}, ${e}%, ${s}%, ${n})`:`hsl(${t}, ${e}%, ${s}%)`},tn=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,en=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,sn=i=>{const t=tn.exec(i)||en.exec(i);return!t||t[2]!==t[4]||t[4]!==t[6]?null:ds({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)})},nn=i=>{const{r:t,g:e,b:s,a:n}=Te(i);return n<1?`rgba(${t}, ${e}, ${s}, ${n})`:`rgb(${t}, ${e}, ${s})`},Se={string:[[Hi,"hex"],[sn,"rgb"],[Qi,"hsl"]],object:[[Yi,"rgb"],[qi,"hsl"],[Vi,"hsv"]]},_s=(i,t)=>{for(let e=0;e<t.length;e++){const s=t[e][0](i);if(s)return[s,t[e][1]]}return[null,void 0]},xs=i=>typeof i=="string"?_s(i.trim(),Se.string):typeof i=="object"&&i!==null?_s(i,Se.object):[null,void 0],rn=i=>xs(i)[1],on=(i,t)=>({r:i.r,g:i.g,b:i.b,a:t}),Ce=(i,t)=>{const e=Ct(i);return{h:e.h,s:K(e.s+t*100,0,100),l:e.l,a:e.a}},ke=i=>(i.r*299+i.g*587+i.b*114)/1e3/255,bs=(i,t)=>{const e=Ct(i);return{h:e.h,s:e.s,l:K(e.l+t*100,0,100),a:e.a}},an=i=>({r:255-i.r,g:255-i.g,b:255-i.b,a:i.a});class se{parsed;rgba;constructor(t){this.parsed=xs(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}isValid(){return this.parsed!==null}brightness(){return N(ke(this.rgba),2)}isDark(){return ke(this.rgba)<.5}isLight(){return ke(this.rgba)>=.5}toHex(){return $i(this.rgba)}toRgb(){return Te(this.rgba)}toRgbString(){return nn(this.rgba)}toHsl(){return ys(Ct(this.rgba))}toHslString(){return Ji(this.rgba)}toHsv(){return Gi(fs(this.rgba))}invert(){return tt(an(this.rgba))}saturate(t=.1){return tt(Ce(this.rgba,t))}desaturate(t=.1){return tt(Ce(this.rgba,-t))}grayscale(){return tt(Ce(this.rgba,-1))}lighten(t=.1){return tt(bs(this.rgba,t))}darken(t=.1){return tt(bs(this.rgba,-t))}rotate(t=15){return this.hue(this.hue()+t)}alpha(t){return typeof t=="number"?tt(on(this.rgba,t)):N(this.rgba.a,3)}hue(t){const e=Ct(this.rgba);return typeof t=="number"?tt({h:t,s:e.s,l:e.l,a:e.a}):N(e.h)}isEqual(t){return this.toHex()===tt(t).toHex()}}const tt=i=>i instanceof se?i:new se(i),As=[],vs=i=>{i.forEach(t=>{As.indexOf(t)<0&&(t(se,Se),As.push(t))})},hn=()=>new se({r:Math.random()*255,g:Math.random()*255,b:Math.random()*255});vs([(i,t)=>{const e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(const a in e)s[e[a]]=a;const n={},r=(a,h)=>(a.r-h.r)**2+(a.g-h.g)**2+(a.b-h.b)**2;i.prototype.toName=function(a){if(!this.rgba.a&&!this.rgba.r&&!this.rgba.g&&!this.rgba.b)return"transparent";const h=s[this.toHex()];if(h)return h;if(a?.closest){const c=this.toRgb();let l=1/0,u="black";if(!n.length)for(const f in e)n[f]=new i(e[f]).toRgb();for(const f in e){const d=r(c,n[f]);d<l&&(l=d,u=f)}return u}};const o=a=>{const h=a.toLowerCase(),c=h==="transparent"?"#0000":e[h];return c?new i(c).toRgb():null};t.string.push([o,"name"])}]);class W{static shared=new W;static _temp=new W;static HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;_value;_components;_int;_arrayRgba;_arrayRgb;constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof W)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const s=typeof t;if(s!==typeof e)return!1;if(s==="number"||s==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((r,o)=>r===e[o]);if(t!==null&&e!==null){const r=Object.keys(t),o=Object.keys(e);return r.length!==o.length?!1:r.every(a=>t[a]===e[a])}return t===e}toRgba(){const[t,e,s,n]=this._components;return{r:t,g:e,b:s,a:n}}toRgb(){const[t,e,s]=this._components;return{r:t,g:e,b:s}}toRgbaString(){const[t,e,s]=this.toUint8RgbArray();return`rgba(${t},${e},${s},${this.alpha})`}toUint8RgbArray(t){const[e,s,n]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||=this._arrayRgb,t[0]=Math.round(e*255),t[1]=Math.round(s*255),t[2]=Math.round(n*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||=this._arrayRgba;const[e,s,n,r]=this._components;return t[0]=e,t[1]=s,t[2]=n,t[3]=r,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||=this._arrayRgb;const[e,s,n]=this._components;return t[0]=e,t[1]=s,t[2]=n,t}toNumber(){return this._int}toBgrNumber(){const[t,e,s]=this.toUint8RgbArray();return(s<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,s,n,r]=W._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=s,this._components[2]*=n,this._components[3]*=r,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let s=this._int>>16&255,n=this._int>>8&255,r=this._int&255;return e&&(s=s*t+.5|0,n=n*t+.5|0,r=r*t+.5|0),(t*255<<24)+(s<<16)+(n<<8)+r}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,s,n,r;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const o=t;e=(o>>16&255)/255,s=(o>>8&255)/255,n=(o&255)/255,r=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,s,n,r=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,s,n,r=255]=t,e/=255,s/=255,n/=255,r/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const a=W.HEX_PATTERN.exec(t);a&&(t=`#${a[2]}`)}const o=tt(t);o.isValid()&&({r:e,g:s,b:n,a:r}=o.rgba,e/=255,s/=255,n/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=s,this._components[2]=n,this._components[3]=r,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,s]=this._components;this._int=(t*255<<16)+(e*255<<8)+(s*255|0)}_clamp(t,e=0,s=1){return typeof t=="number"?Math.min(Math.max(t,e),s):(t.forEach((n,r)=>{t[r]=Math.min(Math.max(n,e),s)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof W||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}}let Ps=null;const Q={get(){return Ps},set(i){Ps=i}},Ie=i=>{if(typeof i=="function"||typeof i=="object"&&i.extension){if(!i.extension)throw new Error("Extension class must have an extension object");i={...typeof i.extension!="object"?{type:i.extension}:i.extension,ref:i}}if(typeof i=="object")i={...i};else throw new Error("Invalid extension type");return typeof i.type=="string"&&(i.type=[i.type]),i},kt=(i,t)=>Ie(i).priority??t,Fe={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...i){return i.map(Ie).forEach(t=>{t.type.forEach(e=>this._removeHandlers[e]?.(t))}),this},add(...i){return i.map(Ie).forEach(t=>{t.type.forEach(e=>{const s=this._addHandlers,n=this._queue;s[e]?s[e]?.(t):(n[e]=n[e]||[],n[e]?.push(t))})}),this},handle(i,t,e){const s=this._addHandlers,n=this._removeHandlers;if(s[i]||n[i])throw new Error(`Extension type ${i} already has a handler`);s[i]=t,n[i]=e;const r=this._queue;return r[i]&&(r[i]?.forEach(o=>t(o)),delete r[i]),this},handleByMap(i,t){return this.handle(i,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(i,t,e=-1){return this.handle(i,s=>{t.findIndex(r=>r.name===s.name)>=0||(t.push({name:s.name,value:s.ref}),t.sort((r,o)=>kt(o.value,e)-kt(r.value,e)))},s=>{const n=t.findIndex(r=>r.name===s.name);n!==-1&&t.splice(n,1)})},handleByList(i,t,e=-1){return this.handle(i,s=>{t.includes(s.ref)||(t.push(s.ref),t.sort((n,r)=>kt(r,e)-kt(n,e)))},s=>{const n=t.indexOf(s.ref);n!==-1&&t.splice(n,1)})},mixin(i,...t){for(const e of t)Object.defineProperties(i.prototype,Object.getOwnPropertyDescriptors(e))}},Re=[];Fe.handleByNamedList("Environment",Re);async function ws(i){if(!i)for(let t=0;t<Re.length;t++){const e=Re[t];if(e.value.test()){await e.value.load();return}}}async function ln(i){return ws(!i)}var cn=Object.prototype.hasOwnProperty,V="~";function It(){}Object.create&&(It.prototype=Object.create(null),new It().__proto__||(V=!1));function un(i,t,e){this.fn=i,this.context=t,this.once=e||!1}function Ms(i,t,e,s,n){if(typeof e!="function")throw new TypeError("The listener must be a function");var r=new un(e,s||i,n),o=V?V+t:t;return i._events[o]?i._events[o].fn?i._events[o]=[i._events[o],r]:i._events[o].push(r):(i._events[o]=r,i._eventsCount++),i}function ie(i,t){--i._eventsCount===0?i._events=new It:delete i._events[t]}function U(){this._events=new It,this._eventsCount=0}U.prototype.eventNames=function(){var t=[],e,s;if(this._eventsCount===0)return t;for(s in e=this._events)cn.call(e,s)&&t.push(V?s.slice(1):s);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(e)):t},U.prototype.listeners=function(t){var e=V?V+t:t,s=this._events[e];if(!s)return[];if(s.fn)return[s.fn];for(var n=0,r=s.length,o=new Array(r);n<r;n++)o[n]=s[n].fn;return o},U.prototype.listenerCount=function(t){var e=V?V+t:t,s=this._events[e];return s?s.fn?1:s.length:0},U.prototype.emit=function(t,e,s,n,r,o){var a=V?V+t:t;if(!this._events[a])return!1;var h=this._events[a],c=arguments.length,l,u;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),c){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,s),!0;case 4:return h.fn.call(h.context,e,s,n),!0;case 5:return h.fn.call(h.context,e,s,n,r),!0;case 6:return h.fn.call(h.context,e,s,n,r,o),!0}for(u=1,l=new Array(c-1);u<c;u++)l[u-1]=arguments[u];h.fn.apply(h.context,l)}else{var f=h.length,d;for(u=0;u<f;u++)switch(h[u].once&&this.removeListener(t,h[u].fn,void 0,!0),c){case 1:h[u].fn.call(h[u].context);break;case 2:h[u].fn.call(h[u].context,e);break;case 3:h[u].fn.call(h[u].context,e,s);break;case 4:h[u].fn.call(h[u].context,e,s,n);break;default:if(!l)for(d=1,l=new Array(c-1);d<c;d++)l[d-1]=arguments[d];h[u].fn.apply(h[u].context,l)}}return!0},U.prototype.on=function(t,e,s){return Ms(this,t,e,s,!1)},U.prototype.once=function(t,e,s){return Ms(this,t,e,s,!0)},U.prototype.removeListener=function(t,e,s,n){var r=V?V+t:t;if(!this._events[r])return this;if(!e)return ie(this,r),this;var o=this._events[r];if(o.fn)o.fn===e&&(!n||o.once)&&(!s||o.context===s)&&ie(this,r);else{for(var a=0,h=[],c=o.length;a<c;a++)(o[a].fn!==e||n&&!o[a].once||s&&o[a].context!==s)&&h.push(o[a]);h.length?this._events[r]=h.length===1?h[0]:h:ie(this,r)}return this},U.prototype.removeAllListeners=function(t){var e;return t?(e=V?V+t:t,this._events[e]&&ie(this,e)):(this._events=new It,this._eventsCount=0),this},U.prototype.off=U.prototype.removeListener,U.prototype.addListener=U.prototype.on,U.prefixed=V,U.EventEmitter=U;class R{x=0;y=0;constructor(t=0,e=0){this.x=t,this.y=e}clone(){return new R(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Le.x=0,Le.y=0,Le}}const Le=new R;var Ft=(i=>(i[i.INTERACTION=50]="INTERACTION",i[i.HIGH=25]="HIGH",i[i.NORMAL=0]="NORMAL",i[i.LOW=-25]="LOW",i[i.UTILITY=-50]="UTILITY",i))(Ft||{});class ne{priority;next=null;previous=null;_fn;_context;_once;_destroyed=!1;constructor(t,e=null,s=0,n=!1){this._fn=t,this._context=e,this.priority=s,this._once=n}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}class X{static targetFPMS=.06;static _shared;static _system;autoStart=!1;deltaTime=1;deltaMS;elapsedMS;lastTime=-1;speed=1;started=!1;_head;_requestId=null;_maxElapsedMS=100;_minElapsedMS=0;_protected=!1;_lastFrame=-1;_tick;constructor(){this._head=new ne(null,null,1/0),this.deltaMS=1/X.targetFPMS,this.elapsedMS=1/X.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,s=Ft.NORMAL){return this._addListener(new ne(t,e,s))}addOnce(t,e,s=Ft.NORMAL){return this._addListener(new ne(t,e,s,!0))}_addListener(t){let e=this._head.next,s=this._head;if(!e)t.connect(s);else{for(;e;){if(t.priority>e.priority){t.connect(s);break}s=e,e=e.next}t.previous||t.connect(s)}return this._startIfPossible(),this}remove(t,e){let s=this._head.next;for(;s;)s.match(t,e)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*X.targetFPMS;const s=this._head;let n=s.next;for(;n;)n=n.emit(this);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),s=Math.min(Math.max(0,e)/1e3,X.targetFPMS);this._maxElapsedMS=1/s}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!X._shared){const t=X._shared=new X;t.autoStart=!0,t._protected=!0}return X._shared}static get system(){if(!X._system){const t=X._system=new X;t.autoStart=!0,t._protected=!0}return X._system}}class dn{events;domElement;interactionFrequency=10;_deltaTime=0;_didMove=!1;_tickerAdded=!1;_pauseUpdate=!0;init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this._tickerAdded||!this.domElement||(X.system.add(this._tickerUpdate,this,Ft.INTERACTION),this._tickerAdded=!0)}removeTickerListener(){this._tickerAdded&&(X.system.remove(this._tickerUpdate,this),this._tickerAdded=!1)}pointerMoved(){this._didMove=!0}_update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const t=this.events._rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(this.events.supportsPointerEvents?new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY,pointerType:t.pointerType,pointerId:t.pointerId}):new MouseEvent("mousemove",{clientX:t.clientX,clientY:t.clientY}))}_tickerUpdate(t){this._deltaTime+=t.deltaTime,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this._update())}}const nt=new dn;class Rt{bubbles=!0;cancelBubble=!0;cancelable=!1;composed=!1;currentTarget;defaultPrevented=!1;eventPhase=Rt.prototype.NONE;isTrusted;returnValue;srcElement;target;timeStamp;type;nativeEvent;originalEvent;propagationStopped=!1;propagationImmediatelyStopped=!1;path;manager;detail;view;which;layer=new R;get layerX(){return this.layer.x}get layerY(){return this.layer.y}page=new R;get pageX(){return this.page.x}get pageY(){return this.page.y}constructor(t){this.manager=t}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,s){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,s,n,r){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}NONE=0;CAPTURING_PHASE=1;AT_TARGET=2;BUBBLING_PHASE=3}class Lt extends Rt{altKey;button;buttons;ctrlKey;metaKey;relatedTarget;shiftKey;client=new R;get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}detail=0;movement=new R;get movementX(){return this.movement.x}get movementY(){return this.movement.y}offset=new R;get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}global=new R;get globalX(){return this.global.x}get globalY(){return this.global.y}screen=new R;get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,s){return t.worldTransform.applyInverse(s||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,s,n,r,o,a,h,c,l,u,f,d,m,y){throw new Error("Method not implemented.")}}class J extends Lt{pointerId;width=0;altitudeAngle;azimuthAngle;height=0;isPrimary=!1;pointerType;pressure;tangentialPressure;tiltX;tiltY;twist;detail=0;getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class re extends Lt{deltaMode;deltaX;deltaY;deltaZ;static DOM_DELTA_PIXEL=0;DOM_DELTA_PIXEL=0;static DOM_DELTA_LINE=1;DOM_DELTA_LINE=1;static DOM_DELTA_PAGE=2;DOM_DELTA_PAGE=2}const fn=2048,pn=new R,Bt=new R;function mn(...i){}class Es{rootTarget;dispatch=new U;cursor;moveOnAll=!1;enableGlobalMoveEvents=!0;mappingTable;mappingState={trackingData:{}};eventPool=new Map;_allInteractiveElements=[];_hitElements=[];_isPointerMoveEvent=!1;constructor(t){this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((s,n)=>s.priority-n.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let s=0,n=e.length;s<n;s++)e[s].fn(t);else mn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){nt.pauseUpdate=!0;const n=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",r=this[n](this.rootTarget,this.rootTarget.eventMode,pn.set(t,e),this.hitTestFn,this.hitPruneFn);return r&&r[0]}propagate(t,e){if(!t.target)return;const s=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let n=0,r=s.length-1;n<r;n++)if(t.currentTarget=s[n],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let n=s.length-2;n>=0;n--)if(t.currentTarget=s[n],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,s=this._allInteractiveElements){if(s.length===0)return;t.eventPhase=t.BUBBLING_PHASE;const n=Array.isArray(e)?e:[e];for(let r=s.length-1;r>=0;r--)n.forEach(o=>{t.currentTarget=s[r],this.notifyTarget(t,o)})}propagationPath(t){const e=[t];for(let s=0;s<fn&&t!==this.rootTarget&&t.parent;s++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestMoveRecursive(t,e,s,n,r,o=!1){let a=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(nt.pauseUpdate=!1),t.interactiveChildren&&t.children){const l=t.children;for(let u=l.length-1;u>=0;u--){const f=l[u],d=this.hitTestMoveRecursive(f,this._isInteractive(e)?e:f.eventMode,s,n,r,o||r(t,s));if(d){if(d.length>0&&!d[d.length-1].parent)continue;const m=t.isInteractive();(d.length>0||m)&&(m&&this._allInteractiveElements.push(t),d.push(t)),this._hitElements.length===0&&(this._hitElements=d),a=!0}}}const h=this._isInteractive(e),c=t.isInteractive();return c&&c&&this._allInteractiveElements.push(t),o||this._hitElements.length>0?null:a?this._hitElements:h&&!r(t,s)&&n(t,s)?c?[t]:[]:null}hitTestRecursive(t,e,s,n,r){if(this._interactivePrune(t)||r(t,s))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(nt.pauseUpdate=!1),t.interactiveChildren&&t.children){const h=t.children,c=s;for(let l=h.length-1;l>=0;l--){const u=h[l],f=this.hitTestRecursive(u,this._isInteractive(e)?e:u.eventMode,c,n,r);if(f){if(f.length>0&&!f[f.length-1].parent)continue;const d=t.isInteractive();return(f.length>0||d)&&f.push(t),f}}}const o=this._isInteractive(e),a=t.isInteractive();return o&&n(t,s)?a?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!t||!t.visible||!t.renderable||!t.measurable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren}hitPruneFn(t,e){if(t.hitArea&&(t.worldTransform.applyInverse(e,Bt),!t.hitArea.contains(Bt.x,Bt.y)))return!0;if(t.effects&&t.effects.length)for(let s=0;s<t.effects.length;s++){const n=t.effects[s];if(n.containsPoint&&!n.containsPoint(e,this.hitTestFn))return!0}return!1}hitTestFn(t,e){return t.hitArea?!0:t?.containsPoint?(t.worldTransform.applyInverse(e,Bt),t.containsPoint(Bt)):!1}notifyTarget(t,e){if(!t.currentTarget.isInteractive())return;e??=t.type;const s=`on${e}`;t.currentTarget[s]?.(t);const n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this._notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this._notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof J))return;const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const n=e.button===2;this.dispatchEvent(e,n?"rightdown":"mousedown")}const s=this.trackingData(t.pointerId);s.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){if(!(t instanceof J))return;this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const e=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const s=e.pointerType==="mouse"||e.pointerType==="pen",n=this.trackingData(t.pointerId),r=this.findMountedTarget(n.overTargets);if(n.overTargets?.length>0&&r!==e.target){const h=t.type==="mousemove"?"mouseout":"pointerout",c=this.createPointerEvent(t,h,r);if(this.dispatchEvent(c,"pointerout"),s&&this.dispatchEvent(c,"mouseout"),!e.composedPath().includes(r)){const l=this.createPointerEvent(t,"pointerleave",r);for(l.eventPhase=l.AT_TARGET;l.target&&!e.composedPath().includes(l.target);)l.currentTarget=l.target,this.notifyTarget(l),s&&this.notifyTarget(l,"mouseleave"),l.target=l.target.parent;this.freeEvent(l)}this.freeEvent(c)}if(r!==e.target){const h=t.type==="mousemove"?"mouseover":"pointerover",c=this.clonePointerEvent(e,h);this.dispatchEvent(c,"pointerover"),s&&this.dispatchEvent(c,"mouseover");let l=r?.parent;for(;l&&l!==this.rootTarget.parent&&l!==e.target;)l=l.parent;if(!l||l===this.rootTarget.parent){const f=this.clonePointerEvent(e,"pointerenter");for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==r&&f.target!==this.rootTarget.parent;)f.currentTarget=f.target,this.notifyTarget(f),s&&this.notifyTarget(f,"mouseenter"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(c)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(e,"pointermove"),a&&o.push("globalpointermove"),e.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),a&&o.push("globaltouchmove")),s&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),a&&o.push("globalmousemove"),this.cursor=e.target?.cursor),o.length>0&&this.all(e,o),this._allInteractiveElements.length=0,this._hitElements.length=0,n.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){if(!(t instanceof J))return;const e=this.trackingData(t.pointerId),s=this.createPointerEvent(t),n=s.pointerType==="mouse"||s.pointerType==="pen";this.dispatchEvent(s,"pointerover"),n&&this.dispatchEvent(s,"mouseover"),s.pointerType==="mouse"&&(this.cursor=s.target?.cursor);const r=this.clonePointerEvent(s,"pointerenter");for(r.eventPhase=r.AT_TARGET;r.target&&r.target!==this.rootTarget.parent;)r.currentTarget=r.target,this.notifyTarget(r),n&&this.notifyTarget(r,"mouseenter"),r.target=r.target.parent;e.overTargets=s.composedPath(),this.freeEvent(s),this.freeEvent(r)}mapPointerOut(t){if(!(t instanceof J))return;const e=this.trackingData(t.pointerId);if(e.overTargets){const s=t.pointerType==="mouse"||t.pointerType==="pen",n=this.findMountedTarget(e.overTargets),r=this.createPointerEvent(t,"pointerout",n);this.dispatchEvent(r),s&&this.dispatchEvent(r,"mouseout");const o=this.createPointerEvent(t,"pointerleave",n);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),s&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;e.overTargets=null,this.freeEvent(r),this.freeEvent(o)}this.cursor=null}mapPointerUp(t){if(!(t instanceof J))return;const e=performance.now(),s=this.createPointerEvent(t);if(this.dispatchEvent(s,"pointerup"),s.pointerType==="touch")this.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const a=s.button===2;this.dispatchEvent(s,a?"rightup":"mouseup")}const n=this.trackingData(t.pointerId),r=this.findMountedTarget(n.pressTargetsByButton[t.button]);let o=r;if(r&&!s.composedPath().includes(r)){let a=r;for(;a&&!s.composedPath().includes(a);){if(s.currentTarget=a,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")this.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const h=s.button===2;this.notifyTarget(s,h?"rightupoutside":"mouseupoutside")}a=a.parent}delete n.pressTargetsByButton[t.button],o=a}if(o){const a=this.clonePointerEvent(s,"click");a.target=o,a.path=null,n.clicksByButton[t.button]||(n.clicksByButton[t.button]={clickCount:0,target:a.target,timeStamp:e});const h=n.clicksByButton[t.button];if(h.target===a.target&&e-h.timeStamp<200?++h.clickCount:h.clickCount=1,h.target=a.target,h.timeStamp=e,a.detail=h.clickCount,a.pointerType==="mouse"){const c=a.button===2;this.dispatchEvent(a,c?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(s)}mapPointerUpOutside(t){if(!(t instanceof J))return;const e=this.trackingData(t.pointerId),s=this.findMountedTarget(e.pressTargetsByButton[t.button]),n=this.createPointerEvent(t);if(s){let r=s;for(;r;)n.currentTarget=r,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch"?this.notifyTarget(n,"touchendoutside"):(n.pointerType==="mouse"||n.pointerType==="pen")&&this.notifyTarget(n,n.button===2?"rightupoutside":"mouseupoutside"),r=r.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(n)}mapWheel(t){if(!(t instanceof re))return;const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let s=1;s<t.length&&t[s].parent===e;s++)e=t[s];return e}createPointerEvent(t,e,s){const n=this.allocateEvent(J);return this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t,n.target=s??this.hitTest(n.global.x,n.global.y)??this._hitElements[0],typeof e=="string"&&(n.type=e),n}createWheelEvent(t){const e=this.allocateEvent(re);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const s=this.allocateEvent(J);return s.nativeEvent=t.nativeEvent,s.originalEvent=t.originalEvent,this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.target=t.target,s.path=t.composedPath().slice(),s.type=e??s.type,s}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof J&&e instanceof J&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof Lt&&e instanceof Lt&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.defaultPrevented=!1,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}_notifyListeners(t,e){const s=t.currentTarget._events[e];if(s)if("fn"in s)s.once&&t.currentTarget.removeListener(e,s.fn,void 0,!0),s.fn.call(s.context,t);else for(let n=0,r=s.length;n<r&&!t.propagationImmediatelyStopped;n++)s[n].once&&t.currentTarget.removeListener(e,s[n].fn,void 0,!0),s[n].fn.call(s[n].context,t)}}const yn=1,gn={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class Dt{static extension={name:"events",type:["ExtensionType.WebGLSystem","ExtensionType.CanvasSystem","ExtensionType.WebGPUSystem"],priority:-1};static defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};static _defaultEventMode;static get defaultEventMode(){return this._defaultEventMode}rootBoundary;supportsTouchEvents="ontouchstart"in globalThis;supportsPointerEvents=!!globalThis.PointerEvent;autoPreventDefault;cursorStyles;domElement=null;resolution=1;renderer;features;_currentCursor;_rootPointerEvent;_rootWheelEvent;_eventsAdded;constructor(t){this.renderer=t,this.rootBoundary=new Es(null),nt.init(this),this.autoPreventDefault=!0,this._eventsAdded=!1,this._rootPointerEvent=new J(null),this._rootWheelEvent=new re(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Dt.defaultEventFeatures},{set:(e,s,n)=>(s==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=n),e[s]=n,!0)}),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerUp=this._onPointerUp.bind(this),this._onPointerOverOut=this._onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}init(t){const{canvas:e,resolution:s}=this.renderer;this.setTargetElement(e),this.resolution=s,Dt._defaultEventMode=t.eventMode??"passive",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null,this._currentCursor=null}setCursor(t){t||="default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this._currentCursor===t)return;this._currentCursor=t;const s=this.cursorStyles[t];if(s)switch(typeof s){case"string":e&&(this.domElement.style.cursor=s);break;case"function":s(t);break;case"object":e&&Object.assign(this.domElement.style,s);break}else e&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this._rootPointerEvent}_onPointerDown(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this._normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let s=0,n=e.length;s<n;s++){const r=e[s],o=this._bootstrapEvent(this._rootPointerEvent,r);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}_onPointerMove(t){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,nt.pointerMoved();const e=this._normalizeToPointerData(t);for(let s=0,n=e.length;s<n;s++){const r=this._bootstrapEvent(this._rootPointerEvent,e[s]);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}_onPointerUp(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const s=e!==this.domElement?"outside":"",n=this._normalizeToPointerData(t);for(let r=0,o=n.length;r<o;r++){const a=this._bootstrapEvent(this._rootPointerEvent,n[r]);a.type+=s,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}_onPointerOverOut(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this._normalizeToPointerData(t);for(let s=0,n=e.length;s<n;s++){const r=this._bootstrapEvent(this._rootPointerEvent,e[s]);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this._removeEvents(),this.domElement=t,nt.domElement=t,this._addEvents()}_addEvents(){if(this._eventsAdded||!this.domElement)return;nt.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this._onPointerMove,!0),this.domElement.addEventListener("pointerdown",this._onPointerDown,!0),this.domElement.addEventListener("pointerleave",this._onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this._onPointerOverOut,!0),globalThis.addEventListener("pointerup",this._onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this._onPointerMove,!0),this.domElement.addEventListener("mousedown",this._onPointerDown,!0),this.domElement.addEventListener("mouseout",this._onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this._onPointerOverOut,!0),globalThis.addEventListener("mouseup",this._onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this._onPointerDown,!0),this.domElement.addEventListener("touchend",this._onPointerUp,!0),this.domElement.addEventListener("touchmove",this._onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this._eventsAdded=!0}_removeEvents(){if(!this._eventsAdded||!this.domElement)return;nt.removeTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction="")),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this._onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this._onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this._onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this._onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this._onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this._onPointerMove,!0),this.domElement.removeEventListener("mousedown",this._onPointerDown,!0),this.domElement.removeEventListener("mouseout",this._onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this._onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this._onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this._onPointerDown,!0),this.domElement.removeEventListener("touchend",this._onPointerUp,!0),this.domElement.removeEventListener("touchmove",this._onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this._eventsAdded=!1}mapPositionToPoint(t,e,s){const n=this.domElement.isConnected?this.domElement.getBoundingClientRect():{width:this.domElement.width,height:this.domElement.height,left:0,top:0},r=1/this.resolution;t.x=(e-n.left)*(this.domElement.width/n.width)*r,t.y=(s-n.top)*(this.domElement.height/n.height)*r}_normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let s=0,n=t.changedTouches.length;s<n;s++){const r=t.changedTouches[s];typeof r.button>"u"&&(r.button=0),typeof r.buttons>"u"&&(r.buttons=1),typeof r.isPrimary>"u"&&(r.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof r.width>"u"&&(r.width=r.radiusX||1),typeof r.height>"u"&&(r.height=r.radiusY||1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="touch"),typeof r.pointerId>"u"&&(r.pointerId=r.identifier||0),typeof r.pressure>"u"&&(r.pressure=r.force||.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),typeof r.layerX>"u"&&(r.layerX=r.offsetX=r.clientX),typeof r.layerY>"u"&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=t.type,e.push(r)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const s=t;typeof s.isPrimary>"u"&&(s.isPrimary=!0),typeof s.width>"u"&&(s.width=1),typeof s.height>"u"&&(s.height=1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="mouse"),typeof s.pointerId>"u"&&(s.pointerId=yn),typeof s.pressure>"u"&&(s.pressure=.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),s.isNormalized=!0,e.push(s)}else e.push(t);return e}normalizeWheelEvent(t){const e=this._rootWheelEvent;return this._transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}_bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this._transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=gn[t.type]||t.type),t}_transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}}const _n={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,get interactive(){return this.eventMode==="dynamic"||this.eventMode==="static"},set interactive(i){this.eventMode=i?"static":"passive"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Dt.defaultEventMode},set eventMode(i){this._internalEventMode=i},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(i,t,e){const s=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,n=typeof e=="object"?e.signal:void 0,r=typeof e=="object"?e.once===!0:!1,o=typeof t=="function"?void 0:t;i=s?`${i}capture`:i;const a=typeof t=="function"?t:t.handleEvent,h=this;n&&n.addEventListener("abort",()=>{h.off(i,a,o)}),r?h.once(i,a,o):h.on(i,a,o)},removeEventListener(i,t,e){const s=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,n=typeof t=="function"?void 0:t;i=s?`${i}capture`:i,t=typeof t=="function"?t:t.handleEvent,this.off(i,t,n)},dispatchEvent(i){if(!(i instanceof Rt))throw new Error("Container cannot propagate events outside of the Federated Events API");return i.defaultPrevented=!1,i.path=null,i.target=this,i.manager.dispatchEvent(i),!i.defaultPrevented}},Ts=Math.PI*2,xn=180/Math.PI,bn=Math.PI/180;class H{a;b;c;d;tx;ty;array=null;constructor(t=1,e=0,s=0,n=1,r=0,o=0){this.a=t,this.b=e,this.c=s,this.d=n,this.tx=r,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,s,n,r,o){return this.a=t,this.b=e,this.c=s,this.d=n,this.tx=r,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const s=e||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(t,e){e=e||new R;const s=t.x,n=t.y;return e.x=this.a*s+this.c*n+this.tx,e.y=this.b*s+this.d*n+this.ty,e}applyInverse(t,e){e=e||new R;const s=this.a,n=this.b,r=this.c,o=this.d,a=this.tx,h=this.ty,c=1/(s*o+r*-n),l=t.x,u=t.y;return e.x=o*c*l+-r*c*u+(h*r-a*o)*c,e.y=s*c*u+-n*c*l+(-h*s+a*n)*c,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),s=Math.sin(t),n=this.a,r=this.c,o=this.tx;return this.a=n*e-this.b*s,this.b=n*s+this.b*e,this.c=r*e-this.d*s,this.d=r*s+this.d*e,this.tx=o*e-this.ty*s,this.ty=o*s+this.ty*e,this}append(t){const e=this.a,s=this.b,n=this.c,r=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*s+t.b*r,this.c=t.c*e+t.d*n,this.d=t.c*s+t.d*r,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*s+t.ty*r+this.ty,this}appendFrom(t,e){const s=t.a,n=t.b,r=t.c,o=t.d,a=t.tx,h=t.ty,c=e.a,l=e.b,u=e.c,f=e.d;return this.a=s*c+n*u,this.b=s*l+n*f,this.c=r*c+o*u,this.d=r*l+o*f,this.tx=a*c+h*u+e.tx,this.ty=a*l+h*f+e.ty,this}setTransform(t,e,s,n,r,o,a,h,c){return this.a=Math.cos(a+c)*r,this.b=Math.sin(a+c)*r,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(s*this.a+n*this.c),this.ty=e-(s*this.b+n*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const s=this.a,n=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,s=this.b,n=this.c,r=this.d,o=t.pivot,a=-Math.atan2(-n,r),h=Math.atan2(s,e),c=Math.abs(a+h);return c<1e-5||Math.abs(Ts-c)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(e*e+s*s),t.scale.y=Math.sqrt(n*n+r*r),t.position.x=this.tx+(o.x*e+o.y*n),t.position.y=this.ty+(o.x*s+o.y*r),t}invert(){const t=this.a,e=this.b,s=this.c,n=this.d,r=this.tx,o=t*n-e*s;return this.a=n/o,this.b=-e/o,this.c=-s/o,this.d=t/o,this.tx=(s*this.ty-n*r)/o,this.ty=-(t*this.ty-e*r)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new H;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return vn.identity()}static get shared(){return An.identity()}}const An=new H,vn=new H,ht=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],lt=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ct=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ut=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Be=[],Ss=[],oe=Math.sign;function Pn(){for(let i=0;i<16;i++){const t=[];Be.push(t);for(let e=0;e<16;e++){const s=oe(ht[i]*ht[e]+ct[i]*lt[e]),n=oe(lt[i]*ht[e]+ut[i]*lt[e]),r=oe(ht[i]*ct[e]+ct[i]*ut[e]),o=oe(lt[i]*ct[e]+ut[i]*ut[e]);for(let a=0;a<16;a++)if(ht[a]===s&&lt[a]===n&&ct[a]===r&&ut[a]===o){t.push(a);break}}}for(let i=0;i<16;i++){const t=new H;t.set(ht[i],lt[i],ct[i],ut[i],0,0),Ss.push(t)}}Pn();const S={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:i=>ht[i],uY:i=>lt[i],vX:i=>ct[i],vY:i=>ut[i],inv:i=>i&8?i&15:-i&7,add:(i,t)=>Be[i][t],sub:(i,t)=>Be[i][S.inv(t)],rotate180:i=>i^4,isVertical:i=>(i&3)===2,byDirection:(i,t)=>Math.abs(i)*2<=Math.abs(t)?t>=0?S.S:S.N:Math.abs(t)*2<=Math.abs(i)?i>0?S.E:S.W:t>0?i>0?S.SE:S.SW:i>0?S.NE:S.NW,matrixAppendRotationInv:(i,t,e=0,s=0)=>{const n=Ss[S.inv(t)];n.tx=e,n.ty=s,i.append(n)},transformRectCoords:(i,t,e,s)=>{const{x:n,y:r,width:o,height:a}=i,{x:h,y:c,width:l,height:u}=t;return e===S.E?(s.set(n+h,r+c,o,a),s):e===S.S?s.set(l-r-a+h,n+c,a,o):e===S.W?s.set(l-n-o+h,u-r-a+c,o,a):e===S.N?s.set(r+h,u-n-o+c,a,o):s.set(n+h,r+c,o,a)}};function dt(i){return i+=i===0?1:0,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i+1}function De(i){return!(i&i-1)&&!!i}function wn(i){let t=(i>65535?1:0)<<4;i>>>=t;let e=(i>255?1:0)<<3;return i>>>=e,t|=e,e=(i>15?1:0)<<2,i>>>=e,t|=e,e=(i>3?1:0)<<1,i>>>=e,t|=e,t|i>>1}function Ot(i,t,e,s,n,r){const o=i-e,a=t-s,h=n-e,c=r-s,l=o*h+a*c,u=h*h+c*c;let f=-1;u!==0&&(f=l/u);let d,m;f<0?(d=e,m=s):f>1?(d=n,m=r):(d=e+f*h,m=s+f*c);const y=i-d,g=t-m;return y*y+g*g}class ft{_x;_y;_observer;constructor(t,e,s){this._x=e||0,this._y=s||0,this._observer=t}clone(t){return new ft(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}function Mn(i,t,e,s,n,r,o,a){const h=o-e,c=a-s,l=n-e,u=r-s,f=i-e,d=t-s,m=h*h+c*c,y=h*l+c*u,g=h*f+c*d,_=l*l+u*u,x=l*f+u*d,v=1/(m*_-y*y),b=(_*g-y*x)*v,E=(m*x-y*g)*v;return b>=0&&E>=0&&b+E<1}const ae=[new R,new R,new R,new R];class ${type="rectangle";x;y;width;height;constructor(t=0,e=0,s=0,n=0){this.x=Number(t),this.y=Number(e),this.width=Number(s),this.height=Number(n)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new $(0,0,0,0)}clone(){return new $(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,s,n=.5){const{width:r,height:o}=this;if(r<=0||o<=0)return!1;const a=this.x,h=this.y,c=s*(1-n),l=s-c,u=a-c,f=a+r+c,d=h-c,m=h+o+c,y=a+l,g=a+r-l,_=h+l,x=h+o-l;return t>=u&&t<=f&&e>=d&&e<=m&&!(t>y&&t<g&&e>_&&e<x)}intersects(t,e){if(!e){const k=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=k)return!1;const w=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>w}const s=this.left,n=this.right,r=this.top,o=this.bottom;if(n<=s||o<=r)return!1;const a=ae[0].set(t.left,t.top),h=ae[1].set(t.left,t.bottom),c=ae[2].set(t.right,t.top),l=ae[3].set(t.right,t.bottom);if(c.x<=a.x||h.y<=a.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(a,a),e.apply(h,h),e.apply(c,c),e.apply(l,l),Math.max(a.x,h.x,c.x,l.x)<=s||Math.min(a.x,h.x,c.x,l.x)>=n||Math.max(a.y,h.y,c.y,l.y)<=r||Math.min(a.y,h.y,c.y,l.y)>=o))return!1;const f=u*(h.y-a.y),d=u*(a.x-h.x),m=f*s+d*r,y=f*n+d*r,g=f*s+d*o,_=f*n+d*o;if(Math.max(m,y,g,_)<=f*a.x+d*a.y||Math.min(m,y,g,_)>=f*l.x+d*l.y)return!1;const x=u*(a.y-c.y),v=u*(c.x-a.x),b=x*s+v*r,E=x*n+v*r,P=x*s+v*o,A=x*n+v*o;return!(Math.max(b,E,P,A)<=x*a.x+v*a.y||Math.min(b,E,P,A)>=x*l.x+v*l.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),n=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(s-e,0),this.y=n,this.height=Math.max(r-n,0),this}ceil(t=1,e=.001){const s=Math.ceil((this.x+this.width-e)*t)/t,n=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=s-this.x,this.height=n-this.y,this}scale(t,e=t){return this.x*=t,this.y*=e,this.width*=t,this.height*=e,this}enlarge(t){const e=Math.min(this.x,t.x),s=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),r=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=s-e,this.y=n,this.height=r-n,this}getBounds(t){return t||=new $,t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const e=t.x,s=t.y,n=t.x+t.width,r=t.y+t.height;return e>=this.x&&e<this.x+this.width&&s>=this.y&&s<this.y+this.height&&n>=this.x&&n<this.x+this.width&&r>=this.y&&r<this.y+this.height}set(t,e,s,n){return this.x=t,this.y=e,this.width=s,this.height=n,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class he{x;y;radius;type="circle";constructor(t=0,e=0,s=0){this.x=t,this.y=e,this.radius=s}clone(){return new he(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const s=this.radius*this.radius;let n=this.x-t,r=this.y-e;return n*=n,r*=r,n+r<=s}strokeContains(t,e,s,n=.5){if(this.radius===0)return!1;const r=this.x-t,o=this.y-e,a=this.radius,h=(1-n)*s,c=Math.sqrt(r*r+o*o);return c<=a+h&&c>a-(s-h)}getBounds(t){return t||=new $,t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class le{x;y;halfWidth;halfHeight;type="ellipse";constructor(t=0,e=0,s=0,n=0){this.x=t,this.y=e,this.halfWidth=s,this.halfHeight=n}clone(){return new le(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let s=(t-this.x)/this.halfWidth,n=(e-this.y)/this.halfHeight;return s*=s,n*=n,s+n<=1}strokeContains(t,e,s,n=.5){const{halfWidth:r,halfHeight:o}=this;if(r<=0||o<=0)return!1;const a=s*(1-n),h=s-a,c=r-h,l=o-h,u=r+a,f=o+a,d=t-this.x,m=e-this.y,y=d*d/(c*c)+m*m/(l*l),g=d*d/(u*u)+m*m/(f*f);return y>1&&g<=1}getBounds(t){return t||=new $,t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}let En,Tn;class wt{points;closePath;type="polygon";constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const s=[];for(let n=0,r=e.length;n<r;n++)s.push(e[n].x,e[n].y);e=s}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,s=e.length;for(let n=0;n<s;n+=2){const r=e[n],o=e[n+1],a=e[(n+2)%s],h=e[(n+3)%s];t+=(a-r)*(h+o)}return t<0}containsPolygon(t){const e=this.getBounds(En),s=t.getBounds(Tn);if(!e.containsRect(s))return!1;const n=t.points;for(let r=0;r<n.length;r+=2){const o=n[r],a=n[r+1];if(!this.contains(o,a))return!1}return!0}clone(){const t=this.points.slice(),e=new wt(t);return e.closePath=this.closePath,e}contains(t,e){let s=!1;const n=this.points.length/2;for(let r=0,o=n-1;r<n;o=r++){const a=this.points[r*2],h=this.points[r*2+1],c=this.points[o*2],l=this.points[o*2+1];h>e!=l>e&&t<(c-a)*((e-h)/(l-h))+a&&(s=!s)}return s}strokeContains(t,e,s,n=.5){const r=s*s,o=r*(1-n),a=r-o,{points:h}=this,c=h.length-(this.closePath?0:2);for(let l=0;l<c;l+=2){const u=h[l],f=h[l+1],d=h[(l+2)%h.length],m=h[(l+3)%h.length],y=Ot(t,e,u,f,d,m),g=Math.sign((d-u)*(e-f)-(m-f)*(t-u));if(y<=(g<0?a:o))return!0}return!1}getBounds(t){t||=new $;const e=this.points;let s=1/0,n=-1/0,r=1/0,o=-1/0;for(let a=0,h=e.length;a<h;a+=2){const c=e[a],l=e[a+1];s=c<s?c:s,n=c>n?c:n,r=l<r?l:r,o=l>o?l:o}return t.x=s,t.width=n-s,t.y=r,t.height=o-r,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const ce=(i,t,e,s,n,r,o)=>{const a=i-e,h=t-s,c=Math.sqrt(a*a+h*h);return c>=n-r&&c<=n+o};class ue{x;y;width;height;radius;type="roundedRectangle";constructor(t=0,e=0,s=0,n=0,r=20){this.x=t,this.y=e,this.width=s,this.height=n,this.radius=r}getBounds(t){return t||=new $,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new ue(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+s&&e<=this.y+this.height-s||t>=this.x+s&&t<=this.x+this.width-s)return!0;let n=t-(this.x+s),r=e-(this.y+s);const o=s*s;if(n*n+r*r<=o||(n=t-(this.x+this.width-s),n*n+r*r<=o)||(r=e-(this.y+this.height-s),n*n+r*r<=o)||(n=t-(this.x+s),n*n+r*r<=o))return!0}return!1}strokeContains(t,e,s,n=.5){const{x:r,y:o,width:a,height:h,radius:c}=this,l=s*(1-n),u=s-l,f=r+c,d=o+c,m=a-c*2,y=h-c*2,g=r+a,_=o+h;return(t>=r-l&&t<=r+u||t>=g-u&&t<=g+l)&&e>=d&&e<=d+y||(e>=o-l&&e<=o+u||e>=_-u&&e<=_+l)&&t>=f&&t<=f+m?!0:t<f&&e<d&&ce(t,e,f,d,c,u,l)||t>g-c&&e<d&&ce(t,e,g-c,d,c,u,l)||t>g-c&&e>_-c&&ce(t,e,g-c,_-c,c,u,l)||t<f&&e>_-c&&ce(t,e,f,_-c,c,u,l)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class Oe{type="triangle";x;y;x2;y2;x3;y3;constructor(t=0,e=0,s=0,n=0,r=0,o=0){this.x=t,this.y=e,this.x2=s,this.y2=n,this.x3=r,this.y3=o}contains(t,e){const s=(this.x-this.x3)*(e-this.y3)-(this.y-this.y3)*(t-this.x3),n=(this.x2-this.x)*(e-this.y)-(this.y2-this.y)*(t-this.x);if(s<0!=n<0&&s!==0&&n!==0)return!1;const r=(this.x3-this.x2)*(e-this.y2)-(this.y3-this.y2)*(t-this.x2);return r===0||r<0==s+n<=0}strokeContains(t,e,s,n=.5){const r=s/2,o=r*r,{x:a,x2:h,x3:c,y:l,y2:u,y3:f}=this;return Ot(t,e,a,l,h,f)<=o||Ot(t,e,h,u,c,f)<=o||Ot(t,e,c,f,a,l)<=o}clone(){return new Oe(this.x,this.y,this.x2,this.y2,this.x3,this.y3)}copyFrom(t){return this.x=t.x,this.y=t.y,this.x2=t.x2,this.y2=t.y2,this.x3=t.x3,this.y3=t.y3,this}copyTo(t){return t.copyFrom(this),t}getBounds(t){t||=new $;const e=Math.min(this.x,this.x2,this.x3),s=Math.max(this.x,this.x2,this.x3),n=Math.min(this.y,this.y2,this.y3),r=Math.max(this.y,this.y2,this.y3);return t.x=e,t.y=n,t.width=s-e,t.height=r-n,t}}const Sn=8,de=11920929e-14,Cn=1;function Ue(i,t,e,s,n,r,o,a,h,c){const u=Math.min(.99,Math.max(0,c??.5));let f=(Cn-u)/1;return f*=f,kn(t,e,s,n,r,o,a,h,i,f),i}function kn(i,t,e,s,n,r,o,a,h,c){Xe(i,t,e,s,n,r,o,a,h,c,0),h.push(o,a)}function Xe(i,t,e,s,n,r,o,a,h,c,l){if(l>Sn)return;const u=(i+e)/2,f=(t+s)/2,d=(e+n)/2,m=(s+r)/2,y=(n+o)/2,g=(r+a)/2,_=(u+d)/2,x=(f+m)/2,v=(d+y)/2,b=(m+g)/2,E=(_+v)/2,P=(x+b)/2;if(l>0){let A=o-i,k=a-t;const I=Math.abs((e-o)*k-(s-a)*A),w=Math.abs((n-o)*k-(r-a)*A);if(I>de&&w>de){if((I+w)*(I+w)<=c*(A*A+k*k)){h.push(E,P);return}}else if(I>de){if(I*I<=c*(A*A+k*k)){h.push(E,P);return}}else if(w>de){if(w*w<=c*(A*A+k*k)){h.push(E,P);return}}else if(A=E-(i+o)/2,k=P-(t+a)/2,A*A+k*k<=c){h.push(E,P);return}}Xe(i,t,u,f,_,x,E,P,h,c,l+1),Xe(E,P,v,b,y,g,o,a,h,c,l+1)}const In=8,Fn=11920929e-14,Rn=1;function Cs(i,t,e,s,n,r,o,a){const c=Math.min(.99,Math.max(0,a??.5));let l=(Rn-c)/1;return l*=l,Ln(t,e,s,n,r,o,i,l),i}function Ln(i,t,e,s,n,r,o,a){Ye(o,i,t,e,s,n,r,a,0),o.push(n,r)}function Ye(i,t,e,s,n,r,o,a,h){if(h>In)return;const c=(t+s)/2,l=(e+n)/2,u=(s+r)/2,f=(n+o)/2,d=(c+u)/2,m=(l+f)/2;let y=r-t,g=o-e;const _=Math.abs((s-r)*g-(n-o)*y);if(_>Fn){if(_*_<=a*(y*y+g*g)){i.push(d,m);return}}else if(y=d-(t+r)/2,g=m-(e+o)/2,y*y+g*g<=a){i.push(d,m);return}Ye(i,t,e,c,l,d,m,a,h+1),Ye(i,d,m,u,f,r,o,a,h+1)}function Ne(i,t,e,s,n,r,o,a){let h=Math.abs(n-r);(!o&&n>r||o&&r>n)&&(h=2*Math.PI-h),a||=Math.max(6,Math.floor(6*Math.pow(s,1/3)*(h/Math.PI))),a=Math.max(a,3);let c=h/a,l=n;c*=o?-1:1;for(let u=0;u<a+1;u++){const f=Math.cos(l),d=Math.sin(l),m=t+f*s,y=e+d*s;i.push(m,y),l+=c}}function ks(i,t,e,s,n,r){const o=i[i.length-2],h=i[i.length-1]-e,c=o-t,l=n-e,u=s-t,f=Math.abs(h*u-c*l);if(f<1e-8||r===0){(i[i.length-2]!==t||i[i.length-1]!==e)&&i.push(t,e);return}const d=h*h+c*c,m=l*l+u*u,y=h*l+c*u,g=r*Math.sqrt(d)/f,_=r*Math.sqrt(m)/f,x=g*y/d,v=_*y/m,b=g*u+_*c,E=g*l+_*h,P=c*(_+x),A=h*(_+x),k=u*(g+v),I=l*(g+v),w=Math.atan2(A-E,P-b),M=Math.atan2(I-E,k-b);Ne(i,b+t,E+e,r,w,M,c*l>u*h)}const Ut=Math.PI*2,He={centerX:0,centerY:0,ang1:0,ang2:0},$e=({x:i,y:t},e,s,n,r,o,a,h)=>{i*=e,t*=s;const c=n*i-r*t,l=r*i+n*t;return h.x=c+o,h.y=l+a,h};function Bn(i,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),s=t===1.5707963267948966?.551915024494:e,n=Math.cos(i),r=Math.sin(i),o=Math.cos(i+t),a=Math.sin(i+t);return[{x:n-r*s,y:r+n*s},{x:o+a*s,y:a-o*s},{x:o,y:a}]}const Is=(i,t,e,s)=>{const n=i*s-t*e<0?-1:1;let r=i*e+t*s;return r>1&&(r=1),r<-1&&(r=-1),n*Math.acos(r)},Dn=(i,t,e,s,n,r,o,a,h,c,l,u,f)=>{const d=Math.pow(n,2),m=Math.pow(r,2),y=Math.pow(l,2),g=Math.pow(u,2);let _=d*m-d*g-m*y;_<0&&(_=0),_/=d*g+m*y,_=Math.sqrt(_)*(o===a?-1:1);const x=_*n/r*u,v=_*-r/n*l,b=c*x-h*v+(i+e)/2,E=h*x+c*v+(t+s)/2,P=(l-x)/n,A=(u-v)/r,k=(-l-x)/n,I=(-u-v)/r,w=Is(1,0,P,A);let M=Is(P,A,k,I);a===0&&M>0&&(M-=Ut),a===1&&M<0&&(M+=Ut),f.centerX=b,f.centerY=E,f.ang1=w,f.ang2=M};function Fs(i,t,e,s,n,r,o,a=0,h=0,c=0){if(r===0||o===0)return;const l=Math.sin(a*Ut/360),u=Math.cos(a*Ut/360),f=u*(t-s)/2+l*(e-n)/2,d=-l*(t-s)/2+u*(e-n)/2;if(f===0&&d===0)return;r=Math.abs(r),o=Math.abs(o);const m=Math.pow(f,2)/Math.pow(r,2)+Math.pow(d,2)/Math.pow(o,2);m>1&&(r*=Math.sqrt(m),o*=Math.sqrt(m)),Dn(t,e,s,n,r,o,h,c,l,u,f,d,He);let{ang1:y,ang2:g}=He;const{centerX:_,centerY:x}=He;let v=Math.abs(g)/(Ut/4);Math.abs(1-v)<1e-7&&(v=1);const b=Math.max(Math.ceil(v),1);g/=b;let E=i[i.length-2],P=i[i.length-1];const A={x:0,y:0};for(let k=0;k<b;k++){const I=Bn(y,g),{x:w,y:M}=$e(I[0],r,o,u,l,_,x,A),{x:D,y:O}=$e(I[1],r,o,u,l,_,x,A),{x:z,y:zt}=$e(I[2],r,o,u,l,_,x,A);Ue(i,E,P,w,M,D,O,z,zt),E=z,P=zt,y+=g}}const Xt={extension:{type:"ExtensionType.ShapeBuilder",name:"circle"},build(i,t){let e,s,n,r,o,a;if(i.type==="circle"){const b=i;if(o=a=b.radius,o<=0)return!1;e=b.x,s=b.y,n=r=0}else if(i.type==="ellipse"){const b=i;if(o=b.halfWidth,a=b.halfHeight,o<=0||a<=0)return!1;e=b.x,s=b.y,n=r=0}else{const b=i,E=b.width/2,P=b.height/2;e=b.x+E,s=b.y+P,o=a=Math.max(0,Math.min(b.radius,Math.min(E,P))),n=E-o,r=P-a}if(n<0||r<0)return!1;const h=Math.ceil(2.3*Math.sqrt(o+a)),c=h*8+(n?4:0)+(r?4:0);if(c===0)return!1;if(h===0)return t[0]=t[6]=e+n,t[1]=t[3]=s+r,t[2]=t[4]=e-n,t[5]=t[7]=s-r,!0;let l=0,u=h*4+(n?2:0)+2,f=u,d=c,m=n+o,y=r,g=e+m,_=e-m,x=s+y;if(t[l++]=g,t[l++]=x,t[--u]=x,t[--u]=_,r){const b=s-y;t[f++]=_,t[f++]=b,t[--d]=b,t[--d]=g}for(let b=1;b<h;b++){const E=Math.PI/2*(b/h),P=n+Math.cos(E)*o,A=r+Math.sin(E)*a,k=e+P,I=e-P,w=s+A,M=s-A;t[l++]=k,t[l++]=w,t[--u]=w,t[--u]=I,t[f++]=I,t[f++]=M,t[--d]=M,t[--d]=k}m=n,y=r+a,g=e+m,_=e-m,x=s+y;const v=s-y;return t[l++]=g,t[l++]=x,t[--d]=v,t[--d]=g,n&&(t[l++]=_,t[l++]=x,t[--d]=v,t[--d]=_),!0},triangulate(i,t,e,s,n,r){if(i.length===0)return;let o=0,a=0;for(let l=0;l<i.length;l+=2)o+=i[l],a+=i[l+1];o/=i.length/2,a/=i.length/2;let h=s;t[h*e]=o,t[h*e+1]=a;const c=h++;for(let l=0;l<i.length;l+=2)t[h*e]=i[l],t[h*e+1]=i[l+1],l>0&&(n[r++]=h,n[r++]=c,n[r++]=h-1),h++;n[r++]=c+1,n[r++]=c,n[r++]=h-1}},On={...Xt,extension:{...Xt.extension,name:"ellipse"}},Un={...Xt,extension:{...Xt.extension,name:"roundedRectangle"}},We=1e-4,Ge=1e-4;function Rs(i){const t=i.length;if(t<6)return 1;let e=0;for(let s=0,n=i[t-2],r=i[t-1];s<t;s+=2){const o=i[s],a=i[s+1];e+=(o-n)*(a+r),n=o,r=a}return e<0?-1:1}function Ls(i,t,e,s,n,r,o,a){const h=i-e*n,c=t-s*n,l=i+e*r,u=t+s*r;let f,d;o?(f=s,d=-e):(f=-s,d=e);const m=h+f,y=c+d,g=l+f,_=u+d;return a.push(m,y),a.push(g,_),2}function pt(i,t,e,s,n,r,o,a){const h=e-i,c=s-t;let l=Math.atan2(h,c),u=Math.atan2(n-i,r-t);a&&l<u?l+=Math.PI*2:!a&&l>u&&(u+=Math.PI*2);let f=l;const d=u-l,m=Math.abs(d),y=Math.sqrt(h*h+c*c),g=(15*m*Math.sqrt(y)/Math.PI>>0)+1,_=d/g;if(f+=_,a){o.push(i,t),o.push(e,s);for(let x=1,v=f;x<g;x++,v+=_)o.push(i,t),o.push(i+Math.sin(v)*y,t+Math.cos(v)*y);o.push(i,t),o.push(n,r)}else{o.push(e,s),o.push(i,t);for(let x=1,v=f;x<g;x++,v+=_)o.push(i+Math.sin(v)*y,t+Math.cos(v)*y),o.push(i,t);o.push(n,r),o.push(i,t)}return g*2}function Xn(i,t,e,s,n,r){const o=We;if(i.length===0)return;const a=t;let h=a.alignment;if(t.alignment!==.5){let F=Rs(i);e&&(F*=-1),h=(h-.5)*F+.5}const c=new R(i[0],i[1]),l=new R(i[i.length-2],i[i.length-1]),u=s,f=Math.abs(c.x-l.x)<o&&Math.abs(c.y-l.y)<o;if(u){i=i.slice(),f&&(i.pop(),i.pop(),l.set(i[i.length-2],i[i.length-1]));const F=(c.x+l.x)*.5,at=(l.y+c.y)*.5;i.unshift(F,at),i.push(F,at)}const d=n,m=i.length/2;let y=i.length;const g=d.length/2,_=a.width/2,x=_*_,v=a.miterLimit*a.miterLimit;let b=i[0],E=i[1],P=i[2],A=i[3],k=0,I=0,w=-(E-A),M=b-P,D=0,O=0,z=Math.sqrt(w*w+M*M);w/=z,M/=z,w*=_,M*=_;const zt=h,T=(1-zt)*2,C=zt*2;u||(a.cap==="round"?y+=pt(b-w*(T-C)*.5,E-M*(T-C)*.5,b-w*T,E-M*T,b+w*C,E+M*C,d,!0)+2:a.cap==="square"&&(y+=Ls(b,E,w,M,T,C,!0,d))),d.push(b-w*T,E-M*T),d.push(b+w*C,E+M*C);for(let F=1;F<m-1;++F){b=i[(F-1)*2],E=i[(F-1)*2+1],P=i[F*2],A=i[F*2+1],k=i[(F+1)*2],I=i[(F+1)*2+1],w=-(E-A),M=b-P,z=Math.sqrt(w*w+M*M),w/=z,M/=z,w*=_,M*=_,D=-(A-I),O=P-k,z=Math.sqrt(D*D+O*O),D/=z,O/=z,D*=_,O*=_;const at=P-b,Zt=E-A,Kt=P-k,Qt=I-A,Li=at*Kt+Zt*Qt,we=Zt*Kt-Qt*at,Jt=we<0;if(Math.abs(we)<.001*Math.abs(Li)){d.push(P-w*T,A-M*T),d.push(P+w*C,A+M*C),Li>=0&&(a.join==="round"?y+=pt(P,A,P-w*T,A-M*T,P-D*T,A-O*T,d,!1)+4:y+=2,d.push(P-D*C,A-O*C),d.push(P+D*T,A+O*T));continue}const Bi=(-w+b)*(-M+A)-(-w+P)*(-M+E),Di=(-D+k)*(-O+A)-(-D+P)*(-O+I),Me=(at*Di-Kt*Bi)/we,Ee=(Qt*Bi-Zt*Di)/we,cs=(Me-P)*(Me-P)+(Ee-A)*(Ee-A),bt=P+(Me-P)*T,At=A+(Ee-A)*T,vt=P-(Me-P)*C,Pt=A-(Ee-A)*C,_o=Math.min(at*at+Zt*Zt,Kt*Kt+Qt*Qt),Oi=Jt?T:C,xo=_o+Oi*Oi*x;cs<=xo?a.join==="bevel"||cs/x>v?(Jt?(d.push(bt,At),d.push(P+w*C,A+M*C),d.push(bt,At),d.push(P+D*C,A+O*C)):(d.push(P-w*T,A-M*T),d.push(vt,Pt),d.push(P-D*T,A-O*T),d.push(vt,Pt)),y+=2):a.join==="round"?Jt?(d.push(bt,At),d.push(P+w*C,A+M*C),y+=pt(P,A,P+w*C,A+M*C,P+D*C,A+O*C,d,!0)+4,d.push(bt,At),d.push(P+D*C,A+O*C)):(d.push(P-w*T,A-M*T),d.push(vt,Pt),y+=pt(P,A,P-w*T,A-M*T,P-D*T,A-O*T,d,!1)+4,d.push(P-D*T,A-O*T),d.push(vt,Pt)):(d.push(bt,At),d.push(vt,Pt)):(d.push(P-w*T,A-M*T),d.push(P+w*C,A+M*C),a.join==="round"?Jt?y+=pt(P,A,P+w*C,A+M*C,P+D*C,A+O*C,d,!0)+2:y+=pt(P,A,P-w*T,A-M*T,P-D*T,A-O*T,d,!1)+2:a.join==="miter"&&cs/x<=v&&(Jt?(d.push(vt,Pt),d.push(vt,Pt)):(d.push(bt,At),d.push(bt,At)),y+=2),d.push(P-D*T,A-O*T),d.push(P+D*C,A+O*C),y+=2)}b=i[(m-2)*2],E=i[(m-2)*2+1],P=i[(m-1)*2],A=i[(m-1)*2+1],w=-(E-A),M=b-P,z=Math.sqrt(w*w+M*M),w/=z,M/=z,w*=_,M*=_,d.push(P-w*T,A-M*T),d.push(P+w*C,A+M*C),u||(a.cap==="round"?y+=pt(P-w*(T-C)*.5,A-M*(T-C)*.5,P-w*T,A-M*T,P+w*C,A+M*C,d,!1)+2:a.cap==="square"&&(y+=Ls(P,A,w,M,T,C,!1,d)));const go=Ge*Ge;for(let F=g;F<y+g-2;++F)b=d[F*2],E=d[F*2+1],P=d[(F+1)*2],A=d[(F+1)*2+1],k=d[(F+2)*2],I=d[(F+2)*2+1],!(Math.abs(b*(A-I)+P*(I-E)+k*(E-A))<go)&&r.push(F,F+1,F+2)}function Yn(i,t,e,s){const n=We;if(i.length===0)return;const r=i[0],o=i[1],a=i[i.length-2],h=i[i.length-1],c=t||Math.abs(r-a)<n&&Math.abs(o-h)<n,l=e,u=i.length/2,f=l.length/2;for(let d=0;d<u;d++)l.push(i[d*2]),l.push(i[d*2+1]);for(let d=0;d<u-1;d++)s.push(f+d,f+d+1);c&&s.push(f+u-1,f)}function Bs(i,t,e=2){const s=t&&t.length,n=s?t[0]*e:i.length;let r=Ds(i,0,n,e,!0);const o=[];if(!r||r.next===r.prev)return o;let a,h,c;if(s&&(r=Gn(i,t,r,e)),i.length>80*e){a=1/0,h=1/0;let l=-1/0,u=-1/0;for(let f=e;f<n;f+=e){const d=i[f],m=i[f+1];d<a&&(a=d),m<h&&(h=m),d>l&&(l=d),m>u&&(u=m)}c=Math.max(l-a,u-h),c=c!==0?32767/c:0}return Yt(r,o,e,a,h,c,0),o}function Ds(i,t,e,s,n){let r;if(n===sr(i,t,e,s)>0)for(let o=t;o<e;o+=s)r=Ys(o/s|0,i[o],i[o+1],r);else for(let o=e-s;o>=t;o-=s)r=Ys(o/s|0,i[o],i[o+1],r);return r&&Mt(r,r.next)&&($t(r),r=r.next),r}function mt(i,t){if(!i)return i;t||(t=i);let e=i,s;do if(s=!1,!e.steiner&&(Mt(e,e.next)||L(e.prev,e,e.next)===0)){if($t(e),e=t=e.prev,e===e.next)break;s=!0}else e=e.next;while(s||e!==t);return t}function Yt(i,t,e,s,n,r,o){if(!i)return;!o&&r&&Zn(i,s,n,r);let a=i;for(;i.prev!==i.next;){const h=i.prev,c=i.next;if(r?Hn(i,s,n,r):Nn(i)){t.push(h.i,i.i,c.i),$t(i),i=c.next,a=c.next;continue}if(i=c,i===a){o?o===1?(i=$n(mt(i),t),Yt(i,t,e,s,n,r,2)):o===2&&Wn(i,t,e,s,n,r):Yt(mt(i),t,e,s,n,r,1);break}}}function Nn(i){const t=i.prev,e=i,s=i.next;if(L(t,e,s)>=0)return!1;const n=t.x,r=e.x,o=s.x,a=t.y,h=e.y,c=s.y,l=Math.min(n,r,o),u=Math.min(a,h,c),f=Math.max(n,r,o),d=Math.max(a,h,c);let m=s.next;for(;m!==t;){if(m.x>=l&&m.x<=f&&m.y>=u&&m.y<=d&&Nt(n,a,r,h,o,c,m.x,m.y)&&L(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function Hn(i,t,e,s){const n=i.prev,r=i,o=i.next;if(L(n,r,o)>=0)return!1;const a=n.x,h=r.x,c=o.x,l=n.y,u=r.y,f=o.y,d=Math.min(a,h,c),m=Math.min(l,u,f),y=Math.max(a,h,c),g=Math.max(l,u,f),_=Ve(d,m,t,e,s),x=Ve(y,g,t,e,s);let v=i.prevZ,b=i.nextZ;for(;v&&v.z>=_&&b&&b.z<=x;){if(v.x>=d&&v.x<=y&&v.y>=m&&v.y<=g&&v!==n&&v!==o&&Nt(a,l,h,u,c,f,v.x,v.y)&&L(v.prev,v,v.next)>=0||(v=v.prevZ,b.x>=d&&b.x<=y&&b.y>=m&&b.y<=g&&b!==n&&b!==o&&Nt(a,l,h,u,c,f,b.x,b.y)&&L(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;v&&v.z>=_;){if(v.x>=d&&v.x<=y&&v.y>=m&&v.y<=g&&v!==n&&v!==o&&Nt(a,l,h,u,c,f,v.x,v.y)&&L(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;b&&b.z<=x;){if(b.x>=d&&b.x<=y&&b.y>=m&&b.y<=g&&b!==n&&b!==o&&Nt(a,l,h,u,c,f,b.x,b.y)&&L(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function $n(i,t){let e=i;do{const s=e.prev,n=e.next.next;!Mt(s,n)&&Us(s,e,e.next,n)&&Ht(s,n)&&Ht(n,s)&&(t.push(s.i,e.i,n.i),$t(e),$t(e.next),e=i=n),e=e.next}while(e!==i);return mt(e)}function Wn(i,t,e,s,n,r){let o=i;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Jn(o,a)){let h=Xs(o,a);o=mt(o,o.next),h=mt(h,h.next),Yt(o,t,e,s,n,r,0),Yt(h,t,e,s,n,r,0);return}a=a.next}o=o.next}while(o!==i)}function Gn(i,t,e,s){const n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r]*s,h=r<o-1?t[r+1]*s:i.length,c=Ds(i,a,h,s,!1);c===c.next&&(c.steiner=!0),n.push(Qn(c))}n.sort(Vn);for(let r=0;r<n.length;r++)e=qn(n[r],e);return e}function Vn(i,t){let e=i.x-t.x;if(e===0&&(e=i.y-t.y,e===0)){const s=(i.next.y-i.y)/(i.next.x-i.x),n=(t.next.y-t.y)/(t.next.x-t.x);e=s-n}return e}function qn(i,t){const e=jn(i,t);if(!e)return t;const s=Xs(e,i);return mt(s,s.next),mt(e,e.next)}function jn(i,t){let e=t;const s=i.x,n=i.y;let r=-1/0,o;if(Mt(i,e))return e;do{if(Mt(i,e.next))return e.next;if(n<=e.y&&n>=e.next.y&&e.next.y!==e.y){const u=e.x+(n-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(u<=s&&u>r&&(r=u,o=e.x<e.next.x?e:e.next,u===s))return o}e=e.next}while(e!==t);if(!o)return null;const a=o,h=o.x,c=o.y;let l=1/0;e=o;do{if(s>=e.x&&e.x>=h&&s!==e.x&&Os(n<c?s:r,n,h,c,n<c?r:s,n,e.x,e.y)){const u=Math.abs(n-e.y)/(s-e.x);Ht(e,i)&&(u<l||u===l&&(e.x>o.x||e.x===o.x&&zn(o,e)))&&(o=e,l=u)}e=e.next}while(e!==a);return o}function zn(i,t){return L(i.prev,i,t.prev)<0&&L(t.next,i,i.next)<0}function Zn(i,t,e,s){let n=i;do n.z===0&&(n.z=Ve(n.x,n.y,t,e,s)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==i);n.prevZ.nextZ=null,n.prevZ=null,Kn(n)}function Kn(i){let t,e=1;do{let s=i,n;i=null;let r=null;for(t=0;s;){t++;let o=s,a=0;for(let c=0;c<e&&(a++,o=o.nextZ,!!o);c++);let h=e;for(;a>0||h>0&&o;)a!==0&&(h===0||!o||s.z<=o.z)?(n=s,s=s.nextZ,a--):(n=o,o=o.nextZ,h--),r?r.nextZ=n:i=n,n.prevZ=r,r=n;s=o}r.nextZ=null,e*=2}while(t>1);return i}function Ve(i,t,e,s,n){return i=(i-e)*n|0,t=(t-s)*n|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,i|t<<1}function Qn(i){let t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function Os(i,t,e,s,n,r,o,a){return(n-o)*(t-a)>=(i-o)*(r-a)&&(i-o)*(s-a)>=(e-o)*(t-a)&&(e-o)*(r-a)>=(n-o)*(s-a)}function Nt(i,t,e,s,n,r,o,a){return!(i===o&&t===a)&&Os(i,t,e,s,n,r,o,a)}function Jn(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!tr(i,t)&&(Ht(i,t)&&Ht(t,i)&&er(i,t)&&(L(i.prev,i,t.prev)||L(i,t.prev,t))||Mt(i,t)&&L(i.prev,i,i.next)>0&&L(t.prev,t,t.next)>0)}function L(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function Mt(i,t){return i.x===t.x&&i.y===t.y}function Us(i,t,e,s){const n=pe(L(i,t,e)),r=pe(L(i,t,s)),o=pe(L(e,s,i)),a=pe(L(e,s,t));return!!(n!==r&&o!==a||n===0&&fe(i,e,t)||r===0&&fe(i,s,t)||o===0&&fe(e,i,s)||a===0&&fe(e,t,s))}function fe(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function pe(i){return i>0?1:i<0?-1:0}function tr(i,t){let e=i;do{if(e.i!==i.i&&e.next.i!==i.i&&e.i!==t.i&&e.next.i!==t.i&&Us(e,e.next,i,t))return!0;e=e.next}while(e!==i);return!1}function Ht(i,t){return L(i.prev,i,i.next)<0?L(i,t,i.next)>=0&&L(i,i.prev,t)>=0:L(i,t,i.prev)<0||L(i,i.next,t)<0}function er(i,t){let e=i,s=!1;const n=(i.x+t.x)/2,r=(i.y+t.y)/2;do e.y>r!=e.next.y>r&&e.next.y!==e.y&&n<(e.next.x-e.x)*(r-e.y)/(e.next.y-e.y)+e.x&&(s=!s),e=e.next;while(e!==i);return s}function Xs(i,t){const e=qe(i.i,i.x,i.y),s=qe(t.i,t.x,t.y),n=i.next,r=t.prev;return i.next=t,t.prev=i,e.next=n,n.prev=e,s.next=e,e.prev=s,r.next=s,s.prev=r,s}function Ys(i,t,e,s){const n=qe(i,t,e);return s?(n.next=s.next,n.prev=s,s.next.prev=n,s.next=n):(n.prev=n,n.next=n),n}function $t(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function qe(i,t,e){return{i,x:t,y:e,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function sr(i,t,e,s){let n=0;for(let r=t,o=e-s;r<e;r+=s)n+=(i[o]-i[r])*(i[r+1]+i[o+1]),o=r;return n}const Ns=Bs.default||Bs;function Hs(i,t,e,s,n,r,o){const a=Ns(i,t,2);if(!a)return;for(let c=0;c<a.length;c+=3)r[o++]=a[c]+n,r[o++]=a[c+1]+n,r[o++]=a[c+2]+n;let h=n*s;for(let c=0;c<i.length;c+=2)e[h]=i[c],e[h+1]=i[c+1],h+=s}const ir=[],nr={extension:{type:"ExtensionType.ShapeBuilder",name:"polygon"},build(i,t){for(let e=0;e<i.points.length;e++)t[e]=i.points[e];return!0},triangulate(i,t,e,s,n,r){Hs(i,ir,t,e,s,n,r)}},rr={extension:{type:"ExtensionType.ShapeBuilder",name:"rectangle"},build(i,t){const e=i,s=e.x,n=e.y,r=e.width,o=e.height;return r>0&&o>0?(t[0]=s,t[1]=n,t[2]=s+r,t[3]=n,t[4]=s+r,t[5]=n+o,t[6]=s,t[7]=n+o,!0):!1},triangulate(i,t,e,s,n,r){let o=0;s*=e,t[s+o]=i[0],t[s+o+1]=i[1],o+=e,t[s+o]=i[2],t[s+o+1]=i[3],o+=e,t[s+o]=i[6],t[s+o+1]=i[7],o+=e,t[s+o]=i[4],t[s+o+1]=i[5],o+=e;const a=s/e;n[r++]=a,n[r++]=a+1,n[r++]=a+2,n[r++]=a+1,n[r++]=a+3,n[r++]=a+2}},or={extension:{type:"ExtensionType.ShapeBuilder",name:"triangle"},build(i,t){return t[0]=i.x,t[1]=i.y,t[2]=i.x2,t[3]=i.y2,t[4]=i.x3,t[5]=i.y3,!0},triangulate(i,t,e,s,n,r){let o=0;s*=e,t[s+o]=i[0],t[s+o+1]=i[1],o+=e,t[s+o]=i[2],t[s+o+1]=i[3],o+=e,t[s+o]=i[4],t[s+o+1]=i[5];const a=s/e;n[r++]=a,n[r++]=a+1,n[r++]=a+2}},Wt={default:-1};function et(i="default"){return Wt[i]===void 0&&(Wt[i]=-1),++Wt[i]}function ar(){for(const i in Wt)delete Wt[i]}const $s={},Z="8.0.0";function j(i,t,e=3){if($s[t])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`):(s=s.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${i}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`),console.warn(s))),$s[t]=!0}function Ws(i){const t={};for(const e in i)i[e]!==void 0&&(t[e]=i[e]);return t}const je=()=>{},Gs=Object.create(null);function hr(i){const t=Gs[i];return t===void 0&&(Gs[i]=et("resource")),t}class Gt extends U{_resourceType="textureSampler";_touched=0;_sharedResourceId;static defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};addressModeU;addressModeV;addressModeW;magFilter;minFilter;mipmapFilter;lodMinClamp;lodMaxClamp;compare;_maxAnisotropy=1;destroyed=!1;constructor(t={}){super(),t={...Gt.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){j(Z,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=hr(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}}class q extends U{constructor(t={}){super(),this.options=t,t={...q.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new Gt(Ws(t)),this.destroyed=!1,this._refreshPOT()}static defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};uid=et("textureSource");label;_resourceType="textureSource";_resourceId=et("resource");uploadMethodId="unknown";_resolution=1;pixelWidth=1;pixelHeight=1;width=1;height=1;resource;sampleCount=1;mipLevelCount=1;autoGenerateMipmaps=!1;format="rgba8unorm";dimension="2d";alphaMode;_style;antialias=!1;destroyed;_touched=0;_batchTick=-1;_textureBindLocation=-1;isPowerOfTwo;autoGarbageCollect;_sourceOrigin;get source(){return this}get style(){return this._style}set style(t){this.style!==t&&(this._style?.off("change",this._onStyleChange,this),this._style=t,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=et("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,s){s||=this._resolution,t||=this.width,e||=this.height;const n=Math.round(t*s),r=Math.round(e*s);return this.width=n/s,this.height=r/s,this._resolution=s,this.pixelWidth===n&&this.pixelHeight===r?!1:(this._refreshPOT(),this.pixelWidth=n,this.pixelHeight=r,this.emit("resize",this),this._resourceId=et("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=De(this.pixelWidth)&&De(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}static from}class Vs extends q{static extension="ExtensionType.TextureSource";uploadMethodId="buffer";constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let s=t.format;s||(e instanceof Float32Array?s="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?s="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?s="rgba16uint":(e instanceof Int8Array,s="bgra8unorm")),super({...t,resource:e,format:s})}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}const qs=new H;class js{mapCoord;clampOffset;clampMargin;uClampFrame;uClampOffset;_updateID;_textureID;_texture;isSimple;constructor(t,e){this.mapCoord=new H,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){this.texture!==t&&(this._texture?.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const s=this.mapCoord;for(let n=0;n<t.length;n+=2){const r=t[n],o=t[n+1];e[n]=r*s.a+o*s.c+s.tx,e[n+1]=r*s.b+o*s.d+s.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const s=t.orig,n=t.trim;n&&(qs.set(s.width/n.width,0,0,s.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(qs));const r=t.source,o=this.uClampFrame,a=this.clampMargin/r._resolution,h=this.clampOffset/r._resolution;return o[0]=(t.frame.x+a+h)/r.width,o[1]=(t.frame.y+a+h)/r.height,o[2]=(t.frame.x+t.frame.width-a+h)/r.width,o[3]=(t.frame.y+t.frame.height-a+h)/r.height,this.uClampOffset[0]=this.clampOffset/r.pixelWidth,this.uClampOffset[1]=this.clampOffset/r.pixelHeight,this.isSimple=t.frame.width===r.width&&t.frame.height===r.height&&t.rotate===0,!0}}class Y extends U{static from;label;uid=et("texture");destroyed;_source;rotate;uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0};defaultAnchor;defaultBorders;frame=new $;orig;trim;noFrame=!1;dynamic=!1;_textureMatrix;isTexture=!0;constructor({source:t,label:e,frame:s,orig:n,trim:r,defaultAnchor:o,defaultBorders:a,rotate:h,dynamic:c}={}){if(super(),this.label=e,this.source=t?.source??new q,this.noFrame=!s,s)this.frame.copyFrom(s);else{const{width:l,height:u}=this._source;this.frame.width=l,this.frame.height=u}this.orig=n||this.frame,this.trim=r,this.rotate=h??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=c||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new js(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:s,height:n}=this._source,r=e.x/s,o=e.y/n,a=e.width/s,h=e.height/n;let c=this.rotate;if(c){const l=a/2,u=h/2,f=r+l,d=o+u;c=S.add(c,S.NW),t.x0=f+l*S.uX(c),t.y0=d+u*S.uY(c),c=S.add(c,2),t.x1=f+l*S.uX(c),t.y1=d+u*S.uY(c),c=S.add(c,2),t.x2=f+l*S.uX(c),t.y2=d+u*S.uY(c),c=S.add(c,2),t.x3=f+l*S.uX(c),t.y3=d+u*S.uY(c)}else t.x0=r,t.y0=o,t.x1=r+a,t.y1=o,t.x2=r+a,t.y2=o+h,t.x3=r,t.y3=o+h}destroy(t=!1){this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return j(Z,"Texture.baseTexture is now Texture.source"),this._source}static EMPTY;static WHITE}Y.EMPTY=new Y({label:"EMPTY",source:new q({label:"EMPTY"})}),Y.EMPTY.destroy=je,Y.WHITE=new Y({source:new Vs({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"}),Y.WHITE.destroy=je;class ze extends q{static extension="ExtensionType.TextureSource";uploadMethodId="image";constructor(t){super(t),this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}const zs=[{offset:0,color:"white"},{offset:1,color:"black"}];class rt{static defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};static defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};uid=et("fillGradient");type="linear";texture;transform;colorStops=[];textureSpace;_textureSize;start;end;_wrapMode;center;outerCenter;innerRadius;outerRadius;scale;rotation;constructor(...t){let e=lr(t);e={...e.type==="radial"?rt.defaultRadialOptions:rt.defaultLinearOptions,...Ws(e)},this._textureSize=e.textureSize,this._wrapMode=e.wrapMode,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(n=>{this.addColorStop(n.offset,n.color)})}addColorStop(t,e){return this.colorStops.push({offset:t,color:W.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:t,y:e}=this.start,{x:s,y:n}=this.end,r=s-t,o=n-e;const a=r<0||o<0;if(this._wrapMode==="clamp-to-edge"){if(r<0){const g=t;t=s,s=g,r*=-1}if(o<0){const g=e;e=n,n=g,o*=-1}}const h=this.colorStops.length?this.colorStops:zs,c=this._textureSize,{canvas:l,context:u}=Ks(c,1),f=a?u.createLinearGradient(this._textureSize,0,0,0):u.createLinearGradient(0,0,this._textureSize,0);Zs(f,h),u.fillStyle=f,u.fillRect(0,0,c,1),this.texture=new Y({source:new ze({resource:l,addressMode:this._wrapMode})});const d=Math.sqrt(r*r+o*o),m=Math.atan2(o,r),y=new H;y.scale(d/c,1),y.rotate(m),y.translate(t,e),this.textureSpace==="local"&&y.scale(c,c),this.transform=y}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:zs,e=this._textureSize,{canvas:s,context:n}=Ks(e,e),{x:r,y:o}=this.center,{x:a,y:h}=this.outerCenter,c=this.innerRadius,l=this.outerRadius,u=a-l,f=h-l,d=e/(l*2),m=(r-u)*d,y=(o-f)*d,g=n.createRadialGradient(m,y,c*d,(a-u)*d,(h-f)*d,l*d);Zs(g,t),n.fillStyle=t[t.length-1].color,n.fillRect(0,0,e,e),n.fillStyle=g,n.translate(m,y),n.rotate(this.rotation),n.scale(1,this.scale),n.translate(-m,-y),n.fillRect(0,0,e,e),this.texture=new Y({source:new ze({resource:s,addressMode:this._wrapMode})});const _=new H;_.scale(1/d,1/d),_.translate(u,f),this.textureSpace==="local"&&_.scale(e,e),this.transform=_}get styleKey(){return this.uid}destroy(){this.texture?.destroy(!0),this.texture=null}}function Zs(i,t){for(let e=0;e<t.length;e++){const s=t[e];i.addColorStop(s.offset,s.color)}}function Ks(i,t){const e=Q.get().createCanvas(i,t),s=e.getContext("2d");return{canvas:e,context:s}}function lr(i){let t=i[0]??{};return(typeof t=="number"||i[1])&&(j("8.5.2","use options object instead"),t={type:"linear",start:{x:i[0],y:i[1]},end:{x:i[2],y:i[3]},textureSpace:i[4],textureSize:i[5]??rt.defaultLinearOptions.textureSize}),t}const Qs={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class Js{uid=et("fillPattern");texture;transform=new H;_styleKey=null;constructor(t,e){this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=Qs[e].addressModeU,t.source.style.addressModeV=Qs[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}let Ze=0;const ti=500;function Et(...i){Ze!==ti&&(Ze++,Ze===ti?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...i))}const Ke={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},cr=/([astvzqmhlc])([^astvzqmhlc]*)/ig,ur=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function dr(i){const t=[];return i.replace(cr,function(e,s,n){let r=s.toLowerCase(),o=fr(n);for(r=="m"&&o.length>2&&(t.push([s].concat(o.splice(0,2))),r="l",s=s=="m"?"l":"L");;){if(o.length==Ke[r])return o.unshift(s),t.push(o);if(o.length<Ke[r])throw new Error("malformed path data");t.push([s].concat(o.splice(0,Ke[r])))}}),t}function fr(i){var t=i.match(ur);return t?t.map(Number):[]}function ei(i,t){const e=dr(i),s=[];let n=null,r=0,o=0;for(let a=0;a<e.length;a++){const h=e[a],c=h[0],l=h;switch(c){case"M":r=l[1],o=l[2],t.moveTo(r,o);break;case"m":r+=l[1],o+=l[2],t.moveTo(r,o);break;case"H":r=l[1],t.lineTo(r,o);break;case"h":r+=l[1],t.lineTo(r,o);break;case"V":o=l[1],t.lineTo(r,o);break;case"v":o+=l[1],t.lineTo(r,o);break;case"L":r=l[1],o=l[2],t.lineTo(r,o);break;case"l":r+=l[1],o+=l[2],t.lineTo(r,o);break;case"C":r=l[5],o=l[6],t.bezierCurveTo(l[1],l[2],l[3],l[4],r,o);break;case"c":t.bezierCurveTo(r+l[1],o+l[2],r+l[3],o+l[4],r+l[5],o+l[6]),r+=l[5],o+=l[6];break;case"S":r=l[3],o=l[4],t.bezierCurveToShort(l[1],l[2],r,o);break;case"s":t.bezierCurveToShort(r+l[1],o+l[2],r+l[3],o+l[4]),r+=l[3],o+=l[4];break;case"Q":r=l[3],o=l[4],t.quadraticCurveTo(l[1],l[2],r,o);break;case"q":t.quadraticCurveTo(r+l[1],o+l[2],r+l[3],o+l[4]),r+=l[3],o+=l[4];break;case"T":r=l[1],o=l[2],t.quadraticCurveToShort(r,o);break;case"t":r+=l[1],o+=l[2],t.quadraticCurveToShort(r,o);break;case"A":r=l[6],o=l[7],t.arcToSvg(l[1],l[2],l[3],l[4],l[5],r,o);break;case"a":r+=l[6],o+=l[7],t.arcToSvg(l[1],l[2],l[3],l[4],l[5],r,o);break;case"Z":case"z":t.closePath(),s.length>0&&(n=s.pop(),n?(r=n.startX,o=n.startY):(r=0,o=0)),n=null;break}c!=="Z"&&c!=="z"&&n===null&&(n={startX:r,startY:o},s.push(n))}return t}const si=new H;class me{minX=1/0;minY=1/0;maxX=-1/0;maxY=-1/0;matrix=si;_rectangle;constructor(t=1/0,e=1/0,s=-1/0,n=-1/0){this.minX=t,this.minY=e,this.maxX=s,this.maxY=n}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new $);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=si,this}set(t,e,s,n){this.minX=t,this.minY=e,this.maxX=s,this.maxY=n}addFrame(t,e,s,n,r){r||=this.matrix;const o=r.a,a=r.b,h=r.c,c=r.d,l=r.tx,u=r.ty;let f=this.minX,d=this.minY,m=this.maxX,y=this.maxY,g=o*t+h*e+l,_=a*t+c*e+u;g<f&&(f=g),_<d&&(d=_),g>m&&(m=g),_>y&&(y=_),g=o*s+h*e+l,_=a*s+c*e+u,g<f&&(f=g),_<d&&(d=_),g>m&&(m=g),_>y&&(y=_),g=o*t+h*n+l,_=a*t+c*n+u,g<f&&(f=g),_<d&&(d=_),g>m&&(m=g),_>y&&(y=_),g=o*s+h*n+l,_=a*s+c*n+u,g<f&&(f=g),_<d&&(d=_),g>m&&(m=g),_>y&&(y=_),this.minX=f,this.minY=d,this.maxX=m,this.maxY=y}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,s=this.minY,n=this.maxX,r=this.maxY,{a:o,b:a,c:h,d:c,tx:l,ty:u}=t;let f=o*e+h*s+l,d=a*e+c*s+u;this.minX=f,this.minY=d,this.maxX=f,this.maxY=d,f=o*n+h*s+l,d=a*n+c*s+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY,f=o*e+h*r+l,d=a*e+c*r+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY,f=o*n+h*r+l,d=a*n+c*r+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,s,n){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<s&&(this.minY=s),this.maxY>n&&(this.maxY=n),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new me(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,s,n){let r=this.minX,o=this.minY,a=this.maxX,h=this.maxY;n||=this.matrix;const c=n.a,l=n.b,u=n.c,f=n.d,d=n.tx,m=n.ty;for(let y=e;y<s;y+=2){const g=t[y],_=t[y+1],x=c*g+u*_+d,v=l*g+f*_+m;r=x<r?x:r,o=v<o?v:o,a=x>a?x:a,h=v>h?v:h}this.minX=r,this.minY=o,this.maxX=a,this.maxY=h}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}function ii(i,t,e){const s=(o,a)=>{const h=a.x-o.x,c=a.y-o.y,l=Math.sqrt(h*h+c*c),u=h/l,f=c/l;return{len:l,nx:u,ny:f}},n=(o,a)=>{o===0?i.moveTo(a.x,a.y):i.lineTo(a.x,a.y)};let r=t[t.length-1];for(let o=0;o<t.length;o++){const a=t[o%t.length],h=a.radius??e;if(h<=0){n(o,a),r=a;continue}const c=t[(o+1)%t.length],l=s(a,r),u=s(a,c);if(l.len<1e-4||u.len<1e-4){n(o,a),r=a;continue}let f=Math.asin(l.nx*u.ny-l.ny*u.nx),d=1,m=!1;l.nx*u.nx-l.ny*-u.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,d=-1,m=!0):f>0&&(d=-1,m=!0);const y=f/2;let g,_=Math.abs(Math.cos(y)*h/Math.sin(y));_>Math.min(l.len/2,u.len/2)?(_=Math.min(l.len/2,u.len/2),g=Math.abs(_*Math.sin(y)/Math.cos(y))):g=h;const x=a.x+u.nx*_+-u.ny*g*d,v=a.y+u.ny*_+u.nx*g*d,b=Math.atan2(l.ny,l.nx)+Math.PI/2*d,E=Math.atan2(u.ny,u.nx)-Math.PI/2*d;o===0&&i.moveTo(x+Math.cos(b)*g,v+Math.sin(b)*g),i.arc(x,v,g,b,E,m),r=a}}function ni(i,t,e,s){const n=(a,h)=>Math.sqrt((a.x-h.x)**2+(a.y-h.y)**2),r=(a,h,c)=>({x:a.x+(h.x-a.x)*c,y:a.y+(h.y-a.y)*c}),o=t.length;for(let a=0;a<o;a++){const h=t[(a+1)%o],c=h.radius??e;if(c<=0){a===0?i.moveTo(h.x,h.y):i.lineTo(h.x,h.y);continue}const l=t[a],u=t[(a+2)%o],f=n(l,h);let d;if(f<1e-4)d=h;else{const g=Math.min(f/2,c);d=r(h,l,g/f)}const m=n(u,h);let y;if(m<1e-4)y=h;else{const g=Math.min(m/2,c);y=r(h,u,g/m)}a===0?i.moveTo(d.x,d.y):i.lineTo(d.x,d.y),i.quadraticCurveTo(h.x,h.y,y.x,y.y,s)}}const pr=new $;class ri{shapePrimitives=[];_currentPoly=null;_graphicsPath2D;_bounds=new me;signed;constructor(t){this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const s=this._currentPoly.points,n=s[s.length-2],r=s[s.length-1];return(n!==t||r!==e)&&s.push(t,e),this}arc(t,e,s,n,r,o){this._ensurePoly(!1);const a=this._currentPoly.points;return Ne(a,t,e,s,n,r,o),this}arcTo(t,e,s,n,r){this._ensurePoly();const o=this._currentPoly.points;return ks(o,t,e,s,n,r),this}arcToSvg(t,e,s,n,r,o,a){const h=this._currentPoly.points;return Fs(h,this._currentPoly.lastX,this._currentPoly.lastY,o,a,t,e,s,n,r),this}bezierCurveTo(t,e,s,n,r,o,a){this._ensurePoly();const h=this._currentPoly;return Ue(this._currentPoly.points,h.lastX,h.lastY,t,e,s,n,r,o,a),this}quadraticCurveTo(t,e,s,n,r){this._ensurePoly();const o=this._currentPoly;return Cs(this._currentPoly.points,o.lastX,o.lastY,t,e,s,n,r),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));const s=this.shapePrimitives,n=s.length;for(let r=0;r<t.instructions.length;r++){const o=t.instructions[r];this[o.action](...o.data)}if(t.checkForHoles&&s.length-n>1){let r=null;for(let o=n;o<s.length;o++){const a=s[o];if(a.shape.type==="polygon"){const h=a.shape,c=r?.shape;c&&c.containsPolygon(h)?(r.holes||=[],r.holes.push(a),s.copyWithin(o,o+1),s.length--,o--):r=a}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,s,n,r){return this.drawShape(new $(t,e,s,n),r),this}circle(t,e,s,n){return this.drawShape(new he(t,e,s),n),this}poly(t,e,s){const n=new wt(t);return n.closePath=e,this.drawShape(n,s),this}regularPoly(t,e,s,n,r=0,o){n=Math.max(n|0,3);const a=-1*Math.PI/2+r,h=Math.PI*2/n,c=[];for(let l=0;l<n;l++){const u=a-l*h;c.push(t+s*Math.cos(u),e+s*Math.sin(u))}return this.poly(c,!0,o),this}roundPoly(t,e,s,n,r,o=0,a){if(n=Math.max(n|0,3),r<=0)return this.regularPoly(t,e,s,n,o);const h=s*Math.sin(Math.PI/n)-.001;r=Math.min(r,h);const c=-1*Math.PI/2+o,l=Math.PI*2/n,u=(n-2)*Math.PI/n/2;for(let f=0;f<n;f++){const d=f*l+c,m=t+s*Math.cos(d),y=e+s*Math.sin(d),g=d+Math.PI+u,_=d-Math.PI-u,x=m+r*Math.cos(g),v=y+r*Math.sin(g),b=m+r*Math.cos(_),E=y+r*Math.sin(_);f===0?this.moveTo(x,v):this.lineTo(x,v),this.quadraticCurveTo(m,y,b,E,a)}return this.closePath()}roundShape(t,e,s=!1,n){return t.length<3?this:(s?ni(this,t,e,n):ii(this,t,e),this.closePath())}filletRect(t,e,s,n,r){if(r===0)return this.rect(t,e,s,n);const o=Math.min(s,n)/2,a=Math.min(o,Math.max(-o,r)),h=t+s,c=e+n,l=a<0?-a:0,u=Math.abs(a);return this.moveTo(t,e+u).arcTo(t+l,e+l,t+u,e,u).lineTo(h-u,e).arcTo(h-l,e+l,h,e+u,u).lineTo(h,c-u).arcTo(h-l,c-l,t+s-u,c,u).lineTo(t+u,c).arcTo(t+l,c-l,t,c-u,u).closePath()}chamferRect(t,e,s,n,r,o){if(r<=0)return this.rect(t,e,s,n);const a=Math.min(r,Math.min(s,n)/2),h=t+s,c=e+n,l=[t+a,e,h-a,e,h,e+a,h,c-a,h-a,c,t+a,c,t,c-a,t,e+a];for(let u=l.length-1;u>=2;u-=2)l[u]===l[u-2]&&l[u-1]===l[u-3]&&l.splice(u-1,2);return this.poly(l,!0,o)}ellipse(t,e,s,n,r){return this.drawShape(new le(t,e,s,n),r),this}roundRect(t,e,s,n,r,o){return this.drawShape(new ue(t,e,s,n,r),o),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let s=this._currentPoly;return s&&this.endPoly(),s=new wt,s.points.push(t,e),this._currentPoly=s,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new wt,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let s=e.shape.x,n=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const r=e.transform,o=s;s=r.a*s+r.c*n+r.tx,n=r.b*o+r.d*n+r.ty}this._currentPoly.points.push(s,n)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const s=t.instructions[e];this[s.action](...s.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let s=0;s<e.length;s++){const n=e[s],r=n.shape.getBounds(pr);n.transform?t.addRect(r,n.transform):t.addRect(r)}return t}}class yt{instructions=[];uid=et("graphicsPath");_dirty=!0;_shapePath;checkForHoles;get shapePath(){return this._shapePath||(this._shapePath=new ri(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}constructor(t,e=!1){this.checkForHoles=e,typeof t=="string"?ei(t,this):this.instructions=t?.slice()??[]}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,s,n,r){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(R.shared);let h=0,c=0;if(!o||o.action!=="bezierCurveTo")h=a.x,c=a.y;else{h=o.data[2],c=o.data[3];const l=a.x,u=a.y;h=l+(l-h),c=u+(u-c)}return this.instructions.push({action:"bezierCurveTo",data:[h,c,t,e,s,n,r]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,s){const n=this.instructions[this.instructions.length-1],r=this.getLastPoint(R.shared);let o=0,a=0;if(!n||n.action!=="quadraticCurveTo")o=r.x,a=r.y;else{o=n.data[0],a=n.data[1];const h=r.x,c=r.y;o=h+(h-o),a=c+(c-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,t,e,s]}),this._dirty=!0,this}rect(t,e,s,n,r){return this.instructions.push({action:"rect",data:[t,e,s,n,r]}),this._dirty=!0,this}circle(t,e,s,n){return this.instructions.push({action:"circle",data:[t,e,s,n]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,s,n,r,o,a){r||=n/2;const h=-1*Math.PI/2+o,c=s*2,l=Math.PI*2/c,u=[];for(let f=0;f<c;f++){const d=f%2?r:n,m=f*l+h;u.push(t+d*Math.cos(m),e+d*Math.sin(m))}return this.poly(u,!0,a),this}clone(t=!1){const e=new yt;if(e.checkForHoles=this.checkForHoles,!t)e.instructions=this.instructions.slice();else for(let s=0;s<this.instructions.length;s++){const n=this.instructions[s];e.instructions.push({action:n.action,data:n.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,s=t.b,n=t.c,r=t.d,o=t.tx,a=t.ty;let h=0,c=0,l=0,u=0,f=0,d=0,m=0,y=0;for(let g=0;g<this.instructions.length;g++){const _=this.instructions[g],x=_.data;switch(_.action){case"moveTo":case"lineTo":h=x[0],c=x[1],x[0]=e*h+n*c+o,x[1]=s*h+r*c+a;break;case"bezierCurveTo":l=x[0],u=x[1],f=x[2],d=x[3],h=x[4],c=x[5],x[0]=e*l+n*u+o,x[1]=s*l+r*u+a,x[2]=e*f+n*d+o,x[3]=s*f+r*d+a,x[4]=e*h+n*c+o,x[5]=s*h+r*c+a;break;case"quadraticCurveTo":l=x[0],u=x[1],h=x[2],c=x[3],x[0]=e*l+n*u+o,x[1]=s*l+r*u+a,x[2]=e*h+n*c+o,x[3]=s*h+r*c+a;break;case"arcToSvg":h=x[5],c=x[6],m=x[0],y=x[1],x[0]=e*m+n*y,x[1]=s*m+r*y,x[5]=e*h+n*c+o,x[6]=s*h+r*c+a;break;case"circle":x[4]=Vt(x[3],t);break;case"rect":x[4]=Vt(x[4],t);break;case"ellipse":x[8]=Vt(x[8],t);break;case"roundRect":x[5]=Vt(x[5],t);break;case"addPath":x[0].transform(t);break;case"poly":x[2]=Vt(x[2],t);break;default:Et("unknown transform action",_.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,s=this.instructions[e];if(!s)return t.x=0,t.y=0,t;for(;s.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;s=this.instructions[e]}switch(s.action){case"moveTo":case"lineTo":t.x=s.data[0],t.y=s.data[1];break;case"quadraticCurveTo":t.x=s.data[2],t.y=s.data[3];break;case"bezierCurveTo":t.x=s.data[4],t.y=s.data[5];break;case"arc":case"arcToSvg":t.x=s.data[5],t.y=s.data[6];break;case"addPath":s.data[0].getLastPoint(t);break}return t}}function Vt(i,t){return i?i.prepend(t):t.clone()}function B(i,t,e){const s=i.getAttribute(t);return s?Number(s):e}function oi(i,t){const e=i.querySelectorAll("defs");for(let s=0;s<e.length;s++){const n=e[s];for(let r=0;r<n.children.length;r++){const o=n.children[r];switch(o.nodeName.toLowerCase()){case"lineargradient":t.defs[o.id]=mr(o);break;case"radialgradient":t.defs[o.id]=yr();break}}}}function mr(i){const t=B(i,"x1",0),e=B(i,"y1",0),s=B(i,"x2",1),n=B(i,"y2",0),r=i.getAttribute("gradientUnits")||"objectBoundingBox",o=new rt(t,e,s,n,r==="objectBoundingBox"?"local":"global");for(let a=0;a<i.children.length;a++){const h=i.children[a],c=B(h,"offset",0),l=W.shared.setValue(h.getAttribute("stop-color")).toNumber();o.addColorStop(c,l)}return o}function yr(i){return new rt(0,0,1,0)}function Qe(i){const t=i.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const Je={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function ts(i,t){const e=i.getAttribute("style"),s={},n={},r={strokeStyle:s,fillStyle:n,useFill:!1,useStroke:!1};for(const o in Je){const a=i.getAttribute(o);a&&ai(t,r,o,a.trim())}if(e){const o=e.split(";");for(let a=0;a<o.length;a++){const h=o[a].trim(),[c,l]=h.split(":");Je[c]&&ai(t,r,c,l.trim())}}return{strokeStyle:r.useStroke?s:null,fillStyle:r.useFill?n:null,useFill:r.useFill,useStroke:r.useStroke}}function ai(i,t,e,s){switch(e){case"stroke":if(s!=="none"){if(s.startsWith("url(")){const n=Qe(s);t.strokeStyle.fill=i.defs[n]}else t.strokeStyle.color=W.shared.setValue(s).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(s);break;case"fill":if(s!=="none"){if(s.startsWith("url(")){const n=Qe(s);t.fillStyle.fill=i.defs[n]}else t.fillStyle.color=W.shared.setValue(s).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(s);break;case"stroke-opacity":t.strokeStyle.alpha=Number(s);break;case"opacity":t.fillStyle.alpha=Number(s),t.strokeStyle.alpha=Number(s);break}}function gr(...i){}function hi(i,t){if(typeof i=="string"){const o=document.createElement("div");o.innerHTML=i.trim(),i=o.querySelector("svg")}const e={context:t,defs:{},path:new yt};oi(i,e);const s=i.children,{fillStyle:n,strokeStyle:r}=ts(i,e);for(let o=0;o<s.length;o++){const a=s[o];a.nodeName.toLowerCase()!=="defs"&&li(a,e,n,r)}return t}function li(i,t,e,s){const n=i.children,{fillStyle:r,strokeStyle:o}=ts(i,t);r&&e?e={...e,...r}:r&&(e=r),o&&s?s={...s,...o}:o&&(s=o);const a=!e&&!s;a&&(e={color:0});let h,c,l,u,f,d,m,y,g,_,x,v,b,E,P,A,k;switch(i.nodeName.toLowerCase()){case"path":E=i.getAttribute("d"),i.getAttribute("fill-rule"),P=new yt(E,!0),t.context.path(P),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"circle":m=B(i,"cx",0),y=B(i,"cy",0),g=B(i,"r",0),t.context.ellipse(m,y,g,g),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"rect":h=B(i,"x",0),c=B(i,"y",0),A=B(i,"width",0),k=B(i,"height",0),_=B(i,"rx",0),x=B(i,"ry",0),_||x?t.context.roundRect(h,c,A,k,_||x):t.context.rect(h,c,A,k),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"ellipse":m=B(i,"cx",0),y=B(i,"cy",0),_=B(i,"rx",0),x=B(i,"ry",0),t.context.beginPath(),t.context.ellipse(m,y,_,x),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"line":l=B(i,"x1",0),u=B(i,"y1",0),f=B(i,"x2",0),d=B(i,"y2",0),t.context.beginPath(),t.context.moveTo(l,u),t.context.lineTo(f,d),s&&t.context.stroke(s);break;case"polygon":b=i.getAttribute("points"),v=b.match(/\d+/g).map(I=>parseInt(I,10)),t.context.poly(v,!0),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"polyline":b=i.getAttribute("points"),v=b.match(/\d+/g).map(I=>parseInt(I,10)),t.context.poly(v,!1),s&&t.context.stroke(s);break;case"g":case"svg":break;default:{gr(`[SVG parser] <${i.nodeName}> elements unsupported`);break}}a&&(e=null);for(let I=0;I<n.length;I++)li(n[I],t,e,s)}function _r(i){return W.isColorLike(i)}function ci(i){return i instanceof Js}function ui(i){return i instanceof rt}function xr(i){return i instanceof Y}function br(i,t,e){const s=W.shared.setValue(t??0);return i.color=s.toNumber(),i.alpha=s.alpha===1?e.alpha:s.alpha,i.texture=Y.WHITE,{...e,...i}}function Ar(i,t,e){return i.texture=t,{...e,...i}}function di(i,t,e){return i.fill=t,i.color=16777215,i.texture=t.texture,i.matrix=t.transform,{...e,...i}}function fi(i,t,e){return t.buildGradient(),i.fill=t,i.color=16777215,i.texture=t.texture,i.matrix=t.transform,i.textureSpace=t.textureSpace,{...e,...i}}function vr(i,t){const e={...t,...i},s=W.shared.setValue(e.color);return e.alpha*=s.alpha,e.color=s.toNumber(),e}function Tt(i,t){if(i==null)return null;const e={},s=i;return _r(i)?br(e,i,t):xr(i)?Ar(e,i,t):ci(i)?di(e,i,t):ui(i)?fi(e,i,t):s.fill&&ci(s.fill)?di(s,s.fill,t):s.fill&&ui(s.fill)?fi(s,s.fill,t):vr(s,t)}function es(i,t){const{width:e,alignment:s,miterLimit:n,cap:r,join:o,pixelLine:a,...h}=t,c=Tt(i,h);return c?{width:e,alignment:s,miterLimit:n,cap:r,join:o,pixelLine:a,...c}:null}const Pr=new R,pi=new H;class G extends U{static defaultFillStyle={color:16777215,alpha:1,texture:Y.WHITE,matrix:null,fill:null,textureSpace:"local"};static defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:Y.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};uid=et("graphicsContext");dirty=!0;batchMode="auto";instructions=[];customShader;_activePath=new yt;_transform=new H;_fillStyle={...G.defaultFillStyle};_strokeStyle={...G.defaultStrokeStyle};_stateStack=[];_tick=0;_bounds=new me;_boundsDirty=!0;clone(){const t=new G;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=Tt(t,G.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=es(t,G.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=Tt(t,G.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=Tt(t,G.defaultStrokeStyle),this}texture(t,e,s,n,r,o){return this.instructions.push({action:"texture",data:{image:t,dx:s||0,dy:n||0,dw:r||t.frame.width,dh:o||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?W.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new yt,this}fill(t,e){let s;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n&&n.action==="stroke"?s=n.data.path:s=this._activePath.clone(),s?(t!=null&&(e!==void 0&&typeof t=="number"&&(t={color:t,alpha:e}),this._fillStyle=Tt(t,G.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(R.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s&&s.action==="fill"?e=s.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=es(t,G.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],s=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(s);else{e.data.hole=s;break}}return this._initNextPathLocation(),this}arc(t,e,s,n,r,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,s,n,r,o),this}arcTo(t,e,s,n,r){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*s+o.c*n+o.tx,o.b*s+o.d*n+o.ty,r),this}arcToSvg(t,e,s,n,r,o,a){this._tick++;const h=this._transform;return this._activePath.arcToSvg(t,e,s,n,r,h.a*o+h.c*a+h.tx,h.b*o+h.d*a+h.ty),this}bezierCurveTo(t,e,s,n,r,o,a){this._tick++;const h=this._transform;return this._activePath.bezierCurveTo(h.a*t+h.c*e+h.tx,h.b*t+h.d*e+h.ty,h.a*s+h.c*n+h.tx,h.b*s+h.d*n+h.ty,h.a*r+h.c*o+h.tx,h.b*r+h.d*o+h.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(t,e,s,n){return this._tick++,this._activePath.ellipse(t,e,s,n,this._transform.clone()),this}circle(t,e,s){return this._tick++,this._activePath.circle(t,e,s,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const s=this._transform;return this._activePath.lineTo(s.a*t+s.c*e+s.tx,s.b*t+s.d*e+s.ty),this}moveTo(t,e){this._tick++;const s=this._transform,n=this._activePath.instructions,r=s.a*t+s.c*e+s.tx,o=s.b*t+s.d*e+s.ty;return n.length===1&&n[0].action==="moveTo"?(n[0].data[0]=r,n[0].data[1]=o,this):(this._activePath.moveTo(r,o),this)}quadraticCurveTo(t,e,s,n,r){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*s+o.c*n+o.tx,o.b*s+o.d*n+o.ty,r),this}rect(t,e,s,n){return this._tick++,this._activePath.rect(t,e,s,n,this._transform.clone()),this}roundRect(t,e,s,n,r){return this._tick++,this._activePath.roundRect(t,e,s,n,r,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,s,n,r=0,o){return this._tick++,this._activePath.regularPoly(t,e,s,n,r,o),this}roundPoly(t,e,s,n,r,o){return this._tick++,this._activePath.roundPoly(t,e,s,n,r,o),this}roundShape(t,e,s,n){return this._tick++,this._activePath.roundShape(t,e,s,n),this}filletRect(t,e,s,n,r){return this._tick++,this._activePath.filletRect(t,e,s,n,r),this}chamferRect(t,e,s,n,r,o){return this._tick++,this._activePath.chamferRect(t,e,s,n,r,o),this}star(t,e,s,n,r=0,o=0){return this._tick++,this._activePath.star(t,e,s,n,r,o,this._transform.clone()),this}svg(t){return this._tick++,hi(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,s,n,r,o){return t instanceof H?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,s,n,r,o),this)}transform(t,e,s,n,r,o){return t instanceof H?(this._transform.append(t),this):(pi.set(t,e,s,n,r,o),this._transform.append(pi),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const s=this.instructions[e],n=s.action;if(n==="fill"){const r=s.data;t.addBounds(r.path.bounds)}else if(n==="texture"){const r=s.data;t.addFrame(r.dx,r.dy,r.dx+r.dw,r.dy+r.dh,r.transform)}if(n==="stroke"){const r=s.data,o=r.style.alignment,a=r.style.width*(1-o),h=r.path.bounds;t.addFrame(h.minX-a,h.minY-a,h.maxX+a,h.maxY+a)}}return t}containsPoint(t){if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let s=!1;for(let n=0;n<e.length;n++){const r=e[n],o=r.data,a=o.path;if(!r.action||!a)continue;const h=o.style,c=a.shapePath.shapePrimitives;for(let l=0;l<c.length;l++){const u=c[l].shape;if(!h||!u)continue;const f=c[l].transform,d=f?f.applyInverse(t,Pr):t;if(r.action==="fill")s=u.contains(d.x,d.y);else{const y=h;s=u.strokeContains(d.x,d.y,y.width,y.alignment)}const m=o.hole;if(m){const y=m.shapePath?.shapePrimitives;if(y)for(let g=0;g<y.length;g++)y[g].shape.contains(d.x,d.y)&&(s=!1)}if(s)return!0}}return s}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t?.texture){const s=typeof t=="boolean"?t:t?.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(s)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(s))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}}class ye{batched;_context;_ownedContext;constructor(t){t instanceof G&&(t={context:t});const{context:e,roundPixels:s,...n}=t||{};e?this._context=e:this._context=this._ownedContext=new G,this._context.on("update",this.onViewUpdate,this)}onViewUpdate(){}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||t?.context===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new ye(this._context.clone()):(this._ownedContext=null,new ye(this._context))}lineStyle(t,e,s){j(Z,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const n={};return t&&(n.width=t),e&&(n.color=e),s&&(n.alpha=s),this.context.strokeStyle=n,this}beginFill(t,e){j(Z,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const s={};return t!==void 0&&(s.color=t),e!==void 0&&(s.alpha=e),this.context.fillStyle=s,this}endFill(){j(Z,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==G.defaultStrokeStyle.width||t.color!==G.defaultStrokeStyle.color||t.alpha!==G.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return j(Z,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return j(Z,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return j(Z,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return j(Z,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return j(Z,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return j(Z,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}const wr=new H,Mr=new $;function Er(i,t,e,s){const n=t.matrix?i.copyFrom(t.matrix).invert():i.identity();if(t.textureSpace==="local"){const o=e.getBounds(Mr);t.width&&o.pad(t.width);const{x:a,y:h}=o,c=1/o.width,l=1/o.height,u=-a*c,f=-h*l,d=n.a,m=n.b,y=n.c,g=n.d;n.a*=c,n.b*=c,n.c*=l,n.d*=l,n.tx=u*d+f*y+n.tx,n.ty=u*m+f*g+n.ty}else n.translate(t.texture.frame.x,t.texture.frame.y),n.scale(1/t.texture.source.width,1/t.texture.source.height);const r=t.texture.source.style;return!(t.fill instanceof rt)&&r.addressMode==="clamp-to-edge"&&(r.addressMode="repeat",r.update()),s&&n.append(wr.copyFrom(s).invert()),n}class mi{canvasOptions;enableFullScreen;_canvasPool;constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){const s=Q.get().createCanvas();s.width=t,s.height=e;const n=s.getContext("2d");return{canvas:s,context:n}}getOptimalCanvasAndContext(t,e,s=1){t=Math.ceil(t*s-1e-6),e=Math.ceil(e*s-1e-6),t=dt(t),e=dt(e);const n=(t<<17)+(e<<1);this._canvasPool[n]||(this._canvasPool[n]=[]);let r=this._canvasPool[n].pop();return r||(r=this._createCanvasAndContext(t,e)),r}returnCanvasAndContext(t){const e=t.canvas,{width:s,height:n}=e,r=(s<<17)+(n<<1);t.context.resetTransform(),t.context.clearRect(0,0,s,n),this._canvasPool[r].push(t)}clear(){this._canvasPool={}}}const Tr=new mi;var ge=(i=>(i.CLAMP="clamp-to-edge",i.REPEAT="repeat",i.MIRRORED_REPEAT="mirror-repeat",i))(ge||{});const Sr=new Proxy(ge,{get(i,t){return j(Z,`DRAW_MODES.${t} is deprecated, use '${ge[t]}' instead`),i[t]}});var _e=(i=>(i.NEAREST="nearest",i.LINEAR="linear",i))(_e||{});const Cr=new Proxy(_e,{get(i,t){return j(Z,`DRAW_MODES.${t} is deprecated, use '${_e[t]}' instead`),i[t]}});class ss extends Y{static create(t){return new ss({source:new q(t)})}resize(t,e,s){return this.source.resize(t,e,s),this}}class yi extends q{static extension="ExtensionType.TextureSource";uploadMethodId="image";autoDensity;transparent;_context2D;constructor(t){t.resource||(t.resource=Q.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,s=this._resolution){const n=super.resize(t,e,s);return n&&this.resizeCanvas(),n}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}class kr extends q{uploadMethodId="compressed";constructor(t){super(t),this.resource=t.resource,this.mipLevelCount=this.resource.length}}let gi;async function _i(){return gi??=(async()=>{const t=Q.get().createCanvas(1,1).getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!e)return"premultiply-alpha-on-upload";const s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const r=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,r),t.deleteFramebuffer(n),t.deleteTexture(s),t.getExtension("WEBGL_lose_context")?.loseContext(),r[0]<=r[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})(),gi}class is extends q{static extension="ExtensionType.TextureSource";static defaultOptions={...q.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};isReady=!1;uploadMethodId="video";autoPlay;_autoUpdate;_isConnectedToTicker;_load;_msToNextUpdate;_preloadTimeout;_resolve;_reject;_updateFPS;_videoFrameRequestCallbackHandle;constructor(t){super(t),t={...is.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=X.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await _i(),this._load=new Promise((s,n)=>{this.isValid?s(this):(this._resolve=s,this._reject=n,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(X.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(X.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(X.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}}class ns{static extension={type:["ExtensionType.WebGLSystem","ExtensionType.WebGPUSystem"],name:"textureGC"};static defaultOptions={textureGCActive:!0,textureGCAMaxIdle:null,textureGCMaxIdle:3600,textureGCCheckCountMax:600};count;checkCount;maxIdle;checkCountMax;active;_renderer;constructor(t){this._renderer=t,this.count=0,this.checkCount=0}init(t){t={...ns.defaultOptions,...t},this.checkCountMax=t.textureGCCheckCountMax,this.maxIdle=t.textureGCAMaxIdle??t.textureGCMaxIdle,this.active=t.textureGCActive}postrender(){this._renderer.renderingToScreen&&(this.count++,this.active&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this._renderer.texture.managedTextures;for(let e=0;e<t.length;e++){const s=t[e];s.autoGarbageCollect&&s.resource&&s._touched>-1&&this.count-s._touched>this.maxIdle&&(s._touched=-1,s.unload())}}destroy(){this._renderer=null}}let Ir=0;class xi{textureOptions;textureStyle;enableFullScreen;_texturePool;_poolKeyHash=Object.create(null);constructor(t){this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this.textureStyle=new Gt(this.textureOptions)}createTexture(t,e,s){const n=new q({...this.textureOptions,width:t,height:e,resolution:1,antialias:s,autoGarbageCollect:!1});return new Y({source:n,label:`texturePool_${Ir++}`})}getOptimalTexture(t,e,s=1,n){let r=Math.ceil(t*s-1e-6),o=Math.ceil(e*s-1e-6);r=dt(r),o=dt(o);const a=(r<<17)+(o<<1)+(n?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let h=this._texturePool[a].pop();return h||(h=this.createTexture(r,o,n)),h.source._resolution=s,h.source.width=r/s,h.source.height=o/s,h.source.pixelWidth=r,h.source.pixelHeight=o,h.frame.x=0,h.frame.y=0,h.frame.width=t,h.frame.height=e,h.updateUvs(),this._poolKeyHash[h.uid]=a,h}getSameSizeTexture(t,e=!1){const s=t.source;return this.getOptimalTexture(t.width,t.height,s._resolution,e)}returnTexture(t,e=!1){const s=this._poolKeyHash[t.uid];e&&(t.source.style=this.textureStyle),this._texturePool[s].push(t)}clear(t){if(t=t!==!1,t)for(const e in this._texturePool){const s=this._texturePool[e];if(s)for(let n=0;n<s.length;n++)s[n].destroy(!0)}this._texturePool={}}}const Fr=new xi;class Rr{x0;y0;x1;y1;x2;y2;x3;y3;uvsFloat32;constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,s){const n=e.width,r=e.height;if(s){const o=t.width/2/n,a=t.height/2/r,h=t.x/n+o,c=t.y/r+a;s=S.add(s,S.NW),this.x0=h+o*S.uX(s),this.y0=c+a*S.uY(s),s=S.add(s,2),this.x1=h+o*S.uX(s),this.y1=c+a*S.uY(s),s=S.add(s,2),this.x2=h+o*S.uX(s),this.y2=c+a*S.uY(s),s=S.add(s,2),this.x3=h+o*S.uX(s),this.y3=c+a*S.uY(s)}else this.x0=t.x/n,this.y0=t.y/r,this.x1=(t.x+t.width)/n,this.y1=t.y/r,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/r,this.x3=t.x/n,this.y3=(t.y+t.height)/r;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[pixi.js/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const St=new Map;function Lr(i,t){if(!St.has(i)){const e=new Y({source:new yi({resource:i,...t})}),s=()=>{St.get(i)===e&&St.delete(i)};e.once("destroy",s),e.source.once("destroy",s),St.set(i,e)}return St.get(i)}function Br(i){return St.has(i)}async function bi(){return[]}const Ai=["r8unorm","r8snorm","r8uint","r8sint","r16uint","r16sint","r16float","rg8unorm","rg8snorm","rg8uint","rg8sint","r32uint","r32sint","r32float","rg16uint","rg16sint","rg16float","rgba8unorm","rgba8unorm-srgb","rgba8snorm","rgba8uint","rgba8sint","bgra8unorm","bgra8unorm-srgb","rgb9e5ufloat","rgb10a2unorm","rg11b10ufloat","rg32uint","rg32sint","rg32float","rgba16uint","rgba16sint","rgba16float","rgba32uint","rgba32sint","rgba32float","stencil8","depth16unorm","depth24plus","depth24plus-stencil8","depth32float","depth32float-stencil8"];let xe;async function Dr(){if(xe!==void 0)return xe;const i=await bi();return xe=[...Ai,...i],xe}const gt=(i,t,e=!1)=>(Array.isArray(i)||(i=[i]),t?i.map(s=>typeof s=="string"||e?t(s):s):i);class Or{_parsers=[];_cache=new Map;_cacheMap=new Map;reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||Et(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const s=gt(t);let n;for(let h=0;h<this.parsers.length;h++){const c=this.parsers[h];if(c.test(e)){n=c.getCacheableAssets(s,e);break}}const r=new Map(Object.entries(n||{}));n||s.forEach(h=>{r.set(h,e)});const o=[...r.keys()],a={cacheKeys:o,keys:s};s.forEach(h=>{this._cacheMap.set(h,a)}),o.forEach(h=>{const c=n?n[h]:e;this._cache.has(h)&&this._cache.get(h)!==c&&Et("[Cache] already has key:",h),this._cache.set(h,r.get(h))})}remove(t){if(!this._cacheMap.has(t)){Et(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(n=>{this._cache.delete(n)}),e.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const _t=new Or,rs=[];Fe.handleByList("ExtensionType.TextureSource",rs);function Ur(i={}){return os(i)}function os(i={}){const t=i&&i.resource,e=t?i.resource:i,s=t?i:{resource:i};for(let n=0;n<rs.length;n++){const r=rs[n];if(r.test(e))return new r(s)}throw new Error(`Could not find a source type for resource: ${s.resource}`)}function vi(i={},t=!1){const e=i&&i.resource,s=e?i.resource:i,n=e?i:{resource:i};if(!t&&_t.has(s))return _t.get(s);const r=new Y({source:os(n)});return r.on("destroy",()=>{_t.has(s)&&_t.remove(s)}),t||_t.set(s,r),r}function Pi(i,t=!1){return typeof i=="string"?_t.get(i):i instanceof q?new Y({source:i}):vi(i,t)}Y.from=Pi,q.from=os;function Xr(){const{userAgent:i}=Q.get().getNavigator();return/^((?!chrome|android).)*safari/i.test(i)}let be;function Yr(i){return be!==void 0||(be=(()=>{const t={stencil:!0,failIfMajorPerformanceCaveat:i};try{if(!Q.get().getWebGLRenderingContext())return!1;let s=Q.get().createCanvas().getContext("webgl",t);const n=!!s?.getContextAttributes()?.stencil;if(s){const r=s.getExtension("WEBGL_lose_context");r&&r.loseContext()}return s=null,n}catch{return!1}})()),be}let Ae;async function Nr(i={}){return Ae!==void 0||(Ae=await(async()=>{const t=Q.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(i)).requestDevice(),!0}catch{return!1}})()),Ae}let qt;function Hr(){if(typeof qt=="boolean")return qt;try{qt=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{qt=!1}return qt}let xt=null,ot=null;function $r(i,t){xt||(xt=Q.get().createCanvas(256,128),ot=xt.getContext("2d",{willReadFrequently:!0}),ot.globalCompositeOperation="copy",ot.globalAlpha=1),(xt.width<i||xt.height<t)&&(xt.width=dt(i),xt.height=dt(t))}function wi(i,t,e){for(let s=0,n=4*e*t;s<t;++s,n+=4)if(i[n+3]!==0)return!1;return!0}function Mi(i,t,e,s,n){const r=4*t;for(let o=s,a=s*r+4*e;o<=n;++o,a+=r)if(i[a+3]!==0)return!1;return!0}function Wr(...i){let t=i[0];t.canvas||(t={canvas:i[0],resolution:i[1]});const{canvas:e}=t,s=Math.min(t.resolution??1,1),n=t.width??e.width,r=t.height??e.height;let o=t.output;if($r(n,r),!ot)throw new TypeError("Failed to get canvas 2D context");ot.drawImage(e,0,0,n,r,0,0,n*s,r*s);const h=ot.getImageData(0,0,n,r).data;let c=0,l=0,u=n-1,f=r-1;for(;l<r&&wi(h,n,l);)++l;if(l===r)return $.EMPTY;for(;wi(h,n,f);)--f;for(;Mi(h,n,c,l,f);)++c;for(;Mi(h,n,u,l,f);)--u;return++u,++f,ot.globalCompositeOperation="source-over",ot.strokeRect(c,l,u-c,f-l),ot.globalCompositeOperation="copy",o??=new $,o.set(c/s,l/s,(u-c)/s,(f-l)/s),o}const Gr=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i,as="$_VERSION";function Vr(i){let t=!1;for(const s in i)if(i[s]==null){t=!0;break}if(!t)return i;const e=Object.create(null);for(const s in i){const n=i[s];n&&(e[s]=n)}return e}function qr(i){let t=0;for(let e=0;e<i.length;e++)i[e]==null?t++:i[e-t]=i[e];return i.length-=t,i}function jr(i,t,e){const s=i.length;let n;if(t>=s||e===0)return;e=t+e>s?s-t:e;const r=s-e;for(n=t;n<r;++n)i[n]=i[n+e];i.length=r}function zr(i,t,e){const{width:s,height:n}=e.orig,r=e.trim;if(r){const o=r.width,a=r.height;i.minX=r.x-t._x*s,i.maxX=i.minX+o,i.minY=r.y-t._y*n,i.maxY=i.minY+a}else i.minX=-t._x*s,i.maxX=i.minX+s,i.minY=-t._y*n,i.maxY=i.minY+n}class Zr{size;rawBinaryData;uint32View;float32View;uint16View;_int8View;_uint8View;_int16View;_int32View;_float64Array;_bigUint64Array;constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}class Kr{_matrix;position;scale;pivot;skew;_rotation;_cx;_sx;_cy;_sy;dirty=!0;observer;constructor({matrix:t,observer:e}={}){this._matrix=t??new H,this.observer=e,this.position=new ft(this,0,0),this.scale=new ft(this,1,1),this.pivot=new ft(this,0,0),this.skew=new ft(this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1}get matrix(){const t=this._matrix;return this.dirty&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this.dirty=!1),t}_onUpdate(t){this.dirty=!0,t===this.skew&&this.updateSkew(),this.observer?._onUpdate(this)}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this.dirty=!0}toString(){return`[pixi.js/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}setFromMatrix(t){t.decompose(this),this.dirty=!0}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this.skew))}}function st(i){if(typeof i!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(i)}`)}function jt(i){return i.split("?")[0].split("#")[0]}function Qr(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Jr(i,t,e){return i.replace(new RegExp(Qr(t),"g"),e)}function to(i,t){let e="",s=0,n=-1,r=0,o=-1;for(let a=0;a<=i.length;++a){if(a<i.length)o=i.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(n===a-1||r===1))if(n!==a-1&&r===2){if(e.length<2||s!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",s=0):(e=e.slice(0,h),s=e.length-1-e.lastIndexOf("/")),n=a,r=0;continue}}else if(e.length===2||e.length===1){e="",s=0,n=a,r=0;continue}}}else e.length>0?e+=`/${i.slice(n+1,a)}`:e=i.slice(n+1,a),s=a-n-1;n=a,r=0}else o===46&&r!==-1?++r:r=-1}return e}const ve={toPosix(i){return Jr(i,"\\","/")},isUrl(i){return/^https?:/.test(this.toPosix(i))},isDataUrl(i){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(i)},isBlobUrl(i){return i.startsWith("blob:")},hasProtocol(i){return/^[^/:]+:/.test(this.toPosix(i))},getProtocol(i){st(i),i=this.toPosix(i);const t=/^file:\/\/\//.exec(i);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(i);return e?e[0]:""},toAbsolute(i,t,e){if(st(i),this.isDataUrl(i)||this.isBlobUrl(i))return i;const s=jt(this.toPosix(t??Q.get().getBaseUrl())),n=jt(this.toPosix(e??this.rootname(s)));return i=this.toPosix(i),i.startsWith("/")?ve.join(n,i.slice(1)):this.isAbsolute(i)?i:this.join(s,i)},normalize(i){if(st(i),i.length===0)return".";if(this.isDataUrl(i)||this.isBlobUrl(i))return i;i=this.toPosix(i);let t="";const e=i.startsWith("/");this.hasProtocol(i)&&(t=this.rootname(i),i=i.slice(t.length));const s=i.endsWith("/");return i=to(i),i.length>0&&s&&(i+="/"),e?`/${i}`:t+i},isAbsolute(i){return st(i),i=this.toPosix(i),this.hasProtocol(i)?!0:i.startsWith("/")},join(...i){if(i.length===0)return".";let t;for(let e=0;e<i.length;++e){const s=i[e];if(st(s),s.length>0)if(t===void 0)t=s;else{const n=i[e-1]??"";this.joinExtensions.includes(this.extname(n).toLowerCase())?t+=`/../${s}`:t+=`/${s}`}}return t===void 0?".":this.normalize(t)},dirname(i){if(st(i),i.length===0)return".";i=this.toPosix(i);let t=i.charCodeAt(0);const e=t===47;let s=-1,n=!0;const r=this.getProtocol(i),o=i;i=i.slice(r.length);for(let a=i.length-1;a>=1;--a)if(t=i.charCodeAt(a),t===47){if(!n){s=a;break}}else n=!1;return s===-1?e?"/":this.isUrl(o)?r+i:r:e&&s===1?"//":r+i.slice(0,s)},rootname(i){st(i),i=this.toPosix(i);let t="";if(i.startsWith("/")?t="/":t=this.getProtocol(i),this.isUrl(i)){const e=i.indexOf("/",t.length);e!==-1?t=i.slice(0,e):t=i,t.endsWith("/")||(t+="/")}return t},basename(i,t){st(i),t&&st(t),i=jt(this.toPosix(i));let e=0,s=-1,n=!0,r;if(t!==void 0&&t.length>0&&t.length<=i.length){if(t.length===i.length&&t===i)return"";let o=t.length-1,a=-1;for(r=i.length-1;r>=0;--r){const h=i.charCodeAt(r);if(h===47){if(!n){e=r+1;break}}else a===-1&&(n=!1,a=r+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(s=r):(o=-1,s=a))}return e===s?s=a:s===-1&&(s=i.length),i.slice(e,s)}for(r=i.length-1;r>=0;--r)if(i.charCodeAt(r)===47){if(!n){e=r+1;break}}else s===-1&&(n=!1,s=r+1);return s===-1?"":i.slice(e,s)},extname(i){st(i),i=jt(this.toPosix(i));let t=-1,e=0,s=-1,n=!0,r=0;for(let o=i.length-1;o>=0;--o){const a=i.charCodeAt(o);if(a===47){if(!n){e=o+1;break}continue}s===-1&&(n=!1,s=o+1),a===46?t===-1?t=o:r!==1&&(r=1):t!==-1&&(r=-1)}return t===-1||s===-1||r===0||r===1&&t===s-1&&t===e+1?"":i.slice(t,s)},parse(i){st(i);const t={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return t;i=jt(this.toPosix(i));let e=i.charCodeAt(0);const s=this.isAbsolute(i);let n;t.root=this.rootname(i),s||this.hasProtocol(i)?n=1:n=0;let r=-1,o=0,a=-1,h=!0,c=i.length-1,l=0;for(;c>=n;--c){if(e=i.charCodeAt(c),e===47){if(!h){o=c+1;break}continue}a===-1&&(h=!1,a=c+1),e===46?r===-1?r=c:l!==1&&(l=1):r!==-1&&(l=-1)}return r===-1||a===-1||l===0||l===1&&r===a-1&&r===o+1?a!==-1&&(o===0&&s?t.base=t.name=i.slice(1,a):t.base=t.name=i.slice(o,a)):(o===0&&s?(t.name=i.slice(1,r),t.base=i.slice(1,a)):(t.name=i.slice(o,r),t.base=i.slice(o,a)),t.ext=i.slice(r,a)),t.dir=this.dirname(i),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function Ei(i,t,e,s,n){const r=t[e];for(let o=0;o<r.length;o++){const a=r[o];e<t.length-1?Ei(i.replace(s[e],a),t,e+1,s,n):n.push(i.replace(s[e],a))}}function Ti(i){const t=/\{(.*?)\}/g,e=i.match(t),s=[];if(e){const n=[];e.forEach(r=>{const o=r.substring(1,r.length-1).split(",");n.push(o)}),Ei(i,n,0,e,s)}else s.push(i);return s}const hs=i=>!Array.isArray(i);class Si{static RETINA_PREFIX=/@([0-9\.]+)x/;_defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")};_bundleIdConnector=this._defaultBundleIdentifierOptions.connector;_createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId;_extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle;_assetMap={};_preferredOrder=[];_parsers=[];_resolverHash={};_rootPath;_basePath;_manifest;_bundles={};_defaultSearchParams;setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`).join("&")}}getAlias(t){const{alias:e,src:s}=t;return gt(e||s,r=>typeof r=="string"?r:Array.isArray(r)?r.map(o=>o?.src??o):r?.src?r.src:r,!0)}addManifest(t){this._manifest&&Et("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const s=[];let n=e;Array.isArray(e)||(n=Object.entries(e).map(([r,o])=>typeof o=="string"||Array.isArray(o)?{alias:r,src:o}:{alias:r,...o})),n.forEach(r=>{const o=r.src,a=r.alias;let h;if(typeof a=="string"){const c=this._createBundleAssetId(t,a);s.push(c),h=[a,c]}else{const c=a.map(l=>this._createBundleAssetId(t,l));s.push(...c),h=[...a,...c]}this.add({...r,alias:h,src:o})}),this._bundles[t]=s}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let s;s=r=>{this.hasKey(r)&&Et(`[Resolver] already has key: ${r} overwriting`)},gt(e).forEach(r=>{const{src:o}=r;let{data:a,format:h,loadParser:c}=r;const l=gt(o).map(d=>typeof d=="string"?Ti(d):Array.isArray(d)?d:[d]),u=this.getAlias(r);Array.isArray(u)?u.forEach(s):s(u);const f=[];l.forEach(d=>{d.forEach(m=>{let y={};if(typeof m!="object"){y.src=m;for(let g=0;g<this._parsers.length;g++){const _=this._parsers[g];if(_.test(m)){y=_.parse(m);break}}}else a=m.data??a,h=m.format??h,c=m.loadParser??c,y={...y,...m};if(!u)throw new Error(`[Resolver] alias is undefined for this asset: ${y.src}`);y=this._buildResolvedAsset(y,{aliases:u,data:a,format:h,loadParser:c}),f.push(y)})}),u.forEach(d=>{this._assetMap[d]=f})})}resolveBundle(t){const e=hs(t);t=gt(t);const s={};return t.forEach(n=>{const r=this._bundles[n];if(r){const o=this.resolve(r),a={};for(const h in o){const c=o[h];a[this._extractAssetIdFromBundle(n,h)]=c}s[n]=a}}),e?s[t[0]]:s}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const s={};for(const n in e)s[n]=e[n].src;return s}return e.src}resolve(t){const e=hs(t);t=gt(t);const s={};return t.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let r=this._assetMap[n];const o=this._getPreferredOrder(r);o?.priority.forEach(a=>{o.params[a].forEach(h=>{const c=r.filter(l=>l[a]?l[a]===h:!1);c.length&&(r=c)})}),this._resolverHash[n]=r[0]}else this._resolverHash[n]=this._buildResolvedAsset({alias:[n],src:n},{});s[n]=this._resolverHash[n]}),e?s[t[0]]:s}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const s=t[e],n=this._preferredOrder.find(r=>r.params.format.includes(s.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:s,data:n,loadParser:r,format:o}=e;return(this._basePath||this._rootPath)&&(t.src=ve.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=s??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...n||{},...t.data},t.loadParser=r??t.loadParser,t.format=o??t.format??Ci(t.src),t}}function Ci(i){return i.split(".").pop().split("?").shift().split("#").shift()}function eo(i,t=1){const e=Si.RETINA_PREFIX?.exec(i);return e?parseFloat(e[1]):t}class ki{_classType;_pool=[];_count=0;_index=0;constructor(t,e){this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){let e;return this._index>0?e=this._pool[--this._index]:e=new this._classType,e.init?.(t),e}return(t){t.reset?.(),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class Ii{_poolsByClass=new Map;prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new ki(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const s=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[s]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}}const so=new Ii;let Fi=!1;function io(i){if(!Fi){if(Q.get().getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1){const t=[`%c  %c  %c  %c  %c PixiJS %c v${as} (${i}) http://www.pixijs.com/

`,"background: #E72264; padding:5px 0;","background: #6CA2EA; padding:5px 0;","background: #B5D33D; padding:5px 0;","background: #FED23F; padding:5px 0;","color: #FFFFFF; background: #E72264; padding:5px 0;","color: #E72264; background: #FFFFFF; padding:5px 0;"];globalThis.console.log(...t)}else globalThis.console&&globalThis.console.log(`PixiJS ${as} - ${i} - http://www.pixijs.com/`);Fi=!0}}class no{items;_name;constructor(t){this.items=[],this._name=t}emit(t,e,s,n,r,o,a,h){const{name:c,items:l}=this;for(let u=0,f=l.length;u<f;u++)l[u][c](t,e,s,n,r,o,a,h);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}class ro{_isActive;_assetList;_isLoading;_maxConcurrent;verbose;_loader;constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<e;s++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}async function ls(i){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=i});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(i)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const oo={extension:{type:"ExtensionType.DetectionParser",priority:1},test:async()=>ls("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async i=>[...i,"avif"],remove:async i=>i.filter(t=>t!=="avif")},Ri=["png","jpg","jpeg"],ao={extension:{type:"ExtensionType.DetectionParser",priority:-1},test:()=>Promise.resolve(!0),add:async i=>[...i,...Ri],remove:async i=>i.filter(t=>!Ri.includes(t))},ho="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Pe(i){return ho?!1:document.createElement("video").canPlayType(i)!==""}const lo={extension:{type:"ExtensionType.DetectionParser",priority:0},test:async()=>Pe("video/mp4"),add:async i=>[...i,"mp4","m4v"],remove:async i=>i.filter(t=>t!=="mp4"&&t!=="m4v")},co={extension:{type:"ExtensionType.DetectionParser",priority:0},test:async()=>Pe("video/ogg"),add:async i=>[...i,"ogv"],remove:async i=>i.filter(t=>t!=="ogv")},uo={extension:{type:"ExtensionType.DetectionParser",priority:0},test:async()=>Pe("video/webm"),add:async i=>[...i,"webm"],remove:async i=>i.filter(t=>t!=="webm")},fo={extension:{type:"ExtensionType.DetectionParser",priority:0},test:async()=>ls("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async i=>[...i,"webp"],remove:async i=>i.filter(t=>t!=="webp")};function po(i,t){if(Array.isArray(t)){for(const e of t)if(i.startsWith(`data:${e}`))return!0;return!1}return i.startsWith(`data:${t}`)}function mo(i,t){const e=i.split("?")[0],s=ve.extname(e).toLowerCase();return Array.isArray(t)?t.includes(s):s===t}const yo=(i,t)=>{const e=t.split("?")[1];return e&&(i+=`?${e}`),i};p.BackgroundLoader=ro,p.BigPool=so,p.BufferImageSource=Vs,p.Cache=_t,p.CanvasPool=Tr,p.CanvasPoolClass=mi,p.CanvasSource=yi,p.Circle=he,p.Color=W,p.CompressedSource=kr,p.DATA_URI=Gr,p.DEG_TO_RAD=bn,p.DEPRECATED_SCALE_MODES=_e,p.DEPRECATED_WRAP_MODES=ge,p.DOMAdapter=Q,p.Ellipse=le,p.EventBoundary=Es,p.EventEmitter=U,p.EventSystem=Dt,p.EventsTicker=nt,p.FederatedContainer=_n,p.FederatedEvent=Rt,p.FederatedMouseEvent=Lt,p.FederatedPointerEvent=J,p.FederatedWheelEvent=re,p.FillGradient=rt,p.FillPattern=Js,p.Graphics=ye,p.GraphicsContext=G,p.GraphicsPath=yt,p.ImageSource=ze,p.Matrix=H,p.NOOP=je,p.ObservablePoint=ft,p.PI_2=Ts,p.Point=R,p.Polygon=wt,p.Pool=ki,p.PoolGroupClass=Ii,p.RAD_TO_DEG=xn,p.Rectangle=$,p.RenderTexture=ss,p.Resolver=Si,p.RoundedRectangle=ue,p.SCALE_MODES=Cr,p.SVGParser=hi,p.ShapePath=ri,p.SystemRunner=no,p.Texture=Y,p.TextureGCSystem=ns,p.TextureMatrix=js,p.TexturePool=Fr,p.TexturePoolClass=xi,p.TextureSource=q,p.TextureStyle=Gt,p.TextureUvs=Rr,p.Ticker=X,p.TickerListener=ne,p.Transform=Kr,p.Triangle=Oe,p.UPDATE_PRIORITY=Ft,p.VERSION=as,p.VideoSource=is,p.ViewableBuffer=Zr,p.WRAP_MODES=Sr,p.autoDetectEnvironment=ln,p.autoDetectSource=Ur,p.buildAdaptiveBezier=Ue,p.buildAdaptiveQuadratic=Cs,p.buildArc=Ne,p.buildArcTo=ks,p.buildArcToSvg=Fs,p.buildCircle=Xt,p.buildEllipse=On,p.buildLine=Xn,p.buildPixelLine=Yn,p.buildPolygon=nr,p.buildRectangle=rr,p.buildRoundedRectangle=Un,p.buildTriangle=or,p.checkDataUrl=po,p.checkExtension=mo,p.cleanArray=qr,p.cleanHash=Vr,p.closePointEps=We,p.colord=tt,p.convertToList=gt,p.copySearchParams=yo,p.createStringVariations=Ti,p.curveEps=Ge,p.detectAvif=oo,p.detectDefaults=ao,p.detectMp4=lo,p.detectOgv=co,p.detectVideoAlphaMode=_i,p.detectWebm=uo,p.detectWebp=fo,p.earcut=Ns,p.extend=vs,p.extensions=Fe,p.extractSvgUrlId=Qe,p.generateTextureMatrix=Er,p.getCanvasBoundingBox=Wr,p.getCanvasTexture=Lr,p.getFormat=rn,p.getOrientationOfPoints=Rs,p.getResolutionOfUrl=eo,p.getSupportedCompressedTextureFormats=bi,p.getSupportedTextureFormats=Dr,p.getUrlExtension=Ci,p.groupD8=S,p.hasCachedCanvasTexture=Br,p.isPow2=De,p.isSafari=Xr,p.isSingleItem=hs,p.isWebGLSupported=Yr,p.isWebGPUSupported=Nr,p.loadEnvironmentExtensions=ws,p.log2=wn,p.nextPow2=dt,p.nonCompressedFormats=Ai,p.normalizeExtensionPriority=kt,p.parseSVGDefinitions=oi,p.parseSVGFloatAttribute=B,p.parseSVGPath=ei,p.parseSVGStyle=ts,p.path=ve,p.pointInTriangle=Mn,p.random=hn,p.removeItems=jr,p.resetUids=ar,p.resourceToTexture=vi,p.roundedShapeArc=ii,p.roundedShapeQuadraticCurve=ni,p.sayHello=io,p.squaredDistanceToLineSegment=Ot,p.styleAttributes=Je,p.testImageFormat=ls,p.testVideoFormat=Pe,p.textureFrom=Pi,p.toFillStyle=Tt,p.toStrokeStyle=es,p.triangulateWithHoles=Hs,p.uid=et,p.unsafeEvalSupported=Hr,p.updateQuadBounds=zr,Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});
