(function(Ze,pi){typeof exports=="object"&&typeof module<"u"?pi(exports):typeof define=="function"&&define.amd?define(["exports"],pi):(Ze=typeof globalThis<"u"?globalThis:Ze||self,pi((Ze.dxMyth=Ze.dxMyth||{},Ze.dxMyth.math={})))})(this,function(Ze){"use strict";function pi(r,e,n){return r[0]=e,r[1]=n,r}function Vf(r,e,n,i,s){let o=e,a=n,h=Math.sqrt(o*o+a*a);if(h===0||!Number.isFinite(h))return!1;let c=i/h;return e*=c,n*=c,r[0]=e,r[1]=n,!0}function Hg(r,e){return r[0]=e,r[1]=e,r}function tc(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r}function kr(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r}function $s(r,e,n){return r[0]=e[0]*n[0],r[1]=e[1]*n[1],r}function ec(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r}function Rr(r,e,n){return r[0]=e[0]/n[0],r[1]=e[1]/n[1],r}function Ho(r,e){return r[0]*e[0]+r[1]*e[1]}function nc(r,e){return r[0]*e[1]-r[1]*e[0]}function Uf(r,e){return Math.sqrt((r[0]-e[0])*(r[0]-e[0])+(r[1]-e[1])*(r[1]-e[1]))}function Wf(r,e){return(r[0]-e[0])*(r[0]-e[0])+(r[1]-e[1])*(r[1]-e[1])}function jf(r){return r[0]*r[0]+r[1]*r[1]}function Or(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function Yf(r,e){return Math.abs(r[0]-e[0])+Math.abs(r[1]-e[1])}function Hf(r,e){return Math.max(Math.abs(r[0]-e[0]),Math.abs(r[1]-e[1]))}function Xo(r,e){const n=Or(e);return r[0]=e[0]/n,r[1]=e[1]/n,r}function ic(r,e,n,i){return r[0]=e[0]+(n[0]-e[0])*i,r[1]=e[1]+(n[1]-e[1])*i,r}function Xf(r,e,n,i){i=i<0?0:i>1?1:i;const s=i*i*(3-2*i);return ic(r,e,n,s)}function Zf(r){return Math.atan2(r[1],r[0])}function Gf(r,e){return Math.acos(Ho(r,e)/(Or(r)*Or(e)))}function Xg(r,e=[0,0]){return Math.atan2(r[1]-e[1],r[0]-e[0])}function Jf(r,e){return Math.atan2(nc(e,r),Ho(r,e))}function sc(r,e){return r[0]=-e[1],r[1]=e[0],r}function Qf(r,e,n){const i=2*(e[0]*n[0]+e[1]*n[1]);return r[0]=e[0]-i*n[0],r[1]=e[1]-i*n[1],r}function Zg(r,e,n,i,s){const o=Xo(O.default(),n),a=Xo(O.default(),e),h=i/s,c=-a.dot(o),l=Math.sqrt(1-c*c),u=h*l;if(u>1)return null;const f=Math.sqrt(1-u*u);return a.multiplyScalar(h).add(o.multiplyScalar(h*c-f)),r[0]=a[0],r[1]=a[1],r}function Kf(r,e){return r[0]=-e[0],r[1]=-e[1],r}function t0(r,e){return r[0]=Math.abs(e[0]),r[1]=Math.abs(e[1]),r}function e0(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r}function n0(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r}function i0(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r}function s0(r,e,n){return r[0]=Math.min(e[0],n[0]),r[1]=Math.min(e[1],n[1]),r}function r0(r,e,n){return r[0]=Math.max(e[0],n[0]),r[1]=Math.max(e[1],n[1]),r}function o0(r,e,n,i){return r[0]=Math.max(n[0],Math.min(i[0],e[0])),r[1]=Math.max(n[1],Math.min(i[1],e[1])),r}function a0(r,e){return r[0]=e[0]-Math.floor(e[0]),r[1]=e[1]-Math.floor(e[1]),r}function h0(r,e,n){return r[0]=e[0]-n[0]*Math.floor(e[0]/n[0]),r[1]=e[1]-n[1]*Math.floor(e[1]/n[1]),r}function Gg(r,e,n){return r[0]=e[0]-n[0]*Math.ceil(e[0]/n[0]),r[1]=e[1]-n[1]*Math.ceil(e[1]/n[1]),r}function c0(r,e,n){const i=Math.cos(n),s=Math.sin(n),o=e[0],a=e[1];return r[0]=o*i-a*s,r[1]=o*s+a*i,r}function l0(r,e,n,i){const s=Math.cos(i),o=Math.sin(i),a=e[0]-n[0],h=e[1]-n[1];return r[0]=a*s-h*o+n[0],r[1]=a*o+h*s+n[1],r}function u0(r,e,n,i){return r[0]=e[0]*n,r[1]=e[1]*i,r}function f0(r,e,n,i){return r[0]=(e[0]-n[0])*i[0]+n[0],r[1]=(e[1]-n[1])*i[1]+n[1],r}function d0(r,e,n,i){return r[0]=e[0]+n,r[1]=e[1]+i,r}function p0(r,e,n){return r[0]=e[0]*n[0]+e[1]*n[2]+n[4],r[1]=e[0]*n[1]+e[1]*n[3]+n[5],r}function y0(r,e,n){return r[0]=e[0]*n[0]+e[1]*n[4]+n[8],r[1]=e[0]*n[1]+e[1]*n[5]+n[9],r}function Jg(r,e){return r[0]===e[0]&&r[1]===e[1]}function Qg(r){return r[0]===0&&r[1]===0}function Kg(r,e,n=1e-6){return Math.abs(r[0]-e[0])<n&&Math.abs(r[1]-e[1])<n}let O=class extends Float32Array{static BYTE_LENGTH=2*Float32Array.BYTES_PER_ELEMENT;static create(e,n){return new this(e,n)}static from(e){return this.create(e[0],e[1])}static fromPoint(e){return this.create(e.x,e.y)}static fromRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.create(n,i)}static default(){return this.create(0,0)}static zero(){return this.create(0,0)}static splat(e){return this.create(e,e)}static makeZeroArray(e){return Array.from({length:e},()=>this.zero())}static set=pi;static setXY=pi;static add=tc;static sub=kr;static mul=$s;static mulScalar=ec;static multiply=$s;static div=Rr;static divide=Rr;static dot=Ho;static cross=nc;static distance=Uf;static distanceSquared=Wf;static lengthSquared=jf;static length=Or;static manhattanDistance=Yf;static chebyshevDistance=Hf;static normalize=Xo;static lerp=ic;static smoonthStep=Xf;static angle=Zf;static angleTo=Gf;static angleBetweenPI2=Jf;static perpendicular=sc;static perp=sc;static reflect=Qf;static negate=Kf;static abs=t0;static round=e0;static floor=n0;static ceil=i0;static min=s0;static max=r0;static clamp=o0;static fractal=a0;static floorMod=h0;static rotate=c0;static rotateAround=l0;static scale=u0;static scaleAround=f0;static translate=d0;static transformMat2d=p0;static transformMat3d=y0;static equals=Jg;static isZero=Qg;static equalsEpsilon=Kg;constructor(...e){e.length===0?super(2):Array.isArray(e[0])?super(e[0]):super(e)}get x(){return this[0]}set x(e){this[0]=e}get y(){return this[1]}set y(e){this[1]=e}copy(e){return this[0]=e[0],this[1]=e[1],this}clone(){return this.constructor.create(this[0],this[1])}set(e,n){return Array.isArray(e)?(super.set(e,n),this):pi(this,e,n)}setXY(e,n){return pi(this,e,n)}setLength(e){return Vf(this,this.x,this.y,e),this}setLengthFromPoint(e,n,i){return Vf(this,e,n,i),this}setRotation(e){return this.setXY(Math.cos(e),Math.sin(e))}splat(e){return Hg(this,e)}add(e){return tc(this,this,e)}addVectors(e,n){return tc(this,e,n)}subtract(e){return kr(this,this,e)}sub(e){return kr(this,this,e)}subVectors(e,n){return kr(this,e,n)}subtractVectors(e,n){return kr(this,e,n)}mul(e){return $s(this,this,e)}multiply(e){return $s(this,this,e)}multiplyVectors(e,n){return $s(this,e,n)}mulVectors(e,n){return $s(this,e,n)}mulScalar(e){return ec(this,this,e)}multiplyScalar(e){return ec(this,this,e)}div(e){return Rr(this,this,e)}divide(e){return Rr(this,this,e)}divideVectors(e,n){return Rr(this,e,n)}dot(e){return Ho(this,e)}cross(e){return nc(this,e)}distance(e){return Uf(this,e)}distanceSquared(e){return Wf(this,e)}magnitudeSquared(){return jf(this)}magnitude(){return Or(this)}manhattanDistance(e){return Yf(this,e)}chebyshevDistance(e){return Hf(this,e)}normalize(){return Xo(this,this)}lerp(e,n){return ic(this,this,e,n)}smoonthStep(e,n){return Xf(this,this,e,n)}angle(){return Zf(this)}angleTo(e){return Gf(this,e)}angleToOrigin(e){return Xg(this,e)}angleBetween(e,n){return Jf(e,n)}perp(){return sc(this,this)}ccw(){return this.setXY(this.y,-this.x)}cw(){return this.setXY(-this.y,this.x)}reflect(e){return Qf(this,this,e)}refract(e,n,i,s){return Zg(this,e,n,i,s)}negate(){return Kf(this,this)}abs(){return t0(this,this)}round(){return e0(this,this)}floor(){return n0(this,this)}ceil(){return i0(this,this)}min(e){return s0(this,this,e)}max(e){return r0(this,this,e)}clamp(e,n){return o0(this,this,e,n)}fractal(){return a0(this,this)}modDown(e){return h0(this,this,e)}modUp(e){return Gg(this,this,e)}rotate(e){return c0(this,this,e)}rotateAround(e,n){return l0(this,this,e,n)}scale(e,n){return u0(this,this,e,n)}scaleAround(e,n){return f0(this,this,e,n)}translate(e,n){return d0(this,this,e,n)}transformMat2d(e){return p0(this,this,e)}applyMatrix2D(e){return this.transformMat2d(e)}applyMatrix3D(e){return this.transformMat3d(e)}transformMat3d(e){return y0(this,this,e)}isFinite(){return isFinite(this.x)&&isFinite(this.y)}isZero(){return this.x===0&&this.y===0}equals(e){return this[0]===e[0]&&this[1]===e[1]}equalsEpsilon(e,n=1e-6){return Math.abs(this[0]-e[0])<n&&Math.abs(this[1]-e[1])<n}canNormalize(){return this.isFinite()&&(this.x!==0||this.y!==0)}toZero(e){let n=this;return n[0]+e[0]==n[0]?e[0]=0:n[0]+e[0]==e[0]&&(n[0]=0),n[1]+e[1]==n[1]?e[1]=0:n[1]+e[1]==e[1]&&(n[1]=0),this}toArray(){return[this[0],this[1]]}};const t2=Math.PI*2;function rc(r,e,n,i,s,o,a){return r[0]=e,r[1]=n,r[2]=i,r[3]=s,r[4]=o,r[5]=a,r}function oc(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r}function x0(r,e,n){const i=e[0],s=e[2],o=e[4],a=e[1],h=e[3],c=e[5];return r[0]=i,r[1]=a,r[2]=s,r[3]=h,r[4]=o+i*n[0]+s*n[1],r[5]=c+a*n[0]+h*n[1],r}function m0(r,e,n){const i=e[0],s=e[2],o=e[4],a=e[1],h=e[3],c=e[5],l=Math.cos(n),u=Math.sin(n);return r[0]=i*l+s*u,r[1]=a*l+h*u,r[2]=i*-u+s*l,r[3]=a*u+h*l,r[4]=o,r[5]=c,r}function g0(r,e,n){const i=e[0],s=e[2],o=e[4],a=e[1],h=e[3],c=e[5],l=n[0],u=n[1];return r[0]=i*l,r[1]=a*l,r[2]=s*u,r[3]=h*u,r[4]=o,r[5]=c,r}function w0(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=e[0],r[5]=e[1],r}function b0(r,e){const n=Math.cos(e),i=Math.sin(e);return r[0]=n,r[1]=i,r[2]=-i,r[3]=n,r[4]=0,r[5]=0,r}function v0(r,e){const n=e[0],i=e[1];return r[0]=n,r[1]=0,r[2]=0,r[3]=i,r[4]=0,r[5]=0,r}function e2(r,e){const n=Math.tan(e[0]),i=Math.tan(e[1]);return r[0]=1,r[1]=i,r[2]=n,r[3]=1,r[4]=0,r[5]=0,r}function M0(r,e,n,i){const s=Math.cos(n),o=Math.sin(n);return r[0]=s*i[0],r[1]=o*i[0],r[2]=-o*i[1],r[3]=s*i[1],r[4]=e[0],r[5]=e[1],r}function n2(r,e,n,i,s){const o=Math.cos(n),a=Math.sin(n),h=e[0]+s[0],c=e[1]+s[1];return r[0]=o*i[0],r[1]=a*i[0],r[2]=-a*i[1],r[3]=o*i[1],r[4]=h-(s[0]*r[0]+s[1]*r[2]),r[5]=c-(s[0]*r[1]+s[1]*r[3]),r}function i2(r,e,n,i,s,o){const a=Math.cos(i),h=Math.sin(i),c=Math.tan(n[0]),l=Math.tan(n[1]),u=e[0]+o[0],f=e[1]+o[1];return r[0]=(a+c*h)*s[0],r[1]=(l*h+a)*s[0],r[2]=(-h+c*a)*s[1],r[3]=(l*-h+a)*s[1],r[4]=u-(o[0]*r[0]+o[1]*r[2]),r[5]=f-(o[0]*r[1]+o[1]*r[3]),r}function s2(r,e,n,i,s,o){const a=Math.cos(n),h=Math.sin(n),c=e[0]+s[0],l=e[1]+s[1],u=o[0]+s[0],f=o[1]+s[1];return r[0]=a*i[0],r[1]=h*i[0],r[2]=-h*i[1],r[3]=a*i[1],r[4]=c-(u*r[0]+f*r[2]),r[5]=l-(u*r[1]+f*r[3]),r}function r2(r,e,n,i,s,o,a){const h=Math.cos(i),c=Math.sin(i),l=Math.tan(n[0]),u=Math.tan(n[1]),f=e[0]+o[0],d=e[1]+o[1],p=a[0]+o[0],y=a[1]+o[1];return r[0]=(h+l*c)*s[0],r[1]=(u*h+c)*s[0],r[2]=(-c+l*h)*s[1],r[3]=(u*-c+h)*s[1],r[4]=f-(p*r[0]+y*r[2]),r[5]=d-(p*r[1]+y*r[3]),r}function o2(r,e,n,i,s,o,a){const h=Math.cos(i+n[1]),c=Math.sin(i+n[1]),l=-Math.sin(i-n[0]),u=Math.cos(i-n[0]),f=o[0],d=o[1],p=e[0],y=e[1],x=a[0]+f,m=a[1]+d;return r[0]=h*s[0],r[1]=c*s[0],r[2]=l*s[1],r[3]=u*s[1],r[4]=p-(x*r[0]+m*r[2])+f,r[5]=y-(x*r[1]+m*r[3])+d,r}function _0(r,e){return r[0]=e[4],r[1]=e[5],r}function Zo(r){return Math.atan2(r[1],r[0])}function S0(r,e){return r[0]=Math.sqrt(e[0]*e[0]+e[1]*e[1]),r[1]=Math.sqrt(e[2]*e[2]+e[3]*e[3]),r}function T0(r,e){const n=Math.cos(Zo(e)),i=Math.sin(Zo(e));return r[0]=e[4]+n*e[2]*-e[4]-i*e[3]*-e[5],r[1]=e[5]+i*e[2]*-e[4]+n*e[3]*-e[5],r}function a2(r,e){let i=r[0],s=r[1],o=r[2],a=r[3],h=r[4],c=r[5],l=e.origin.x,u=e.origin.y,f=e.pivot.x,d=e.pivot.y,p=Math.hypot(i,s),y=Math.hypot(o,a);p<1e-6&&(p=0),y<1e-6&&(y=0),i*a-s*o<0&&(p>y?(y*=-1,o*=-1,a*=-1):(p*=-1,i*=-1,s*=-1));let m=Math.atan2(s,i),g=0,w=0;if(p>1e-6&&y>1e-6){const I=i/p,b=s/p,v=o/y,_=a/y;g=Math.atan(I*v+b*_),w=Math.atan(I*b+v*_)}const M=i*(f+l)+o*(d+u),S=s*(f+l)+a*(d+u),E=h+M-l,A=c+S-u;e.position.setXY(E,A),e.skew.set(g,w),e.scale.set(p,y),e.rotation=m}function h2(r){const e=r[0],n=r[1],i=r[2],s=r[3],o=r[4],a=r[5],h=o,c=a;let l=Math.sqrt(e*e+n*n),u=Math.sqrt(i*i+s*s),f=Math.atan2(n,e);return e*s-n*i<0&&(l>u?u=-u:l=-l),{position:{x:h,y:c},rotation:f,scale:{x:l,y:u}}}function Go(r,e,n){const i=e[0],s=e[1],o=e[2],a=e[3],h=e[4],c=e[5],l=n[0],u=n[1],f=n[2],d=n[3],p=n[4],y=n[5];return r[0]=i*l+o*u,r[1]=s*l+a*u,r[2]=i*f+o*d,r[3]=s*f+a*d,r[4]=i*p+o*y+h,r[5]=s*p+a*y+c,r}function E0(r,e){const n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],h=e[5],c=n*o-i*s;if(!c)return null;const l=1/c;return r[0]=o*l,r[1]=-i*l,r[2]=-s*l,r[3]=n*l,r[4]=(s*h-o*a)*l,r[5]=(i*a-n*h)*l,r}function ac(r,e,n){const i=n[0],s=n[1];return r[0]=e[0]*i+e[2]*s+e[4],r[1]=e[1]*i+e[3]*s+e[5],r}function z0(r,e,n){for(let i=0;i<n.length;i+=2)ac(r[i],e,n[i]);return r}function A0(r){return r[0]===1&&r[1]===0&&r[2]===0&&r[3]===1&&r[4]===0&&r[5]===0}function c2(r){return r[4]!==0||r[5]!==0}function C0(r){return r[0]!==1||r[1]!==0||r[2]!==0||r[3]!==1}function P0(r){return r[0]!==1||r[3]!==1}class re extends Float32Array{static IENTITY_MATRIX=new re;static default(){return new this}static fromColumns(e,n,i,s,o,a){return rc(new this,e,n,i,s,o,a)}static fromRows(e,n,i,s,o,a){return rc(new this,e,s,n,o,i,a)}static fromMatrix2D(e){const n=this.default();return n.set(e),n}static fromSinCos(e,n){return this.fromRows(n,e,-e,n,0,0)}static fromScale(e,n){return this.fromRows(e,0,0,n,0,0)}static fromTranslate(e,n){return this.fromRows(1,0,e,1,n,0)}static fromRotation(e){return this.fromSinCos(Math.sin(e),Math.cos(e))}static fromAngle(e){return this.fromRotation(e*Math.PI/180)}static identity=oc;static multiply=Go;static invert=E0;static translate=x0;static scale=g0;static rotation=m0;static makeTranslation=w0;static makeRotation=b0;static makeScale=v0;static makeTranslationRotationScale=M0;static makeTranslationRotationScaleOrigin=n2;static makeTranslationSkewRotationScaleOrigin=i2;static makeTranslationRotationScaleOriginPivot=s2;static makeTranslationSkewRotationScaleOriginPivot=r2;static extractTranslation=_0;static extractRotation=Zo;static extractScale=S0;static extractOrigin=T0;static decomposeTKRSPO=a2;static decompose=h2;static mapPoint=ac;static mapPoints=z0;static hasTranslation=c2;static hasRotation=C0;static hasScale=P0;static hasIdentity=A0;constructor(){super(6),oc(this)}get a(){return this[0]}set a(e){this[0]=e}get b(){return this[1]}set b(e){this[1]=e}get c(){return this[2]}set c(e){this[2]=e}get d(){return this[3]}set d(e){this[3]=e}get e(){return this[4]}set e(e){this[4]=e}get f(){return this[5]}set f(e){this[5]=e}get tx(){return this[4]}set tx(e){this[4]=e}get ty(){return this[5]}set ty(e){this[5]=e}copy(e){return rc(this,e[0],e[1],e[2],e[3],e[4],e[5]),this}clone(){return this.constructor.default().copy(this)}identity(){return oc(this)}multiplyMatrices(e,n){return Go(this,e,n)}premultiply(e){return Go(this,e,this)}multiply(e){return Go(this,this,e)}invert(){return E0(this,this)}translate(e){return x0(this,this,e)}rotate(e){return m0(this,this,e)}scale(e){return g0(this,this,e)}makeTranslation(e){return w0(this,e)}makeRotation(e){return b0(this,e)}makeScale(e){return v0(this,e)}makeSkew(e){return e2(this,e)}makeTRS(e,n,i){return M0(this,e,n,i)}makeTKRSOP(e,n,i,s,o,a){return o2(this,e,n,i,s,o,a)}extractTranslation(e){return _0(e,this)}extractRotation(){return Zo(this)}extractScale(e){return S0(e,this)}extractOrigin(e){return T0(e,this)}preScale(e,n){return this.multiplyMatrices(this,re.fromScale(e,n))}postScale(e,n){return this.multiplyMatrices(re.fromScale(e,n),this)}preRotate(e){return this.multiplyMatrices(this,re.fromRotation(e))}preRotateDegrees(e){return this.preRotate(e*Math.PI/180)}postRotate(e){return this.multiplyMatrices(re.fromRotation(e),this)}postRotateDegrees(e){return this.postRotate(e*Math.PI/180)}preTranslate(e,n){return this.multiplyMatrices(this,re.fromTranslate(e,n))}postTranslate(e,n){return this.multiplyMatrices(re.fromTranslate(e,n),this)}mapPoint(e,n=e){return ac(n,this,e)}mapPoints(e,n=e){return z0(n,this,e)}hasIdentity(){return A0(this)}hasRotation(){return C0(this)}hasScale(){return P0(this)}decompose(e){const n=this.a,i=this.b,s=this.c,o=this.d,a=e.pivot,h=-Math.atan2(-s,o),c=Math.atan2(i,n),l=Math.abs(h+c);l<1e-5||Math.abs(t2-l)<1e-5?(e.rotation=c,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=h,e.skew.y=c),e.scale.x=Math.sqrt(n*n+i*i),e.scale.y=Math.sqrt(s*s+o*o);const u=a.x+e.origin.x,f=a.y+e.origin.y;return e.position.x=this.tx+(u*n+f*s)-e.origin.x,e.position.y=this.ty+(u*i+f*o)-e.origin.y,e}toMatrix3x3(e=!0){return e?new Float32Array([this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]):new Float32Array([this.a,this.c,this.tx,this.b,this.d,this.ty,0,0,1])}}function hc(r){return r[0]=1,r[3]=0,r[6]=0,r[1]=0,r[4]=1,r[7]=0,r[2]=0,r[5]=0,r[8]=1,r}function Jo(r,e,n){const i=e[0],s=e[3],o=e[6],a=e[1],h=e[4],c=e[7],l=e[2],u=e[5],f=e[8],d=n[0],p=n[3],y=n[6],x=n[1],m=n[4],g=n[7],w=n[2],M=n[5],S=n[8];return r[0]=i*d+s*x+o*w,r[1]=a*d+h*x+c*w,r[2]=l*y+u*x+f*w,r[3]=i*p+s*m+o*M,r[4]=a*p+h*m+c*M,r[5]=l*p+u*m+f*M,r[6]=i*y+s*g+o*S,r[7]=a*y+h*g+c*S,r[8]=l*y+u*g+f*S,r}function l2(r,e,n){const i=e[0],s=e[3],o=e[6],a=e[1],h=e[4],c=e[7],l=e[2],u=e[5],f=e[8];return r[0]=i,r[1]=a,r[2]=l,r[3]=s,r[4]=h,r[5]=u,r[6]=i*n[0]+s*n[1]+o,r[7]=a*n[0]+h*n[1]+c,r[8]=f,r}function u2(r,e,n){const i=Math.sin(n),s=Math.cos(n),o=e[0],a=e[3],h=e[6],c=e[1],l=e[4],u=e[7],f=e[2],d=e[5],p=e[8];return r[0]=o*s+a*i,r[1]=c*s+l*i,r[2]=f*s+d*i,r[3]=o*-i+a*s,r[4]=c*-i+l*s,r[5]=f*-i+d*s,r[6]=h,r[7]=u,r[8]=p,r}function f2(r,e,n){const i=n[0],s=n[1],o=e[0],a=e[3],h=e[6],c=e[1],l=e[4],u=e[7],f=e[2],d=e[5],p=e[8];return r[0]=o*i,r[1]=c*i,r[2]=f*i,r[3]=a*s,r[4]=l*s,r[5]=d*s,r[6]=h,r[7]=u,r[8]=p,r}function I0(r,e){return r[0]=1,r[3]=0,r[6]=e[0],r[1]=0,r[4]=1,r[7]=e[1],r[2]=0,r[5]=0,r[8]=1,r}function k0(r,e){const n=Math.sin(e),i=Math.cos(e);return r[0]=i,r[3]=-n,r[6]=0,r[1]=n,r[4]=i,r[7]=0,r[2]=0,r[5]=0,r[8]=1,r}function R0(r,e){return r[0]=e[0],r[3]=0,r[6]=0,r[1]=0,r[4]=e[1],r[7]=0,r[2]=0,r[5]=0,r[8]=1,r}function O0(r,e){return r[0]=1,r[3]=Math.tan(e[0]),r[6]=0,r[1]=Math.tan(e[1]),r[4]=1,r[7]=0,r[2]=0,r[5]=0,r[8]=1,r}function d2(r,e,n){return r[0]=2/e,r[3]=0,r[6]=-1,r[1]=0,r[4]=-2/n,r[7]=1,r[2]=0,r[5]=0,r[8]=1,r}function L0(r,e,n,i){const s=Math.sin(n),o=Math.cos(n);return r[0]=i[0]*o,r[3]=i[1]*-s,r[6]=e[0],r[1]=i[0]*s,r[4]=i[1]*o,r[7]=e[1],r[2]=0,r[5]=0,r[8]=1,r}function p2(r,e,n,i,s){const o=Math.cos(n),a=Math.sin(n),h=i[0],c=i[1],l=e[0]+s[0],u=e[1]+s[1];return r[0]=o*h,r[1]=a*h,r[2]=0,r[3]=-a*c,r[4]=o*c,r[5]=0,r[6]=l-(s[0]*r[0]+s[1]*r[3]),r[7]=u-(s[0]*r[1]+s[1]*r[4]),r[8]=1,r}function y2(r,e,n,i,s,o){const a=Math.cos(n),h=Math.sin(n),c=i[0],l=i[1],u=e[0]+s[0],f=e[1]+s[1],d=o[0]+s[0],p=o[1]+s[1];return r[0]=a*c,r[1]=h*c,r[2]=0,r[3]=-h*l,r[4]=a*l,r[5]=0,r[6]=u-(d*r[0]+p*r[3]),r[7]=f-(d*r[1]+p*r[4]),r[8]=1,r}function x2(r,e,n,i,s,o,a){const h=Math.cos(i),c=Math.sin(i),l=s[0],u=s[1],f=Math.tan(n[0]),d=Math.tan(n[1]),p=e[0]+o[0],y=e[1]+o[1],x=a[0]+o[0],m=a[1]+o[1];return r[0]=(h+f*c)*l,r[1]=(d*c+h)*l,r[2]=0,r[3]=(-c+f*h)*u,r[4]=(d*-c+h)*u,r[5]=0,r[6]=p-(x*r[0]+m*r[3]),r[7]=y-(x*r[1]+m*r[4]),r[8]=1,r}function m2(r,e){return r[0]=e[6],r[1]=e[7],r}function g2(r){return Math.atan2(r[3],r[0])}function w2(r,e){return r[0]=Math.sqrt(e[0]*e[0]+e[3]*e[3]),r[1]=Math.sqrt(e[1]*e[1]+e[4]*e[4]),r}function b2(r,e){const n=e[0],i=e[3],s=e[6],o=e[1],a=e[4],h=e[7],c=e[2],l=e[5],u=e[8];let f=n,d=i,p=s,y=o,x=a,m=h,g=c,w=l,M=u,S=0,E=0;return Math.abs(f)>=Math.abs(y)&&Math.abs(f)>=Math.abs(g)?(E=1/f,f*=E,d*=E,p*=E,y*=E,x*=E,m*=E,g*=E,w*=E,M*=E,S=f,f=1,y-=d,x-=d,m-=d,g-=p,w-=p,M-=p):Math.abs(y)>=Math.abs(f)&&Math.abs(y)>=Math.abs(g)?(E=1/y,f*=E,d*=E,p*=E,y*=E,x*=E,m*=E,g*=E,w*=E,M*=E,S=-y,y=0,d-=x,p-=m,w-=m,M-=m):(E=1/g,f*=E,d*=E,p*=E,y*=E,x*=E,m*=E,g*=E,w*=E,M*=E,S=g,g=0,p-=w,d-=w,m-=w,x-=w),r[0]=f,r[3]=d,r[6]=p,r[1]=y,r[4]=x,r[7]=m,r[2]=g,r[5]=w,r[8]=M,S}function B0(r,e){const n=e[0],i=e[3],s=e[6],o=e[1],a=e[4],h=e[7],c=e[2],l=e[5],u=e[8];return r[0]=a*u-h*l,r[3]=-o*u+h*c,r[6]=o*l-a*c,r[1]=-i*u+s*l,r[4]=n*u-s*c,r[7]=-n*l+i*c,r[2]=i*h-s*a,r[5]=-n*h+s*o,r[8]=n*a-i*o,r}function F0(r){const e=r[0],n=r[3],i=r[6],s=r[1],o=r[4],a=r[7],h=r[2],c=r[5],l=r[8];return e*(o*l-c*a)-n*(s*l-a*h)+i*(s*c-o*h)}function N0(r,e){const n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],h=e[5],c=e[6],l=e[7],u=e[8],f=u*a-h*l,d=-u*o+h*c,p=l*o-a*c;let y=n*f+i*d+s*p;return y?(y=1/y,r[0]=f*y,r[1]=(-u*i+s*l)*y,r[2]=(h*i-s*a)*y,r[3]=d*y,r[4]=(u*n-s*c)*y,r[5]=(-h*n+s*o)*y,r[6]=p*y,r[7]=(-l*n+i*c)*y,r[8]=(a*n-i*o)*y,r):null}function q0(r,e){const n=e[0],i=e[3],s=e[6],o=e[1],a=e[4],h=e[7],c=e[2],l=e[5],u=e[8];r[0]=n,r[1]=o,r[2]=c,r[3]=i,r[4]=a,r[5]=l,r[6]=s,r[7]=h,r[8]=u}function v2(r){return r[6]!==0||r[7]!==0||r[8]!==1}function M2(r){return r[0]!==1||r[3]!==0||r[6]!==0||r[1]!==0||r[4]!==1||r[7]!==0||r[2]!==0||r[5]!==0||r[8]!==1}function _2(r){return r[0]!==1||r[3]!==0||r[6]!==0||r[1]!==0||r[4]!==1||r[7]!==0||r[2]!==0||r[5]!==0||r[8]!==1}function S2(r){return r[0]!==1||r[3]!==0||r[6]!==0||r[1]!==0||r[4]!==1||r[7]!==0||r[2]!==0||r[5]!==0||r[8]!==1}function T2(r,e,n,i,s,o,a,h,c,l){return r[0]=e,r[3]=n,r[6]=i,r[1]=s,r[4]=o,r[7]=a,r[2]=h,r[5]=c,r[8]=l,r}function cc(r,e,n){let i=n[0],s=n[1];return r[0]=e[0]*i+e[3]*s+e[6],r[1]=e[1]*i+e[4]*s+e[7],r}function D0(r,e,n){for(let i=0;i<n.length;i+=2)cc(r[i],e,n[i]);return r}function $0(r,e,n){let i=2/e,s=-2/n;return r[0]=i,r[3]=0,r[6]=-1,r[1]=0,r[4]=s,r[7]=1,r[2]=0,r[5]=0,r[8]=1,r}let E2=class extends Float32Array{static default(){return new this}static identity=hc;static multiply=Jo;static invert=N0;static makeProjection=d2;static makeTranslation=I0;static makeRotation=k0;static makeScale=R0;static makeTranslationRotationScale=L0;static makeTranslationRotationScaleOrigin=p2;static makeTranslationRotationScaleOriginPivot=y2;static makeTranslationSkewRotationScaleOriginPivot=x2;static extractTranslation=m2;static extractRotation=g2;static extractScale=w2;static decompose=b2;static adjugate=B0;static determinant=F0;static transpose=q0;static fromValues=T2;static makeSkew=O0;static mapPoint=cc;static mapPoints=D0;static projection=$0;constructor(){super(9),hc(this)}identity(){return hc(this)}multiplyMatrices(e,n){return Jo(this,e,n)}premultiply(e){return Jo(this,e,this)}multiply(e){return Jo(this,this,e)}translate(e){return l2(this,this,e)}rotate(e){return u2(this,this,e)}scale(e){return f2(this,this,e)}makeTranslation(e){return I0(this,e)}makeRotation(e){return k0(this,e)}makeScale(e){return R0(this,e)}makeSkew(e){return O0(this,e)}makeTRS(e,n,i){return L0(this,e,n,i)}adjugate(){return B0(this,this)}determinant(){return F0(this)}invert(){return N0(this,this)}transpose(){return q0(this,this)}hasTranslation(){return v2(this)}hasRotation(){return M2(this)}hasScale(){return _2(this)}hasIdentity(){return S2(this)}mapPoint(e,n=e){return cc(n,this,e)}mapPoints(e,n=e){return D0(n,this,e)}projection(e,n){return $0(this,e,n)}},Vs=class extends Float32Array{static create(e,n){return new this(e,n)}constructor(e,n){super(2),this[0]=e,this[1]=n}get x(){return this[0]}get y(){return this[1]}set x(e){this[0]!==e&&(this[0]=e,this._change(this))}set y(e){this[1]!==e&&(this[1]=e,this._change(this))}_change(e){}onChange(e){this._change=e}copy(e){this.setXY(e[0],e[1])}setXY(e,n){(this[0]!==e||this[1]!==n)&&(this[0]=e,this[1]=n,this._change(this))}set(e,n){this.setXY(e,n)}};function z2(r){return class extends r{position=Vs.create(0,0);_rotation=0;_cx=1;_sx=0;_cy=0;_sy=1;skew=Vs.create(0,0);scale=Vs.create(1,1);origin=Vs.create(0,0);pivot=Vs.create(0,0);_matrix=re.default();_matrixWorld=re.default();localMatrixDirty=!1;worldMatrixId=0;parentWorldMatrixId=0;parent=null;children=null;constructor(...e){super(...e);const n=e[0];this.position.onChange(this.onUpdateTransformable),this.scale.onChange(this.onUpdateTransformable),this.origin.onChange(this.onUpdateTransformable),this.pivot.onChange(this.onUpdateTransformable),this.skew.onChange(this.onUpdateTransformable),this.setTransformWithOptions(n)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.onUpdateTransformable(this.skew))}get angle(){return this._rotation/Math.PI*180}set angle(e){this.rotation=e/180*Math.PI}get hasWorldMatrixDirty(){return this.parent?this.parentWorldMatrixId===-1||this.parentWorldMatrixId!==this.parent.worldMatrixId||this.parent.hasWorldMatrixDirty:this.parentWorldMatrixId===-1}get matrix(){return this.updateMatrix(),this._matrix}get worldMatrix(){return this.updateWorldMatrix(),this._matrixWorld}setTransformWithOptions(e){e&&(e.position&&this.position.setXY(e.position.x,e.position.y),e.rotation!==void 0&&(this.rotation=e.rotation),e.angle!==void 0&&(this.angle=e.angle),e.scale&&this.scale.setXY(e.scale.x,e.scale.y),e.origin&&this.origin.setXY(e.origin.x,e.origin.y),e.pivot&&this.pivot.setXY(e.pivot.x,e.pivot.y),e.skew&&this.skew.setXY(e.skew.x,e.skew.y))}setTransformFromMatrix(e){e.decompose(this),this.onUpdateTransformable()}updateMatrix(){if(!this.localMatrixDirty)return;this.localMatrixDirty=!1;const e=this.position.x,n=this.position.y,i=this.pivot.x,s=this.pivot.y,o=-this.origin.x,a=-this.origin.y,h=this.scale.x,c=this.scale.y,l=this._matrix;l.a=this._cx*h,l.b=this._sx*h,l.c=this._cy*c,l.d=this._sy*c,l.tx=e-(i*l.a+s*l.c)+(o*l.a+a*l.c)-o,l.ty=n-(i*l.b+s*l.d)+(o*l.b+a*l.d)-a}updateWorldMatrix(){this.hasWorldMatrixDirty&&(this.parent?(this._matrixWorld.multiplyMatrices(this.parent.worldMatrix,this.matrix),this.parentWorldMatrixId=this.parent.worldMatrixId):(this._matrixWorld.copy(this.matrix),this.parentWorldMatrixId=0),this.worldMatrixId+=1)}onUpdateTransformable=e=>{e===this.skew&&this._updateSkew(),this.localMatrixDirty=!0,this.parentWorldMatrixId=-1,this.onTransformChange()};_updateSkew(){const e=this._rotation,n=this.skew;this._cx=Math.cos(e+n.y),this._sx=Math.sin(e+n.y),this._cy=-Math.sin(e-n.x),this._sy=Math.cos(e-n.x)}onTransformChange(){}}}let Ni=class Bg{static empty(){return this.fromLTRB(0,0,0,0)}static default(){return new this}static fromXYWH(e,n,i,s){return this.fromLTRB(e,n,e+i,n+s)}static fromLTRB(e,n,i,s){return new this(O.create(e,n),O.create(i,s))}min;max;constructor(e=O.create(1/0,1/0),n=O.create(-1/0,-1/0)){this.min=e,this.max=n}get left(){return this.min.x}get top(){return this.min.y}get right(){return this.max.x}get bottom(){return this.max.y}get x(){return this.min.x}get y(){return this.min.y}get width(){return this.max.x-this.min.x}get height(){return this.max.y-this.min.y}get cx(){return this.left*.5+this.right*.5}get cy(){return this.top*.5+this.bottom*.5}get center(){return O.create(this.cx,this.cy)}isEmpty(){return this.min.x>this.max.x||this.min.y>this.max.y}clone(){return new Bg().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}makeZero(){return this.min.x=this.min.y=0,this.max.x=this.max.y=0,this}setViewport(e,n,i,s){return this.min.set(e,n),this.max.set(e+i,n+s),this}set(e,n){return this.min.copy(e),this.max.copy(n),this}fromCircle(e,n,i){return this.min.set(e-i,n-i),this.max.set(e+i,n+i),this}fromLine(e,n,i,s,o){const a=i-e,h=s-n,c=Math.sqrt(a*a+h*h);if(c===0){this.makeZero();return}const l=a/c,f=-(h/c),d=l,p=f*o/2,y=d*o/2,x=[{x:e-p,y:n-y},{x:e+p,y:n+y},{x:i-p,y:s-y},{x:i+p,y:s+y}];return this.setFromPoints(x),this}fromRect(e,n,i,s){return this.min.set(e,n),this.max.set(e+i,n+s),this}setFromVertices(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=2)this.expandByXY(e[n],e[n+1]);return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}expandByStrokeWidth(e){let n=e*.5;return this.min.translate(-n,-n),this.max.translate(n,n),this}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByXY(e,n){return this.min.set(Math.min(this.min.x,e),Math.min(this.min.y,n)),this.max.set(Math.max(this.max.x,e),Math.max(this.max.y,n)),this}isValid(){return this.isFinite()&&this.left<=this.right&&this.top<=this.bottom}isZero(){return this.width===0||this.height===0}isFinite(){return this.isEmpty()}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}translate(e,n){this.min.translate(e,n),this.max.translate(e,n)}inset(e,n){this.min.translate(e,n),this.max.translate(-e,-n)}outset(e,n){this.inset(-e,-n)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}containsXY(e,n){return!(e<this.left||e>this.right||n<this.top||n>this.bottom)}containsPoint(e){return this.containsXY(e.x,e.y)}containsBox(e){return!(e.min.x<this.min.x||e.max.x>this.max.x||e.min.y<this.min.y||e.max.y>this.max.y)}intersectBox3(e,n){if(!e)return!1;const i=this,s=i.left,o=i.right,a=i.top,h=i.bottom,c=e.left,l=e.right,u=e.top,f=e.bottom,d=O.default(),p=O.default();let y=!(o<c||l<s||h<u||f<a);if(n){let x=1/0,m=0;const g=Math.abs(o-c),w=Math.abs(l-s),M=Math.abs(h-u),S=Math.abs(f-a),E=Math.min(g,w),A=Math.min(M,S);o<c||l<s?E>m&&(m=E,g<w?d.set(-g,0):d.set(w,0)):E<x&&(x=E,g<w?p.set(g,0):p.set(-w,0)),h<u||f<a?A>m&&(m=A,M<S?d.set(0,-M):d.set(0,S)):E<x&&(x=E,M<S?p.set(0,M):p.set(0,-S))}return n&&n.copy(y?p:d),y}intersectionBox(e){return!(this.left>e.right||this.right<e.left||this.top>e.bottom||this.bottom<e.top)}applyMatrix(e){if(e.hasIdentity())return;const n=O.create(this.left,this.top),i=O.create(this.right,this.top),s=O.create(this.left,this.bottom),o=O.create(this.right,this.bottom);n.applyMatrix2D(e),i.applyMatrix2D(e),s.applyMatrix2D(e),o.applyMatrix2D(e),this.makeEmpty(),this.expandByPoint(n),this.expandByPoint(i),this.expandByPoint(s),this.expandByPoint(o)}};const A2=Math.PI*2;let yi=class Fg{x=0;y=0;constructor(e=0,n=0){this.x=e,this.y=n}clone(){return new Fg(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,n=e){return this.x=e,this.y=n,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return lc.x=0,lc.y=0,lc}};const lc=new yi;let uc=class Ng{a;b;c;d;tx;ty;array=null;constructor(e=1,n=0,i=0,s=1,o=0,a=0){this.a=e,this.b=n,this.c=i,this.d=s,this.tx=o,this.ty=a}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,n,i,s,o,a){return this.a=e,this.b=n,this.c=i,this.d=s,this.tx=o,this.ty=a,this}toArray(e,n){this.array||(this.array=new Float32Array(9));const i=n||this.array;return e?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(e,n){n=n||new yi;const i=e.x,s=e.y;return n.x=this.a*i+this.c*s+this.tx,n.y=this.b*i+this.d*s+this.ty,n}applyInverse(e,n){n=n||new yi;const i=this.a,s=this.b,o=this.c,a=this.d,h=this.tx,c=this.ty,l=1/(i*a+o*-s),u=e.x,f=e.y;return n.x=a*l*u+-o*l*f+(c*o-h*a)*l,n.y=i*l*f+-s*l*u+(-c*i+h*s)*l,n}translate(e,n){return this.tx+=e,this.ty+=n,this}scale(e,n){return this.a*=e,this.d*=n,this.c*=e,this.b*=n,this.tx*=e,this.ty*=n,this}rotate(e){const n=Math.cos(e),i=Math.sin(e),s=this.a,o=this.c,a=this.tx;return this.a=s*n-this.b*i,this.b=s*i+this.b*n,this.c=o*n-this.d*i,this.d=o*i+this.d*n,this.tx=a*n-this.ty*i,this.ty=a*i+this.ty*n,this}append(e){const n=this.a,i=this.b,s=this.c,o=this.d;return this.a=e.a*n+e.b*s,this.b=e.a*i+e.b*o,this.c=e.c*n+e.d*s,this.d=e.c*i+e.d*o,this.tx=e.tx*n+e.ty*s+this.tx,this.ty=e.tx*i+e.ty*o+this.ty,this}appendFrom(e,n){const i=e.a,s=e.b,o=e.c,a=e.d,h=e.tx,c=e.ty,l=n.a,u=n.b,f=n.c,d=n.d;return this.a=i*l+s*f,this.b=i*u+s*d,this.c=o*l+a*f,this.d=o*u+a*d,this.tx=h*l+c*f+n.tx,this.ty=h*u+c*d+n.ty,this}setTransform(e,n,i,s,o,a,h,c,l){return this.a=Math.cos(h+l)*o,this.b=Math.sin(h+l)*o,this.c=-Math.sin(h-c)*a,this.d=Math.cos(h-c)*a,this.tx=e-(i*this.a+s*this.c),this.ty=n-(i*this.b+s*this.d),this}prepend(e){const n=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const i=this.a,s=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=s*e.a+this.d*e.c,this.d=s*e.b+this.d*e.d}return this.tx=n*e.a+this.ty*e.c+e.tx,this.ty=n*e.b+this.ty*e.d+e.ty,this}decompose(e){const n=this.a,i=this.b,s=this.c,o=this.d,a=e.pivot,h=-Math.atan2(-s,o),c=Math.atan2(i,n),l=Math.abs(h+c);return l<1e-5||Math.abs(A2-l)<1e-5?(e.rotation=c,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=h,e.skew.y=c),e.scale.x=Math.sqrt(n*n+i*i),e.scale.y=Math.sqrt(s*s+o*o),e.position.x=this.tx+(a.x*n+a.y*s),e.position.y=this.ty+(a.x*i+a.y*o),e}invert(){const e=this.a,n=this.b,i=this.c,s=this.d,o=this.tx,a=e*s-n*i;return this.a=s/a,this.b=-n/a,this.c=-i/a,this.d=e/a,this.tx=(i*this.ty-s*o)/a,this.ty=-(e*this.ty-n*o)/a,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Ng;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return P2.identity()}static get shared(){return C2.identity()}};const C2=new uc,P2=new uc,Qo=[new yi,new yi,new yi,new yi];let Lr=class Qh{type="rectangle";x;y;width;height;constructor(e=0,n=0,i=0,s=0){this.x=Number(e),this.y=Number(n),this.width=Number(i),this.height=Number(s)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Qh(0,0,0,0)}clone(){return new Qh(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,n){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&n>=this.y&&n<this.y+this.height}strokeContains(e,n,i,s=.5){const{width:o,height:a}=this;if(o<=0||a<=0)return!1;const h=this.x,c=this.y,l=i*(1-s),u=i-l,f=h-l,d=h+o+l,p=c-l,y=c+a+l,x=h+u,m=h+o-u,g=c+u,w=c+a-u;return e>=f&&e<=d&&n>=p&&n<=y&&!(e>x&&e<m&&n>g&&n<w)}intersects(e,n){if(!n){const b=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=b)return!1;const _=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>_}const i=this.left,s=this.right,o=this.top,a=this.bottom;if(s<=i||a<=o)return!1;const h=Qo[0].set(e.left,e.top),c=Qo[1].set(e.left,e.bottom),l=Qo[2].set(e.right,e.top),u=Qo[3].set(e.right,e.bottom);if(l.x<=h.x||c.y<=h.y)return!1;const f=Math.sign(n.a*n.d-n.b*n.c);if(f===0||(n.apply(h,h),n.apply(c,c),n.apply(l,l),n.apply(u,u),Math.max(h.x,c.x,l.x,u.x)<=i||Math.min(h.x,c.x,l.x,u.x)>=s||Math.max(h.y,c.y,l.y,u.y)<=o||Math.min(h.y,c.y,l.y,u.y)>=a))return!1;const d=f*(c.y-h.y),p=f*(h.x-c.x),y=d*i+p*o,x=d*s+p*o,m=d*i+p*a,g=d*s+p*a;if(Math.max(y,x,m,g)<=d*h.x+p*h.y||Math.min(y,x,m,g)>=d*u.x+p*u.y)return!1;const w=f*(h.y-l.y),M=f*(l.x-h.x),S=w*i+M*o,E=w*s+M*o,A=w*i+M*a,I=w*s+M*a;return!(Math.max(S,E,A,I)<=w*h.x+M*h.y||Math.min(S,E,A,I)>=w*u.x+M*u.y)}pad(e=0,n=e){return this.x-=e,this.y-=n,this.width+=e*2,this.height+=n*2,this}fit(e){const n=Math.max(this.x,e.x),i=Math.min(this.x+this.width,e.x+e.width),s=Math.max(this.y,e.y),o=Math.min(this.y+this.height,e.y+e.height);return this.x=n,this.width=Math.max(i-n,0),this.y=s,this.height=Math.max(o-s,0),this}ceil(e=1,n=.001){const i=Math.ceil((this.x+this.width-n)*e)/e,s=Math.ceil((this.y+this.height-n)*e)/e;return this.x=Math.floor((this.x+n)*e)/e,this.y=Math.floor((this.y+n)*e)/e,this.width=i-this.x,this.height=s-this.y,this}enlarge(e){const n=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),s=Math.min(this.y,e.y),o=Math.max(this.y+this.height,e.y+e.height);return this.x=n,this.width=i-n,this.y=s,this.height=o-s,this}getBounds(e){return e||=new Qh,e.copyFrom(this),e}containsRect(e){if(this.width<=0||this.height<=0)return!1;const n=e.x,i=e.y,s=e.x+e.width,o=e.y+e.height;return n>=this.x&&n<this.x+this.width&&i>=this.y&&i<this.y+this.height&&s>=this.x&&s<this.x+this.width&&o>=this.y&&o<this.y+this.height}set(e,n,i,s){return this.x=e,this.y=n,this.width=i,this.height=s,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}},I2=class qg{x;y;radius;type="circle";constructor(e=0,n=0,i=0){this.x=e,this.y=n,this.radius=i}clone(){return new qg(this.x,this.y,this.radius)}contains(e,n){if(this.radius<=0)return!1;const i=this.radius*this.radius;let s=this.x-e,o=this.y-n;return s*=s,o*=o,s+o<=i}strokeContains(e,n,i,s=.5){if(this.radius===0)return!1;const o=this.x-e,a=this.y-n,h=this.radius,c=(1-s)*i,l=Math.sqrt(o*o+a*a);return l<=h+c&&l>h-(i-c)}getBounds(e){return e||=new Lr,e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}},k2=class Dg{x;y;halfWidth;halfHeight;type="ellipse";constructor(e=0,n=0,i=0,s=0){this.x=e,this.y=n,this.halfWidth=i,this.halfHeight=s}clone(){return new Dg(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,n){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let i=(e-this.x)/this.halfWidth,s=(n-this.y)/this.halfHeight;return i*=i,s*=s,i+s<=1}strokeContains(e,n,i,s=.5){const{halfWidth:o,halfHeight:a}=this;if(o<=0||a<=0)return!1;const h=i*(1-s),c=i-h,l=o-c,u=a-c,f=o+h,d=a+h,p=e-this.x,y=n-this.y,x=p*p/(l*l)+y*y/(u*u),m=p*p/(f*f)+y*y/(d*d);return x>1&&m<=1}getBounds(e){return e||=new Lr,e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}};function R2(r,e,n,i,s,o){const a=r-n,h=e-i,c=s-n,l=o-i,u=a*c+h*l,f=c*c+l*l;let d=-1;f!==0&&(d=u/f);let p,y;d<0?(p=n,y=i):d>1?(p=s,y=o):(p=n+d*c,y=i+d*l);const x=r-p,m=e-y;return x*x+m*m}let O2,L2,B2=class $g{points;closePath;type="polygon";constructor(...e){let n=Array.isArray(e[0])?e[0]:e;if(typeof n[0]!="number"){const i=[];for(let s=0,o=n.length;s<o;s++)i.push(n[s].x,n[s].y);n=i}this.points=n,this.closePath=!0}isClockwise(){let e=0;const n=this.points,i=n.length;for(let s=0;s<i;s+=2){const o=n[s],a=n[s+1],h=n[(s+2)%i],c=n[(s+3)%i];e+=(h-o)*(c+a)}return e<0}containsPolygon(e){const n=this.getBounds(O2),i=e.getBounds(L2);if(!n.containsRect(i))return!1;const s=e.points;for(let o=0;o<s.length;o+=2){const a=s[o],h=s[o+1];if(!this.contains(a,h))return!1}return!0}clone(){const e=this.points.slice(),n=new $g(e);return n.closePath=this.closePath,n}contains(e,n){let i=!1;const s=this.points.length/2;for(let o=0,a=s-1;o<s;a=o++){const h=this.points[o*2],c=this.points[o*2+1],l=this.points[a*2],u=this.points[a*2+1];c>n!=u>n&&e<(l-h)*((n-c)/(u-c))+h&&(i=!i)}return i}strokeContains(e,n,i,s=.5){const o=i*i,a=o*(1-s),h=o-a,{points:c}=this,l=c.length-(this.closePath?0:2);for(let u=0;u<l;u+=2){const f=c[u],d=c[u+1],p=c[(u+2)%c.length],y=c[(u+3)%c.length],x=R2(e,n,f,d,p,y),m=Math.sign((p-f)*(n-d)-(y-d)*(e-f));if(x<=(m<0?h:a))return!0}return!1}getBounds(e){e||=new Lr;const n=this.points;let i=1/0,s=-1/0,o=1/0,a=-1/0;for(let h=0,c=n.length;h<c;h+=2){const l=n[h],u=n[h+1];i=l<i?l:i,s=l>s?l:s,o=u<o?u:o,a=u>a?u:a}return e.x=i,e.width=s-i,e.y=o,e.height=a-o,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,n)=>`${e}, ${n}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}};const Ko=(r,e,n,i,s,o,a)=>{const h=r-n,c=e-i,l=Math.sqrt(h*h+c*c);return l>=s-o&&l<=s+a},F2=Object.freeze(Object.defineProperty({__proto__:null,Circle:I2,Ellipse:k2,Polygon:B2,Rectangle:Lr,RoundedRectangle:class Vg{x;y;width;height;radius;type="roundedRectangle";constructor(e=0,n=0,i=0,s=0,o=20){this.x=e,this.y=n,this.width=i,this.height=s,this.radius=o}getBounds(e){return e||=new Lr,e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new Vg(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,n){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&n>=this.y&&n<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(n>=this.y+i&&n<=this.y+this.height-i||e>=this.x+i&&e<=this.x+this.width-i)return!0;let s=e-(this.x+i),o=n-(this.y+i);const a=i*i;if(s*s+o*o<=a||(s=e-(this.x+this.width-i),s*s+o*o<=a)||(o=n-(this.y+this.height-i),s*s+o*o<=a)||(s=e-(this.x+i),s*s+o*o<=a))return!0}return!1}strokeContains(e,n,i,s=.5){const{x:o,y:a,width:h,height:c,radius:l}=this,u=i*(1-s),f=i-u,d=o+l,p=a+l,y=h-l*2,x=c-l*2,m=o+h,g=a+c;return(e>=o-u&&e<=o+f||e>=m-f&&e<=m+u)&&n>=p&&n<=p+x||(n>=a-u&&n<=a+f||n>=g-f&&n<=g+u)&&e>=d&&e<=d+y?!0:e<d&&n<p&&Ko(e,n,d,p,l,f,u)||e>m-l&&n<p&&Ko(e,n,m-l,p,l,f,u)||e>m-l&&n>g-l&&Ko(e,n,m-l,g-l,l,f,u)||e<d&&n>g-l&&Ko(e,n,d,g-l,l,f,u)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}},Symbol.toStringTag,{value:"Module"}));let N2=class Ug{_x;_y;_observer;constructor(e,n,i){this._x=n||0,this._y=i||0,this._observer=e}clone(e){return new Ug(e??this._observer,this._x,this._y)}set(e=0,n=e){return(this._x!==e||this._y!==n)&&(this._x=e,this._y=n,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}};function q2(r,e,n,i,s,o,a,h){const c=a-n,l=h-i,u=s-n,f=o-i,d=r-n,p=e-i,y=c*c+l*l,x=c*u+l*f,m=c*d+l*p,g=u*u+f*f,w=u*d+f*p,M=1/(y*g-x*x),S=(g*m-x*w)*M,E=(y*w-x*m)*M;return S>=0&&E>=0&&S+E<1}const D2=Object.freeze(Object.defineProperty({__proto__:null,ObservablePoint:N2,Point:yi,pointInTriangle:q2},Symbol.toStringTag,{value:"Module"})),$2=(r,e)=>r[0]*e[0]+r[1]*e[1],V2=(r,e)=>r[0]*e[1]-r[1]*e[0],V0=(r,e)=>Math.atan2(V2(r,e),$2(r,e));function U0(r,e,n,i,s,o,a){let h=Math.PI*2;a===0&&(a=1e-6),a===h&&(a=h-1e-6);let c=Math.cos(s),l=Math.sin(s),u=c*n*Math.cos(o)-l*i*Math.sin(o)+r,f=l*n*Math.cos(o)+c*i*Math.sin(o)+e,d=c*n*Math.cos(o+a)-l*i*Math.sin(o+a)+r,p=l*n*Math.cos(o+a)+c*i*Math.sin(o+a)+e,y=Math.abs(a)>Math.PI?1:0,x=a>0?1:0;return{x1:u,y1:f,x2:d,y2:p,fa:y,fs:x}}function W0(r,e,n,i,s,o,a,h,c){let l=Math.cos(c),u=Math.sin(c),f=l*(r-n)/2+u*(e-i)/2,d=-u*(r-n)/2+l*(e-i)/2,p=f*f/(a*a)+d*d/(h*h);p>1&&(p=Math.sqrt(p),a*=p,h*=p);let y=s!==o?1:-1,x=(a*a*h*h-a*a*d*d-h*h*f*f)/(a*a*d*d+h*h*f*f);x<0?x=0:x=Math.sqrt(x);let m=y*x*(a*d/h),g=y*x*(-h*f/a),w=l*m-u*g+(r+n)/2,M=u*m+l*g+(e+i)/2,S=V0([1,0],[(f-m)/a,(d-g)/h]),E=V0([(f-m)/a,(d-g)/h],[(-f-m)/a,(-d-g)/h]);!o&&E>0?E-=Math.PI*2:o&&E<0&&(E+=Math.PI*2);let A=S+E;return{rx:a,ry:h,cx:w,cy:M,theta1:S,theta2:A,dtheta:E}}function j0(r,e,n,i,s,o){const a=Math.cos(o)*n,h=Math.sin(o)*i,c=Math.cos(s),l=Math.sin(s);return{x:r+c*a-l*h,y:e+l*a+c*h}}function fc(r,e,n,i,s,o,a){const h=a-o,c=4/3*Math.tan(h/4),l=O.fromRotation(o),u=O.fromRotation(a),f=O.fromPoint(l),d=O.fromPoint(u);return f.translate(-c*l.y,c*l.x),d.translate(c*u.y,-c*u.x),l.scale(n,i).rotate(s).translate(r,e),f.scale(n,i).rotate(s).translate(r,e),d.scale(n,i).rotate(s).translate(r,e),u.scale(n,i).rotate(s).translate(r,e),[l.x,l.y,f.x,f.y,d.x,d.y,u.x,u.y]}function ta(r,e,n,i,s,o,a,h,c,l){const{cx:u,cy:f,theta1:d,dtheta:p,rx:y,ry:x}=W0(r,e,n,i,h,c,s,o,a),m=Math.ceil(Math.abs(p/(Math.PI/2))),g=p/m,w=[];let M=d;for(let S=0;S<m;S++){const E=M+g;let[A,I,b,v,_,z,P,k]=fc(u,f,y,x,a,M,E);l?.(A,I,b,v,_,z,P,k,S),M=E,w.push(A,I,b,v,_,z,P,k)}return w}const Y0=Math.PI,U2=Math.PI*2,W2=Math.PI*.5,j2=4/3*(Math.sqrt(2)-1);function Y2(r){return 4/3*Math.tan(r/4)}function H2(r){return Math.ceil(Math.abs(r)/Y0)}function X2(r){for(var e=0;e<r.length;e++)if(r[e]!==void 0&&!Number.isFinite(r[e]))return!1;return!0}function Z2(r,e,n=1e-5){return Math.abs(r-e)<=n}function G2(r){return r*(180/Math.PI)}function J2(r){return r*(Math.PI/180)}function Q2(r){return Math.sqrt(r)}function K2(r,e){return Math.pow(r,e)}function tw(r){return Math.abs(r)}function ew(r,e){return Math.min(r,e)}function nw(r,e){return Math.max(r,e)}function iw(r,e){return Math.random()*(e-r)+r}function sw(r,e,n=1e-4){return(r(e+n)-r(e-n))/(2*n)}function dc(r){if(r<0)return-1;let e=1;for(let n=2;n<=r;n++)e*=n;return e}function H0(r,e){if(e>r)return 0;let n=1;for(let i=1;i<=e;i++)n*=(r-i+1)/i;return n}function rw(r,e){if(e>r)return 0;let n=1;for(let i=1;i<=e;i++)n*=r-i+1;return n}function ow(r,e,n,i,s){return(r-e)*(s-i)/(n-e)+i}function ve(r,e,n){return Math.min(Math.max(r,e),n)}function aw(r,e,n){return r*(1-n)+e*n}function hw(r,e,n){return(n-r)/(e-r)}function cw(r,e,n){const i=ve((n-r)/(e-r),0,1);return i*i*(3-2*i)}function lw(r,e,n){const i=ve((n-r)/(e-r),0,1);return i<.5?4*i*i*i:(i-1)*(2*i-2)*(2*i-2)+1}function uw(r,e,n){const i=ve((n-r)/(e-r),0,1);return i*i*i}function fw(r,e,n){const i=ve((n-r)/(e-r),0,1);return(i-1)*(2*i-2)*(2*i-2)+1}function dw(r){return e=>class extends e{constructor(...n){super(...n),Object.assign(this,r)}}}const pw=Object.freeze(Object.defineProperty({__proto__:null,BEZIER_CIRCLE_GOLDEN_RATIO:j2,PI:Y0,PI2:U2,PI_2:W2,abs:tw,allAreFinite:X2,calcArcGoldenRatio:Y2,calcArcSteps:H2,clamp:ve,createMixin:dw,degreesToRadians:J2,derivative:sw,easeIn:uw,easeInOut:lw,easeOut:fw,equalsEpsilon:Z2,factorial:dc,inverseLerp:hw,lerp:aw,map:ow,max:nw,min:ew,nCr:H0,nPr:rw,pow:K2,radiansToDegrees:G2,random:iw,smoothstep:cw,sqrt:Q2},Symbol.toStringTag,{value:"Module"})),ht=1e-6,yw="zyx",X0=new Float32Array([1,0,0,1]);class oe extends Float32Array{static BYTE_LENGTH=4*Float32Array.BYTES_PER_ELEMENT;constructor(...e){switch(e.length){case 4:super(e);break;case 2:super(e[0],e[1],4);break;case 1:const n=e[0];typeof n=="number"?super([n,n,n,n]):super(n,0,4);break;default:super(X0);break}}get str(){return oe.str(this)}copy(e){return this.set(e),this}identity(){return this.set(X0),this}multiply(e){return oe.multiply(this,this,e)}mul(e){return this}transpose(){return oe.transpose(this,this)}invert(){return oe.invert(this,this)}scale(e){return oe.scale(this,this,e)}rotate(e){return oe.rotate(this,this,e)}static create(){return new oe}static clone(e){return new oe(e)}static copy(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}static fromValues(...e){return new oe(...e)}static set(e,...n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}static identity(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}static transpose(e,n){if(e===n){let i=n[1];e[1]=n[2],e[2]=i}else e[0]=n[0],e[1]=n[2],e[2]=n[1],e[3]=n[3];return e}static invert(e,n){const i=n[0],s=n[1],o=n[2],a=n[3];let h=i*a-o*s;return h?(h=1/h,e[0]=a*h,e[1]=-s*h,e[2]=-o*h,e[3]=i*h,e):null}static adjoint(e,n){const i=n[0];return e[0]=n[3],e[1]=-n[1],e[2]=-n[2],e[3]=i,e}static determinant(e){return e[0]*e[3]-e[2]*e[1]}static add(e,n,i){return e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e[3]=n[3]+i[3],e}static subtract(e,n,i){return e[0]=n[0]-i[0],e[1]=n[1]-i[1],e[2]=n[2]-i[2],e[3]=n[3]-i[3],e}static sub(e,n,i){return e}static multiply(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3],c=i[0],l=i[1],u=i[2],f=i[3];return e[0]=s*c+a*l,e[1]=o*c+h*l,e[2]=s*u+a*f,e[3]=o*u+h*f,e}static mul(e,n,i){return e}static rotate(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3],c=Math.sin(i),l=Math.cos(i);return e[0]=s*l+a*c,e[1]=o*l+h*c,e[2]=s*-c+a*l,e[3]=o*-c+h*l,e}static scale(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3],c=i[0],l=i[1];return e[0]=s*c,e[1]=o*c,e[2]=a*l,e[3]=h*l,e}static fromRotation(e,n){const i=Math.sin(n),s=Math.cos(n);return e[0]=s,e[1]=i,e[2]=-i,e[3]=s,e}static fromScaling(e,n){return e[0]=n[0],e[1]=0,e[2]=0,e[3]=n[1],e}static frob(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]+e[3]*e[3])}static multiplyScalar(e,n,i){return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=n[3]*i,e}static multiplyScalarAndAdd(e,n,i,s){return e[0]=n[0]+i[0]*s,e[1]=n[1]+i[1]*s,e[2]=n[2]+i[2]*s,e[3]=n[3]+i[3]*s,e}static LDU(e,n,i,s){return e[2]=s[2]/s[0],i[0]=s[0],i[1]=s[1],i[3]=s[3]-e[2]*i[1],[e,n,i]}static exactEquals(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]}static equals(e,n){const i=e[0],s=e[1],o=e[2],a=e[3],h=n[0],c=n[1],l=n[2],u=n[3];return Math.abs(i-h)<=ht*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(s-c)<=ht*Math.max(1,Math.abs(s),Math.abs(c))&&Math.abs(o-l)<=ht*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(a-u)<=ht*Math.max(1,Math.abs(a),Math.abs(u))}static str(e){return`Mat2(${e.join(", ")})`}}oe.prototype.mul=oe.prototype.multiply,oe.mul=oe.multiply,oe.sub=oe.subtract;const Us=oe,Z0=new Float32Array([1,0,0,1,0,0]);class Me extends Float32Array{static BYTE_LENGTH=6*Float32Array.BYTES_PER_ELEMENT;constructor(...e){switch(e.length){case 6:super(e);break;case 2:super(e[0],e[1],6);break;case 1:const n=e[0];typeof n=="number"?super([n,n,n,n,n,n]):super(n,0,6);break;default:super(Z0);break}}get str(){return Me.str(this)}copy(e){return this.set(e),this}identity(){return this.set(Z0),this}multiply(e){return Me.multiply(this,this,e)}mul(e){return this}translate(e){return Me.translate(this,this,e)}rotate(e){return Me.rotate(this,this,e)}scale(e){return Me.scale(this,this,e)}static create(){return new Me}static clone(e){return new Me(e)}static copy(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e}static fromValues(...e){return new Me(...e)}static set(e,...n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e}static identity(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}static invert(e,n){const i=n[0],s=n[1],o=n[2],a=n[3],h=n[4],c=n[5];let l=i*a-s*o;return l?(l=1/l,e[0]=a*l,e[1]=-s*l,e[2]=-o*l,e[3]=i*l,e[4]=(o*c-a*h)*l,e[5]=(s*h-i*c)*l,e):null}static determinant(e){return e[0]*e[3]-e[1]*e[2]}static add(e,n,i){return e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e[3]=n[3]+i[3],e[4]=n[4]+i[4],e[5]=n[5]+i[5],e}static subtract(e,n,i){return e[0]=n[0]-i[0],e[1]=n[1]-i[1],e[2]=n[2]-i[2],e[3]=n[3]-i[3],e[4]=n[4]-i[4],e[5]=n[5]-i[5],e}static sub(e,n,i){return e}static multiply(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3],c=n[4],l=n[5],u=i[0],f=i[1],d=i[2],p=i[3],y=i[4],x=i[5];return e[0]=s*u+a*f,e[1]=o*u+h*f,e[2]=s*d+a*p,e[3]=o*d+h*p,e[4]=s*y+a*x+c,e[5]=o*y+h*x+l,e}static mul(e,n,i){return e}static translate(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3],c=n[4],l=n[5],u=i[0],f=i[1];return e[0]=s,e[1]=o,e[2]=a,e[3]=h,e[4]=s*u+a*f+c,e[5]=o*u+h*f+l,e}static rotate(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3],c=n[4],l=n[5],u=Math.sin(i),f=Math.cos(i);return e[0]=s*f+a*u,e[1]=o*f+h*u,e[2]=s*-u+a*f,e[3]=o*-u+h*f,e[4]=c,e[5]=l,e}static scale(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3],c=n[4],l=n[5],u=i[0],f=i[1];return e[0]=s*u,e[1]=o*u,e[2]=a*f,e[3]=h*f,e[4]=c,e[5]=l,e}static fromTranslation(e,n){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=n[0],e[5]=n[1],e}static fromRotation(e,n){const i=Math.sin(n),s=Math.cos(n);return e[0]=s,e[1]=i,e[2]=-i,e[3]=s,e[4]=0,e[5]=0,e}static fromScaling(e,n){return e[0]=n[0],e[1]=0,e[2]=0,e[3]=n[1],e[4]=0,e[5]=0,e}static frob(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]+e[3]*e[3]+e[4]*e[4]+e[5]*e[5]+1)}static multiplyScalar(e,n,i){return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=n[3]*i,e[4]=n[4]*i,e[5]=n[5]*i,e}static multiplyScalarAndAdd(e,n,i,s){return e[0]=n[0]+i[0]*s,e[1]=n[1]+i[1]*s,e[2]=n[2]+i[2]*s,e[3]=n[3]+i[3]*s,e[4]=n[4]+i[4]*s,e[5]=n[5]+i[5]*s,e}static exactEquals(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]&&e[4]===n[4]&&e[5]===n[5]}static equals(e,n){const i=e[0],s=e[1],o=e[2],a=e[3],h=e[4],c=e[5],l=n[0],u=n[1],f=n[2],d=n[3],p=n[4],y=n[5];return Math.abs(i-l)<=ht*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(s-u)<=ht*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(o-f)<=ht*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(a-d)<=ht*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(h-p)<=ht*Math.max(1,Math.abs(h),Math.abs(p))&&Math.abs(c-y)<=ht*Math.max(1,Math.abs(c),Math.abs(y))}static str(e){return`Mat2d(${e.join(", ")})`}}Me.mul=Me.multiply,Me.sub=Me.subtract;const xi=Me,G0=new Float32Array([1,0,0,0,1,0,0,0,1]);class Zt extends Float32Array{static BYTE_LENGTH=9*Float32Array.BYTES_PER_ELEMENT;constructor(...e){switch(e.length){case 9:super(e);break;case 2:super(e[0],e[1],9);break;case 1:const n=e[0];typeof n=="number"?super([n,n,n,n,n,n,n,n,n]):super(n,0,9);break;default:super(G0);break}}get str(){return Zt.str(this)}copy(e){return this.set(e),this}identity(){return this.set(G0),this}multiply(e){return Zt.multiply(this,this,e)}mul(e){return this}transpose(){return Zt.transpose(this,this)}invert(){return Zt.invert(this,this)}translate(e){return Zt.translate(this,this,e)}rotate(e){return Zt.rotate(this,this,e)}scale(e){return Zt.scale(this,this,e)}static create(){return new Zt}static clone(e){return new Zt(e)}static copy(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e}static fromValues(...e){return new Zt(...e)}static set(e,...n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e}static identity(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}static transpose(e,n){if(e===n){const i=n[1],s=n[2],o=n[5];e[1]=n[3],e[2]=n[6],e[3]=i,e[5]=n[7],e[6]=s,e[7]=o}else e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8];return e}static invert(e,n){const i=n[0],s=n[1],o=n[2],a=n[3],h=n[4],c=n[5],l=n[6],u=n[7],f=n[8],d=f*h-c*u,p=-f*a+c*l,y=u*a-h*l;let x=i*d+s*p+o*y;return x?(x=1/x,e[0]=d*x,e[1]=(-f*s+o*u)*x,e[2]=(c*s-o*h)*x,e[3]=p*x,e[4]=(f*i-o*l)*x,e[5]=(-c*i+o*a)*x,e[6]=y*x,e[7]=(-u*i+s*l)*x,e[8]=(h*i-s*a)*x,e):null}static adjoint(e,n){const i=n[0],s=n[1],o=n[2],a=n[3],h=n[4],c=n[5],l=n[6],u=n[7],f=n[8];return e[0]=h*f-c*u,e[1]=o*u-s*f,e[2]=s*c-o*h,e[3]=c*l-a*f,e[4]=i*f-o*l,e[5]=o*a-i*c,e[6]=a*u-h*l,e[7]=s*l-i*u,e[8]=i*h-s*a,e}static determinant(e){const n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],h=e[5],c=e[6],l=e[7],u=e[8];return n*(u*a-h*l)+i*(-u*o+h*c)+s*(l*o-a*c)}static add(e,n,i){return e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e[3]=n[3]+i[3],e[4]=n[4]+i[4],e[5]=n[5]+i[5],e[6]=n[6]+i[6],e[7]=n[7]+i[7],e[8]=n[8]+i[8],e}static subtract(e,n,i){return e[0]=n[0]-i[0],e[1]=n[1]-i[1],e[2]=n[2]-i[2],e[3]=n[3]-i[3],e[4]=n[4]-i[4],e[5]=n[5]-i[5],e[6]=n[6]-i[6],e[7]=n[7]-i[7],e[8]=n[8]-i[8],e}static sub(e,n,i){return e}static multiply(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3],c=n[4],l=n[5],u=n[6],f=n[7],d=n[8];let p=i[0],y=i[1],x=i[2];return e[0]=p*s+y*h+x*u,e[1]=p*o+y*c+x*f,e[2]=p*a+y*l+x*d,p=i[3],y=i[4],x=i[5],e[3]=p*s+y*h+x*u,e[4]=p*o+y*c+x*f,e[5]=p*a+y*l+x*d,p=i[6],y=i[7],x=i[8],e[6]=p*s+y*h+x*u,e[7]=p*o+y*c+x*f,e[8]=p*a+y*l+x*d,e}static mul(e,n,i){return e}static translate(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3],c=n[4],l=n[5],u=n[6],f=n[7],d=n[8],p=i[0],y=i[1];return e[0]=s,e[1]=o,e[2]=a,e[3]=h,e[4]=c,e[5]=l,e[6]=p*s+y*h+u,e[7]=p*o+y*c+f,e[8]=p*a+y*l+d,e}static rotate(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3],c=n[4],l=n[5],u=n[6],f=n[7],d=n[8],p=Math.sin(i),y=Math.cos(i);return e[0]=y*s+p*h,e[1]=y*o+p*c,e[2]=y*a+p*l,e[3]=y*h-p*s,e[4]=y*c-p*o,e[5]=y*l-p*a,e[6]=u,e[7]=f,e[8]=d,e}static scale(e,n,i){const s=i[0],o=i[1];return e[0]=s*n[0],e[1]=s*n[1],e[2]=s*n[2],e[3]=o*n[3],e[4]=o*n[4],e[5]=o*n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e}static fromTranslation(e,n){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=n[0],e[7]=n[1],e[8]=1,e}static fromRotation(e,n){const i=Math.sin(n),s=Math.cos(n);return e[0]=s,e[1]=i,e[2]=0,e[3]=-i,e[4]=s,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}static fromScaling(e,n){return e[0]=n[0],e[1]=0,e[2]=0,e[3]=0,e[4]=n[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}static fromMat2d(e,n){return e[0]=n[0],e[1]=n[1],e[2]=0,e[3]=n[2],e[4]=n[3],e[5]=0,e[6]=n[4],e[7]=n[5],e[8]=1,e}static fromQuat(e,n){const i=n[0],s=n[1],o=n[2],a=n[3],h=i+i,c=s+s,l=o+o,u=i*h,f=s*h,d=s*c,p=o*h,y=o*c,x=o*l,m=a*h,g=a*c,w=a*l;return e[0]=1-d-x,e[3]=f-w,e[6]=p+g,e[1]=f+w,e[4]=1-u-x,e[7]=y-m,e[2]=p-g,e[5]=y+m,e[8]=1-u-d,e}static fromMat4(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[4],e[4]=n[5],e[5]=n[6],e[6]=n[8],e[7]=n[9],e[8]=n[10],e}static normalFromMat4(e,n){const i=n[0],s=n[1],o=n[2],a=n[4],h=n[5],c=n[6],l=n[8],u=n[9],f=n[10];return e[0]=h*f-c*u,e[1]=o*u-s*f,e[2]=s*c-o*h,e[3]=c*l-a*f,e[4]=i*f-o*l,e[5]=o*a-i*c,e[6]=a*u-h*l,e[7]=s*l-i*u,e[8]=i*h-s*a,e}static normalFromMat4Fast(e,n){return e}static projection(e,n,i){return e[0]=2/n,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/i,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}static frob(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]+e[3]*e[3]+e[4]*e[4]+e[5]*e[5]+e[6]*e[6]+e[7]*e[7]+e[8]*e[8])}static multiplyScalar(e,n,i){return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=n[3]*i,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=n[7]*i,e[8]=n[8]*i,e}static multiplyScalarAndAdd(e,n,i,s){return e[0]=n[0]+i[0]*s,e[1]=n[1]+i[1]*s,e[2]=n[2]+i[2]*s,e[3]=n[3]+i[3]*s,e[4]=n[4]+i[4]*s,e[5]=n[5]+i[5]*s,e[6]=n[6]+i[6]*s,e[7]=n[7]+i[7]*s,e[8]=n[8]+i[8]*s,e}static exactEquals(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]&&e[4]===n[4]&&e[5]===n[5]&&e[6]===n[6]&&e[7]===n[7]&&e[8]===n[8]}static equals(e,n){const i=e[0],s=e[1],o=e[2],a=e[3],h=e[4],c=e[5],l=e[6],u=e[7],f=e[8],d=n[0],p=n[1],y=n[2],x=n[3],m=n[4],g=n[5],w=n[6],M=n[7],S=n[8];return Math.abs(i-d)<=ht*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(s-p)<=ht*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(o-y)<=ht*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(a-x)<=ht*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(h-m)<=ht*Math.max(1,Math.abs(h),Math.abs(m))&&Math.abs(c-g)<=ht*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(l-w)<=ht*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(u-M)<=ht*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(f-S)<=ht*Math.max(1,Math.abs(f),Math.abs(S))}static str(e){return`Mat3(${e.join(", ")})`}}Zt.prototype.mul=Zt.prototype.multiply,Zt.mul=Zt.multiply,Zt.sub=Zt.subtract,Zt.normalFromMat4Fast=Zt.normalFromMat4;const J0=Zt,Q0=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class At extends Float32Array{static BYTE_LENGTH=16*Float32Array.BYTES_PER_ELEMENT;constructor(...e){switch(e.length){case 16:super(e);break;case 2:super(e[0],e[1],16);break;case 1:const n=e[0];typeof n=="number"?super([n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n]):super(n,0,16);break;default:super(Q0);break}}get str(){return At.str(this)}copy(e){return this.set(e),this}identity(){return this.set(Q0),this}multiply(e){return At.multiply(this,this,e)}mul(e){return this}transpose(){return At.transpose(this,this)}invert(){return At.invert(this,this)}translate(e){return At.translate(this,this,e)}rotate(e,n){return At.rotate(this,this,e,n)}scale(e){return At.scale(this,this,e)}rotateX(e){return At.rotateX(this,this,e)}rotateY(e){return At.rotateY(this,this,e)}rotateZ(e){return At.rotateZ(this,this,e)}perspectiveNO(e,n,i,s){return At.perspectiveNO(this,e,n,i,s)}perspectiveZO(e,n,i,s){return At.perspectiveZO(this,e,n,i,s)}orthoNO(e,n,i,s,o,a){return At.orthoNO(this,e,n,i,s,o,a)}orthoZO(e,n,i,s,o,a){return At.orthoZO(this,e,n,i,s,o,a)}static create(){return new At}static clone(e){return new At(e)}static copy(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}static fromValues(...e){return new At(...e)}static set(e,...n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}static identity(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}static transpose(e,n){if(e===n){const i=n[1],s=n[2],o=n[3],a=n[6],h=n[7],c=n[11];e[1]=n[4],e[2]=n[8],e[3]=n[12],e[4]=i,e[6]=n[9],e[7]=n[13],e[8]=s,e[9]=a,e[11]=n[14],e[12]=o,e[13]=h,e[14]=c}else e[0]=n[0],e[1]=n[4],e[2]=n[8],e[3]=n[12],e[4]=n[1],e[5]=n[5],e[6]=n[9],e[7]=n[13],e[8]=n[2],e[9]=n[6],e[10]=n[10],e[11]=n[14],e[12]=n[3],e[13]=n[7],e[14]=n[11],e[15]=n[15];return e}static invert(e,n){const i=n[0],s=n[1],o=n[2],a=n[3],h=n[4],c=n[5],l=n[6],u=n[7],f=n[8],d=n[9],p=n[10],y=n[11],x=n[12],m=n[13],g=n[14],w=n[15],M=i*c-s*h,S=i*l-o*h,E=i*u-a*h,A=s*l-o*c,I=s*u-a*c,b=o*u-a*l,v=f*m-d*x,_=f*g-p*x,z=f*w-y*x,P=d*g-p*m,k=d*w-y*m,B=p*w-y*g;let R=M*B-S*k+E*P+A*z-I*_+b*v;return R?(R=1/R,e[0]=(c*B-l*k+u*P)*R,e[1]=(o*k-s*B-a*P)*R,e[2]=(m*b-g*I+w*A)*R,e[3]=(p*I-d*b-y*A)*R,e[4]=(l*z-h*B-u*_)*R,e[5]=(i*B-o*z+a*_)*R,e[6]=(g*E-x*b-w*S)*R,e[7]=(f*b-p*E+y*S)*R,e[8]=(h*k-c*z+u*v)*R,e[9]=(s*z-i*k-a*v)*R,e[10]=(x*I-m*E+w*M)*R,e[11]=(d*E-f*I-y*M)*R,e[12]=(c*_-h*P-l*v)*R,e[13]=(i*P-s*_+o*v)*R,e[14]=(m*S-x*A-g*M)*R,e[15]=(f*A-d*S+p*M)*R,e):null}static adjoint(e,n){const i=n[0],s=n[1],o=n[2],a=n[3],h=n[4],c=n[5],l=n[6],u=n[7],f=n[8],d=n[9],p=n[10],y=n[11],x=n[12],m=n[13],g=n[14],w=n[15],M=i*c-s*h,S=i*l-o*h,E=i*u-a*h,A=s*l-o*c,I=s*u-a*c,b=o*u-a*l,v=f*m-d*x,_=f*g-p*x,z=f*w-y*x,P=d*g-p*m,k=d*w-y*m,B=p*w-y*g;return e[0]=c*B-l*k+u*P,e[1]=o*k-s*B-a*P,e[2]=m*b-g*I+w*A,e[3]=p*I-d*b-y*A,e[4]=l*z-h*B-u*_,e[5]=i*B-o*z+a*_,e[6]=g*E-x*b-w*S,e[7]=f*b-p*E+y*S,e[8]=h*k-c*z+u*v,e[9]=s*z-i*k-a*v,e[10]=x*I-m*E+w*M,e[11]=d*E-f*I-y*M,e[12]=c*_-h*P-l*v,e[13]=i*P-s*_+o*v,e[14]=m*S-x*A-g*M,e[15]=f*A-d*S+p*M,e}static determinant(e){const n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],h=e[5],c=e[6],l=e[7],u=e[8],f=e[9],d=e[10],p=e[11],y=e[12],x=e[13],m=e[14],g=e[15],w=n*h-i*a,M=n*c-s*a,S=i*c-s*h,E=u*x-f*y,A=u*m-d*y,I=f*m-d*x,b=n*I-i*A+s*E,v=a*I-h*A+c*E,_=u*S-f*M+d*w,z=y*S-x*M+m*w;return l*b-o*v+g*_-p*z}static multiply(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3],c=n[4],l=n[5],u=n[6],f=n[7],d=n[8],p=n[9],y=n[10],x=n[11],m=n[12],g=n[13],w=n[14],M=n[15];let S=i[0],E=i[1],A=i[2],I=i[3];return e[0]=S*s+E*c+A*d+I*m,e[1]=S*o+E*l+A*p+I*g,e[2]=S*a+E*u+A*y+I*w,e[3]=S*h+E*f+A*x+I*M,S=i[4],E=i[5],A=i[6],I=i[7],e[4]=S*s+E*c+A*d+I*m,e[5]=S*o+E*l+A*p+I*g,e[6]=S*a+E*u+A*y+I*w,e[7]=S*h+E*f+A*x+I*M,S=i[8],E=i[9],A=i[10],I=i[11],e[8]=S*s+E*c+A*d+I*m,e[9]=S*o+E*l+A*p+I*g,e[10]=S*a+E*u+A*y+I*w,e[11]=S*h+E*f+A*x+I*M,S=i[12],E=i[13],A=i[14],I=i[15],e[12]=S*s+E*c+A*d+I*m,e[13]=S*o+E*l+A*p+I*g,e[14]=S*a+E*u+A*y+I*w,e[15]=S*h+E*f+A*x+I*M,e}static mul(e,n,i){return e}static translate(e,n,i){const s=i[0],o=i[1],a=i[2];if(n===e)e[12]=n[0]*s+n[4]*o+n[8]*a+n[12],e[13]=n[1]*s+n[5]*o+n[9]*a+n[13],e[14]=n[2]*s+n[6]*o+n[10]*a+n[14],e[15]=n[3]*s+n[7]*o+n[11]*a+n[15];else{const h=n[0],c=n[1],l=n[2],u=n[3],f=n[4],d=n[5],p=n[6],y=n[7],x=n[8],m=n[9],g=n[10],w=n[11];e[0]=h,e[1]=c,e[2]=l,e[3]=u,e[4]=f,e[5]=d,e[6]=p,e[7]=y,e[8]=x,e[9]=m,e[10]=g,e[11]=w,e[12]=h*s+f*o+x*a+n[12],e[13]=c*s+d*o+m*a+n[13],e[14]=l*s+p*o+g*a+n[14],e[15]=u*s+y*o+w*a+n[15]}return e}static scale(e,n,i){const s=i[0],o=i[1],a=i[2];return e[0]=n[0]*s,e[1]=n[1]*s,e[2]=n[2]*s,e[3]=n[3]*s,e[4]=n[4]*o,e[5]=n[5]*o,e[6]=n[6]*o,e[7]=n[7]*o,e[8]=n[8]*a,e[9]=n[9]*a,e[10]=n[10]*a,e[11]=n[11]*a,e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}static rotate(e,n,i,s){let o=s[0],a=s[1],h=s[2],c=Math.sqrt(o*o+a*a+h*h);if(c<ht)return null;c=1/c,o*=c,a*=c,h*=c;const l=Math.sin(i),u=Math.cos(i),f=1-u,d=n[0],p=n[1],y=n[2],x=n[3],m=n[4],g=n[5],w=n[6],M=n[7],S=n[8],E=n[9],A=n[10],I=n[11],b=o*o*f+u,v=a*o*f+h*l,_=h*o*f-a*l,z=o*a*f-h*l,P=a*a*f+u,k=h*a*f+o*l,B=o*h*f+a*l,R=a*h*f-o*l,L=h*h*f+u;return e[0]=d*b+m*v+S*_,e[1]=p*b+g*v+E*_,e[2]=y*b+w*v+A*_,e[3]=x*b+M*v+I*_,e[4]=d*z+m*P+S*k,e[5]=p*z+g*P+E*k,e[6]=y*z+w*P+A*k,e[7]=x*z+M*P+I*k,e[8]=d*B+m*R+S*L,e[9]=p*B+g*R+E*L,e[10]=y*B+w*R+A*L,e[11]=x*B+M*R+I*L,n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e}static rotateX(e,n,i){let s=Math.sin(i),o=Math.cos(i),a=n[4],h=n[5],c=n[6],l=n[7],u=n[8],f=n[9],d=n[10],p=n[11];return n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[4]=a*o+u*s,e[5]=h*o+f*s,e[6]=c*o+d*s,e[7]=l*o+p*s,e[8]=u*o-a*s,e[9]=f*o-h*s,e[10]=d*o-c*s,e[11]=p*o-l*s,e}static rotateY(e,n,i){let s=Math.sin(i),o=Math.cos(i),a=n[0],h=n[1],c=n[2],l=n[3],u=n[8],f=n[9],d=n[10],p=n[11];return n!==e&&(e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=a*o-u*s,e[1]=h*o-f*s,e[2]=c*o-d*s,e[3]=l*o-p*s,e[8]=a*s+u*o,e[9]=h*s+f*o,e[10]=c*s+d*o,e[11]=l*s+p*o,e}static rotateZ(e,n,i){let s=Math.sin(i),o=Math.cos(i),a=n[0],h=n[1],c=n[2],l=n[3],u=n[4],f=n[5],d=n[6],p=n[7];return n!==e&&(e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=a*o+u*s,e[1]=h*o+f*s,e[2]=c*o+d*s,e[3]=l*o+p*s,e[4]=u*o-a*s,e[5]=f*o-h*s,e[6]=d*o-c*s,e[7]=p*o-l*s,e}static fromTranslation(e,n){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}static fromScaling(e,n){return e[0]=n[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=n[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}static fromRotation(e,n,i){let s=i[0],o=i[1],a=i[2],h=Math.sqrt(s*s+o*o+a*a);if(h<ht)return null;h=1/h,s*=h,o*=h,a*=h;const c=Math.sin(n),l=Math.cos(n),u=1-l;return e[0]=s*s*u+l,e[1]=o*s*u+a*c,e[2]=a*s*u-o*c,e[3]=0,e[4]=s*o*u-a*c,e[5]=o*o*u+l,e[6]=a*o*u+s*c,e[7]=0,e[8]=s*a*u+o*c,e[9]=o*a*u-s*c,e[10]=a*a*u+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}static fromXRotation(e,n){let i=Math.sin(n),s=Math.cos(n);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=i,e[7]=0,e[8]=0,e[9]=-i,e[10]=s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}static fromYRotation(e,n){let i=Math.sin(n),s=Math.cos(n);return e[0]=s,e[1]=0,e[2]=-i,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=i,e[9]=0,e[10]=s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}static fromZRotation(e,n){const i=Math.sin(n),s=Math.cos(n);return e[0]=s,e[1]=i,e[2]=0,e[3]=0,e[4]=-i,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}static fromRotationTranslation(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3],c=s+s,l=o+o,u=a+a,f=s*c,d=s*l,p=s*u,y=o*l,x=o*u,m=a*u,g=h*c,w=h*l,M=h*u;return e[0]=1-(y+m),e[1]=d+M,e[2]=p-w,e[3]=0,e[4]=d-M,e[5]=1-(f+m),e[6]=x+g,e[7]=0,e[8]=p+w,e[9]=x-g,e[10]=1-(f+y),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}static fromQuat2(e,n){const i=-n[0],s=-n[1],o=-n[2],a=n[3],h=n[4],c=n[5],l=n[6],u=n[7];let f=i*i+s*s+o*o+a*a;return f>0?(un[0]=(h*a+u*i+c*o-l*s)*2/f,un[1]=(c*a+u*s+l*i-h*o)*2/f,un[2]=(l*a+u*o+h*s-c*i)*2/f):(un[0]=(h*a+u*i+c*o-l*s)*2,un[1]=(c*a+u*s+l*i-h*o)*2,un[2]=(l*a+u*o+h*s-c*i)*2),At.fromRotationTranslation(e,n,un),e}static normalFromMat4(e,n){const i=n[0],s=n[1],o=n[2],a=n[4],h=n[5],c=n[6],l=n[8],u=n[9],f=n[10];return e[0]=h*f-c*u,e[1]=o*u-s*f,e[2]=s*c-o*h,e[3]=0,e[4]=c*l-a*f,e[5]=i*f-o*l,e[6]=o*a-i*c,e[7]=0,e[8]=a*u-h*l,e[9]=s*l-i*u,e[10]=i*h-s*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}static normalFromMat4Fast(e,n){return e}static getTranslation(e,n){return e[0]=n[12],e[1]=n[13],e[2]=n[14],e}static getScaling(e,n){const i=n[0],s=n[1],o=n[2],a=n[4],h=n[5],c=n[6],l=n[8],u=n[9],f=n[10];return e[0]=Math.sqrt(i*i+s*s+o*o),e[1]=Math.sqrt(a*a+h*h+c*c),e[2]=Math.sqrt(l*l+u*u+f*f),e}static getRotation(e,n){At.getScaling(un,n);const i=1/un[0],s=1/un[1],o=1/un[2],a=n[0]*i,h=n[1]*s,c=n[2]*o,l=n[4]*i,u=n[5]*s,f=n[6]*o,d=n[8]*i,p=n[9]*s,y=n[10]*o,x=a+u+y;let m=0;return x>0?(m=Math.sqrt(x+1)*2,e[3]=.25*m,e[0]=(f-p)/m,e[1]=(d-c)/m,e[2]=(h-l)/m):a>u&&a>y?(m=Math.sqrt(1+a-u-y)*2,e[3]=(f-p)/m,e[0]=.25*m,e[1]=(h+l)/m,e[2]=(d+c)/m):u>y?(m=Math.sqrt(1+u-a-y)*2,e[3]=(d-c)/m,e[0]=(h+l)/m,e[1]=.25*m,e[2]=(f+p)/m):(m=Math.sqrt(1+y-a-u)*2,e[3]=(h-l)/m,e[0]=(d+c)/m,e[1]=(f+p)/m,e[2]=.25*m),e}static decompose(e,n,i,s){n[0]=s[12],n[1]=s[13],n[2]=s[14];const o=s[0],a=s[1],h=s[2],c=s[4],l=s[5],u=s[6],f=s[8],d=s[9],p=s[10];i[0]=Math.sqrt(o*o+a*a+h*h),i[1]=Math.sqrt(c*c+l*l+u*u),i[2]=Math.sqrt(f*f+d*d+p*p);const y=1/i[0],x=1/i[1],m=1/i[2],g=o*y,w=a*x,M=h*m,S=c*y,E=l*x,A=u*m,I=f*y,b=d*x,v=p*m,_=g+E+v;let z=0;return _>0?(z=Math.sqrt(_+1)*2,e[3]=.25*z,e[0]=(A-b)/z,e[1]=(I-M)/z,e[2]=(w-S)/z):g>E&&g>v?(z=Math.sqrt(1+g-E-v)*2,e[3]=(A-b)/z,e[0]=.25*z,e[1]=(w+S)/z,e[2]=(I+M)/z):E>v?(z=Math.sqrt(1+E-g-v)*2,e[3]=(I-M)/z,e[0]=(w+S)/z,e[1]=.25*z,e[2]=(A+b)/z):(z=Math.sqrt(1+v-g-E)*2,e[3]=(w-S)/z,e[0]=(I+M)/z,e[1]=(A+b)/z,e[2]=.25*z),e}static fromRotationTranslationScale(e,n,i,s){const o=n[0],a=n[1],h=n[2],c=n[3],l=o+o,u=a+a,f=h+h,d=o*l,p=o*u,y=o*f,x=a*u,m=a*f,g=h*f,w=c*l,M=c*u,S=c*f,E=s[0],A=s[1],I=s[2];return e[0]=(1-(x+g))*E,e[1]=(p+S)*E,e[2]=(y-M)*E,e[3]=0,e[4]=(p-S)*A,e[5]=(1-(d+g))*A,e[6]=(m+w)*A,e[7]=0,e[8]=(y+M)*I,e[9]=(m-w)*I,e[10]=(1-(d+x))*I,e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}static fromRotationTranslationScaleOrigin(e,n,i,s,o){const a=n[0],h=n[1],c=n[2],l=n[3],u=a+a,f=h+h,d=c+c,p=a*u,y=a*f,x=a*d,m=h*f,g=h*d,w=c*d,M=l*u,S=l*f,E=l*d,A=s[0],I=s[1],b=s[2],v=o[0],_=o[1],z=o[2],P=(1-(m+w))*A,k=(y+E)*A,B=(x-S)*A,R=(y-E)*I,L=(1-(p+w))*I,N=(g+M)*I,q=(x+S)*b,U=(g-M)*b,J=(1-(p+m))*b;return e[0]=P,e[1]=k,e[2]=B,e[3]=0,e[4]=R,e[5]=L,e[6]=N,e[7]=0,e[8]=q,e[9]=U,e[10]=J,e[11]=0,e[12]=i[0]+v-(P*v+R*_+q*z),e[13]=i[1]+_-(k*v+L*_+U*z),e[14]=i[2]+z-(B*v+N*_+J*z),e[15]=1,e}static fromQuat(e,n){const i=n[0],s=n[1],o=n[2],a=n[3],h=i+i,c=s+s,l=o+o,u=i*h,f=s*h,d=s*c,p=o*h,y=o*c,x=o*l,m=a*h,g=a*c,w=a*l;return e[0]=1-d-x,e[1]=f+w,e[2]=p-g,e[3]=0,e[4]=f-w,e[5]=1-u-x,e[6]=y+m,e[7]=0,e[8]=p+g,e[9]=y-m,e[10]=1-u-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}static frustumNO(e,n,i,s,o,a,h=1/0){const c=1/(i-n),l=1/(o-s);if(e[0]=a*2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a*2*l,e[6]=0,e[7]=0,e[8]=(i+n)*c,e[9]=(o+s)*l,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,h!=null&&h!==1/0){const u=1/(a-h);e[10]=(h+a)*u,e[14]=2*h*a*u}else e[10]=-1,e[14]=-2*a;return e}static frustum(e,n,i,s,o,a,h=1/0){return e}static frustumZO(e,n,i,s,o,a,h=1/0){const c=1/(i-n),l=1/(o-s);if(e[0]=a*2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a*2*l,e[6]=0,e[7]=0,e[8]=(i+n)*c,e[9]=(o+s)*l,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,h!=null&&h!==1/0){const u=1/(a-h);e[10]=h*u,e[14]=h*a*u}else e[10]=-1,e[14]=-a;return e}static perspectiveNO(e,n,i,s,o=1/0){const a=1/Math.tan(n/2);if(e[0]=a/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,o!=null&&o!==1/0){const h=1/(s-o);e[10]=(o+s)*h,e[14]=2*o*s*h}else e[10]=-1,e[14]=-2*s;return e}static perspective(e,n,i,s,o=1/0){return e}static perspectiveZO(e,n,i,s,o=1/0){const a=1/Math.tan(n/2);if(e[0]=a/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,o!=null&&o!==1/0){const h=1/(s-o);e[10]=o*h,e[14]=o*s*h}else e[10]=-1,e[14]=-s;return e}static perspectiveFromFieldOfView(e,n,i,s){const o=Math.tan(n.upDegrees*Math.PI/180),a=Math.tan(n.downDegrees*Math.PI/180),h=Math.tan(n.leftDegrees*Math.PI/180),c=Math.tan(n.rightDegrees*Math.PI/180),l=2/(h+c),u=2/(o+a);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-((h-c)*l*.5),e[9]=(o-a)*u*.5,e[10]=s/(i-s),e[11]=-1,e[12]=0,e[13]=0,e[14]=s*i/(i-s),e[15]=0,e}static orthoNO(e,n,i,s,o,a,h){const c=1/(n-i),l=1/(s-o),u=1/(a-h);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(n+i)*c,e[13]=(o+s)*l,e[14]=(h+a)*u,e[15]=1,e}static ortho(e,n,i,s,o,a,h){return e}static orthoZO(e,n,i,s,o,a,h){const c=1/(n-i),l=1/(s-o),u=1/(a-h);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=u,e[11]=0,e[12]=(n+i)*c,e[13]=(o+s)*l,e[14]=a*u,e[15]=1,e}static lookAt(e,n,i,s){const o=n[0],a=n[1],h=n[2],c=s[0],l=s[1],u=s[2],f=i[0],d=i[1],p=i[2];if(Math.abs(o-f)<ht&&Math.abs(a-d)<ht&&Math.abs(h-p)<ht)return At.identity(e);let y=o-f,x=a-d,m=h-p,g=1/Math.sqrt(y*y+x*x+m*m);y*=g,x*=g,m*=g;let w=l*m-u*x,M=u*y-c*m,S=c*x-l*y;g=Math.sqrt(w*w+M*M+S*S),g?(g=1/g,w*=g,M*=g,S*=g):(w=0,M=0,S=0);let E=x*S-m*M,A=m*w-y*S,I=y*M-x*w;return g=Math.sqrt(E*E+A*A+I*I),g?(g=1/g,E*=g,A*=g,I*=g):(E=0,A=0,I=0),e[0]=w,e[1]=E,e[2]=y,e[3]=0,e[4]=M,e[5]=A,e[6]=x,e[7]=0,e[8]=S,e[9]=I,e[10]=m,e[11]=0,e[12]=-(w*o+M*a+S*h),e[13]=-(E*o+A*a+I*h),e[14]=-(y*o+x*a+m*h),e[15]=1,e}static targetTo(e,n,i,s){const o=n[0],a=n[1],h=n[2],c=s[0],l=s[1],u=s[2];let f=o-i[0],d=a-i[1],p=h-i[2],y=f*f+d*d+p*p;y>0&&(y=1/Math.sqrt(y),f*=y,d*=y,p*=y);let x=l*p-u*d,m=u*f-c*p,g=c*d-l*f;return y=x*x+m*m+g*g,y>0&&(y=1/Math.sqrt(y),x*=y,m*=y,g*=y),e[0]=x,e[1]=m,e[2]=g,e[3]=0,e[4]=d*g-p*m,e[5]=p*x-f*g,e[6]=f*m-d*x,e[7]=0,e[8]=f,e[9]=d,e[10]=p,e[11]=0,e[12]=o,e[13]=a,e[14]=h,e[15]=1,e}static frob(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]+e[3]*e[3]+e[4]*e[4]+e[5]*e[5]+e[6]*e[6]+e[7]*e[7]+e[8]*e[8]+e[9]*e[9]+e[10]*e[10]+e[11]*e[11]+e[12]*e[12]+e[13]*e[13]+e[14]*e[14]+e[15]*e[15])}static add(e,n,i){return e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e[3]=n[3]+i[3],e[4]=n[4]+i[4],e[5]=n[5]+i[5],e[6]=n[6]+i[6],e[7]=n[7]+i[7],e[8]=n[8]+i[8],e[9]=n[9]+i[9],e[10]=n[10]+i[10],e[11]=n[11]+i[11],e[12]=n[12]+i[12],e[13]=n[13]+i[13],e[14]=n[14]+i[14],e[15]=n[15]+i[15],e}static subtract(e,n,i){return e[0]=n[0]-i[0],e[1]=n[1]-i[1],e[2]=n[2]-i[2],e[3]=n[3]-i[3],e[4]=n[4]-i[4],e[5]=n[5]-i[5],e[6]=n[6]-i[6],e[7]=n[7]-i[7],e[8]=n[8]-i[8],e[9]=n[9]-i[9],e[10]=n[10]-i[10],e[11]=n[11]-i[11],e[12]=n[12]-i[12],e[13]=n[13]-i[13],e[14]=n[14]-i[14],e[15]=n[15]-i[15],e}static sub(e,n,i){return e}static multiplyScalar(e,n,i){return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=n[3]*i,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=n[7]*i,e[8]=n[8]*i,e[9]=n[9]*i,e[10]=n[10]*i,e[11]=n[11]*i,e[12]=n[12]*i,e[13]=n[13]*i,e[14]=n[14]*i,e[15]=n[15]*i,e}static multiplyScalarAndAdd(e,n,i,s){return e[0]=n[0]+i[0]*s,e[1]=n[1]+i[1]*s,e[2]=n[2]+i[2]*s,e[3]=n[3]+i[3]*s,e[4]=n[4]+i[4]*s,e[5]=n[5]+i[5]*s,e[6]=n[6]+i[6]*s,e[7]=n[7]+i[7]*s,e[8]=n[8]+i[8]*s,e[9]=n[9]+i[9]*s,e[10]=n[10]+i[10]*s,e[11]=n[11]+i[11]*s,e[12]=n[12]+i[12]*s,e[13]=n[13]+i[13]*s,e[14]=n[14]+i[14]*s,e[15]=n[15]+i[15]*s,e}static exactEquals(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]&&e[4]===n[4]&&e[5]===n[5]&&e[6]===n[6]&&e[7]===n[7]&&e[8]===n[8]&&e[9]===n[9]&&e[10]===n[10]&&e[11]===n[11]&&e[12]===n[12]&&e[13]===n[13]&&e[14]===n[14]&&e[15]===n[15]}static equals(e,n){const i=e[0],s=e[1],o=e[2],a=e[3],h=e[4],c=e[5],l=e[6],u=e[7],f=e[8],d=e[9],p=e[10],y=e[11],x=e[12],m=e[13],g=e[14],w=e[15],M=n[0],S=n[1],E=n[2],A=n[3],I=n[4],b=n[5],v=n[6],_=n[7],z=n[8],P=n[9],k=n[10],B=n[11],R=n[12],L=n[13],N=n[14],q=n[15];return Math.abs(i-M)<=ht*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(s-S)<=ht*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(o-E)<=ht*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(a-A)<=ht*Math.max(1,Math.abs(a),Math.abs(A))&&Math.abs(h-I)<=ht*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(c-b)<=ht*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(l-v)<=ht*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(u-_)<=ht*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(f-z)<=ht*Math.max(1,Math.abs(f),Math.abs(z))&&Math.abs(d-P)<=ht*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(p-k)<=ht*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(y-B)<=ht*Math.max(1,Math.abs(y),Math.abs(B))&&Math.abs(x-R)<=ht*Math.max(1,Math.abs(x),Math.abs(R))&&Math.abs(m-L)<=ht*Math.max(1,Math.abs(m),Math.abs(L))&&Math.abs(g-N)<=ht*Math.max(1,Math.abs(g),Math.abs(N))&&Math.abs(w-q)<=ht*Math.max(1,Math.abs(w),Math.abs(q))}static str(e){return`Mat4(${e.join(", ")})`}}const un=new Float32Array(3);At.prototype.mul=At.prototype.multiply,At.sub=At.subtract,At.mul=At.multiply,At.frustum=At.frustumNO,At.perspective=At.perspectiveNO,At.ortho=At.orthoNO,At.normalFromMat4Fast=At.normalFromMat4;const K0=At;class xt extends Float32Array{static BYTE_LENGTH=3*Float32Array.BYTES_PER_ELEMENT;constructor(...e){switch(e.length){case 3:super(e);break;case 2:super(e[0],e[1],3);break;case 1:{const n=e[0];typeof n=="number"?super([n,n,n]):super(n,0,3);break}default:super(3);break}}get x(){return this[0]}set x(e){this[0]=e}get y(){return this[1]}set y(e){this[1]=e}get z(){return this[2]}set z(e){this[2]=e}get r(){return this[0]}set r(e){this[0]=e}get g(){return this[1]}set g(e){this[1]=e}get b(){return this[2]}set b(e){this[2]=e}get magnitude(){const e=this[0],n=this[1],i=this[2];return Math.sqrt(e*e+n*n+i*i)}get mag(){return this.magnitude}get squaredMagnitude(){const e=this[0],n=this[1],i=this[2];return e*e+n*n+i*i}get sqrMag(){return this.squaredMagnitude}get str(){return xt.str(this)}copy(e){return this.set(e),this}add(e){return this[0]+=e[0],this[1]+=e[1],this[2]+=e[2],this}subtract(e){return this[0]-=e[0],this[1]-=e[1],this[2]-=e[2],this}sub(e){return this}multiply(e){return this[0]*=e[0],this[1]*=e[1],this[2]*=e[2],this}mul(e){return this}divide(e){return this[0]/=e[0],this[1]/=e[1],this[2]/=e[2],this}div(e){return this}scale(e){return this[0]*=e,this[1]*=e,this[2]*=e,this}scaleAndAdd(e,n){return this[0]+=e[0]*n,this[1]+=e[1]*n,this[2]+=e[2]*n,this}distance(e){return xt.distance(this,e)}dist(e){return 0}squaredDistance(e){return xt.squaredDistance(this,e)}sqrDist(e){return 0}negate(){return this[0]*=-1,this[1]*=-1,this[2]*=-1,this}invert(){return this[0]=1/this[0],this[1]=1/this[1],this[2]=1/this[2],this}abs(){return this[0]=Math.abs(this[0]),this[1]=Math.abs(this[1]),this[2]=Math.abs(this[2]),this}dot(e){return this[0]*e[0]+this[1]*e[1]+this[2]*e[2]}normalize(){return xt.normalize(this,this)}static create(){return new xt}static clone(e){return new xt(e)}static magnitude(e){let n=e[0],i=e[1],s=e[2];return Math.sqrt(n*n+i*i+s*s)}static mag(e){return 0}static length(e){return 0}static len(e){return 0}static fromValues(e,n,i){return new xt(e,n,i)}static copy(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}static set(e,n,i,s){return e[0]=n,e[1]=i,e[2]=s,e}static add(e,n,i){return e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e}static subtract(e,n,i){return e[0]=n[0]-i[0],e[1]=n[1]-i[1],e[2]=n[2]-i[2],e}static sub(e,n,i){return[0,0,0]}static multiply(e,n,i){return e[0]=n[0]*i[0],e[1]=n[1]*i[1],e[2]=n[2]*i[2],e}static mul(e,n,i){return[0,0,0]}static divide(e,n,i){return e[0]=n[0]/i[0],e[1]=n[1]/i[1],e[2]=n[2]/i[2],e}static div(e,n,i){return[0,0,0]}static ceil(e,n){return e[0]=Math.ceil(n[0]),e[1]=Math.ceil(n[1]),e[2]=Math.ceil(n[2]),e}static floor(e,n){return e[0]=Math.floor(n[0]),e[1]=Math.floor(n[1]),e[2]=Math.floor(n[2]),e}static min(e,n,i){return e[0]=Math.min(n[0],i[0]),e[1]=Math.min(n[1],i[1]),e[2]=Math.min(n[2],i[2]),e}static max(e,n,i){return e[0]=Math.max(n[0],i[0]),e[1]=Math.max(n[1],i[1]),e[2]=Math.max(n[2],i[2]),e}static scale(e,n,i){return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e}static scaleAndAdd(e,n,i,s){return e[0]=n[0]+i[0]*s,e[1]=n[1]+i[1]*s,e[2]=n[2]+i[2]*s,e}static distance(e,n){const i=n[0]-e[0],s=n[1]-e[1],o=n[2]-e[2];return Math.sqrt(i*i+s*s+o*o)}static dist(e,n){return 0}static squaredDistance(e,n){const i=n[0]-e[0],s=n[1]-e[1],o=n[2]-e[2];return i*i+s*s+o*o}static sqrDist(e,n){return 0}static squaredLength(e){const n=e[0],i=e[1],s=e[2];return n*n+i*i+s*s}static sqrLen(e,n){return 0}static negate(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e}static inverse(e,n){return e[0]=1/n[0],e[1]=1/n[1],e[2]=1/n[2],e}static abs(e,n){return e[0]=Math.abs(n[0]),e[1]=Math.abs(n[1]),e[2]=Math.abs(n[2]),e}static normalize(e,n){const i=n[0],s=n[1],o=n[2];let a=i*i+s*s+o*o;return a>0&&(a=1/Math.sqrt(a)),e[0]=n[0]*a,e[1]=n[1]*a,e[2]=n[2]*a,e}static dot(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}static cross(e,n,i){const s=n[0],o=n[1],a=n[2],h=i[0],c=i[1],l=i[2];return e[0]=o*l-a*c,e[1]=a*h-s*l,e[2]=s*c-o*h,e}static lerp(e,n,i,s){const o=n[0],a=n[1],h=n[2];return e[0]=o+s*(i[0]-o),e[1]=a+s*(i[1]-a),e[2]=h+s*(i[2]-h),e}static slerp(e,n,i,s){const o=Math.acos(Math.min(Math.max(xt.dot(n,i),-1),1)),a=Math.sin(o),h=Math.sin((1-s)*o)/a,c=Math.sin(s*o)/a;return e[0]=h*n[0]+c*i[0],e[1]=h*n[1]+c*i[1],e[2]=h*n[2]+c*i[2],e}static hermite(e,n,i,s,o,a){const h=a*a,c=h*(2*a-3)+1,l=h*(a-2)+a,u=h*(a-1),f=h*(3-2*a);return e[0]=n[0]*c+i[0]*l+s[0]*u+o[0]*f,e[1]=n[1]*c+i[1]*l+s[1]*u+o[1]*f,e[2]=n[2]*c+i[2]*l+s[2]*u+o[2]*f,e}static bezier(e,n,i,s,o,a){const h=1-a,c=h*h,l=a*a,u=c*h,f=3*a*c,d=3*l*h,p=l*a;return e[0]=n[0]*u+i[0]*f+s[0]*d+o[0]*p,e[1]=n[1]*u+i[1]*f+s[1]*d+o[1]*p,e[2]=n[2]*u+i[2]*f+s[2]*d+o[2]*p,e}static transformMat4(e,n,i){const s=n[0],o=n[1],a=n[2],h=i[3]*s+i[7]*o+i[11]*a+i[15]||1;return e[0]=(i[0]*s+i[4]*o+i[8]*a+i[12])/h,e[1]=(i[1]*s+i[5]*o+i[9]*a+i[13])/h,e[2]=(i[2]*s+i[6]*o+i[10]*a+i[14])/h,e}static transformMat3(e,n,i){let s=n[0],o=n[1],a=n[2];return e[0]=s*i[0]+o*i[3]+a*i[6],e[1]=s*i[1]+o*i[4]+a*i[7],e[2]=s*i[2]+o*i[5]+a*i[8],e}static transformQuat(e,n,i){const s=i[0],o=i[1],a=i[2],h=i[3]*2,c=n[0],l=n[1],u=n[2],f=o*u-a*l,d=a*c-s*u,p=s*l-o*c,y=(o*p-a*d)*2,x=(a*f-s*p)*2,m=(s*d-o*f)*2;return e[0]=c+f*h+y,e[1]=l+d*h+x,e[2]=u+p*h+m,e}static rotateX(e,n,i,s){const o=i[1],a=i[2],h=n[1]-o,c=n[2]-a;return e[0]=n[0],e[1]=h*Math.cos(s)-c*Math.sin(s)+o,e[2]=h*Math.sin(s)+c*Math.cos(s)+a,e}static rotateY(e,n,i,s){const o=i[0],a=i[2],h=n[0]-o,c=n[2]-a;return e[0]=c*Math.sin(s)+h*Math.cos(s)+o,e[1]=n[1],e[2]=c*Math.cos(s)-h*Math.sin(s)+a,e}static rotateZ(e,n,i,s){const o=i[0],a=i[1],h=n[0]-o,c=n[1]-a;return e[0]=h*Math.cos(s)-c*Math.sin(s)+o,e[1]=h*Math.sin(s)+c*Math.cos(s)+a,e[2]=i[2],e}static angle(e,n){const i=e[0],s=e[1],o=e[2],a=n[0],h=n[1],c=n[2],l=Math.sqrt((i*i+s*s+o*o)*(a*a+h*h+c*c)),u=l&&xt.dot(e,n)/l;return Math.acos(Math.min(Math.max(u,-1),1))}static zero(e){return e[0]=0,e[1]=0,e[2]=0,e}static str(e){return`Vec3(${e.join(", ")})`}static exactEquals(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}static equals(e,n){const i=e[0],s=e[1],o=e[2],a=n[0],h=n[1],c=n[2];return Math.abs(i-a)<=ht*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(s-h)<=ht*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(o-c)<=ht*Math.max(1,Math.abs(o),Math.abs(c))}}xt.prototype.sub=xt.prototype.subtract,xt.prototype.mul=xt.prototype.multiply,xt.prototype.div=xt.prototype.divide,xt.prototype.dist=xt.prototype.distance,xt.prototype.sqrDist=xt.prototype.squaredDistance,xt.sub=xt.subtract,xt.mul=xt.multiply,xt.div=xt.divide,xt.dist=xt.distance,xt.sqrDist=xt.squaredDistance,xt.sqrLen=xt.squaredLength,xt.mag=xt.magnitude,xt.length=xt.magnitude,xt.len=xt.magnitude;const Yn=xt;class yt extends Float32Array{static BYTE_LENGTH=4*Float32Array.BYTES_PER_ELEMENT;constructor(...e){switch(e.length){case 4:super(e);break;case 2:super(e[0],e[1],4);break;case 1:{const n=e[0];typeof n=="number"?super([n,n,n,n]):super(n,0,4);break}default:super(4);break}}get x(){return this[0]}set x(e){this[0]=e}get y(){return this[1]}set y(e){this[1]=e}get z(){return this[2]}set z(e){this[2]=e}get w(){return this[3]}set w(e){this[3]=e}get r(){return this[0]}set r(e){this[0]=e}get g(){return this[1]}set g(e){this[1]=e}get b(){return this[2]}set b(e){this[2]=e}get a(){return this[3]}set a(e){this[3]=e}get magnitude(){const e=this[0],n=this[1],i=this[2],s=this[3];return Math.sqrt(e*e+n*n+i*i+s*s)}get mag(){return this.magnitude}get str(){return yt.str(this)}copy(e){return super.set(e),this}add(e){return this[0]+=e[0],this[1]+=e[1],this[2]+=e[2],this[3]+=e[3],this}subtract(e){return this[0]-=e[0],this[1]-=e[1],this[2]-=e[2],this[3]-=e[3],this}sub(e){return this}multiply(e){return this[0]*=e[0],this[1]*=e[1],this[2]*=e[2],this[3]*=e[3],this}mul(e){return this}divide(e){return this[0]/=e[0],this[1]/=e[1],this[2]/=e[2],this[3]/=e[3],this}div(e){return this}scale(e){return this[0]*=e,this[1]*=e,this[2]*=e,this[3]*=e,this}scaleAndAdd(e,n){return this[0]+=e[0]*n,this[1]+=e[1]*n,this[2]+=e[2]*n,this[3]+=e[3]*n,this}distance(e){return yt.distance(this,e)}dist(e){return 0}squaredDistance(e){return yt.squaredDistance(this,e)}sqrDist(e){return 0}negate(){return this[0]*=-1,this[1]*=-1,this[2]*=-1,this[3]*=-1,this}invert(){return this[0]=1/this[0],this[1]=1/this[1],this[2]=1/this[2],this[3]=1/this[3],this}abs(){return this[0]=Math.abs(this[0]),this[1]=Math.abs(this[1]),this[2]=Math.abs(this[2]),this[3]=Math.abs(this[3]),this}dot(e){return this[0]*e[0]+this[1]*e[1]+this[2]*e[2]+this[3]*e[3]}normalize(){return yt.normalize(this,this)}static create(){return new yt}static clone(e){return new yt(e)}static fromValues(e,n,i,s){return new yt(e,n,i,s)}static copy(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}static set(e,n,i,s,o){return e[0]=n,e[1]=i,e[2]=s,e[3]=o,e}static add(e,n,i){return e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e[3]=n[3]+i[3],e}static subtract(e,n,i){return e[0]=n[0]-i[0],e[1]=n[1]-i[1],e[2]=n[2]-i[2],e[3]=n[3]-i[3],e}static sub(e,n,i){return e}static multiply(e,n,i){return e[0]=n[0]*i[0],e[1]=n[1]*i[1],e[2]=n[2]*i[2],e[3]=n[3]*i[3],e}static mul(e,n,i){return e}static divide(e,n,i){return e[0]=n[0]/i[0],e[1]=n[1]/i[1],e[2]=n[2]/i[2],e[3]=n[3]/i[3],e}static div(e,n,i){return e}static ceil(e,n){return e[0]=Math.ceil(n[0]),e[1]=Math.ceil(n[1]),e[2]=Math.ceil(n[2]),e[3]=Math.ceil(n[3]),e}static floor(e,n){return e[0]=Math.floor(n[0]),e[1]=Math.floor(n[1]),e[2]=Math.floor(n[2]),e[3]=Math.floor(n[3]),e}static min(e,n,i){return e[0]=Math.min(n[0],i[0]),e[1]=Math.min(n[1],i[1]),e[2]=Math.min(n[2],i[2]),e[3]=Math.min(n[3],i[3]),e}static max(e,n,i){return e[0]=Math.max(n[0],i[0]),e[1]=Math.max(n[1],i[1]),e[2]=Math.max(n[2],i[2]),e[3]=Math.max(n[3],i[3]),e}static round(e,n){return e[0]=Math.round(n[0]),e[1]=Math.round(n[1]),e[2]=Math.round(n[2]),e[3]=Math.round(n[3]),e}static scale(e,n,i){return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=n[3]*i,e}static scaleAndAdd(e,n,i,s){return e[0]=n[0]+i[0]*s,e[1]=n[1]+i[1]*s,e[2]=n[2]+i[2]*s,e[3]=n[3]+i[3]*s,e}static distance(e,n){const i=n[0]-e[0],s=n[1]-e[1],o=n[2]-e[2],a=n[3]-e[3];return Math.hypot(i,s,o,a)}static dist(e,n){return 0}static squaredDistance(e,n){const i=n[0]-e[0],s=n[1]-e[1],o=n[2]-e[2],a=n[3]-e[3];return i*i+s*s+o*o+a*a}static sqrDist(e,n){return 0}static magnitude(e){const n=e[0],i=e[1],s=e[2],o=e[3];return Math.sqrt(n*n+i*i+s*s+o*o)}static mag(e){return 0}static length(e){return 0}static len(e){return 0}static squaredLength(e){const n=e[0],i=e[1],s=e[2],o=e[3];return n*n+i*i+s*s+o*o}static sqrLen(e){return 0}static negate(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e[3]=-n[3],e}static inverse(e,n){return e[0]=1/n[0],e[1]=1/n[1],e[2]=1/n[2],e[3]=1/n[3],e}static abs(e,n){return e[0]=Math.abs(n[0]),e[1]=Math.abs(n[1]),e[2]=Math.abs(n[2]),e[3]=Math.abs(n[3]),e}static normalize(e,n){const i=n[0],s=n[1],o=n[2],a=n[3];let h=i*i+s*s+o*o+a*a;return h>0&&(h=1/Math.sqrt(h)),e[0]=i*h,e[1]=s*h,e[2]=o*h,e[3]=a*h,e}static dot(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]+e[3]*n[3]}static cross(e,n,i,s){const o=i[0]*s[1]-i[1]*s[0],a=i[0]*s[2]-i[2]*s[0],h=i[0]*s[3]-i[3]*s[0],c=i[1]*s[2]-i[2]*s[1],l=i[1]*s[3]-i[3]*s[1],u=i[2]*s[3]-i[3]*s[2],f=n[0],d=n[1],p=n[2],y=n[3];return e[0]=d*u-p*l+y*c,e[1]=-(f*u)+p*h-y*a,e[2]=f*l-d*h+y*o,e[3]=-(f*c)+d*a-p*o,e}static lerp(e,n,i,s){const o=n[0],a=n[1],h=n[2],c=n[3];return e[0]=o+s*(i[0]-o),e[1]=a+s*(i[1]-a),e[2]=h+s*(i[2]-h),e[3]=c+s*(i[3]-c),e}static transformMat4(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3];return e[0]=i[0]*s+i[4]*o+i[8]*a+i[12]*h,e[1]=i[1]*s+i[5]*o+i[9]*a+i[13]*h,e[2]=i[2]*s+i[6]*o+i[10]*a+i[14]*h,e[3]=i[3]*s+i[7]*o+i[11]*a+i[15]*h,e}static transformQuat(e,n,i){const s=n[0],o=n[1],a=n[2],h=i[0],c=i[1],l=i[2],u=i[3],f=u*s+c*a-l*o,d=u*o+l*s-h*a,p=u*a+h*o-c*s,y=-h*s-c*o-l*a;return e[0]=f*u+y*-h+d*-l-p*-c,e[1]=d*u+y*-c+p*-h-f*-l,e[2]=p*u+y*-l+f*-c-d*-h,e[3]=n[3],e}static zero(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}static str(e){return`Vec4(${e.join(", ")})`}static exactEquals(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]}static equals(e,n){const i=e[0],s=e[1],o=e[2],a=e[3],h=n[0],c=n[1],l=n[2],u=n[3];return Math.abs(i-h)<=ht*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(s-c)<=ht*Math.max(1,Math.abs(s),Math.abs(c))&&Math.abs(o-l)<=ht*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(a-u)<=ht*Math.max(1,Math.abs(a),Math.abs(u))}}yt.prototype.sub=yt.prototype.subtract,yt.prototype.mul=yt.prototype.multiply,yt.prototype.div=yt.prototype.divide,yt.prototype.dist=yt.prototype.distance,yt.prototype.sqrDist=yt.prototype.squaredDistance,yt.sub=yt.subtract,yt.mul=yt.multiply,yt.div=yt.divide,yt.dist=yt.distance,yt.sqrDist=yt.squaredDistance,yt.sqrLen=yt.squaredLength,yt.mag=yt.magnitude,yt.length=yt.magnitude,yt.len=yt.magnitude;const qi=yt;class dt extends Float32Array{static BYTE_LENGTH=4*Float32Array.BYTES_PER_ELEMENT;constructor(...e){switch(e.length){case 4:super(e);break;case 2:super(e[0],e[1],4);break;case 1:{const n=e[0];typeof n=="number"?super([n,n,n,n]):super(n,0,4);break}default:super(4),this[3]=1;break}}get x(){return this[0]}set x(e){this[0]=e}get y(){return this[1]}set y(e){this[1]=e}get z(){return this[2]}set z(e){this[2]=e}get w(){return this[3]}set w(e){this[3]=e}get magnitude(){const e=this[0],n=this[1],i=this[2],s=this[3];return Math.sqrt(e*e+n*n+i*i+s*s)}get mag(){return this.magnitude}get str(){return dt.str(this)}copy(e){return super.set(e),this}identity(){return this[0]=0,this[1]=0,this[2]=0,this[3]=1,this}multiply(e){return dt.multiply(this,this,e)}mul(e){return this}rotateX(e){return dt.rotateX(this,this,e)}rotateY(e){return dt.rotateY(this,this,e)}rotateZ(e){return dt.rotateZ(this,this,e)}invert(){return dt.invert(this,this)}scale(e){return this[0]*=e,this[1]*=e,this[2]*=e,this[3]*=e,this}dot(e){return dt.dot(this,e)}static create(){return new dt}static identity(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}static setAxisAngle(e,n,i){i=i*.5;const s=Math.sin(i);return e[0]=s*n[0],e[1]=s*n[1],e[2]=s*n[2],e[3]=Math.cos(i),e}static getAxisAngle(e,n){const i=Math.acos(n[3])*2,s=Math.sin(i/2);return s>ht?(e[0]=n[0]/s,e[1]=n[1]/s,e[2]=n[2]/s):(e[0]=1,e[1]=0,e[2]=0),i}static getAngle(e,n){const i=dt.dot(e,n);return Math.acos(2*i*i-1)}static multiply(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3],c=i[0],l=i[1],u=i[2],f=i[3];return e[0]=s*f+h*c+o*u-a*l,e[1]=o*f+h*l+a*c-s*u,e[2]=a*f+h*u+s*l-o*c,e[3]=h*f-s*c-o*l-a*u,e}static rotateX(e,n,i){i*=.5;const s=n[0],o=n[1],a=n[2],h=n[3],c=Math.sin(i),l=Math.cos(i);return e[0]=s*l+h*c,e[1]=o*l+a*c,e[2]=a*l-o*c,e[3]=h*l-s*c,e}static rotateY(e,n,i){i*=.5;const s=n[0],o=n[1],a=n[2],h=n[3],c=Math.sin(i),l=Math.cos(i);return e[0]=s*l-a*c,e[1]=o*l+h*c,e[2]=a*l+s*c,e[3]=h*l-o*c,e}static rotateZ(e,n,i){i*=.5;const s=n[0],o=n[1],a=n[2],h=n[3],c=Math.sin(i),l=Math.cos(i);return e[0]=s*l+o*c,e[1]=o*l-s*c,e[2]=a*l+h*c,e[3]=h*l-a*c,e}static calculateW(e,n){const i=n[0],s=n[1],o=n[2];return e[0]=i,e[1]=s,e[2]=o,e[3]=Math.sqrt(Math.abs(1-i*i-s*s-o*o)),e}static exp(e,n){const i=n[0],s=n[1],o=n[2],a=n[3],h=Math.sqrt(i*i+s*s+o*o),c=Math.exp(a),l=h>0?c*Math.sin(h)/h:0;return e[0]=i*l,e[1]=s*l,e[2]=o*l,e[3]=c*Math.cos(h),e}static ln(e,n){const i=n[0],s=n[1],o=n[2],a=n[3],h=Math.sqrt(i*i+s*s+o*o),c=h>0?Math.atan2(h,a)/h:0;return e[0]=i*c,e[1]=s*c,e[2]=o*c,e[3]=.5*Math.log(i*i+s*s+o*o+a*a),e}static pow(e,n,i){return dt.ln(e,n),dt.scale(e,e,i),dt.exp(e,e),e}static slerp(e,n,i,s){const o=n[0],a=n[1],h=n[2],c=n[3];let l=i[0],u=i[1],f=i[2],d=i[3],p,y,x=o*l+a*u+h*f+c*d;if(x<0&&(x=-x,l=-l,u=-u,f=-f,d=-d),1-x>ht){const m=Math.acos(x),g=Math.sin(m);p=Math.sin((1-s)*m)/g,y=Math.sin(s*m)/g}else p=1-s,y=s;return e[0]=p*o+y*l,e[1]=p*a+y*u,e[2]=p*h+y*f,e[3]=p*c+y*d,e}static invert(e,n){const i=n[0],s=n[1],o=n[2],a=n[3],h=i*i+s*s+o*o+a*a,c=h?1/h:0;return e[0]=-i*c,e[1]=-s*c,e[2]=-o*c,e[3]=a*c,e}static conjugate(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e[3]=n[3],e}static fromMat3(e,n){const i=n[0]+n[4]+n[8];let s;if(i>0)s=Math.sqrt(i+1),e[3]=.5*s,s=.5/s,e[0]=(n[5]-n[7])*s,e[1]=(n[6]-n[2])*s,e[2]=(n[1]-n[3])*s;else{let o=0;n[4]>n[0]&&(o=1),n[8]>n[o*3+o]&&(o=2);let a=(o+1)%3,h=(o+2)%3;s=Math.sqrt(n[o*3+o]-n[a*3+a]-n[h*3+h]+1),e[o]=.5*s,s=.5/s,e[3]=(n[a*3+h]-n[h*3+a])*s,e[a]=(n[a*3+o]+n[o*3+a])*s,e[h]=(n[h*3+o]+n[o*3+h])*s}return e}static fromEuler(e,n,i,s,o=yw){let a=.5*Math.PI/180;n*=a,i*=a,s*=a;let h=Math.sin(n),c=Math.cos(n),l=Math.sin(i),u=Math.cos(i),f=Math.sin(s),d=Math.cos(s);switch(o){case"xyz":e[0]=h*u*d+c*l*f,e[1]=c*l*d-h*u*f,e[2]=c*u*f+h*l*d,e[3]=c*u*d-h*l*f;break;case"xzy":e[0]=h*u*d-c*l*f,e[1]=c*l*d-h*u*f,e[2]=c*u*f+h*l*d,e[3]=c*u*d+h*l*f;break;case"yxz":e[0]=h*u*d+c*l*f,e[1]=c*l*d-h*u*f,e[2]=c*u*f-h*l*d,e[3]=c*u*d+h*l*f;break;case"yzx":e[0]=h*u*d+c*l*f,e[1]=c*l*d+h*u*f,e[2]=c*u*f-h*l*d,e[3]=c*u*d-h*l*f;break;case"zxy":e[0]=h*u*d-c*l*f,e[1]=c*l*d+h*u*f,e[2]=c*u*f+h*l*d,e[3]=c*u*d-h*l*f;break;case"zyx":e[0]=h*u*d-c*l*f,e[1]=c*l*d+h*u*f,e[2]=c*u*f-h*l*d,e[3]=c*u*d+h*l*f;break;default:throw new Error("Unknown angle order "+o)}return e}static str(e){return`Quat(${e.join(", ")})`}static clone(e){return new dt(e)}static fromValues(e,n,i,s){return new dt(e,n,i,s)}static copy(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}static set(e,n,i,s,o){return e}static add(e,n,i){return e}static mul(e,n,i){return e}static scale(e,n,i){return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=n[3]*i,e}static dot(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]+e[3]*n[3]}static lerp(e,n,i,s){return e}static magnitude(e){return 0}static mag(e){return 0}static length(e){return 0}static len(e){return 0}static squaredLength(e){return 0}static sqrLen(e){return 0}static normalize(e,n){return e}static exactEquals(e,n){return!1}static equals(e,n){return!1}static rotationTo(e,n,i){let s=xt.dot(n,i);return s<-.999999?(xt.cross(In,xw,n),xt.mag(In)<1e-6&&xt.cross(In,mw,n),xt.normalize(In,In),dt.setAxisAngle(e,In,Math.PI),e):s>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(xt.cross(In,n,i),e[0]=In[0],e[1]=In[1],e[2]=In[2],e[3]=1+s,dt.normalize(e,e))}static sqlerp(e,n,i,s,o,a){return dt.slerp(td,n,o,a),dt.slerp(ed,i,s,a),dt.slerp(e,td,ed,2*a*(1-a)),e}static setAxes(e,n,i,s){return Pn[0]=i[0],Pn[3]=i[1],Pn[6]=i[2],Pn[1]=s[0],Pn[4]=s[1],Pn[7]=s[2],Pn[2]=-n[0],Pn[5]=-n[1],Pn[8]=-n[2],dt.normalize(e,dt.fromMat3(e,Pn))}}const td=new Float32Array(4),ed=new Float32Array(4),Pn=new Float32Array(9),In=new Float32Array(3),xw=new Float32Array([1,0,0]),mw=new Float32Array([0,1,0]);dt.set=yt.set,dt.add=yt.add,dt.lerp=yt.lerp,dt.normalize=yt.normalize,dt.squaredLength=yt.squaredLength,dt.sqrLen=yt.squaredLength,dt.exactEquals=yt.exactEquals,dt.equals=yt.equals,dt.magnitude=yt.magnitude,dt.prototype.mul=dt.prototype.multiply,dt.mul=dt.multiply,dt.mag=dt.magnitude,dt.length=dt.magnitude,dt.len=dt.magnitude;const gw=dt;class Gt extends Float32Array{static BYTE_LENGTH=8*Float32Array.BYTES_PER_ELEMENT;constructor(...e){switch(e.length){case 8:super(e);break;case 2:super(e[0],e[1],8);break;case 1:{const n=e[0];typeof n=="number"?super([n,n,n,n,n,n,n,n]):super(n,0,8);break}default:super(8),this[3]=1;break}}get str(){return Gt.str(this)}copy(e){return super.set(e),this}static create(){return new Gt}static clone(e){return new Gt(e)}static fromValues(e,n,i,s,o,a,h,c){return new Gt(e,n,i,s,o,a,h,c)}static fromRotationTranslationValues(e,n,i,s,o,a,h){const c=o*.5,l=a*.5,u=h*.5;return new Gt(e,n,i,s,c*s+l*i-u*n,l*s+u*e-c*i,u*s+c*n-l*e,-c*e-l*n-u*i)}static fromRotationTranslation(e,n,i){const s=i[0]*.5,o=i[1]*.5,a=i[2]*.5,h=n[0],c=n[1],l=n[2],u=n[3];return e[0]=h,e[1]=c,e[2]=l,e[3]=u,e[4]=s*u+o*l-a*c,e[5]=o*u+a*h-s*l,e[6]=a*u+s*c-o*h,e[7]=-s*h-o*c-a*l,e}static fromTranslation(e,n){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=n[0]*.5,e[5]=n[1]*.5,e[6]=n[2]*.5,e[7]=0,e}static fromRotation(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}static fromMat4(e,n){return At.getRotation(nd,n),At.getTranslation(id,n),Gt.fromRotationTranslation(e,nd,id)}static copy(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e}static identity(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}static set(e,n,i,s,o,a,h,c,l){return e[0]=n,e[1]=i,e[2]=s,e[3]=o,e[4]=a,e[5]=h,e[6]=c,e[7]=l,e}static getReal(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}static getDual(e,n){return e[0]=n[4],e[1]=n[5],e[2]=n[6],e[3]=n[7],e}static setReal(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}static setDual(e,n){return e[4]=n[0],e[5]=n[1],e[6]=n[2],e[7]=n[3],e}static getTranslation(e,n){const i=n[4],s=n[5],o=n[6],a=n[7],h=-n[0],c=-n[1],l=-n[2],u=n[3];return e[0]=(i*u+a*h+s*l-o*c)*2,e[1]=(s*u+a*c+o*h-i*l)*2,e[2]=(o*u+a*l+i*c-s*h)*2,e}static translate(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3],c=i[0]*.5,l=i[1]*.5,u=i[2]*.5,f=n[4],d=n[5],p=n[6],y=n[7];return e[0]=s,e[1]=o,e[2]=a,e[3]=h,e[4]=h*c+o*u-a*l+f,e[5]=h*l+a*c-s*u+d,e[6]=h*u+s*l-o*c+p,e[7]=-s*c-o*l-a*u+y,e}static rotateX(e,n,i){let s=-n[0],o=-n[1],a=-n[2],h=n[3];const c=n[4],l=n[5],u=n[6],f=n[7],d=c*h+f*s+l*a-u*o,p=l*h+f*o+u*s-c*a,y=u*h+f*a+c*o-l*s,x=f*h-c*s-l*o-u*a;return dt.rotateX(e,n,i),s=e[0],o=e[1],a=e[2],h=e[3],e[4]=d*h+x*s+p*a-y*o,e[5]=p*h+x*o+y*s-d*a,e[6]=y*h+x*a+d*o-p*s,e[7]=x*h-d*s-p*o-y*a,e}static rotateY(e,n,i){let s=-n[0],o=-n[1],a=-n[2],h=n[3];const c=n[4],l=n[5],u=n[6],f=n[7],d=c*h+f*s+l*a-u*o,p=l*h+f*o+u*s-c*a,y=u*h+f*a+c*o-l*s,x=f*h-c*s-l*o-u*a;return dt.rotateY(e,n,i),s=e[0],o=e[1],a=e[2],h=e[3],e[4]=d*h+x*s+p*a-y*o,e[5]=p*h+x*o+y*s-d*a,e[6]=y*h+x*a+d*o-p*s,e[7]=x*h-d*s-p*o-y*a,e}static rotateZ(e,n,i){let s=-n[0],o=-n[1],a=-n[2],h=n[3];const c=n[4],l=n[5],u=n[6],f=n[7],d=c*h+f*s+l*a-u*o,p=l*h+f*o+u*s-c*a,y=u*h+f*a+c*o-l*s,x=f*h-c*s-l*o-u*a;return dt.rotateZ(e,n,i),s=e[0],o=e[1],a=e[2],h=e[3],e[4]=d*h+x*s+p*a-y*o,e[5]=p*h+x*o+y*s-d*a,e[6]=y*h+x*a+d*o-p*s,e[7]=x*h-d*s-p*o-y*a,e}static rotateByQuatAppend(e,n,i){const s=i[0],o=i[1],a=i[2],h=i[3];let c=n[0],l=n[1],u=n[2],f=n[3];return e[0]=c*h+f*s+l*a-u*o,e[1]=l*h+f*o+u*s-c*a,e[2]=u*h+f*a+c*o-l*s,e[3]=f*h-c*s-l*o-u*a,c=n[4],l=n[5],u=n[6],f=n[7],e[4]=c*h+f*s+l*a-u*o,e[5]=l*h+f*o+u*s-c*a,e[6]=u*h+f*a+c*o-l*s,e[7]=f*h-c*s-l*o-u*a,e}static rotateByQuatPrepend(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3];let c=i[0],l=i[1],u=i[2],f=i[3];return e[0]=s*f+h*c+o*u-a*l,e[1]=o*f+h*l+a*c-s*u,e[2]=a*f+h*u+s*l-o*c,e[3]=h*f-s*c-o*l-a*u,c=i[4],l=i[5],u=i[6],f=i[7],e[4]=s*f+h*c+o*u-a*l,e[5]=o*f+h*l+a*c-s*u,e[6]=a*f+h*u+s*l-o*c,e[7]=h*f-s*c-o*l-a*u,e}static rotateAroundAxis(e,n,i,s){if(Math.abs(s)<ht)return Gt.copy(e,n);const o=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]);s=s*.5;const a=Math.sin(s),h=a*i[0]/o,c=a*i[1]/o,l=a*i[2]/o,u=Math.cos(s),f=n[0],d=n[1],p=n[2],y=n[3];e[0]=f*u+y*h+d*l-p*c,e[1]=d*u+y*c+p*h-f*l,e[2]=p*u+y*l+f*c-d*h,e[3]=y*u-f*h-d*c-p*l;const x=n[4],m=n[5],g=n[6],w=n[7];return e[4]=x*u+w*h+m*l-g*c,e[5]=m*u+w*c+g*h-x*l,e[6]=g*u+w*l+x*c-m*h,e[7]=w*u-x*h-m*c-g*l,e}static add(e,n,i){return e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e[3]=n[3]+i[3],e[4]=n[4]+i[4],e[5]=n[5]+i[5],e[6]=n[6]+i[6],e[7]=n[7]+i[7],e}static multiply(e,n,i){const s=n[0],o=n[1],a=n[2],h=n[3],c=i[4],l=i[5],u=i[6],f=i[7],d=n[4],p=n[5],y=n[6],x=n[7],m=i[0],g=i[1],w=i[2],M=i[3];return e[0]=s*M+h*m+o*w-a*g,e[1]=o*M+h*g+a*m-s*w,e[2]=a*M+h*w+s*g-o*m,e[3]=h*M-s*m-o*g-a*w,e[4]=s*f+h*c+o*u-a*l+d*M+x*m+p*w-y*g,e[5]=o*f+h*l+a*c-s*u+p*M+x*g+y*m-d*w,e[6]=a*f+h*u+s*l-o*c+y*M+x*w+d*g-p*m,e[7]=h*f-s*c-o*l-a*u+x*M-d*m-p*g-y*w,e}static mul(e,n,i){return e}static scale(e,n,i){return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=n[3]*i,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=n[7]*i,e}static dot(e,n){return 0}static lerp(e,n,i,s){const o=1-s;return Gt.dot(n,i)<0&&(s=-s),e[0]=n[0]*o+i[0]*s,e[1]=n[1]*o+i[1]*s,e[2]=n[2]*o+i[2]*s,e[3]=n[3]*o+i[3]*s,e[4]=n[4]*o+i[4]*s,e[5]=n[5]*o+i[5]*s,e[6]=n[6]*o+i[6]*s,e[7]=n[7]*o+i[7]*s,e}static invert(e,n){const i=Gt.squaredLength(n);return e[0]=-n[0]/i,e[1]=-n[1]/i,e[2]=-n[2]/i,e[3]=n[3]/i,e[4]=-n[4]/i,e[5]=-n[5]/i,e[6]=-n[6]/i,e[7]=n[7]/i,e}static conjugate(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e[3]=n[3],e[4]=-n[4],e[5]=-n[5],e[6]=-n[6],e[7]=n[7],e}static magnitude(e){return 0}static mag(e){return 0}static length(e){return 0}static len(e){return 0}static squaredLength(e){return 0}static sqrLen(e){return 0}static normalize(e,n){let i=Gt.squaredLength(n);if(i>0){i=Math.sqrt(i);const s=n[0]/i,o=n[1]/i,a=n[2]/i,h=n[3]/i,c=n[4],l=n[5],u=n[6],f=n[7],d=s*c+o*l+a*u+h*f;e[0]=s,e[1]=o,e[2]=a,e[3]=h,e[4]=(c-s*d)/i,e[5]=(l-o*d)/i,e[6]=(u-a*d)/i,e[7]=(f-h*d)/i}return e}static str(e){return`Quat2(${e.join(", ")})`}static exactEquals(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]&&e[4]===n[4]&&e[5]===n[5]&&e[6]===n[6]&&e[7]===n[7]}static equals(e,n){const i=e[0],s=e[1],o=e[2],a=e[3],h=e[4],c=e[5],l=e[6],u=e[7],f=n[0],d=n[1],p=n[2],y=n[3],x=n[4],m=n[5],g=n[6],w=n[7];return Math.abs(i-f)<=ht*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(s-d)<=ht*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(o-p)<=ht*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-y)<=ht*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(h-x)<=ht*Math.max(1,Math.abs(h),Math.abs(x))&&Math.abs(c-m)<=ht*Math.max(1,Math.abs(c),Math.abs(m))&&Math.abs(l-g)<=ht*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(u-w)<=ht*Math.max(1,Math.abs(u),Math.abs(w))}}const nd=new Float32Array(4),id=new Float32Array(3);Gt.dot=dt.dot,Gt.squaredLength=dt.squaredLength,Gt.sqrLen=dt.squaredLength,Gt.mag=dt.magnitude,Gt.length=dt.magnitude,Gt.len=dt.magnitude,Gt.mul=Gt.multiply;const ww=Gt;class Et extends Float32Array{static BYTE_LENGTH=2*Float32Array.BYTES_PER_ELEMENT;constructor(...e){switch(e.length){case 2:{const n=e[0];typeof n=="number"?super([n,e[1]]):super(n,e[1],2);break}case 1:{const n=e[0];typeof n=="number"?super([n,n]):super(n,0,2);break}default:super(2);break}}get x(){return this[0]}set x(e){this[0]=e}get y(){return this[1]}set y(e){this[1]=e}get r(){return this[0]}set r(e){this[0]=e}get g(){return this[1]}set g(e){this[1]=e}get magnitude(){return Math.hypot(this[0],this[1])}get mag(){return this.magnitude}get squaredMagnitude(){const e=this[0],n=this[1];return e*e+n*n}get sqrMag(){return this.squaredMagnitude}get str(){return Et.str(this)}copy(e){return this.set(e),this}add(e){return this[0]+=e[0],this[1]+=e[1],this}subtract(e){return this[0]-=e[0],this[1]-=e[1],this}sub(e){return this}multiply(e){return this[0]*=e[0],this[1]*=e[1],this}mul(e){return this}divide(e){return this[0]/=e[0],this[1]/=e[1],this}div(e){return this}scale(e){return this[0]*=e,this[1]*=e,this}scaleAndAdd(e,n){return this[0]+=e[0]*n,this[1]+=e[1]*n,this}distance(e){return Et.distance(this,e)}dist(e){return 0}squaredDistance(e){return Et.squaredDistance(this,e)}sqrDist(e){return 0}negate(){return this[0]*=-1,this[1]*=-1,this}invert(){return this[0]=1/this[0],this[1]=1/this[1],this}abs(){return this[0]=Math.abs(this[0]),this[1]=Math.abs(this[1]),this}dot(e){return this[0]*e[0]+this[1]*e[1]}normalize(){return Et.normalize(this,this)}static create(){return new Et}static clone(e){return new Et(e)}static fromValues(e,n){return new Et(e,n)}static copy(e,n){return e[0]=n[0],e[1]=n[1],e}static set(e,n,i){return e[0]=n,e[1]=i,e}static add(e,n,i){return e[0]=n[0]+i[0],e[1]=n[1]+i[1],e}static subtract(e,n,i){return e[0]=n[0]-i[0],e[1]=n[1]-i[1],e}static sub(e,n,i){return[0,0]}static multiply(e,n,i){return e[0]=n[0]*i[0],e[1]=n[1]*i[1],e}static mul(e,n,i){return[0,0]}static divide(e,n,i){return e[0]=n[0]/i[0],e[1]=n[1]/i[1],e}static div(e,n,i){return[0,0]}static ceil(e,n){return e[0]=Math.ceil(n[0]),e[1]=Math.ceil(n[1]),e}static floor(e,n){return e[0]=Math.floor(n[0]),e[1]=Math.floor(n[1]),e}static min(e,n,i){return e[0]=Math.min(n[0],i[0]),e[1]=Math.min(n[1],i[1]),e}static max(e,n,i){return e[0]=Math.max(n[0],i[0]),e[1]=Math.max(n[1],i[1]),e}static round(e,n){return e[0]=Math.round(n[0]),e[1]=Math.round(n[1]),e}static scale(e,n,i){return e[0]=n[0]*i,e[1]=n[1]*i,e}static scaleAndAdd(e,n,i,s){return e[0]=n[0]+i[0]*s,e[1]=n[1]+i[1]*s,e}static distance(e,n){return Math.hypot(n[0]-e[0],n[1]-e[1])}static dist(e,n){return 0}static squaredDistance(e,n){const i=n[0]-e[0],s=n[1]-e[1];return i*i+s*s}static sqrDist(e,n){return 0}static magnitude(e){let n=e[0],i=e[1];return Math.sqrt(n*n+i*i)}static mag(e){return 0}static length(e){return 0}static len(e){return 0}static squaredLength(e){const n=e[0],i=e[1];return n*n+i*i}static sqrLen(e,n){return 0}static negate(e,n){return e[0]=-n[0],e[1]=-n[1],e}static inverse(e,n){return e[0]=1/n[0],e[1]=1/n[1],e}static abs(e,n){return e[0]=Math.abs(n[0]),e[1]=Math.abs(n[1]),e}static normalize(e,n){const i=n[0],s=n[1];let o=i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),e[0]=n[0]*o,e[1]=n[1]*o,e}static dot(e,n){return e[0]*n[0]+e[1]*n[1]}static cross(e,n,i){const s=n[0]*i[1]-n[1]*i[0];return e[0]=e[1]=0,e[2]=s,e}static lerp(e,n,i,s){const o=n[0],a=n[1];return e[0]=o+s*(i[0]-o),e[1]=a+s*(i[1]-a),e}static transformMat2(e,n,i){const s=n[0],o=n[1];return e[0]=i[0]*s+i[2]*o,e[1]=i[1]*s+i[3]*o,e}static transformMat2d(e,n,i){const s=n[0],o=n[1];return e[0]=i[0]*s+i[2]*o+i[4],e[1]=i[1]*s+i[3]*o+i[5],e}static transformMat3(e,n,i){const s=n[0],o=n[1];return e[0]=i[0]*s+i[3]*o+i[6],e[1]=i[1]*s+i[4]*o+i[7],e}static transformMat4(e,n,i){const s=n[0],o=n[1];return e[0]=i[0]*s+i[4]*o+i[12],e[1]=i[1]*s+i[5]*o+i[13],e}static rotate(e,n,i,s){const o=n[0]-i[0],a=n[1]-i[1],h=Math.sin(s),c=Math.cos(s);return e[0]=o*c-a*h+i[0],e[1]=o*h+a*c+i[1],e}static angle(e,n){const i=e[0],s=e[1],o=n[0],a=n[1],h=Math.sqrt(i*i+s*s)*Math.sqrt(o*o+a*a),c=h&&(i*o+s*a)/h;return Math.acos(Math.min(Math.max(c,-1),1))}static zero(e){return e[0]=0,e[1]=0,e}static exactEquals(e,n){return e[0]===n[0]&&e[1]===n[1]}static equals(e,n){const i=e[0],s=e[1],o=n[0],a=n[1];return Math.abs(i-o)<=ht*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(s-a)<=ht*Math.max(1,Math.abs(s),Math.abs(a))}static str(e){return`Vec2(${e.join(", ")})`}}Et.prototype.sub=Et.prototype.subtract,Et.prototype.mul=Et.prototype.multiply,Et.prototype.div=Et.prototype.divide,Et.prototype.dist=Et.prototype.distance,Et.prototype.sqrDist=Et.prototype.squaredDistance,Et.sub=Et.subtract,Et.mul=Et.multiply,Et.div=Et.divide,Et.dist=Et.distance,Et.sqrDist=Et.squaredDistance,Et.sqrLen=Et.squaredLength,Et.mag=Et.magnitude,Et.length=Et.magnitude,Et.len=Et.magnitude;const et=Et,bw=["xx","xy","yx","yy","xxx","xxy","xyx","xyy","yxx","yxy","yyx","yyy","xxxx","xxxy","xxyx","xxyy","xyxx","xyxy","xyyx","xyyy","yxxx","yxxy","yxyx","yxyy","yyxx","yyxy","yyyx","yyyy","rr","rg","gr","gg","rrr","rrg","rgr","rgg","grr","grg","ggr","ggg","rrrr","rrrg","rrgr","rrgg","rgrr","rgrg","rggr","rggg","grrr","grrg","grgr","grgg","ggrr","ggrg","gggr","gggg"],vw=["xz","yz","zx","zy","zz","xxz","xyz","xzx","xzy","xzz","yxz","yyz","yzx","yzy","yzz","zxx","zxy","zxz","zyx","zyy","zyz","zzx","zzy","zzz","xxxz","xxyz","xxzx","xxzy","xxzz","xyxz","xyyz","xyzx","xyzy","xyzz","xzxx","xzxy","xzxz","xzyx","xzyy","xzyz","xzzx","xzzy","xzzz","yxxz","yxyz","yxzx","yxzy","yxzz","yyxz","yyyz","yyzx","yyzy","yyzz","yzxx","yzxy","yzxz","yzyx","yzyy","yzyz","yzzx","yzzy","yzzz","zxxx","zxxy","zxxz","zxyx","zxyy","zxyz","zxzx","zxzy","zxzz","zyxx","zyxy","zyxz","zyyx","zyyy","zyyz","zyzx","zyzy","zyzz","zzxx","zzxy","zzxz","zzyx","zzyy","zzyz","zzzx","zzzy","zzzz","rb","gb","br","bg","bb","rrb","rgb","rbr","rbg","rbb","grb","ggb","gbr","gbg","gbb","brr","brg","brb","bgr","bgg","bgb","bbr","bbg","bbb","rrrb","rrgb","rrbr","rrbg","rrbb","rgrb","rggb","rgbr","rgbg","rgbb","rbrr","rbrg","rbrb","rbgr","rbgg","rbgb","rbbr","rbbg","rbbb","grrb","grgb","grbr","grbg","grbb","ggrb","gggb","ggbr","ggbg","ggbb","gbrr","gbrg","gbrb","gbgr","gbgg","gbgb","gbbr","gbbg","gbbb","brrr","brrg","brrb","brgr","brgg","brgb","brbr","brbg","brbb","bgrr","bgrg","bgrb","bggr","bggg","bggb","bgbr","bgbg","bgbb","bbrr","bbrg","bbrb","bbgr","bbgg","bbgb","bbbr","bbbg","bbbb"],Mw=["xw","yw","zw","wx","wy","wz","ww","xxw","xyw","xzw","xwx","xwy","xwz","xww","yxw","yyw","yzw","ywx","ywy","ywz","yww","zxw","zyw","zzw","zwx","zwy","zwz","zww","wxx","wxy","wxz","wxw","wyx","wyy","wyz","wyw","wzx","wzy","wzz","wzw","wwx","wwy","wwz","www","xxxw","xxyw","xxzw","xxwx","xxwy","xxwz","xxww","xyxw","xyyw","xyzw","xywx","xywy","xywz","xyww","xzxw","xzyw","xzzw","xzwx","xzwy","xzwz","xzww","xwxx","xwxy","xwxz","xwxw","xwyx","xwyy","xwyz","xwyw","xwzx","xwzy","xwzz","xwzw","xwwx","xwwy","xwwz","xwww","yxxw","yxyw","yxzw","yxwx","yxwy","yxwz","yxww","yyxw","yyyw","yyzw","yywx","yywy","yywz","yyww","yzxw","yzyw","yzzw","yzwx","yzwy","yzwz","yzww","ywxx","ywxy","ywxz","ywxw","ywyx","ywyy","ywyz","ywyw","ywzx","ywzy","ywzz","ywzw","ywwx","ywwy","ywwz","ywww","zxxw","zxyw","zxzw","zxwx","zxwy","zxwz","zxww","zyxw","zyyw","zyzw","zywx","zywy","zywz","zyww","zzxw","zzyw","zzzw","zzwx","zzwy","zzwz","zzww","zwxx","zwxy","zwxz","zwxw","zwyx","zwyy","zwyz","zwyw","zwzx","zwzy","zwzz","zwzw","zwwx","zwwy","zwwz","zwww","wxxx","wxxy","wxxz","wxxw","wxyx","wxyy","wxyz","wxyw","wxzx","wxzy","wxzz","wxzw","wxwx","wxwy","wxwz","wxww","wyxx","wyxy","wyxz","wyxw","wyyx","wyyy","wyyz","wyyw","wyzx","wyzy","wyzz","wyzw","wywx","wywy","wywz","wyww","wzxx","wzxy","wzxz","wzxw","wzyx","wzyy","wzyz","wzyw","wzzx","wzzy","wzzz","wzzw","wzwx","wzwy","wzwz","wzww","wwxx","wwxy","wwxz","wwxw","wwyx","wwyy","wwyz","wwyw","wwzx","wwzy","wwzz","wwzw","wwwx","wwwy","wwwz","wwww","ra","ga","ba","ar","ag","ab","aa","rra","rga","rba","rar","rag","rab","raa","gra","gga","gba","gar","gag","gab","gaa","bra","bga","bba","bar","bag","bab","baa","arr","arg","arb","ara","agr","agg","agb","aga","abr","abg","abb","aba","aar","aag","aab","aaa","rrra","rrga","rrba","rrar","rrag","rrab","rraa","rgra","rgga","rgba","rgar","rgag","rgab","rgaa","rbra","rbga","rbba","rbar","rbag","rbab","rbaa","rarr","rarg","rarb","rara","ragr","ragg","ragb","raga","rabr","rabg","rabb","raba","raar","raag","raab","raaa","grra","grga","grba","grar","grag","grab","graa","ggra","ggga","ggba","ggar","ggag","ggab","ggaa","gbra","gbga","gbba","gbar","gbag","gbab","gbaa","garr","garg","garb","gara","gagr","gagg","gagb","gaga","gabr","gabg","gabb","gaba","gaar","gaag","gaab","gaaa","brra","brga","brba","brar","brag","brab","braa","bgra","bgga","bgba","bgar","bgag","bgab","bgaa","bbra","bbga","bbba","bbar","bbag","bbab","bbaa","barr","barg","barb","bara","bagr","bagg","bagb","baga","babr","babg","babb","baba","baar","baag","baab","baaa","arrr","arrg","arrb","arra","argr","argg","argb","arga","arbr","arbg","arbb","arba","arar","arag","arab","araa","agrr","agrg","agrb","agra","aggr","aggg","aggb","agga","agbr","agbg","agbb","agba","agar","agag","agab","agaa","abrr","abrg","abrb","abra","abgr","abgg","abgb","abga","abbr","abbg","abbb","abba","abar","abag","abab","abaa","aarr","aarg","aarb","aara","aagr","aagg","aagb","aaga","aabr","aabg","aabb","aaba","aaar","aaag","aaab","aaaa"],Hn={x:0,r:0,y:1,g:1,z:2,b:2,w:3,a:3};function pc(r){switch(r.length){case 2:return function(){return new Et(this[Hn[r[0]]],this[Hn[r[1]]])};case 3:return function(){return new xt(this[Hn[r[0]]],this[Hn[r[1]]],this[Hn[r[2]]])};case 4:return function(){return new yt(this[Hn[r[0]]],this[Hn[r[1]]],this[Hn[r[2]]],this[Hn[r[3]]])}}return()=>null}let sd=!1;function _w(){if(!sd){for(const r of bw){const e=pc(r);Object.defineProperty(Et.prototype,r,{get:e}),Object.defineProperty(xt.prototype,r,{get:e}),Object.defineProperty(yt.prototype,r,{get:e})}for(const r of vw){const e=pc(r);Object.defineProperty(xt.prototype,r,{get:e}),Object.defineProperty(yt.prototype,r,{get:e})}for(const r of Mw){const e=pc(r);Object.defineProperty(yt.prototype,r,{get:e})}sd=!0}}const Sw=Object.freeze(Object.defineProperty({__proto__:null,EnableSwizzles:_w,Mat2:oe,Mat2d:Me,Mat3:Zt,Mat4:At,Quat:dt,Quat2:Gt,Vec2:Et,Vec3:xt,Vec4:yt,mat2:Us,mat2d:xi,mat3:J0,mat4:K0,quat:gw,quat2:ww,vec2:et,vec3:Yn,vec4:qi},Symbol.toStringTag,{value:"Module"})),rd=Math.sqrt,od=1e-4;class Ws{static fromPoints(e,n,i){return new Ws(e,n,i)}static fromXY(e,n,i,s,o,a){return new Ws(new O(e,n),new O(i,s),new O(o,a))}p0=O.default();p1=O.default();p2=O.default();constructor(e,n,i){this.p0.copy(e),this.p1.copy(n),this.p2.copy(i)}getBoundingBox(){let e=Ni.default(),n=[];const i=Sc([this.p0,this.p1,this.p2],n);for(let s=0;s<i;s++)e.expandByXY(n[s].x,n[s].y);return e}split(e){return ea(this.p0,this.p1,this.p2,e)}getPoint(e){return ad(this.p0,this.p1,this.p2,e)}getPoints(e=.01){return wc(this.p0,this.p1,this.p2,e)}getExtermas(e){return Sc([this.p0,this.p1,this.p2],e)}fatten(e=1){return wc(this.p0,this.p1,this.p2,e)}}let yc=class $f{static fromQuadBezier(e){const n=O.lerp(O.default(),e.p0,e.p1,.6666666666666666),i=O.lerp(O.default(),e.p2,e.p1,2/3);return this.fromPoints(e.p0,n,i,e.p2)}static fromPoints(e,n,i,s){return new $f(e,n,i,s)}static fromXY(e,n,i,s,o,a,h,c){return new $f(new O(e,n),new O(i,s),new O(o,a),new O(h,c))}p0=O.default();p1=O.default();p2=O.default();p3=O.default();constructor(e,n,i,s){this.p0.copy(e),this.p1.copy(n),this.p2.copy(i),this.p3.copy(s)}getBoundingBox(){let e=Ni.default(),n=[];const i=Tc([this.p0,this.p1,this.p2,this.p3],n);for(let s=0;s<i;s++)e.expandByXY(n[s].x,n[s].y);return e}split(e){return gc(this.p0,this.p1,this.p2,this.p3,e)}getPoint(e){return mc(this.p0,this.p1,this.p2,this.p3,e)}getPoints(e=.01){return bc(this.p0,this.p1,this.p2,this.p3,e)}getExtermas(e){return Tc([this.p0,this.p1,this.p2,this.p3],e)}fatten(e=1){return bc(this.p0,this.p1,this.p2,this.p3,e)}};function js(r,e,n){return H0(r,e)*Math.pow(n,e)*Math.pow(1-n,r-e)}function Tw(r,e){const n=r.length-1;if(n<0)return O.default();const i=O.default();for(let s=0;s<=n;s++){const o=r[s],a=js(n,s,e);i.x+=o.x*a,i.y+=o.y*a}return i}function xc(r,e){const n=r.length-1;if(n<0)return O.default();let i=r.map(s=>s.clone());for(let s=1;s<=n;s++)for(let o=0;o<n-s+1;o++)i[o]=i[o].lerp(i[o+1],e);return i[0]}function Ew(r,e,n,i=1,s){const o=4*i/(3*(1+i)),a=r+(e-r)*o,h=n+(e-n)*o;return Ge(r,a,h,n,s)}function zw(r,e,n,i=1,s){const o=4*i/(3*(1+i)),a=O.lerp(O.default(),r,e,o),h=O.lerp(O.default(),e,n,o);return mc(r,a,h,n,s)}function Aw(r,e,n){const i=r.length-1;if(i<0)return O.default();const s=O.default();let o=0;for(let a=0;a<=i;a++){const h=r[a],c=js(i,a,n);s.x+=e[a]*c*h.x,s.y+=e[a]*c*h.y,o+=e[a]*c}return s.x/=o,s.y/=o,s}function Cw(r,e){const n=hd(r,e),i=cd(r,e),s=Math.abs(n.cross(i)),o=Math.pow(n.magnitudeSquared(),3/2);return s/o}function Pw(r,e,n,i){const s=J0.fromValues(1,-2,1,0,2,-2,0,0,1),o=Yn.fromValues(1,i,i*i),a=Yn.transformMat3(Yn.create(),o,s),h=Yn.fromValues(r.x,e.x,n.x),c=Yn.fromValues(r.y,e.y,n.y);return O.create(Yn.dot(a,h),Yn.dot(a,c))}function Iw(r,e,n,i,s){const o=K0.fromValues(1,-3,3,-1,0,3,-6,3,0,0,3,-3,0,0,0,1),a=qi.fromValues(1,s,s*s,s*s*s),h=qi.transformMat4(Yn.create(),a,o),c=qi.fromValues(r.x,e.x,n.x,i.x),l=qi.fromValues(r.y,e.y,n.y,i.y);return O.create(qi.dot(h,c),qi.dot(h,l))}function fn(r,e,n,i){const s=i*i,o=1-i,a=o*o;return r*a+2*i*o*e+s*n}function ad(r,e,n,i){const s=i*i,o=1-i,a=o*o,h=r.x*a+2*o*i*e.x+s*n.x,c=r.y*a+2*o*i*e.y+s*n.y;return O.create(h,c)}function Ge(r,e,n,i,s){const o=s*s,a=o*s,h=1-s,c=h*h,l=c*h;return r*l+3*s*c*e+3*h*o*n+a*i}function mc(r,e,n,i,s){const o=s*s,a=o*s,h=1-s,c=h*h,l=c*h,u=r.x*l+3*c*s*e.x+3*h*o*n.x+a*i.x,f=r.y*l+3*c*s*e.y+3*h*o*n.y+a*i.y;return O.create(u,f)}function kw(r){const e=r.length;if(e<=1)return[];let n=[r[0]];for(let i=1;i<e;i++){let s=r[i-1],o=r[i];n[i-1]=O.create(s.x*i/e+o.x*(e-i)/e,s.y*i/e+o.y*(e-i)/e)}return n[e]=r[e-1],n}function hd(r,e){const n=r.length-1;if(n<0)return O.default();let i=O.default();for(let s=0;s<n;s++){const o=js(n-1,s,e);i.x+=(r[s+1].x-r[s].x)*o,i.y+=(r[s+1].y-r[s].y)*o}return i.multiplyScalar(n)}function cd(r,e){const n=r.length-1;if(n<2)return O.create(0,0);let i=O.create(0,0);for(let s=0;s<=n-2;s++){const o=js(n-2,s,e);i.x+=r[s+2].x-2*r[s+1].x+r[s].x*o,i.y+=r[s+2].y-2*r[s+1].y+r[s].y*o}return i.x*=n*(n-1),i.y*=n*(n-1),i}function Rw(r,e){let n=r;for(let i=0;i<e;i++){const s=[];for(let o=0;o<n.length-1;o++){const a=n[o+1].clone().sub(n[o]);s.push(a)}n=s}return n}function Ow(r,e,n){const i=r.length-1;if(n>i)throw new Error("导数阶数不能超过贝塞尔曲线阶数");const s=dc(i)/dc(i-n),o=Rw(r,n),a=i-n,h=O.default();for(let c=0;c<=a;c++){const l=js(a,c,e);h.x+=o[c].x*l,h.y+=o[c].y*l}return h.x*=s,h.y*=s,h}function Lw(r){const e=r.length-1;if(e<0)return[];let n=Array.from({length:e}).map(()=>O.default());for(let i=0;i<e;i++)n[i].x=e*(r[i+1].x-r[i].x),n[i].y=e*(r[i+1].y-r[i].y);return n}function Bw(r,e,n){if(e===0&&n===1)return r;if(e===0)return Br(r,n).left;if(n===1)return Br(r,e).right;const i=Br(r,e).right;return Br(i,n).left}function Br(r,e=.5){const n=r.length-1,i=[],s=[],o=r.map(a=>a.clone());i.push(o[0].clone()),s.unshift(o[n].clone());for(let a=1;a<=n;a++){for(let h=0;h<n-a+1;h++)o[h].x=(1-e)*o[h].x+e*o[h+1].x,o[h].y=(1-e)*o[h].y+e*o[h+1].y;i.push(o[0].clone()),s.unshift(o[n-a].clone())}return{left:i,right:s}}function ea(r,e,n,i=.5){const s=r.clone().lerp(e,i),o=e.clone().lerp(n,i),a=s.clone().lerp(o,i);return[r,s,a,o,n]}function Fw(r,e){const n=ld(r[0],r[1],r[2]);return n>0&&n<1?ea(r[0],r[1],r[2],n):r}function gc(r,e,n,i,s=.5){const o=r.clone().lerp(e,s),a=e.clone().lerp(n,s),h=n.clone().lerp(i,s),c=o.clone().lerp(a,s),l=a.clone().lerp(h,s),u=c.clone().lerp(l,s);return[r,o,c,u,l,h,i]}function Nw(r,e,n,i,s,o){const a=s-n,h=o-i,c=r-n,l=e-i,u=a*a+h*h;if(u==0)return 0;const f=Math.max(0,Math.min(1,(c*a+l*h)/u)),d=n+f*a,p=i+f*h,y=r-d,x=e-p;return y*y+x*x}function na(r,e,n,i,s,o){const a=s-n,h=o-i,c=h,l=-a,u=a*i-h*n;return Math.abs(c*r+l*e+u)/Math.sqrt(c*c+l*l)}function wc(r,e,n,i=1,s=1e3){const o=[];function a(h,c,l,u=0){if(na(c.x,c.y,h.x,h.y,l.x,l.y)<i||u>s){o.push(l);return}const[d,p,y,x,m]=ea(h,c,l,.5);a(d,p,y,u+1),a(y,x,m,u+1)}return o.push(r),a(r,e,n),o}function bc(r,e,n,i,s=1,o=1e3){const a=[];function h(c,l,u,f,d=0){const p=na(l.x,l.y,c.x,c.y,f.x,f.y),y=na(u.x,u.y,c.x,c.y,f.x,f.y);if(Math.max(p,y)<s||d>o){a.push(f);return}const[x,m,g,w,M,S,E]=gc(c,l,u,f,.5);h(x,m,g,w,d+1),h(w,M,S,E,d+1)}return a.push(r),h(r,e,n,i),a}function qw(r,e,n){const i=O.lerp(O.default(),r,e,.6666666666666666),s=O.lerp(O.default(),n,e,2/3);return[r,i,s,n]}function Dw(r,e,n,i){const s=2*(e.x-r.x)+2*(n.x-2*e.x+r.x)*i,o=2*(e.y-r.y)+2*(n.y-2*e.y+r.y)*i;return O.create(s,o)}function ld(r,e,n){const i=2*(e.x-r.x),s=2*(e.y-r.y),o=2*(r.x-2*e.x+n.x),a=2*(r.y-2*e.y+n.y);let h=-(i*o+s*a),c=o*o+a*a;return c<0&&(h=-h,c=-c),h<=0?0:h>=c?1:h/c}function $w(r,e,n,i,s){const o=3*s*s*(i.x-3*n.x+3*e.x-r.x)+6*s*(n.x-2*e.x+r.x)+3*(e.x-r.x),a=3*s*s*(i.y-3*n.y+3*e.y-r.y)+6*s*(n.y-2*e.y+r.y)+3*(e.y-r.x);return O.create(o,a)}function ud(r,e){let n=r[2]-r[0],i=r[4]-2*r[2]+r[0],s=r[6]+3*(r[2]-r[4])-r[0];e[0]=s*s,e[1]=3*i*s,e[2]=2*i*i+s*n,e[3]=n*i}function Vw(r,e){let n=0;for(let i=e;i>1;--i)if(r[n]==r[n+1]){for(let s=1;s<i;++s)r[s-1]=r[s];e-=1}else n++;return e}function Uw(r,e){for(let n=e-1;n>0;--n)for(let i=n;i>0;--i)if(r[i]<r[i-1]){let s=r[i];r[i]=r[i-1],r[i-1]=s}}function Ww(r,e){if(Math.abs(r[0])<=1e-6)return _c(r[1],r[2],r[3],e);let n,i,s,o,a;{let u=1/r[0];n=r[1]*u,i=r[2]*u,s=r[3]*u}o=(n*n-i*3)/9,a=(2*n*n*n-9*n*i+27*s)/54;let h=o*o*o,c=a*a-h,l=n/3;if(c<0){let u=Math.cos(ve(a/Math.sqrt(h),-1,1)),f=-2*Math.sqrt(o);return e[0]=ve(f*Math.cos(u/3)-l,0,1),e[1]=ve(f*Math.cos((u+2*Math.PI)/3)-l,0,1),e[2]=ve(f*Math.cos((u-2*Math.PI)/3)-l,0,1),Uw(e,3),Vw(e,3)}else{let u=Math.abs(a)+Math.sqrt(c);return u=Math.pow(u,.3333333),a>0&&(u=-u),u!=0&&(u+=o/u),e[0]=ve(u-l,0,1),1}}function jw(r,e){let n=new Array(4).fill(0),i=new Array(4).fill(0),s;for(ud(r.map(a=>a.x),n),ud(r.map(a=>a.y),i),s=0;s<4;s++)n[s]+=i[s];return Ww(n,e)}function ia(r,e,n){if(r<0&&(r=-r,e=-e),e==0||r==0||r>=e)return 0;let i=r/e;return!Number.isFinite(i)||i==0?0:(n[0]=i,1)}function vc(r,e,n,i){return ia(r-e,r-e-e+n,i)}function Mc(r,e,n,i,s){const o=i-r+3*(e-n),a=2*(r-e-e+n),h=e-r;return _c(o,a,h,s)}function _c(r,e,n,i){if(r==0)return ia(-n,e,i);let s=0,o=e*e-4*r*n;if(o<0)return 0;o=Math.sqrt(o);let a=o;if(!Number.isFinite(a))return 0;let h=e<0?-(e-a)/2:-(e+a)/2,c=[];if(ia(h,r,c)>0&&(i[s]=c[0],s++),ia(n,h,c)&&(i[s]=c[0],s++),s==2)if(i[0]>i[1]){let l=i[0];i[0]=i[1],i[1]=l}else i[0]==i[1]&&(s-=1);return s}function Sc(r,e){let n=[],i=[],s=0;vc(r[0].x,r[1].x,r[2].x,i)>0&&(n[s]=i[0],s++),vc(r[0].y,r[1].y,r[2].y,i)>0&&(n[s]=i[0],s++);for(let o=0;o<s;++o)e[o]=xc(r,n[o]);return e[s]=r[2],s+1}function Tc(r,e){let n=[0,0,0,0],i=[],s=0,o=0;(o=Mc(r[0].x,r[1].x,r[2].x,r[3].x,i))>0&&(o==1&&(n[0]=i[0]),o==2&&(n[1]=i[1]),s+=o),(o=Mc(r[0].y,r[1].y,r[2].y,r[3].y,i))>0&&(o==1&&(n[s]=i[0]),o==2&&(n[s+1]=i[1]),s+=o);for(let a=0;a<s;++a)e[a]=xc(r,n[a]);return e[s]=r[3],s+1}function fd(r,e,n,i,s,o,a,h,c){let l=0,u=.005,f=1/0;const d=O.create(a,h),p=O.default(),y=O.default();for(let x=0;x<1;x+=.05){p[0]=fn(r,n,s,x),p[1]=fn(e,i,o,x);const m=d.distanceSquared(p);m<f&&(l=x,f=m)}f=1/0;for(let x=0;x<32&&!(u<od);x++){const m=l-u,g=l+u;p[0]=fn(r,n,s,m),p[1]=fn(e,i,o,m);const w=d.distanceSquared(p);if(m>=0&&w<f)l=m,f=w;else{y[0]=fn(r,n,s,g),y[1]=fn(e,i,o,g);const M=y.distanceSquared(d);g<=1&&M<f?(l=g,f=M):u*=.5}}return c&&(c[0]=fn(r,n,s,l),c[1]=fn(e,i,o,l)),rd(f)}function Yw(r,e,n,i,s,o,a){let h=r,c=e,l=0;const u=1/a;for(let f=1;f<=a;f++){let d=f*u;const p=fn(r,n,s,d),y=fn(e,i,o,d),x=p-h,m=y-c;l+=Math.sqrt(x*x+m*m),h=p,c=y}return l}function dd(r,e,n,i,s,o,a,h,c,l,u){let f=0,d=.005,p=1/0,y,x,m,g;const w=O.create(c,l),M=O.default(),S=O.default();for(let E=0;E<1;E+=.05)M[0]=Ge(r,n,s,a,E),M[1]=Ge(e,i,o,h,E),m=w.distanceSquared(M),m<p&&(f=E,p=m);p=1/0;for(let E=0;E<32&&!(d<od);E++)y=f-d,x=f+d,M[0]=Ge(r,n,s,a,y),M[1]=Ge(e,i,o,h,y),m=M.distanceSquared(w),y>=0&&m<p?(f=y,p=m):(S[0]=Ge(r,n,s,a,x),S[1]=Ge(e,i,o,h,x),g=S.distanceSquared(w),x<=1&&g<p?(f=x,p=g):d*=.5);return u&&(u[0]=Ge(r,n,s,a,f),u[1]=Ge(e,i,o,h,f)),rd(p)}function Hw(r,e,n,i,s,o,a,h,c){let l=r,u=e,f=0;const d=1/c;for(let p=1;p<=c;p++){let y=p*d;const x=Ge(r,n,s,a,y),m=Ge(e,i,o,h,y),g=x-l,w=m-u;f+=Math.sqrt(g*g+w*w),l=x,u=m}return f}const{abs:Fr,cos:Xn,sin:Ys,acos:Xw,atan2:Nr,sqrt:mi,pow:Je}=Math;function qr(r){return r<0?-Je(-r,1/3):Je(r,1/3)}const pd=Math.PI,sa=2*pd,gi=pd/2,Zw=1e-6,Ec=Number.MAX_SAFE_INTEGER||9007199254740991,zc=Number.MIN_SAFE_INTEGER||-9007199254740991,Gw={x:0,y:0,z:0},K={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(r,e){const n=e(r);let i=n.x*n.x+n.y*n.y;return typeof n.z<"u"&&(i+=n.z*n.z),mi(i)},compute:function(r,e,n){if(r===0)return e[0].t=0,e[0];const i=e.length-1;if(r===1)return e[i].t=1,e[i];const s=1-r;let o=e;if(i===0)return e[0].t=r,e[0];if(i===1){const h={x:s*o[0].x+r*o[1].x,y:s*o[0].y+r*o[1].y,t:r};return n&&(h.z=s*o[0].z+r*o[1].z),h}if(i<4){let h=s*s,c=r*r,l,u,f,d=0;i===2?(o=[o[0],o[1],o[2],Gw],l=h,u=s*r*2,f=c):i===3&&(l=h*s,u=h*r*3,f=s*c*3,d=r*c);const p={x:l*o[0].x+u*o[1].x+f*o[2].x+d*o[3].x,y:l*o[0].y+u*o[1].y+f*o[2].y+d*o[3].y,t:r};return n&&(p.z=l*o[0].z+u*o[1].z+f*o[2].z+d*o[3].z),p}const a=JSON.parse(JSON.stringify(e));for(;a.length>1;){for(let h=0;h<a.length-1;h++)a[h]={x:a[h].x+(a[h+1].x-a[h].x)*r,y:a[h].y+(a[h+1].y-a[h].y)*r},typeof a[h].z<"u"&&(a[h].z=a[h].z+(a[h+1].z-a[h].z)*r);a.splice(a.length-1,1)}return a[0].t=r,a[0]},computeWithRatios:function(r,e,n,i){const s=1-r,o=n,a=e;let h=o[0],c=o[1],l=o[2],u=o[3],f;if(h*=s,c*=r,a.length===2)return f=h+c,{x:(h*a[0].x+c*a[1].x)/f,y:(h*a[0].y+c*a[1].y)/f,z:i?(h*a[0].z+c*a[1].z)/f:!1,t:r};if(h*=s,c*=2*s,l*=r*r,a.length===3)return f=h+c+l,{x:(h*a[0].x+c*a[1].x+l*a[2].x)/f,y:(h*a[0].y+c*a[1].y+l*a[2].y)/f,z:i?(h*a[0].z+c*a[1].z+l*a[2].z)/f:!1,t:r};if(h*=s,c*=1.5*s,l*=3*s,u*=r*r*r,a.length===4)return f=h+c+l+u,{x:(h*a[0].x+c*a[1].x+l*a[2].x+u*a[3].x)/f,y:(h*a[0].y+c*a[1].y+l*a[2].y+u*a[3].y)/f,z:i?(h*a[0].z+c*a[1].z+l*a[2].z+u*a[3].z)/f:!1,t:r}},derive:function(r,e){const n=[];for(let i=r,s=i.length,o=s-1;s>1;s--,o--){const a=[];for(let h=0,c;h<o;h++)c={x:o*(i[h+1].x-i[h].x),y:o*(i[h+1].y-i[h].y)},e&&(c.z=o*(i[h+1].z-i[h].z)),a.push(c);n.push(a),i=a}return n},between:function(r,e,n){return e<=r&&r<=n||K.approximately(r,e)||K.approximately(r,n)},approximately:function(r,e,n){return Fr(r-e)<=(n||Zw)},length:function(r){const n=K.Tvalues.length;let i=0;for(let s=0,o;s<n;s++)o=.5*K.Tvalues[s]+.5,i+=K.Cvalues[s]*K.arcfn(o,r);return .5*i},map:function(r,e,n,i,s){const o=n-e,a=s-i,h=r-e,c=h/o;return i+a*c},lerp:function(r,e,n){const i={x:e.x+r*(n.x-e.x),y:e.y+r*(n.y-e.y)};return e.z!==void 0&&n.z!==void 0&&(i.z=e.z+r*(n.z-e.z)),i},pointToString:function(r){let e=r.x+"/"+r.y;return typeof r.z<"u"&&(e+="/"+r.z),e},pointsToString:function(r){return"["+r.map(K.pointToString).join(", ")+"]"},copy:function(r){return JSON.parse(JSON.stringify(r))},angle:function(r,e,n){const i=e.x-r.x,s=e.y-r.y,o=n.x-r.x,a=n.y-r.y,h=i*a-s*o,c=i*o+s*a;return Nr(h,c)},round:function(r,e){const n=""+r,i=n.indexOf(".");return parseFloat(n.substring(0,i+1+e))},dist:function(r,e){const n=r.x-e.x,i=r.y-e.y;return mi(n*n+i*i)},closest:function(r,e){let n=Je(2,63),i,s;return r.forEach(function(o,a){s=K.dist(e,o),s<n&&(n=s,i=a)}),{mdist:n,mpos:i}},abcratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;const n=Je(r,e)+Je(1-r,e),i=n-1;return Fr(i/n)},projectionratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;const n=Je(1-r,e),i=Je(r,e)+n;return n/i},lli8:function(r,e,n,i,s,o,a,h){const c=(r*i-e*n)*(s-a)-(r-n)*(s*h-o*a),l=(r*i-e*n)*(o-h)-(e-i)*(s*h-o*a),u=(r-n)*(o-h)-(e-i)*(s-a);return u==0?!1:{x:c/u,y:l/u}},lli4:function(r,e,n,i){const s=r.x,o=r.y,a=e.x,h=e.y,c=n.x,l=n.y,u=i.x,f=i.y;return K.lli8(s,o,a,h,c,l,u,f)},lli:function(r,e){return K.lli4(r,r.c,e,e.c)},makeline:function(r,e){return new Ut(r.x,r.y,(r.x+e.x)/2,(r.y+e.y)/2,e.x,e.y)},findbbox:function(r){let e=Ec,n=Ec,i=zc,s=zc;return r.forEach(function(o){const a=o.bbox();e>a.x.min&&(e=a.x.min),n>a.y.min&&(n=a.y.min),i<a.x.max&&(i=a.x.max),s<a.y.max&&(s=a.y.max)}),{x:{min:e,mid:(e+i)/2,max:i,size:i-e},y:{min:n,mid:(n+s)/2,max:s,size:s-n}}},shapeintersections:function(r,e,n,i,s){if(!K.bboxoverlap(e,i))return[];const o=[],a=[r.startcap,r.forward,r.back,r.endcap],h=[n.startcap,n.forward,n.back,n.endcap];return a.forEach(function(c){c.virtual||h.forEach(function(l){if(l.virtual)return;const u=c.intersects(l,s);u.length>0&&(u.c1=c,u.c2=l,u.s1=r,u.s2=n,o.push(u))})}),o},makeshape:function(r,e,n){const i=e.points.length,s=r.points.length,o=K.makeline(e.points[i-1],r.points[0]),a=K.makeline(r.points[s-1],e.points[0]),h={startcap:o,forward:r,back:e,endcap:a,bbox:K.findbbox([o,r,e,a])};return h.intersections=function(c){return K.shapeintersections(h,h.bbox,c,c.bbox,n)},h},getminmax:function(r,e,n){if(!n)return{min:0,max:0};let i=Ec,s=zc,o,a;n.indexOf(0)===-1&&(n=[0].concat(n)),n.indexOf(1)===-1&&n.push(1);for(let h=0,c=n.length;h<c;h++)o=n[h],a=r.get(o),a[e]<i&&(i=a[e]),a[e]>s&&(s=a[e]);return{min:i,mid:(i+s)/2,max:s,size:s-i}},align:function(r,e){const n=e.p1.x,i=e.p1.y,s=-Nr(e.p2.y-i,e.p2.x-n),o=function(a){return{x:(a.x-n)*Xn(s)-(a.y-i)*Ys(s),y:(a.x-n)*Ys(s)+(a.y-i)*Xn(s)}};return r.map(o)},roots:function(r,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const n=r.length-1,i=K.align(r,e),s=function(I){return 0<=I&&I<=1};if(n===2){const I=i[0].y,b=i[1].y,v=i[2].y,_=I-2*b+v;if(_!==0){const z=-mi(b*b-I*v),P=-I+b,k=-(z+P)/_,B=-(-z+P)/_;return[k,B].filter(s)}else if(b!==v&&_===0)return[(2*b-v)/(2*b-2*v)].filter(s);return[]}const o=i[0].y,a=i[1].y,h=i[2].y,c=i[3].y;let l=-o+3*a-3*h+c,u=3*o-6*a+3*h,f=-3*o+3*a,d=o;if(K.approximately(l,0)){if(K.approximately(u,0))return K.approximately(f,0)?[]:[-d/f].filter(s);const I=mi(f*f-4*u*d),b=2*u;return[(I-f)/b,(-f-I)/b].filter(s)}u/=l,f/=l,d/=l;const p=(3*f-u*u)/3,y=p/3,x=(2*u*u*u-9*u*f+27*d)/27,m=x/2,g=m*m+y*y*y;let w,M,S,E,A;if(g<0){const I=-p/3,b=I*I*I,v=mi(b),_=-x/(2*v),z=_<-1?-1:_>1?1:_,P=Xw(z),k=qr(v),B=2*k;return S=B*Xn(P/3)-u/3,E=B*Xn((P+sa)/3)-u/3,A=B*Xn((P+2*sa)/3)-u/3,[S,E,A].filter(s)}else{if(g===0)return w=m<0?qr(-m):-qr(m),S=2*w-u/3,E=-w-u/3,[S,E].filter(s);{const I=mi(g);return w=qr(-m+I),M=qr(m+I),[w-M-u/3].filter(s)}}},droots:function(r){if(r.length===3){const e=r[0],n=r[1],i=r[2],s=e-2*n+i;if(s!==0){const o=-mi(n*n-e*i),a=-e+n,h=-(o+a)/s,c=-(-o+a)/s;return[h,c]}else if(n!==i&&s===0)return[(2*n-i)/(2*(n-i))];return[]}if(r.length===2){const e=r[0],n=r[1];return e!==n?[e/(e-n)]:[]}return[]},curvature:function(r,e,n,i,s){let o,a,h,c,l=0,u=0;const f=K.compute(r,e),d=K.compute(r,n),p=f.x*f.x+f.y*f.y;if(i?(o=mi(Je(f.y*d.z-d.y*f.z,2)+Je(f.z*d.x-d.z*f.x,2)+Je(f.x*d.y-d.x*f.y,2)),a=Je(p+f.z*f.z,3/2)):(o=f.x*d.y-f.y*d.x,a=Je(p,3/2)),o===0||a===0)return{k:0,r:0};if(l=o/a,u=a/o,!s){const y=K.curvature(r-.001,e,n,i,!0).k,x=K.curvature(r+.001,e,n,i,!0).k;c=(x-l+(l-y))/2,h=(Fr(x-l)+Fr(l-y))/2}return{k:l,r:u,dk:c,adk:h}},inflections:function(r){if(r.length<4)return[];const e=K.align(r,{p1:r[0],p2:r.slice(-1)[0]}),n=e[2].x*e[1].y,i=e[3].x*e[1].y,s=e[1].x*e[2].y,o=e[3].x*e[2].y,a=18*(-3*n+2*i+3*s-o),h=18*(3*n-i-3*s),c=18*(s-n);if(K.approximately(a,0)){if(!K.approximately(h,0)){let d=-c/h;if(0<=d&&d<=1)return[d]}return[]}const l=2*a;if(K.approximately(l,0))return[];const u=h*h-4*a*c;if(u<0)return[];const f=Math.sqrt(u);return[(f-h)/l,-(h+f)/l].filter(function(d){return 0<=d&&d<=1})},bboxoverlap:function(r,e){const n=["x","y"],i=n.length;for(let s=0,o,a,h,c;s<i;s++)if(o=n[s],a=r[o].mid,h=e[o].mid,c=(r[o].size+e[o].size)/2,Fr(a-h)>=c)return!1;return!0},expandbox:function(r,e){e.x.min<r.x.min&&(r.x.min=e.x.min),e.y.min<r.y.min&&(r.y.min=e.y.min),e.z&&e.z.min<r.z.min&&(r.z.min=e.z.min),e.x.max>r.x.max&&(r.x.max=e.x.max),e.y.max>r.y.max&&(r.y.max=e.y.max),e.z&&e.z.max>r.z.max&&(r.z.max=e.z.max),r.x.mid=(r.x.min+r.x.max)/2,r.y.mid=(r.y.min+r.y.max)/2,r.z&&(r.z.mid=(r.z.min+r.z.max)/2),r.x.size=r.x.max-r.x.min,r.y.size=r.y.max-r.y.min,r.z&&(r.z.size=r.z.max-r.z.min)},pairiteration:function(r,e,n){const i=r.bbox(),s=e.bbox(),o=1e5,a=n||.5;if(i.x.size+i.y.size<a&&s.x.size+s.y.size<a)return[(o*(r._t1+r._t2)/2|0)/o+"/"+(o*(e._t1+e._t2)/2|0)/o];let h=r.split(.5),c=e.split(.5),l=[{left:h.left,right:c.left},{left:h.left,right:c.right},{left:h.right,right:c.right},{left:h.right,right:c.left}];l=l.filter(function(f){return K.bboxoverlap(f.left.bbox(),f.right.bbox())});let u=[];return l.length===0||(l.forEach(function(f){u=u.concat(K.pairiteration(f.left,f.right,a))}),u=u.filter(function(f,d){return u.indexOf(f)===d})),u},getccenter:function(r,e,n){const i=e.x-r.x,s=e.y-r.y,o=n.x-e.x,a=n.y-e.y,h=i*Xn(gi)-s*Ys(gi),c=i*Ys(gi)+s*Xn(gi),l=o*Xn(gi)-a*Ys(gi),u=o*Ys(gi)+a*Xn(gi),f=(r.x+e.x)/2,d=(r.y+e.y)/2,p=(e.x+n.x)/2,y=(e.y+n.y)/2,x=f+h,m=d+c,g=p+l,w=y+u,M=K.lli8(f,d,x,m,p,y,g,w),S=K.dist(M,r);let E=Nr(r.y-M.y,r.x-M.x),A=Nr(e.y-M.y,e.x-M.x),I=Nr(n.y-M.y,n.x-M.x),b;return E<I?((E>A||A>I)&&(E+=sa),E>I&&(b=I,I=E,E=b)):I<A&&A<E?(b=I,I=E,E=b):I+=sa,M.s=E,M.e=I,M.r=S,M},numberSort:function(r,e){return r-e}};class Dr{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(e){return K.pointsToString(e.points)}).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map(function(e){return e.length()}).reduce(function(e,n){return e+n})}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var n=e[0].bbox(),i=1;i<e.length;i++)K.expandbox(n,e[i].bbox());return n}offset(e){const n=[];return this.curves.forEach(function(i){n.push(...i.offset(e))}),new Dr(n)}}const{abs:$r,min:yd,max:xd,cos:Jw,sin:Qw,acos:Kw,sqrt:Vr}=Math,tb=Math.PI;class Ut{constructor(e){let n=e&&e.forEach?e:Array.from(arguments).slice(),i=!1;if(typeof n[0]=="object"){i=n.length;const p=[];n.forEach(function(y){["x","y","z"].forEach(function(x){typeof y[x]<"u"&&p.push(y[x])})}),n=p}let s=!1;const o=n.length;if(i){if(i>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");s=!0}}else if(o!==6&&o!==8&&o!==9&&o!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const a=this._3d=!s&&(o===9||o===12)||e&&e[0]&&typeof e[0].z<"u",h=this.points=[];for(let p=0,y=a?3:2;p<o;p+=y){var c={x:n[p],y:n[p+1]};a&&(c.z=n[p+2]),h.push(c)}const l=this.order=h.length-1,u=this.dims=["x","y"];a&&u.push("z"),this.dimlen=u.length;const f=K.align(h,{p1:h[0],p2:h[l]}),d=K.dist(h[0],h[l]);this._linear=f.reduce((p,y)=>p+$r(y.y),0)<d/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,n,i,s){if(typeof s>"u"&&(s=.5),s===0)return new Ut(n,n,i);if(s===1)return new Ut(e,n,n);const o=Ut.getABC(2,e,n,i,s);return new Ut(e,o.A,i)}static cubicFromPoints(e,n,i,s,o){typeof s>"u"&&(s=.5);const a=Ut.getABC(3,e,n,i,s);typeof o>"u"&&(o=K.dist(n,a.C));const h=o*(1-s)/s,c=K.dist(e,i),l=(i.x-e.x)/c,u=(i.y-e.y)/c,f=o*l,d=o*u,p=h*l,y=h*u,x={x:n.x-f,y:n.y-d},m={x:n.x+p,y:n.y+y},g=a.A,w={x:g.x+(x.x-g.x)/(1-s),y:g.y+(x.y-g.y)/(1-s)},M={x:g.x+(m.x-g.x)/s,y:g.y+(m.y-g.y)/s},S={x:e.x+(w.x-e.x)/s,y:e.y+(w.y-e.y)/s},E={x:i.x+(M.x-i.x)/(1-s),y:i.y+(M.y-i.y)/(1-s)};return new Ut(e,S,E,i)}static getUtils(){return K}getUtils(){return Ut.getUtils()}static get PolyBezier(){return Dr}valueOf(){return this.toString()}toString(){return K.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,n=e[0].x,i=e[0].y,s=["M",n,i,this.order===2?"Q":"C"];for(let o=1,a=e.length;o<a;o++)s.push(e[o].x),s.push(e[o].y);return s.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map(function(e,n){return""+n+e.x+e.y+(e.z?e.z:0)}).join("")}update(){this._lut=[],this.dpoints=K.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,n=K.angle(e[0],e[this.order],e[1]);this.clockwise=n>0}length(){return K.length(this.derivative.bind(this))}static getABC(e=2,n,i,s,o=.5){const a=K.projectionratio(o,e),h=1-a,c={x:a*n.x+h*s.x,y:a*n.y+h*s.y},l=K.abcratio(o,e);return{A:{x:i.x+(i.x-c.x)/l,y:i.y+(i.y-c.y)/l},B:i,C:c,S:n,E:s}}getABC(e,n){n=n||this.get(e);let i=this.points[0],s=this.points[this.order];return Ut.getABC(this.order,i,n,s,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e+1)return this._lut;this._lut=[],e++,this._lut=[];for(let n=0,i,s;n<e;n++)s=n/(e-1),i=this.compute(s),i.t=s,this._lut.push(i);return this._lut}on(e,n){n=n||5;const i=this.getLUT(),s=[];for(let o=0,a,h=0;o<i.length;o++)a=i[o],K.dist(a,e)<n&&(s.push(a),h+=o/i.length);return s.length?t/=s.length:!1}project(e){const n=this.getLUT(),i=n.length-1,s=K.closest(n,e),o=s.mpos,a=(o-1)/i,h=(o+1)/i,c=.1/i;let l=s.mdist,u=a,f=u,d;l+=1;for(let p;u<h+c;u+=c)d=this.compute(u),p=K.dist(e,d),p<l&&(l=p,f=u);return f=f<0?0:f>1?1:f,d=this.compute(f),d.t=f,d.d=l,d}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?K.computeWithRatios(e,this.points,this.ratios,this._3d):K.compute(e,this.points,this._3d,this.ratios)}raise(){const e=this.points,n=[e[0]],i=e.length;for(let s=1,o,a;s<i;s++)o=e[s],a=e[s-1],n[s]={x:(i-s)/i*o.x+s/i*a.x,y:(i-s)/i*o.y+s/i*a.y};return n[i]=e[i-1],new Ut(n)}derivative(e){return K.compute(e,this.dpoints[0],this._3d)}dderivative(e){return K.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new Ut(K.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return K.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return K.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const n=this.derivative(e),i=Vr(n.x*n.x+n.y*n.y);return{t:e,x:-n.y/i,y:n.x/i}}__normal3(e){const n=this.derivative(e),i=this.derivative(e+.01),s=Vr(n.x*n.x+n.y*n.y+n.z*n.z),o=Vr(i.x*i.x+i.y*i.y+i.z*i.z);n.x/=s,n.y/=s,n.z/=s,i.x/=o,i.y/=o,i.z/=o;const a={x:i.y*n.z-i.z*n.y,y:i.z*n.x-i.x*n.z,z:i.x*n.y-i.y*n.x},h=Vr(a.x*a.x+a.y*a.y+a.z*a.z);a.x/=h,a.y/=h,a.z/=h;const c=[a.x*a.x,a.x*a.y-a.z,a.x*a.z+a.y,a.x*a.y+a.z,a.y*a.y,a.y*a.z-a.x,a.x*a.z-a.y,a.y*a.z+a.x,a.z*a.z];return{t:e,x:c[0]*n.x+c[1]*n.y+c[2]*n.z,y:c[3]*n.x+c[4]*n.y+c[5]*n.z,z:c[6]*n.x+c[7]*n.y+c[8]*n.z}}hull(e){let n=this.points,i=[],s=[],o=0;for(s[o++]=n[0],s[o++]=n[1],s[o++]=n[2],this.order===3&&(s[o++]=n[3]);n.length>1;){i=[];for(let a=0,h,c=n.length-1;a<c;a++)h=K.lerp(e,n[a],n[a+1]),s[o++]=h,i.push(h);n=i}return s}split(e,n){if(e===0&&n)return this.split(n).left;if(n===1)return this.split(e).right;const i=this.hull(e),s={left:this.order===2?new Ut([i[0],i[3],i[5]]):new Ut([i[0],i[4],i[7],i[9]]),right:this.order===2?new Ut([i[5],i[4],i[2]]):new Ut([i[9],i[8],i[6],i[3]]),span:i};return s.left._t1=K.map(0,0,1,this._t1,this._t2),s.left._t2=K.map(e,0,1,this._t1,this._t2),s.right._t1=K.map(e,0,1,this._t1,this._t2),s.right._t2=K.map(1,0,1,this._t1,this._t2),n?(n=K.map(n,e,1,0,1),s.right.split(n).left):s}extrema(){const e={};let n=[];return this.dims.forEach((function(i){let s=function(a){return a[i]},o=this.dpoints[0].map(s);e[i]=K.droots(o),this.order===3&&(o=this.dpoints[1].map(s),e[i]=e[i].concat(K.droots(o))),e[i]=e[i].filter(function(a){return a>=0&&a<=1}),n=n.concat(e[i].sort(K.numberSort))}).bind(this)),e.values=n.sort(K.numberSort).filter(function(i,s){return n.indexOf(i)===s}),e}bbox(){const e=this.extrema(),n={};return this.dims.forEach((function(i){n[i]=K.getminmax(this,i,e[i])}).bind(this)),n}overlaps(e){const n=this.bbox(),i=e.bbox();return K.bboxoverlap(n,i)}offset(e,n){if(typeof n<"u"){const i=this.get(e),s=this.normal(e),o={c:i,n:s,x:i.x+s.x*n,y:i.y+s.y*n};return this._3d&&(o.z=i.z+s.z*n),o}if(this._linear){const i=this.normal(0),s=this.points.map(function(o){const a={x:o.x+e*i.x,y:o.y+e*i.y};return o.z&&i.z&&(a.z=o.z+e*i.z),a});return[new Ut(s)]}return this.reduce().map(function(i){return i._linear?i.offset(e)[0]:i.scale(e)})}simple(){if(this.order===3){const s=K.angle(this.points[0],this.points[3],this.points[1]),o=K.angle(this.points[0],this.points[3],this.points[2]);if(s>0&&o<0||s<0&&o>0)return!1}const e=this.normal(0),n=this.normal(1);let i=e.x*n.x+e.y*n.y;return this._3d&&(i+=e.z*n.z),$r(Kw(i))<tb/3}reduce(){let e,n=0,i=0,s=.01,o,a=[],h=[],c=this.extrema().values;for(c.indexOf(0)===-1&&(c=[0].concat(c)),c.indexOf(1)===-1&&c.push(1),n=c[0],e=1;e<c.length;e++)i=c[e],o=this.split(n,i),o._t1=n,o._t2=i,a.push(o),n=i;return a.forEach(function(l){for(n=0,i=0;i<=1;)for(i=n+s;i<=1+s;i+=s)if(o=l.split(n,i),!o.simple()){if(i-=s,$r(n-i)<s)return[];o=l.split(n,i),o._t1=K.map(n,0,1,l._t1,l._t2),o._t2=K.map(i,0,1,l._t1,l._t2),h.push(o),n=i;break}n<1&&(o=l.split(n,1),o._t1=K.map(n,0,1,l._t1,l._t2),o._t2=l._t2,h.push(o))}),h}translate(e,n,i){i=typeof i=="number"?i:n;const s=this.order;let o=this.points.map((a,h)=>(1-h/s)*n+h/s*i);return new Ut(this.points.map((a,h)=>({x:a.x+e.x*o[h],y:a.y+e.y*o[h]})))}scale(e){const n=this.order;let i=!1;if(typeof e=="function"&&(i=e),i&&n===2)return this.raise().scale(i);const s=this.clockwise,o=this.points;if(this._linear)return this.translate(this.normal(0),i?i(0):e,i?i(1):e);const a=i?i(0):e,h=i?i(1):e,c=[this.offset(0,10),this.offset(1,10)],l=[],u=K.lli4(c[0],c[0].c,c[1],c[1].c);if(!u)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(f){const d=l[f*n]=K.copy(o[f*n]);d.x+=(f?h:a)*c[f].n.x,d.y+=(f?h:a)*c[f].n.y}),i?([0,1].forEach(function(f){if(!(n===2&&f)){var d=o[f+1],p={x:d.x-u.x,y:d.y-u.y},y=i?i((f+1)/n):e;i&&!s&&(y=-y);var x=Vr(p.x*p.x+p.y*p.y);p.x/=x,p.y/=x,l[f+1]={x:d.x+y*p.x,y:d.y+y*p.y}}}),new Ut(l)):([0,1].forEach(f=>{if(n===2&&f)return;const d=l[f*n],p=this.derivative(f),y={x:d.x+p.x,y:d.y+p.y};l[f+1]=K.lli4(d,y,u,o[f+1])}),new Ut(l))}outline(e,n,i,s){if(n=n===void 0?e:n,this._linear){const E=this.normal(0),A=this.points[0],I=this.points[this.points.length-1];let b,v,_;i===void 0&&(i=e,s=n),b={x:A.x+E.x*e,y:A.y+E.y*e},_={x:I.x+E.x*i,y:I.y+E.y*i},v={x:(b.x+_.x)/2,y:(b.y+_.y)/2};const z=[b,v,_];b={x:A.x-E.x*n,y:A.y-E.y*n},_={x:I.x-E.x*s,y:I.y-E.y*s},v={x:(b.x+_.x)/2,y:(b.y+_.y)/2};const P=[_,v,b],k=K.makeline(P[2],z[0]),B=K.makeline(z[2],P[0]),R=[k,new Ut(z),B,new Ut(P)];return new Dr(R)}const o=this.reduce(),a=o.length,h=[];let c=[],l,u=0,f=this.length();const d=typeof i<"u"&&typeof s<"u";function p(E,A,I,b,v){return function(_){const z=b/I,P=(b+v)/I,k=A-E;return K.map(_,0,1,E+z*k,E+P*k)}}o.forEach(function(E){const A=E.length();d?(h.push(E.scale(p(e,i,f,u,A))),c.push(E.scale(p(-n,-s,f,u,A)))):(h.push(E.scale(e)),c.push(E.scale(-n))),u+=A}),c=c.map(function(E){return l=E.points,l[3]?E.points=[l[3],l[2],l[1],l[0]]:E.points=[l[2],l[1],l[0]],E}).reverse();const y=h[0].points[0],x=h[a-1].points[h[a-1].points.length-1],m=c[a-1].points[c[a-1].points.length-1],g=c[0].points[0],w=K.makeline(m,y),M=K.makeline(x,g),S=[w].concat(h).concat([M]).concat(c);return new Dr(S)}outlineshapes(e,n,i){n=n||e;const s=this.outline(e,n).curves,o=[];for(let a=1,h=s.length;a<h/2;a++){const c=K.makeshape(s[a],s[h-a],i);c.startcap.virtual=a>1,c.endcap.virtual=a<h/2-1,o.push(c)}return o}intersects(e,n){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof Ut&&(e=e.reduce()),this.curveintersects(this.reduce(),e,n)):this.selfintersects(n)}lineIntersects(e){const n=yd(e.p1.x,e.p2.x),i=yd(e.p1.y,e.p2.y),s=xd(e.p1.x,e.p2.x),o=xd(e.p1.y,e.p2.y);return K.roots(this.points,e).filter(a=>{var h=this.get(a);return K.between(h.x,n,s)&&K.between(h.y,i,o)})}selfintersects(e){const n=this.reduce(),i=n.length-2,s=[];for(let o=0,a,h,c;o<i;o++)h=n.slice(o,o+1),c=n.slice(o+2),a=this.curveintersects(h,c,e),s.push(...a);return s}curveintersects(e,n,i){const s=[];e.forEach(function(a){n.forEach(function(h){a.overlaps(h)&&s.push({left:a,right:h})})});let o=[];return s.forEach(function(a){const h=K.pairiteration(a.left,a.right,i);h.length>0&&(o=o.concat(h))}),o}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,n,i,s){const o=(s-i)/4,a=this.get(i+o),h=this.get(s-o),c=K.dist(e,n),l=K.dist(e,a),u=K.dist(e,h);return $r(l-c)+$r(u-c)}_iterate(e,n){let i=0,s=1,o;do{o=0,s=1;let a=this.get(i),h,c,l,u,f=!1,d=!1,p,y=s,x=1;do if(d=f,u=l,y=(i+s)/2,h=this.get(y),c=this.get(s),l=K.getccenter(a,h,c),l.interval={start:i,end:s},f=this._error(l,a,i,s)<=e,p=d&&!f,p||(x=s),f){if(s>=1){if(l.interval.end=x=1,u=l,s>1){let g={x:l.x+l.r*Jw(l.e),y:l.y+l.r*Qw(l.e)};l.e+=K.angle({x:l.x,y:l.y},g,this.get(1))}break}s=s+(s-i)/2}else s=y;while(!p&&o++<100);if(o>=100)break;u=u||l,n.push(u),i=x}while(s<1);return n}}const Hs=O.distanceSquared,ra=Math.pow,wi=Math.sqrt,oa=1e-8,md=1e-4,gd=wi(3),aa=1/3,kn=O.default(),Qe=O.default(),Xs=O.default();function bi(r){return r>-oa&&r<oa}function wd(r){return r>oa||r<-oa}function _e(r,e,n,i,s){const o=1-s;return o*o*(o*r+3*s*e)+s*s*(s*i+3*o*n)}function eb(r,e,n,i,s){const o=1-s;return 3*(((e-r)*o+2*(n-e)*s)*o+(i-n)*s*s)}function bd(r,e,n,i,s,o){const a=i+3*(e-n)-r,h=3*(n-e*2+r),c=3*(e-r),l=r-s,u=h*h-3*a*c,f=h*c-9*a*l,d=c*c-3*h*l;let p=0;if(bi(u)&&bi(f))if(bi(h))o[0]=0;else{const y=-c/h;y>=0&&y<=1&&(o[p++]=y)}else{const y=f*f-4*u*d;if(bi(y)){const x=f/u,m=-h/a+x,g=-x/2;m>=0&&m<=1&&(o[p++]=m),g>=0&&g<=1&&(o[p++]=g)}else if(y>0){const x=wi(y);let m=u*h+1.5*a*(-f+x),g=u*h+1.5*a*(-f-x);m<0?m=-ra(-m,aa):m=ra(m,aa),g<0?g=-ra(-g,aa):g=ra(g,aa);const w=(-h-(m+g))/(3*a);w>=0&&w<=1&&(o[p++]=w)}else{const x=(2*u*h-3*a*f)/(2*wi(u*u*u)),m=Math.acos(x)/3,g=wi(u),w=Math.cos(m),M=(-h-2*g*w)/(3*a),S=(-h+g*(w+gd*Math.sin(m)))/(3*a),E=(-h+g*(w-gd*Math.sin(m)))/(3*a);M>=0&&M<=1&&(o[p++]=M),S>=0&&S<=1&&(o[p++]=S),E>=0&&E<=1&&(o[p++]=E)}}return p}function Ac(r,e,n,i,s){const o=6*n-12*e+6*r,a=9*e+3*i-3*r-9*n,h=3*e-3*r;let c=0;if(bi(a)){if(wd(o)){const l=-h/o;l>=0&&l<=1&&(s[c++]=l)}}else{const l=o*o-4*a*h;if(bi(l))s[0]=-o/(2*a);else if(l>0){const u=wi(l),f=(-o+u)/(2*a),d=(-o-u)/(2*a);f>=0&&f<=1&&(s[c++]=f),d>=0&&d<=1&&(s[c++]=d)}}return c}function Cc(r,e,n,i,s,o){const a=(e-r)*s+r,h=(n-e)*s+e,c=(i-n)*s+n,l=(h-a)*s+a,u=(c-h)*s+h,f=(u-l)*s+l;o[0]=r,o[1]=a,o[2]=l,o[3]=f,o[4]=f,o[5]=u,o[6]=c,o[7]=i}function nb(r,e,n,i,s,o,a,h,c,l,u){let f=0,d=.005,p=1/0,y,x,m,g;kn[0]=c,kn[1]=l;for(let w=0;w<1;w+=.05)Qe[0]=_e(r,n,s,a,w),Qe[1]=_e(e,i,o,h,w),m=Hs(kn,Qe),m<p&&(f=w,p=m);p=1/0;for(let w=0;w<32&&!(d<md);w++)y=f-d,x=f+d,Qe[0]=_e(r,n,s,a,y),Qe[1]=_e(e,i,o,h,y),m=Hs(Qe,kn),y>=0&&m<p?(f=y,p=m):(Xs[0]=_e(r,n,s,a,x),Xs[1]=_e(e,i,o,h,x),g=Hs(Xs,kn),x<=1&&g<p?(f=x,p=g):d*=.5);return u&&(u[0]=_e(r,n,s,a,f),u[1]=_e(e,i,o,h,f)),wi(p)}function vd(r,e,n,i,s,o,a,h,c){let l=r,u=e,f=0;const d=1/c;for(let p=1;p<=c;p++){let y=p*d;const x=_e(r,n,s,a,y),m=_e(e,i,o,h,y),g=x-l,w=m-u;f+=Math.sqrt(g*g+w*w),l=x,u=m}return f}function Se(r,e,n,i){const s=1-i;return s*(s*r+2*i*e)+i*i*n}function ib(r,e,n,i){return 2*((1-i)*(e-r)+i*(n-e))}function Md(r,e,n,i,s){const o=r-2*e+n,a=2*(e-r),h=r-i;let c=0;if(bi(o)){if(wd(a)){const l=-h/a;l>=0&&l<=1&&(s[c++]=l)}}else{const l=a*a-4*o*h;if(bi(l)){const u=-a/(2*o);u>=0&&u<=1&&(s[c++]=u)}else if(l>0){const u=wi(l),f=(-a+u)/(2*o),d=(-a-u)/(2*o);f>=0&&f<=1&&(s[c++]=f),d>=0&&d<=1&&(s[c++]=d)}}return c}function Pc(r,e,n){const i=r+n-2*e;return i===0?.5:(r-e)/i}function Ic(r,e,n,i,s){const o=(e-r)*i+r,a=(n-e)*i+e,h=(a-o)*i+o;s[0]=r,s[1]=o,s[2]=h,s[3]=h,s[4]=a,s[5]=n}function sb(r,e,n,i,s,o,a,h,c){let l=0,u=.005,f=1/0;kn[0]=a,kn[1]=h;for(let d=0;d<1;d+=.05){Qe[0]=Se(r,n,s,d),Qe[1]=Se(e,i,o,d);const p=Hs(kn,Qe);p<f&&(l=d,f=p)}f=1/0;for(let d=0;d<32&&!(u<md);d++){const p=l-u,y=l+u;Qe[0]=Se(r,n,s,p),Qe[1]=Se(e,i,o,p);const x=Hs(Qe,kn);if(p>=0&&x<f)l=p,f=x;else{Xs[0]=Se(r,n,s,y),Xs[1]=Se(e,i,o,y);const m=Hs(Xs,kn);y<=1&&m<f?(l=y,f=m):u*=.5}}return c&&(c[0]=Se(r,n,s,l),c[1]=Se(e,i,o,l)),wi(f)}function _d(r,e,n,i,s,o,a){let h=r,c=e,l=0;const u=1/a;for(let f=1;f<=a;f++){let d=f*u;const p=Se(r,n,s,d),y=Se(e,i,o,d),x=p-h,m=y-c;l+=Math.sqrt(x*x+m*m),h=p,c=y}return l}const rb=Object.freeze(Object.defineProperty({__proto__:null,cubicAt:_e,cubicDerivativeAt:eb,cubicExtrema:Ac,cubicLength:vd,cubicProjectPoint:nb,cubicRootAt:bd,cubicSubdivide:Cc,quadraticAt:Se,quadraticDerivativeAt:ib,quadraticExtremum:Pc,quadraticLength:_d,quadraticProjectPoint:sb,quadraticRootAt:Md,quadraticSubdivide:Ic},Symbol.toStringTag,{value:"Module"}));class ob{xs;ys;ks;constructor(e,n){this.xs=e,this.ys=n,this.ks=this.getNaturalKs(new Float64Array(this.xs.length))}getNaturalKs(e){const n=this.xs.length-1,i=hb(n+1,n+2);for(let s=1;s<n;s++)i[s][s-1]=1/(this.xs[s]-this.xs[s-1]),i[s][s]=2*(1/(this.xs[s]-this.xs[s-1])+1/(this.xs[s+1]-this.xs[s])),i[s][s+1]=1/(this.xs[s+1]-this.xs[s]),i[s][n+1]=3*((this.ys[s]-this.ys[s-1])/((this.xs[s]-this.xs[s-1])*(this.xs[s]-this.xs[s-1]))+(this.ys[s+1]-this.ys[s])/((this.xs[s+1]-this.xs[s])*(this.xs[s+1]-this.xs[s])));return i[0][0]=2/(this.xs[1]-this.xs[0]),i[0][1]=1/(this.xs[1]-this.xs[0]),i[0][n+1]=3*(this.ys[1]-this.ys[0])/((this.xs[1]-this.xs[0])*(this.xs[1]-this.xs[0])),i[n][n-1]=1/(this.xs[n]-this.xs[n-1]),i[n][n]=2/(this.xs[n]-this.xs[n-1]),i[n][n+1]=3*(this.ys[n]-this.ys[n-1])/((this.xs[n]-this.xs[n-1])*(this.xs[n]-this.xs[n-1])),ab(i,e)}getIndexBefore(e){let n=0,i=this.xs.length,s=0;for(;n<i;)s=Math.floor((n+i)/2),this.xs[s]<e&&s!==n?n=s:this.xs[s]>=e&&s!==i?i=s:i=n;return n===this.xs.length-1?this.xs.length-1:n+1}at(e){let n=this.getIndexBefore(e);const i=(e-this.xs[n-1])/(this.xs[n]-this.xs[n-1]),s=this.ks[n-1]*(this.xs[n]-this.xs[n-1])-(this.ys[n]-this.ys[n-1]),o=-this.ks[n]*(this.xs[n]-this.xs[n-1])+(this.ys[n]-this.ys[n-1]);return(1-i)*this.ys[n-1]+i*this.ys[n]+i*(1-i)*(s*(1-i)+o*i)}}function ab(r,e){const n=r.length;let i=0,s=0;for(;i<n&&s<=n;){let a=0,h=-1/0;for(let c=i;c<n;c++){const l=Math.abs(r[c][s]);l>h&&(a=c,h=l)}if(r[a][s]===0)s++;else{cb(r,i,a);for(let c=i+1;c<n;c++){const l=r[c][s]/r[i][s];r[c][s]=0;for(let u=s+1;u<=n;u++)r[c][u]-=r[i][u]*l}i++,s++}}for(let a=n-1;a>=0;a--){var o=0;r[a][a]&&(o=r[a][n]/r[a][a]),e[a]=o;for(let h=a-1;h>=0;h--)r[h][n]-=r[h][a]*o,r[h][a]=0}return e}function hb(r,e){const n=[];for(let i=0;i<r;i++)n.push(new Float64Array(e));return n}function cb(r,e,n){let i=r[e];r[e]=r[n],r[n]=i}class kc{length=0;advance=1;_currentIndex=0;data=[];constructor(e,n=e.length,i=!1,s=0){this.data=e,this.length=n,this.advance=i?-1:1,this._currentIndex=Math.floor(s)%n}get current(){return this.data[this._currentIndex]}get(e=0){const n=(this._currentIndex+e*this.advance)%this.length;return this.data[n]}next(e=0){return this._currentIndex=(this._currentIndex+this.advance+e*this.advance)%this.length,this.current}}class lb extends kc{constructor(e,n=!1,i=0){super([O.create(e.cx,e.top),O.create(e.right,e.cy),O.create(e.cx,e.bottom),O.create(e.left,e.cy)],4,n,i)}}class Rc extends kc{constructor(e,n=!1,i=0){super([O.create(e.left,e.top),O.create(e.right,e.top),O.create(e.right,e.bottom),O.create(e.left,e.bottom)],4,n,i)}}class Zn{static default(){return this.fromLTRB(0,0,0,0)}static from(e,n){return this.fromXYWH(e.x,e.x,n.width,n.height)}static fromXYWH(e,n,i,s){return new Zn(e,n,e+i,n+s)}static fromLTRB(e,n,i,s){return new Zn(e,n,i,s)}left=0;top=0;right=0;bottom=0;constructor(e=0,n=0,i=0,s=0){this.left=e,this.top=n,this.right=i,this.bottom=s}get x(){return this.left}get y(){return this.top}get width(){return this.right-this.left}get height(){return this.bottom-this.top}get halfWidth(){return this.width*.5}get halfHeight(){return this.height*.5}get cx(){return(this.left+this.right)/2}get cy(){return(this.top+this.bottom)/2}isEmpty(){return!(this.left<this.right&&this.top<this.bottom)}copy(e){return this.left=e.left,this.top=e.top,this.right=e.right,this.bottom=e.bottom,this}clone(){return new Zn(this.left,this.top,this.right,this.bottom)}offset(e,n){return this.left+=e,this.right+=e,this.top+=n,this.bottom+=n,this}isSorted(){return this.left<=this.right&&this.top<=this.bottom}isFinite(){let e=0;return e*=this.left,e*=this.top,e*=this.right,e*=this.bottom,Number.isFinite(e)}makeSorted(){const e=this.left,n=this.right,i=this.top,s=this.bottom;return Zn.fromLTRB(Math.min(e,n),Math.min(i,s),Math.max(e,n),Math.max(i,s))}}class ub extends kc{constructor(e,n=!1,i=0){super([],8,n,i);const s=e.getBounds(),o=s.left,a=s.top,h=s.right,c=s.bottom,l=[];l[0]=O.create(o+e.radii(dn.kUpperLeft_Corner).x,a),l[1]=O.create(h-e.radii(dn.kUpperRight_Corner).x,a),l[2]=O.create(h,a+e.radii(dn.kUpperRight_Corner).y),l[3]=O.create(h,c-e.radii(dn.kLowerRight_Corner).y),l[4]=O.create(h-e.radii(dn.kLowerRight_Corner).x,c),l[5]=O.create(o+e.radii(dn.kLowerLeft_Corner).x,c),l[6]=O.create(o,c-e.radii(dn.kLowerLeft_Corner).y),l[7]=O.create(o,a+e.radii(dn.kUpperLeft_Corner).y),this.data=l}}function Sd(r){let e=!0;for(let n=0;n<4;++n)r[n].x<=0||r[n].y<=0?(r[n].x=0,r[n].y=0):e=!1;return e}function ha(r,e,n,i){return r+e>n?Math.min(i,n/(r+e)):i}function ca(r,e,n){r[n]+e[n]==r[n]?e[n]=0:r[n]+e[n]==e[n]&&(r[n]=0)}function fb(r,e){if(r===e)return r;const n=r>e?-1:1,i=Number.EPSILON*Math.abs(r)||Number.MIN_VALUE;return r+n*i}function la(r,e,n,i,s){if(n[s]=n[s]*e,i[s]=i[s]*e,n[s]+i[s]>r){let o=n,a=i;o[s]>a[s]&&([a,o]=[o,a]);let h=o[s],c=r-h;for(;c+h>r;)c=fb(c,0);a[s]=c}}function Td(r){return r[0].x==r[3].x&&r[0].y==r[1].y&&r[1].x==r[2].x&&r[3].y==r[2].y}function Ed(r,e,n){return e<=n&&r<=n-e&&e+r<=n&&n-r>=e&&r>=0}class dn{static default(){return new dn}static fromRect(e){return this.default().setRect(e)}static fromOval(e){return this.default().setOval(e)}static kUpperLeft_Corner=0;static kUpperRight_Corner=1;static kLowerRight_Corner=2;static kLowerLeft_Corner=3;type=0;_rect=Zn.default();_radii=[O.default(),O.default(),O.default(),O.default()];radii(e){return this._radii[e]}getType(){return this.type}getBounds(){return this._rect}isEmpty(){return this.type==0}isOval(){return this.type==2}isRect(){return this.type==1}resetRadii(){this._radii.forEach(e=>{e.setXY(0,0)})}copyDadii(e){e.forEach((n,i)=>{this._radii[i].copy(n)})}scaleRadii(){let e=1,n=this._rect,i=this._radii,s=n.right-n.left,o=n.bottom-n.top;return e=ha(i[0].x,i[1].x,s,e),e=ha(i[1].y,i[2].y,o,e),e=ha(i[2].x,i[3].x,s,e),e=ha(i[3].y,i[0].y,o,e),ca(i[0],i[1],0),ca(i[1],i[2],1),ca(i[2],i[3],0),ca(i[3],i[0],1),e<1&&(la(s,e,i[0],i[1],0),la(o,e,i[1],i[2],1),la(s,e,i[2],i[3],0),la(o,e,i[3],i[0],1)),Sd(i),this.computeType(),e<1}initializeRect(e){return e.isFinite()?(this._rect=e.makeSorted(),this._rect.isEmpty()?(this.resetRadii(),this.type=0,!1):!0):(this._rect=Zn.default(),!1)}setRectRadii(e,n){if(this.initializeRect(e)){if(n.every(i=>i.x==0)){this.setRect(e);return}if(this.copyDadii(n),Sd(this._radii)){this.setRect(e);return}this.scaleRadii(),this.isValid()||this.setRect(e)}}setRect(e){return this._rect.copy(e),this.resetRadii(),this.type=1,this}setOval(e){if(e.isEmpty()||!e.isFinite())return;this._rect.copy(e.makeSorted());let n=this._rect.halfWidth,i=this._rect.halfHeight;if(n==0||i==0)this.resetRadii(),this.type=1;else{for(let s=0;s<4;++s)this._radii[s].setXY(n,i);this.type=2}}get width(){return this._rect.width}get height(){return this._rect.height}computeType(){if(this._rect.isEmpty()){this.type=0;return}let e=this._radii,n=this._rect,i=!0,s=e[0].x==0||e[0].y==0;for(let o=1;o<4;++o)e[o].x!=0&&e[o].y!=0&&(s=!1),(e[o].x!=e[o-1].x||e[o].y!=e[o-1].y)&&(i=!1);if(s){this.type=1;return}if(i){e[0].x>=n.halfWidth&&e[0].y>=n.halfHeight?this.type=2:this.type=3;return}Td(e)?this.type=4:this.type=5,this.isValid()||this.setRect(this._rect)}areRectAndRadiiValid(e,n){if(!e.isFinite()||!e.isSorted())return!1;for(let i=0;i<4;++i)if(!Ed(n[i].x,e.left,e.right)||!Ed(n[i].y,e.top,e.bottom))return!1;return!0}isValid(){let e=this.type,n=this._rect,i=this._radii;if(!this.areRectAndRadiiValid(n,i))return!1;let s=i[0].x==0&&i[0].y==0,o=i[0].x==0||i[0].y==0,a=!0;for(let c=1;c<4;++c)(i[c].x!=0||i[c].y!=0)&&(s=!1),(i[c].x!=i[c-1].x||i[c].y!=i[c-1].y)&&(a=!1),i[c].x!=0&&i[c].y!=0&&(o=!1);let h=Td(i);if(e<0||e>5)return!1;switch(e){case 0:if(!n.isEmpty()||!s||!a||!o)return!1;break;case 1:if(n.isEmpty()||!s||!a||!o)return!1;break;case 2:if(n.isEmpty()||s||!a||o)return!1;for(let c=0;c<4;++c)if(!(Math.abs(i[c].x-n.halfWidth)<=1e-6)||!(Math.abs(i[c].y-n.halfHeight)<=1e-6))return!1;break;case 3:if(n.isEmpty()||s||!a||o)return!1;break;case 4:if(n.isEmpty()||s||a||o||!h)return!1;break;case 5:if(n.isEmpty()||s||a||o||h)return!1;break}return!0}}function db(r){let e={tl:0,tr:0,br:0,bl:0};return typeof r=="number"?e={tl:r,tr:r,br:r,bl:r}:Array.isArray(r)?r.length===1?e={tl:r[0],tr:r[0],br:r[0],bl:r[0]}:r.length===2?e={tl:r[0],tr:r[1],br:r[0],bl:r[1]}:r.length===3?e={tl:r[0],tr:r[1],br:r[2],bl:r[1]}:r.length===4&&(e={tl:r[0],tr:r[1],br:r[2],bl:r[3]}):r&&(e.tl=r.x??0,e.tr=r.y??0,e.bl=r.z??0,e.br=r.w??0),e}function zd(r){return r!==null&&typeof r=="object"&&("x"in r||"y"in r)&&(typeof r.x=="number"||typeof r.y=="number"||typeof r.x>"u"||typeof r.y>"u")}function pb(r){return typeof r=="number"?{x:r,y:r}:{x:typeof r.x=="number"?r.x:0,y:typeof r.y=="number"?r.y:0}}function yb(r,e,n,i,s=0){if(typeof s=="number")s=[s];else if(zd(s))s=[s];else if(!Array.isArray(s))return;if(Array.isArray(s)){if(s.length===0||s.length>4)throw new RangeError(`Failed to execute 'roundRect' on '${this.constructor.name}': ${s.length} radii provided. Between one and four radii are necessary.`);s.forEach(d=>{if(zd(d)){const p=d;if(typeof p.x=="number"&&p.x<0)throw new RangeError(`Failed to execute 'roundRect' on '${this.constructor.name}': Radius value ${p.x} is negative.`);if(typeof p.y=="number"&&p.y<0)throw new RangeError(`Failed to execute 'roundRect' on '${this.constructor.name}': Radius value ${p.y} is negative.`)}else{if(typeof d!="number")throw new TypeError(`Failed to execute 'roundRect' on '${this.constructor.name}': Radius value ${d} is not a number or DOMPointInit.`);if(typeof d=="number"&&d<0)throw new RangeError(`Failed to execute 'roundRect' on '${this.constructor.name}': Radius value ${d} is negative.`)}})}const o=s.map(pb);if(s.length===1&&o[0].x===0&&o[0].y===0){this.rect(r,e,n,i);return}const a=n/2,h=i/2,c={x:Math.min(a,o[0].x),y:Math.min(h,o[0].y)};let l=c,u=c,f=c;o.length===2&&(l={x:Math.min(a,o[1].x),y:Math.min(h,o[1].y)},f=l),o.length===3&&(l={x:Math.min(a,o[1].x),y:Math.min(h,o[1].y)},f=l,u={x:Math.min(a,o[2].x),y:Math.min(h,o[2].y)}),o.length===4&&(l={x:Math.min(a,o[1].x),y:Math.min(h,o[1].y)},u={x:Math.min(a,o[2].x),y:Math.min(h,o[2].y)},f={x:Math.min(a,o[3].x),y:Math.min(h,o[3].y)}),this.moveTo(r,e+i-f.y),c.x===c.y&&c.x>0?this.arcTo(r,e,r+c.x,e,c.x):c.x>0||c.y>0?this.ellipse(r+c.x,e+c.y,c.x,c.y,0,Math.PI,Math.PI*1.5,!1):this.lineTo(r,e),this.lineTo(r+n-l.x,e),l.x===l.y&&l.x>0?this.arcTo(r+n,e,r+n,e+l.y,l.x):l.x>0||l.y>0?this.ellipse(r+n-l.x,e+l.y,l.x,l.y,0,Math.PI*1.5,0,!1):this.lineTo(r+n,e),this.lineTo(r+n,e+i-u.y),u.x===u.y&&u.x>0?this.arcTo(r+n,e+i,r+n-u.x,e+i,u.x):u.x>0||u.y>0?this.ellipse(r+n-u.x,e+i-u.y,u.x,u.y,0,0,Math.PI*.5,!1):this.lineTo(r+n,e+i),this.lineTo(r+f.x,e+i),f.x===f.y&&f.x>0?this.arcTo(r,e+i,r,e+i-f.y,f.x):f.x>0||f.y>0?this.ellipse(r+f.x,e+i-f.y,f.x,f.y,0,Math.PI*.5,Math.PI,!1):this.lineTo(r,e+i),this.closePath(),this.moveTo(r,e)}const Ad=Math.PI*2;function Cd(r,e,n=!1){const i=Math.PI*2;let s=r%i;s<=0&&(s+=i);let o=s-r;return r=s,e+=o,!n&&e-r>=i?e=r+i:n&&r-e>=i?e=r-i:!n&&r>e?e=r+(i-(r-e)%i):n&&r<e&&(e=r-(i-(e-r)%i)),{startAngle:r,endAngle:e}}var ua=(r=>(r[r.CW=0]="CW",r[r.CCW=1]="CCW",r[r.Unknown=2147483647]="Unknown",r))(ua||{}),ne=(r=>(r[r.MoveTo=0]="MoveTo",r[r.LineTo=1]="LineTo",r[r.QuadCurveTo=2]="QuadCurveTo",r[r.CubicCurveTo=3]="CubicCurveTo",r[r.ConicTo=4]="ConicTo",r[r.Close=5]="Close",r))(ne||{}),Pd=(r=>(r[r.MoveTo=0]="MoveTo",r[r.LineTo=1]="LineTo",r[r.QuadCurveTo=2]="QuadCurveTo",r[r.ConicTo=4]="ConicTo",r[r.CubicCurveTo=3]="CubicCurveTo",r[r.Close=5]="Close",r[r.Done=6]="Done",r))(Pd||{}),Id=(r=>(r[r.Line_SegmentMask=1]="Line_SegmentMask",r[r.Quad_SegmentMask=2]="Quad_SegmentMask",r[r.Conic_SegmentMask=4]="Conic_SegmentMask",r[r.Cubic_SegmentMask=8]="Cubic_SegmentMask",r))(Id||{});class Di{static default(){return new this}static fromVectices(e){const n=this.default();for(let i=0;i<e.length;i+=2)i===0?n.moveTo(e[i],e[i+1]):n.lineTo(e[i],e[i+1]);return n}static fromPoints(e){const n=this.default();for(let i=0;i<e.length;i++)i===0?n.moveTo(e[i].x,e[i].y):n.lineTo(e[i].x,e[i].y);return n}points=[];verbs=[];_segmentMask=1;_lastMovePointIndex=0;_needMoveTo=!0;_bounds=null;reset(){return this._needMoveTo=!0,this.points.length=0,this.verbs.length=0,this._lastMovePointIndex=0,this._bounds=null,this._segmentMask=1,this}clear(){return this.reset()}get isEmpty(){return this.verbs.length===0}get lastVerb(){return this.verbs[this.verbs.length-1]}get lastPoint(){const e=this.points[this.points.length-2]||0,n=this.points[this.points.length-1]||0;return{x:e,y:n}}get length(){return this.points.length}setLastPoint(e,n){return this.isEmpty?this.moveTo(e,n):(this.points[this.length-2]=e,this.points[this.length-1]=n),this}addPoint(e,n){return this.points.push(e,n),this._bounds=null,this}addVerb(e){return this.verbs.push(e),this}injectMoveToIfNeeded(){this._needMoveTo&&(this.length<=0?this.moveTo(0,0):this.moveTo(this.points[this.length-2],this.points[this.length-1]))}moveTo(e,n){return this._needMoveTo=!1,this.lastVerb===0?(this.points[this._lastMovePointIndex]=e,this.points[this._lastMovePointIndex+1]=n):(this._lastMovePointIndex=this.points.length,this.addVerb(0),this.addPoint(e,n)),this}lineTo(e,n){return this.injectMoveToIfNeeded(),this.addVerb(1),this._segmentMask|=1,this.addPoint(e,n)}quadraticCurveTo(e,n,i,s){return this.injectMoveToIfNeeded(),this.addVerb(2),this.addPoint(e,n),this._segmentMask|=2,this.addPoint(i,s)}bezierCurveTo(e,n,i,s,o,a){return this.cubicCurveTo(e,n,i,s,o,a)}cubicCurveTo(e,n,i,s,o,a){return this.injectMoveToIfNeeded(),this.addVerb(3),this.addPoint(e,n),this.addPoint(i,s),this._segmentMask|=8,this.addPoint(o,a)}conicTo(e,n,i,s,o){const a=4*o/(3*(o+1)),h=this.lastPoint,c=h.x+(e-h.x)*a,l=h.y+(n-h.y)*a,u=i+(e-i)*a,f=s+(n-s)*a;return this.cubicCurveTo(c,l,u,f,i,s)}closePath(){return this.isEmpty||(this.lastVerb!==5&&this.addVerb(5),this._needMoveTo=!0),this}rect(e,n,i,s){return this.moveTo(e,n),this.lineTo(e+i,n),this.lineTo(e+i,n+s),this.lineTo(e,n+s),this.closePath()}roundRect(e,n,i,s,o){let a=db(o);const h=[O.create(a.tl,a.tl),O.create(a.tr,a.tr),O.create(a.br,a.br),O.create(a.bl,a.bl)];let c=dn.default();c.setRectRadii(Zn.fromXYWH(e,n,i,s),h),this.addRRect(c)}roundRect2(e,n,i,s,o=0){yb.call(this,e,n,i,s,o)}ellipse2(e,n,i,s,o=0,a=0,h=Ad,c=!1){({startAngle:a,endAngle:h}=Cd(a,h,c));let l=h-a,u=a;if(Math.abs(l-Math.PI*2)<=1e-6){const f=l/2;this.arcToOval(e,n,i,s,o,u,f,!0),this.arcToOval(e,n,i,s,o,u+f,f,!1)}else this.arcToOval(e,n,i,s,o,u,l,!0)}ellipse(e,n,i,s,o=0,a=0,h=Ad,c=!1){({startAngle:a,endAngle:h}=Cd(a,h,c));const l=h-a,u=j0(e,n,i,s,o,a);this.isEmpty?this.moveTo(u.x,u.y):this.lineTo(u.x,u.y);const f=Math.ceil(Math.abs(l)/(Math.PI/2));let d=l/f,p=a;for(let y=0;y<f;y++){const x=p+d,m=fc(e,n,i,s,o,p,x);this.bezierCurveTo(m[2],m[3],m[4],m[5],m[6],m[7]),p=x}return this}ellipseArc(e,n,i,s,o,a,h,c,l){ta(e,n,i,s,o,a,h,c,l,(u,f,d,p,y,x,m,g,w)=>{w===0&&(this.isEmpty?this.moveTo(u,f):this.lineTo(u,f)),this.cubicCurveTo(d,p,y,x,m,g)})}arc(e,n,i,s,o,a=!1){this.ellipse(e,n,i,i,0,s,o,a)}arcTo(e,n,i,s,o){if(this.injectMoveToIfNeeded(),o===0){this.lineTo(e,n);return}const a=this.lastPoint,h=O.fromPoint(a),c=O.create(e,n),l=O.create(i,s);let u=c.clone().sub(h).normalize(),f=l.clone().sub(c).normalize(),d=u.dot(f),p=u.cross(f);if(!u.isFinite()||!f.isFinite()||Math.abs(p)<=1e-6)return this.lineTo(e,n);let y=Math.abs(o*(1-d)/p),x=c.clone().sub(u.mulScalar(y)),m=c.clone().add(f.mulScalar(y)),g=Math.sqrt(.5+d*.5);this.lineTo(x.x,x.y),this.conicTo(e,n,m.x,m.y,g)}arcTo2(e,n,i,s,o){if(this.injectMoveToIfNeeded(),o===0){this.lineTo(e,n);return}const a=this.lastPoint,h=O.fromPoint(a),c=O.create(e,n),l=O.create(i,s);let u=c.clone().sub(h).normalize(),f=l.clone().sub(c).normalize(),d=u.dot(f),p=u.cross(f);if(Math.abs(p)<=1e-6){this.lineTo(e,n);return}let y=Math.abs(o*(1-d)/p),x=c.clone().sub(u.mulScalar(y)),m=c.clone().add(f.mulScalar(y)),g=p>0;this.lineTo(x.x,x.y),this.ellipseArc(x.x,x.y,m.x,m.y,o,o,0,!1,g)}arcToOval(e,n,i,s,o,a,h,c=!1){const{x1:l,y1:u,x2:f,y2:d,fa:p,fs:y}=U0(e,n,i,s,o,a,h);c&&this.moveTo(l,u),this.ellipseArc(l,u,f,d,i,s,o,!!p,!!y)}addCircle(e,n,i,s=!1){return i>=0&&this.addOval(Zn.fromLTRB(e-i,n-i,e+i,n+i),s),this}addPolygon(e,n=!0){if(e.length<=0)return this;this.moveTo(e[0],e[1]);for(let i=2;i<e.length;i+=2){let s=e[i],o=e[i+1];this.lineTo(s,o)}return n&&this.closePath(),this}addOval(e,n=!1,i=1){let s=new lb(e,n,i),o=new Rc(e,n,i+(n?1:0)),a=Math.SQRT1_2;this.moveTo(s.current.x,s.current.y),o.next(),s.next();for(let h=0;h<4;++h)this.conicTo(o.get(h).x,o.get(h).y,s.get(h).x,s.get(h).y,a);this.closePath()}addRect(e,n=!1,i=0){let s=new Rc(e,n,i);return this.moveTo(s.get(0).x,s.get(0).y),this.lineTo(s.get(1).x,s.get(1).y),this.lineTo(s.get(2).x,s.get(2).y),this.lineTo(s.get(3).x,s.get(3).y),this.closePath()}addRRect(e,n=!1,i=n?7:6){let s=e.getBounds();if(e.isRect()||e.isEmpty())this.addRect(s,n,(i+1)/2);else if(e.isOval())this.addOval(s,n,i/2);else{const o=(i&1)==+(n==!1);let a=Math.SQRT1_2,h=new ub(e,n,i);const c=i/2+(n?1:0);let l=new Rc(s,n,c);if(this.moveTo(h.current.x,h.current.y),o){for(let u=0;u<3;++u)l.next(),h.next(),this.conicTo(l.current.x,l.current.y,h.current.x,h.current.y,a),h.next(),this.lineTo(h.current.x,h.current.y);l.next(),h.next(),this.conicTo(l.current.x,l.current.y,h.current.x,h.current.y,a)}else for(let u=0;u<4;++u)h.next(),this.lineTo(h.current.x,h.current.y),l.next(),h.next(),this.conicTo(l.current.x,l.current.y,h.current.x,h.current.y,a);this.closePath()}}copy(e){return this.points=e.points.slice(),this.verbs=e.verbs.slice(),this._lastMovePointIndex=e._lastMovePointIndex,this._needMoveTo=e._needMoveTo,this}clone(){return Di.default().copy(this)}equals(e){if(this.points.length!==e.points.length)return!1;for(let n=0;n<this.points.length;n++){const i=this.points[n],s=e.points[n];if(i!==s)return!1}return!0}transform(e){for(let n=0;n<this.points.length;n+=2){const i=this.points[n],s=this.points[n+1];this.points[n]=e[0]*i+e[2]*s+e[4],this.points[n+1]=e[1]*i+e[3]*s+e[5]}}scaleRound(e,n){for(let i=0;i<this.points.length;i+=2){const s=this.points[i],o=this.points[i+1];this.points[i]=Math.round(s*e),this.points[i+1]=Math.round(o*e)}}computeTightBounds(){if(this.isEmpty)return Ni.empty();if(this._segmentMask===1)return this.getBounds();const e=Ni.default();return this.visit({moveTo:(n,i)=>{e.expandByXY(n,i)},lineTo:(n,i,s,o)=>{e.expandByXY(s,o)},quadraticCurveTo:(n,i,s,o,a,h)=>{let c=Ws.fromXY(n,i,s,o,a,h).getBoundingBox();e.expandByPoint(c.min),e.expandByPoint(c.max)},cubicCurveTo(n,i,s,o,a,h,c,l){let u=yc.fromXY(n,i,s,o,a,h,c,l).getBoundingBox();e.expandByPoint(u.min),e.expandByPoint(u.max)}}),e}fatten(e=1){const n=Di.default();return this.isEmpty||this.visit({moveTo:(i,s)=>{n.moveTo(i,s)},lineTo:(i,s,o,a)=>{n.lineTo(o,a)},quadraticCurveTo:(i,s,o,a,h,c)=>{Ws.fromXY(i,s,o,a,h,c).fatten(e).forEach(u=>{n.lineTo(u.x,u.y)})},cubicCurveTo:(i,s,o,a,h,c,l,u)=>{yc.fromXY(i,s,o,a,h,c,l,u).fatten(e).forEach(d=>{n.lineTo(d.x,d.y)})},close:()=>{n.closePath()}}),n}toPolygons(e=!0,n=1){const i=[];let s=null;return this.fatten(n).visit({moveTo:(a,h)=>{s!==null&&i.push(s),s=[a,h]},lineTo:(a,h,c,l)=>{s.push(c,l)},close:(a,h)=>{e&&(s.push(a,h),i.push(s),s=null)}}),s!==null&&i.push(s),i}getBounds(){return this._bounds||(this._bounds=Ni.default().setFromVertices(this.points)),this._bounds}visit(e){const n=this.points,i=this.verbs;let s=0,o={x:0,y:0};for(let a=0,h=0,c=i.length;a<c;a++)switch(i[a]){case 0:e.moveTo?.(n[h],n[h+1]),o.x=n[h],o.y=n[h+1],s=h,h+=2;break;case 1:e.lineTo?.(o.x,o.y,n[h],n[h+1]),o.x=n[h],o.y=n[h+1],h+=2;break;case 2:e.quadraticCurveTo?.(o.x,o.y,n[h],n[h+1],n[h+2],n[h+3]),o.x=n[h+2],o.y=n[h+3],h+=4;break;case 3:e.cubicCurveTo?.(o.x,o.y,n[h],n[h+1],n[h+2],n[h+3],n[h+4],n[h+5]),o.x=n[h+4],o.y=n[h+5],h+=6;break;case 5:e.close?.(n[s],n[s+1],o.x,o.y);break}}invertVisit(e){const n=this.points,i=this.verbs;let s=0,o=!0,a=!1,h={x:0,y:0};for(let c=i.length-1,l=n.length;c>=0;c--){let u=i[c];switch(o&&(l-=2,o=!1,e.moveTo?.(n[l],n[l+1]),h.x=n[l],h.y=n[l+1],s=l),u){case 0:a&&(e.close?.(n[s],n[s+1],h.x,h.y),a=!1),o=!0;break;case 1:l-=2,e.lineTo?.(h.x,h.y,n[l],n[l+1]),h.x=n[l],h.y=n[l+1];break;case 2:l-=4,e.quadraticCurveTo?.(h.x,h.y,n[l+2],n[l+3],n[l],n[l+1]),h.x=n[l],h.y=n[l+1];break;case 3:l-=6,e.cubicCurveTo?.(h.x,h.y,n[l+4],n[l+5],n[l+2],n[l+3],n[l],n[l+1]),h.x=n[l],h.y=n[l+1];break;case 5:a=!0;break}}}addPath(e,n){return n&&(e=e.clone(),e.transform(n)),this._segmentMask|=e._segmentMask,this._needMoveTo=e._needMoveTo,this._lastMovePointIndex=this.points.length+e._lastMovePointIndex,this.points=this.points.concat(e.points),this.verbs=this.verbs.concat(e.verbs),this}addReversePath(e){e.invertVisit({moveTo:(n,i)=>{this.moveTo(n,i)},lineTo:(n,i,s,o)=>{this.lineTo(s,o)},quadraticCurveTo:(n,i,s,o,a,h)=>{this.quadraticCurveTo(s,o,a,h)},cubicCurveTo:(n,i,s,o,a,h,c,l)=>{this.cubicCurveTo(s,o,a,h,c,l)},close:()=>{this.closePath()}})}reversePathTo(e){e.isEmpty||e.invertVisit({moveTo:(n,i)=>{},lineTo:(n,i,s,o)=>{this.lineTo(s,o)},quadraticCurveTo:(n,i,s,o,a,h)=>{this.quadraticCurveTo(s,o,a,h)},cubicCurveTo:(n,i,s,o,a,h,c,l)=>{this.cubicCurveTo(s,o,a,h,c,l)},close:()=>{this.closePath()}})}offset(e,n){for(let i=0;i<this.points.length;i+=2)this.points[i]+=e,this.points[i+1]+=n}isZeroLengthSincePoint(e){let n=this.points.length/2-e;if(n<2)return!0;let i=this.points[e*2],s=this.points[e*2+1];for(let o=1;o<n;o++)if(!(i===this.points[e+o*2]&&s===this.points[e+o*2+1]))return!1;return!0}finish(){return this.isEmpty||this.verbs.length==1?null:this}toCanvas(e){this.visit({moveTo:(n,i)=>{e.moveTo(n,i)},lineTo:(n,i,s,o)=>{e.lineTo(s,o)},quadraticCurveTo:(n,i,s,o,a,h)=>{e.quadraticCurveTo(s,o,a,h)},cubicCurveTo:(n,i,s,o,a,h,c,l)=>{e.bezierCurveTo(s,o,a,h,c,l)},close:()=>{e.closePath()}})}toPath2D(){const e=new Path2D;return this.toCanvas(e),e}toSvgPath(){let e=[];return this.visit({moveTo:(n,i)=>{e.push(["M",n,i])},lineTo:(n,i,s,o)=>{e.push(["L",s,o])},quadraticCurveTo:(n,i,s,o,a,h)=>{e.push(["Q",s,o,a,h])},cubicCurveTo:(n,i,s,o,a,h,c,l)=>{e.push(["C",s,o,a,h,c,l])},close:()=>{e.push(["Z"])}}),e.map(n=>n[0]+n.slice(1).join(" ")).join("")}toPoints(){const e=[];for(let n=0;n<this.points.length;n+=2)e.push({x:this.points[n],y:this.points[n+1]});return e}}const xb=3402823466e29,Oc=1/4096,Lc=Math.SQRT1_2;function mb(r,e=1e-6){return Math.abs(r)<=e}const kd=Math.PI,Rd=11920929e-14;class Bc{static from_points(e){let n=e[0].clone(),i=e[1].clone(),s=e[2].clone(),o=Zs(i.clone().sub(n)),a=s.clone().sub(Zs(i)).add(n);return new this({a,b:o,c:n})}a=O.default();b=O.default();c=O.default();constructor(e){e&&Object.assign(this,e)}eval(e){return O.default().copy(this.a).multiply(e).add(this.b).mul(e).add(this.c)}}class Od{static from_points(e){let n=e[0].clone(),i=e[1].clone(),s=e[2].clone(),o=e[3].clone(),a=O.splat(3);return new this({a:o.clone().add(i.clone().sub(s).mul(a)).sub(n),b:a.clone().mul(s.clone().sub(Zs(i)).add(n)),c:a.clone().mul(i.clone().sub(n)),d:n.clone()})}a=O.default();b=O.default();c=O.default();d=O.default();constructor(e){e&&Object.assign(this,e)}eval(e){return O.default().copy(this.a).multiply(e).add(this.b).mul(e).add(this.c).mul(e).add(this.d)}}function Ld(){return new Array(3)}function gb(r,e,n){let i=r[0].clone(),s=r[1].clone(),o=r[2].clone(),a=O.splat(e),h=Gn(i,s,a),c=Gn(s,o,a);n[0]=O.from(i),n[1]=O.from(h),n[2]=O.from(Gn(h,c,a)),n[3]=O.from(c),n[4]=O.from(o)}function Ur(r,e,n,i){if(r==0){let c=Wr(-n,e);return c?(i[0]=c,1):0}let s=e*e-4*r*n;if(s<0)return 0;s=Math.sqrt(s);let o=s;if(!Number.isFinite(o))return 0;let a=e<0?-(e-o)/2:-(e+o)/2,h=0;{let c=Wr(a,r);c&&(i[h]=c,h+=1)}{let c=Wr(n,a);c&&(i[h]=c,h+=1)}return h==2&&(i[0]>i[1]?[i[0],i[1]]=[i[1],i[0]]:i[0]==i[1]&&(h-=1)),h}function Fc(r,e,n){let i=r[e];return r[e]=r[n],r[n]=i,r}function Nc(r,e,n){let i=r[0].clone(),s=r[1].clone(),o=r[2].clone(),a=r[3].clone(),h=O.splat(e),c=Gn(i,s,h),l=Gn(s,o,h),u=Gn(o,a,h),f=Gn(c,l,h),d=Gn(l,u,h),p=Gn(f,d,h);n[0]=O.from(i),n[1]=O.from(c),n[2]=O.from(f),n[3]=O.from(p),n[4]=O.from(d),n[5]=O.from(u),n[6]=O.from(a)}function wb(r,e,n){return Wr(r-e,r-e-e+n)}function Wr(r,e){return r<0&&(r=-r,e=-e),e==0||r==0||r>=e?void 0:r/e}function Gn(r,e,n){return O.default().copy(r).add(e.clone().sub(r)).multiply(n)}function Zs(r){return O.default().copy(r).add(r)}function Bd(r){let e=r[1].x-r[0].x,n=r[1].y-r[0].y,i=r[0].x-r[1].x-r[1].x+r[2].x,s=r[0].y-r[1].y-r[1].y+r[2].y,o=-(e*i+n*s),a=i*i+s*s;if(a<0&&(o=-o,a=-a),o<=0)return 0;if(o>=a)return 1;let h=o/a;return(h<0||h>1)&&console.assert("值无效"),h}class $i{static ZERO=0;static ONE=1;static new_clamped(e){return Number.isFinite(e)?ve(e,0,1):this.ZERO}}function jr(r,e){return O.from(Bc.from_points(r).eval(O.splat(e)))}function Fd(r,e){if(e==$i.ZERO&&r[0]==r[1]||e==$i.ONE&&r[1]==r[2])return r[2].clone().sub(r[0]);let n=r[0].clone(),i=r[1].clone(),s=r[2].clone(),o=i.clone().sub(n),h=s.clone().sub(i).sub(o).clone().mul(O.splat(e)).add(o);return O.from(h).add(h)}function qc(r,e){let n=Nd([r[0].x,r[1].x,r[2].x,r[3].x]),i=Nd([r[0].y,r[1].y,r[2].y,r[3].y]);for(let o=0;o<4;o++)n[o]+=i[o];let s=bb(n,e);return e.slice(0,s)}function Nd(r){let e=r[1]-r[0],n=r[2]-2*r[1]+r[0],i=r[3]+3*(r[1]-r[2])-r[0];return[i*i,3*n*i,2*n*n+i*e,e*n]}function bb(r,e){if(mb(r[0])){let f=Ld(),d=Ur(r[1],r[2],r[3],f);for(let p=0;p<d;p++)e[p]=f[p];return d}let n=1/r[0],i=r[1]*n,s=r[2]*n,o=r[3]*n,a=(i*i-s*3)/9,h=(2*i*i*i-9*i*s+27*o)/54,c=a*a*a,l=h*h-c,u=i/3;if(l<0){let f=Math.acos(ve(h/Math.sqrt(c),-1,1)),d=-2*Math.sqrt(a);return e[0]=$i.new_clamped(d*Math.cos(f/3)-u),e[1]=$i.new_clamped(d*Math.cos((f+2*kd)/3)-u),e[2]=$i.new_clamped(d*Math.cos((f-2*kd)/3)-u),vb(e),Mb(e)}else{let f=Math.abs(h)+Math.sqrt(l);return f=_b(f),h>0&&(f=-f),f!=0&&(f+=a/f),e[0]=$i.new_clamped(f-u),1}}function vb(r){r[0]>r[1]&&Fc(r,0,1),r[1]>r[2]&&Fc(r,1,2),r[0]>r[1]&&Fc(r,0,1)}function Mb(r){let e=3;return r[1]==r[2]&&(e=2),r[0]==r[1]&&(e=1),e}function _b(r){return Math.pow(r,.3333333)}function fa(r,e){return O.from(Od.from_points(r).eval(O.splat(e)))}function qd(r,e){if(e==0&&r[0]==r[1]||e==1&&r[2]==r[3]){let n=e==0?r[2].clone().sub(r[0]):r[3].clone().sub(r[1]);return n.x==0&&n.y==0&&(n=r[3].clone().sub(r[0])),n}else return Dd(r,e)}function Dd(r,e){let n=r[0].clone(),i=r[1].clone(),s=r[2].clone(),o=r[3].clone(),a=new Bc({a:o.clone().add(O.splat(3).mul(i.clone().sub(s))).sub(n),b:Zs(s.clone().sub(Zs(i)).add(n)),c:i.clone().sub(n)});return O.from(a.eval(O.splat(e)))}function Sb(r,e,n,i,s){let o=i-r+3*(e-n),a=2*(r-e-e+n),h=e-r;const c=Ur(o,a,h,s);return s.slice(0,c)}function $d(r,e){let n=r[1].x-r[0].x,i=r[1].y-r[0].y,s=r[2].x-2*r[1].x+r[0].x,o=r[2].y-2*r[1].y+r[0].y,a=r[3].x+3*(r[1].x-r[2].x)-r[0].x,h=r[3].y+3*(r[1].y-r[2].y)-r[0].y,c=Ur(s*h-o*a,n*h-i*a,n*o-i*s,e);return e.slice(0,c)}function Vd(r){if(r[0].equals(r[1])||r[2].equals(r[3])||Ud(r,0,2)||Ud(r,2,0))return;let e=Array.from({length:3},()=>$i.ZERO),n=qc(r,e);for(let i of n){if(0>=i||i>=1)continue;let o=Dd(r,i).magnitudeSquared(),a=Tb(r);if(o<a)return ve(i,Rd,1-Rd)}}function Ud(r,e,n){let i=r[n],s=r[n+1].clone().sub(i),o=[0,0];for(let a=0;a<2;a++){let h=r[e+a].clone().sub(i);o[a]=s.clone().cross(h)}return o[0]*o[1]>=0}function Tb(r){return(r[1].distanceSquared(r[0])+r[2].distanceSquared(r[1])+r[3].distanceSquared(r[2]))*1e-8}class pn{points=O.makeZeroArray(3);weight=0;static default(){return new this}static new(e,n,i,s){const o=this.default();return o.points[0].copy(e),o.points[1].copy(n),o.points[2].copy(i),o.weight=s,o}static from_points(e,n){return this.new(e[0],e[1],e[2],n)}static build_unit_arc(e,n,i,s,o){let a=e.dot(n),h=e.cross(n);if(Math.abs(h)<=Oc&&a>0&&(h>=0&&i==0||h<=0&&i==1))return;i==1&&(h=-h);let l=0;h==0?l=2:a==0?l=h>0?1:3:(h<0&&(l+=2),a<0!=h<0&&(l+=1));let u=[O.create(1,0),O.create(1,1),O.create(0,1),O.create(-1,1),O.create(-1,0),O.create(-1,-1),O.create(0,-1),O.create(1,-1)];const f=Lc;let d=l;for(let g=0;g<d;g++)o[g]=pn.new(u[g*2],u[g*2+1],u[g*2+2],f);let p=O.create(a,h),y=u[l*2],x=y.dot(p);if(x<1){let g=O.create(y.x+a,y.y+h),w=Math.sqrt((1+x)/2);g.setLength(1/w),y.equalsEpsilon(g)||(o[d]=pn.new(y,g,p,w),d+=1)}let m=re.fromSinCos(e.y,e.x);i==1&&(m=m.preScale(1,-1)),s&&m.premultiply(s);for(let g=0;g<d;g++)m.mapPoints(o[g].points,o[g].points);if(d!=0)return o.slice(0,d)}constructor(e){e&&(this.points.forEach((n,i)=>{e.points[i]&&n.copy(e.points[i])}),this.weight=e.weight)}compute_quad_pow2(e){if(e<0||!Number.isFinite(e))return;const n=this;if(!n.points[0].isFinite()||!n.points[1].isFinite()||!n.points[2].isFinite())return;const i=4;let s=n.weight-1,o=s/(4*(2+s)),a=o*(n.points[0].x-2*n.points[1].x+n.points[2].x),h=o*(n.points[0].y-2*n.points[1].y+n.points[2].y),c=Math.sqrt(a*a+h*h),l=0;for(let u=0;u<i&&!(c<=e);u++)c*=.25,l+=1;return Math.max(l,1)}chop_into_quads_pow2(e,n){const i=this;n[0]=i.points[0],Dc(i,n.slice(1),e);let o=2*(1<<e)+1;if(n.slice(0,o).some(h=>!Number.isFinite(h)))for(let h=0;h<o-1;h++)this.points[h+1]=this.points[1];return 1<<e}chop(){const e=this;let n=O.splat(1/(1+e.weight)),i=zb(e.weight),s=e.points[0].clone(),o=e.points[1].clone(),a=e.points[2].clone(),c=O.splat(e.weight).clone().mul(o),l=s.clone().add(Zs(c)).add(a).multiply(n).mul(O.splat(.5)),u=O.from(l);if(!u.isFinite()){let f=e.weight,d=f*2,p=1/(1+f)*.5;u.x=(e.points[0].x+d*e.points[1].x+e.points[2].x)*p,u.y=(e.points[0].y+d*e.points[1].y+e.points[2].y)*p}return[new pn({points:[e.points[0],O.from(s.clone().add(c).mul(n)),u],weight:i}),new pn({points:[u,O.from(c.clone().add(a).mul(n)),e.points[2]],weight:i})]}}function Eb(r,e,n,i,s){let o=r.dot(e),a=r.cross(e);if(Math.abs(a)<=Oc&&o>0&&(a>=0&&n==0||a<=0&&n==1))return;n==1&&(a=-a);let c=0;a==0?c=2:o==0?c=a>0?1:3:(a<0&&(c+=2),o<0!=a<0&&(c+=1));let l=[O.create(1,0),O.create(1,1),O.create(0,1),O.create(-1,1),O.create(-1,0),O.create(-1,-1),O.create(0,-1),O.create(1,-1)];const u=Lc;let f=c;for(let m=0;m<f;m++)s[m]=pn.from_points(l.slice(m*2),u);let d=O.create(o,a),p=l[c*2],y=p.dot(d);if(y<1){let m=O.create(p.x+o,p.y+a),g=Math.sqrt((1+y)/2);m.setLength(1/g),p.equalsEpsilon(m)||(s[f]=pn.new(p,m,d,g),f+=1)}let x=re.fromSinCos(r.y,r.x);if(n==1&&(x=x.preScale(1,-1)),x=x.premultiply(i),s.slice(f).forEach((m,g)=>{x.mapPoints(m.points,m.points)}),f!=0)return s.slice(0,f)}function zb(r){return Math.sqrt(.5+r*.5)}function Dc(r,e,n){if(n==0)return e[0]=r.points[1],e[1]=r.points[2],e.slice(2);{let i=r.chop(),s=r.points[0].y,o=r.points[2].y;if(da(s,r.points[1].y,o)){let a=i[0].points[2].y;if(!da(s,a,o)){let h=Math.abs(a-s)<Math.abs(a-o)?s:o;i[0].points[2].y=h,i[1].points[0].y=h}da(s,i[0].points[1].y,i[0].points[2].y)||(i[0].points[1].y=s),da(i[1].points[0].y,i[1].points[1].y,o)||(i[1].points[1].y=o)}return n-=1,e=Dc(i[0],e,n),Dc(i[1],e,n)}}function da(r,e,n){return(r-e)*(n-e)<=0}class Ab{points=[];len=0;static compute(e,n,i,s){let o=pn.new(e,n,i,s),a=o.compute_quad_pow2(.25);if(a===void 0)return;let h=Array.from({length:64},()=>O.zero()),c=o.chop_into_quads_pow2(a,h);return new this({points:h,len:c})}constructor(e){e&&Object.assign(this,e)}}function Cb(r,e,n){if(e.length<=0)n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3];else{let i=e[0],s=O.makeZeroArray(4),o=0;for(let a=0;a<e.length;a++){let h=[];Nc(r,i,h);for(let l=0;l<h.length;l++)n[o+l]=h[l];if(a==e.length-1)break;o+=3,s[0]=n[o+0],s[1]=n[o+1],s[2]=n[o+2],s[3]=n[o+3],r=s;let c=Wr(e[a+1]-e[a],1-e[a]);c!==void 0?i=c:(n[o+4].copy(r[3]),n[o+5].copy(r[3]),n[o+6].copy(r[3]))}}}function Wd(r,e=1e-6){return Math.abs(r)<=e}var jd=(r=>(r.Miter="miter",r.Round="round",r.Bevel="bevel",r.MiterClip="miter-clip",r))(jd||{}),Yd=(r=>(r.Butt="butt",r.Round="round",r.Square="square",r))(Yd||{}),Hd=(r=>(r.NonZero="nonzero",r.EvenOdd="evenodd",r))(Hd||{});class pa{isAutoClose=!1;path;verbIndex;pointsIndex;lastMoveTo=O.default();lastPoint=O.default();constructor(e){this.isAutoClose=e.isAutoClose??!1,this.verbIndex=e.verbIndex,this.pointsIndex=e.pointsIndex,this.path=e.path,e.lastMoveTo&&this.lastMoveTo.copy(e.lastMoveTo),e.lastPoint&&this.lastPoint.copy(e.lastPoint)}get curVerb(){return this.path.verbs[this.verbIndex-1]}get nextVerb(){return this.path.verbs[this.verbIndex]}copy(e){return this.isAutoClose=e.isAutoClose,this.verbIndex=e.verbIndex,this.pointsIndex=e.pointsIndex,this.lastMoveTo.copy(e.lastMoveTo),this.lastPoint.copy(e.lastPoint),this}clone(){return new pa({isAutoClose:this.isAutoClose,path:this.path,verbIndex:this.verbIndex,pointsIndex:this.pointsIndex,lastMoveTo:this.lastMoveTo,lastPoint:this.lastPoint})}*[Symbol.iterator](){const e=Array.from({length:this.path.points.length/2},(s,o)=>O.create(this.path.points[o*2],this.path.points[o*2+1])),n=this.path.verbs;let i=null;for(;this.verbIndex<n.length;){const s=n[this.verbIndex++];switch(s){case ne.MoveTo:this.pointsIndex+=1,i=e[this.pointsIndex-1],this.lastMoveTo.copy(i),this.lastPoint.copy(this.lastMoveTo),yield{type:s,p0:e[this.pointsIndex-1]};break;case ne.LineTo:this.pointsIndex+=1,this.lastPoint.copy(e[this.pointsIndex-1]),yield{type:s,p0:e[this.pointsIndex-1]};break;case ne.QuadCurveTo:this.pointsIndex+=2,this.lastPoint.copy(e[this.pointsIndex-1]),yield{type:s,p0:e[this.pointsIndex-3],p1:e[this.pointsIndex-2],p2:e[this.pointsIndex-1]};break;case ne.CubicCurveTo:this.pointsIndex+=3,this.lastPoint.copy(e[this.pointsIndex-1]),yield{type:s,p0:e[this.pointsIndex-4],p1:e[this.pointsIndex-3],p2:e[this.pointsIndex-2],p3:e[this.pointsIndex-1]};break;case ne.Close:const o=this.autoClose();this.lastPoint.copy(this.lastMoveTo),yield o;break}}}hasValidTangent(){let e=this.clone();for(let n of e)switch(n.type){case ne.MoveTo:return!1;case ne.LineTo:{if(e.lastPoint.equals(n.p0))continue;return!0}case ne.QuadCurveTo:{if(e.lastPoint.equals(n.p1)&&e.lastPoint.equals(n.p2))continue;return!0}case ne.CubicCurveTo:{if(e.lastPoint.equals(n.p1)&&e.lastPoint.equals(n.p2)&&e.lastPoint.equals(n.p3))continue;return!0}case ne.Close:return!1}return!1}setAutoClose(e){this.isAutoClose=e}autoClose(){return this.isAutoClose&&!this.lastPoint.equals(this.lastMoveTo)?(this.verbIndex-=1,{type:ne.LineTo,p0:this.lastMoveTo}):{type:ne.Close,p0:this.lastPoint,p1:this.lastMoveTo}}}class Pb{constructor(e,n){this.inner=e,this.outer=n}swap(){[this.inner,this.outer]=[this.outer,this.inner]}}const $c=.707106781,Vc=(r,e,n,i,s)=>{s.lineTo(n.x,n.y)},Ib=(r,e,n,i,s)=>{let o=e.clone();o.cw();let a=r.clone().add(o),h=a.clone().add(e);s.conicTo(h.x,h.y,a.x,a.y,$c),h.copy(a).sub(e),s.conicTo(h.x,h.y,n.x,n.y,$c)},kb=(r,e,n,i,s)=>{let o=e.clone();o.cw(),i?(s.setLastPoint(r.x+e.x+o.x,r.y+e.y+o.y),s.lineTo(r.x-e.x+o.x,r.y-e.y+o.y)):(s.lineTo(r.x+e.x+o.x,r.y+e.y+o.y),s.lineTo(r.x-e.x+o.x,r.y-e.y+o.y),s.lineTo(n.x,n.y))};function Xd(r){return Math.abs(r)<=Yc}function Zd(r){return r>=0?Xd(1-r)?3:2:Xd(1+r)?0:1}function Uc(r,e){return r.x*e.y>r.y*e.x}function ya(r,e,n){n.lineTo(r.x,r.y),n.lineTo(r.x-e.x,r.y-e.y)}const Gd=(r,e,n,i,s,o,a,h,c)=>{function l(w,M,S,E,A,I,b,v,_,z){if(v=v.clone(),v.multiplyScalar(S),b=b.clone(),I=I.clone(),z){b.normalize();let P=I.dot(b),k=I.cross(b),B=0;Math.abs(k)<=Yc?B=1/_:B=(1/_-P)/k,I.multiplyScalar(S);let R=I.clone();R.cw();let L=v.clone();L.ccw();let N=O.default();N.addVectors(M,I).add(R.clone().multiplyScalar(B));let q=O.default();N.addVectors(M,v).add(L.clone().multiplyScalar(B)),E?w.outer.setLastPoint(N.x,N.y):w.outer.lineTo(N.x,N.y),w.outer.lineTo(q.x,q.y)}A||w.outer.lineTo(M.x+v.x,M.y+v.y),ya(M,v,w.inner)}function u(w,M,S,E,A,I,b){b=b.clone(),b.multiplyScalar(S),E?w.outer.setLastPoint(M.x+I.x,M.y+I.y):w.outer.lineTo(M.x+I.x,M.y+I.y),A||w.outer.lineTo(M.x+b.x,M.y+b.y),ya(M,b,w.inner)}let f=r.dot(n),d=Zd(f),p=r.clone(),y=n.clone(),x=O.default();if(d==3)return;if(d==0){h=!1,x.subVectors(y,p).multiplyScalar(i/2),l(c,e,i,a,h,p,x,y,s,o);return}let m=!Uc(p,y);if(m&&(c.swap(),p.negate(),y.negate()),f==0&&s<=$c){x.addVectors(p,y).multiplyScalar(i),u(c,e,i,a,h,x,y);return}d==1?(x=O.create(y.y-p.y,p.x-y.x),m&&x.negate()):x=O.create(p.x+y.x,p.y+y.y);let g=Math.sqrt((1+f)/2);if(g<s){h=!1,l(c,e,i,a,h,p,x,y,s,o);return}x.setLength(i/g),u(c,e,i,a,h,x,y)},Rb=(r,e,n,i,s,o,a,h)=>{let c=n.clone().multiplyScalar(i);Uc(r,n)||(h.swap(),c.negate()),h.outer.lineTo(e.x+c.x,e.y+c.y),ya(e,c,h.inner)},Ob=(r,e,n,i,s,o,a,h)=>Gd(r,e,n,i,s,!1,o,a,h),Lb=(r,e,n,i,s,o,a,h)=>{Gd(r,e,n,i,s,!0,o,a,h)},Wc=(r,e,n,i,s,o,a,h)=>{let c=r.dot(n);if(Zd(c)==3)return;let u=r.clone(),f=n.clone(),d=ua.CW;Uc(u,f)||(h.swap(),u.negate(),f.negate(),d=ua.CCW);let p=re.fromRows(i,0,0,i,e.x,e.y),y=new Array(5).fill(0).map(()=>new pn),x=pn.build_unit_arc(u,f,d,p,y);if(x){for(let m of x)h.outer.conicTo(m.points[1].x,m.points[1].y,m.points[2].x,m.points[2].y,m.weight);f.multiplyScalar(i),ya(e,f,h.inner)}};function Jd(r,e,n,i,s,o){return o.setLengthFromPoint((e.x-r.x)*n,(e.y-r.y)*n,1)?(o.ccw(),s.copy(o).multiplyScalar(i),!0):!1}function Bb(r,e,n,i){return i.setLengthFromPoint(r.x,r.y,1)?(i.ccw(),n.copy(i).multiplyScalar(e),!0):!1}class xa{static default(){return new this}quad=[O.default(),O.default(),O.default()];tangent_start=O.default();tangent_end=O.default();start_t=0;mid_t=0;end_t=0;start_set=!1;end_set=!1;opposite_tangents=!1;init(e,n){return this.start_t=e,this.mid_t=Math.min(1,Math.max(0,(e+n)/2)),this.end_t=n,this.start_set=!1,this.end_set=!1,this.start_t<this.mid_t&&this.mid_t<this.end_t}initWithStart(e){const n=this;return n.init(e.start_t,e.mid_t)?(n.quad[0].copy(e.quad[0]),n.tangent_start.copy(e.tangent_start),n.start_set=!0,!0):!1}initWithEnd(e){const n=this;return n.init(e.mid_t,e.end_t)?(n.quad[2].copy(e.quad[2]),n.tangent_end.copy(e.tangent_end),n.end_set=!0,!0):!1}}function Fb(r){let e=Jn(r[1].clone().sub(r[0])),n=Jn(r[2].clone().sub(r[1]));if(e&n)return[O.default(),0];if(e|n)return[O.default(),1];if(!Nb(r))return[O.default(),2];let i=Bd(r);if(i==0||i==1)return[O.default(),1];let s=jr(r,i);return[O.create(s.x,s.y),3]}function Jn(r){return+!r.canNormalize()}function Nb(r){let e=-1,n=0,i=0;for(let h=0;h<2;h++)for(let c=h+1;c<3;c++){let l=r[c].clone().sub(r[h]),u=Math.max(Math.abs(l.x),Math.abs(l.y));e<u&&(n=h,i=c,e=u)}console.assert(n<=1),console.assert(i>=1&&i<=2),console.assert(n<i);let s=n^i^3,a=e*e*5e-6;return Gs(r[s],r[n],r[i])<=a}function Gs(r,e,n){let i=n.clone().sub(e),s=r.clone().sub(e),o=i.dot(s),a=i.dot(i),h=o/a;return h>=0&&h<=1?O.create(e.x*(1-h)+n.x*h,e.y*(1-h)+n.y*h).distanceSquared(r):r.distanceSquared(e)}function qb(r,e,n){let i=r[1].clone().sub(r[0]),s=[0,0,0];for(let l=0;l<3;l++)s[l]=(e[l].y-r[0].y)*i.x-(e[l].x-r[0].x)*i.y;let o=s[2],a=s[1],h=s[0];o+=h-2*a,a-=h;let c=Ur(o,2*a,h,n);return n.slice(0,c)}function jc(r,e,n){return r.distanceSquared(e)<=n*n}function Qd(r){let e=r[1].clone().sub(r[0]),n=r[1].clone().sub(r[2]),i=e.magnitudeSquared(),s=n.magnitudeSquared();return i>s&&([e,n]=[n,e],s=i),e.setLength(s)?e.dot(n)>0:!1}function Db(r,e,n){let i=Math.min(r[0].x,r[1].x,r[2].x);if(e.x+n<i)return!1;let s=Math.max(r[0].x,r[1].x,r[2].x);if(e.x-n>s)return!1;let o=Math.min(r[0].y,r[1].y,r[2].y);if(e.y+n<o)return!1;let a=Math.max(r[0].y,r[1].y,r[2].y);return!(e.y-n>a)}function $b(r,e,n){let i=Jn(r[1].clone().sub(r[0])),s=Jn(r[2].clone().sub(r[1])),o=Jn(r[3].clone().sub(r[2]));if(i&s&o)return 0;if(i+s+o==2)return 1;if(!Vb(r))return n&&(i?n.copy(r[2]):n.copy(r[1])),2;let a=[0,0,0];a=qc(r,a);let h=0;for(let c of a){if(0>=c||c>=1)continue;let l=fa(r,c);e[h]=O.create(l.x,l.y),!e[h].equals(r[0])&&!e[h].equals(r[3])&&(h+=1)}switch(h){case 0:return 1;case 1:return 1;case 2:return 4;case 3:return 5;default:return-1}}function Vb(r){let e=-1,n=0,i=0;for(let h=0;h<3;h++)for(let c=h+1;c<4;c++){let l=r[c].clone().sub(r[h]),u=Math.max(Math.abs(l.x),Math.abs(l.y));e<u&&(n=h,i=c,e=u)}let s=1+(2>>i)>>n,o=n^i^s,a=e*e*1e-5;return Gs(r[s],r[n],r[i])<=a&&Gs(r[o],r[n],r[i])<=a}const Ub={bevel:Rb,miter:Ob,"miter-clip":Lb,round:Wc},Wb={butt:Vc,round:Ib,square:kb},jb=3,Kd=[15,78,33,33],Yc=1/4096;class Yb{static computeResolutionScale(e){let n=O.create(e.a,e.b).magnitude(),i=O.create(e.c,e.d).magnitude();if(Number.isFinite(n)&&Number.isFinite(i)){let s=Math.max(n,i);if(s>0)return s}return 1}radius=0;inv_miter_limit=0;res_scale=1;inv_res_scale=1;inv_res_scale_squared=1;first_normal=O.default();prev_normal=O.default();first_unit_normal=O.default();prev_unit_normal=O.default();first_pt=O.default();prev_pt=O.default();first_outer_pt=O.default();first_outer_pt_index_in_contour=0;segment_count=-1;prev_is_line=!1;capper;joiner;inner=Di.default();outer=Di.default();cusper=Di.default();stroke_type=1;recursion_depth=0;found_tangents=!1;join_completed=!1;get moveToPt(){return this.first_pt}builders(){return new Pb(this.inner,this.outer)}close(e){this.finishContour(!0,e)}moveTo(e){this.segment_count>0&&this.finishContour(!1,!1),this.segment_count=0,this.first_pt.copy(e),this.prev_pt.copy(e),this.join_completed=!1}finishContour(e,n){const i=this;if(i.segment_count>0){if(e){i.joiner(i.prev_unit_normal,i.prev_pt,i.first_unit_normal,i.radius,i.inv_miter_limit,i.prev_is_line,n,i.builders()),i.outer.closePath();let s=i.inner.lastPoint??O.create(0,0);i.outer.moveTo(s.x,s.y),i.outer.reversePathTo(i.inner),i.outer.closePath()}else{let s=i.inner.lastPoint?O.fromPoint(i.inner.lastPoint):O.create(0,0),o=n?i.inner:null;i.capper(i.prev_pt,i.prev_normal,s,o,i.outer),i.outer.reversePathTo(i.inner),o=i.prev_is_line?i.inner:null,i.capper(i.first_pt,i.first_normal.clone().negate(),i.first_outer_pt,o,i.outer),i.outer.closePath()}i.cusper.isEmpty||(i.outer.addPath(i.cusper),i.cusper.clear())}i.inner.clear(),i.segment_count=-1,i.first_outer_pt_index_in_contour=i.outer.points.length}preJoinTo(e,n,i,s){const o=this;let a=o.prev_pt.x,h=o.prev_pt.y;if(!Jd(o.prev_pt,e,o.res_scale,o.radius,i,s)){if(o.capper===Vc)return!1;i.set(o.radius,0),s.set(1,0)}return o.segment_count==0?(o.first_normal.copy(i),o.first_unit_normal.copy(s),o.first_outer_pt=O.create(a+i.x,h+i.y),o.outer.moveTo(o.first_outer_pt.x,o.first_outer_pt.y),o.inner.moveTo(a-i.x,h-i.y)):o.joiner(o.prev_unit_normal,o.prev_pt,s,o.radius,o.inv_miter_limit,o.prev_is_line,n,o.builders()),o.prev_is_line=n,!0}postJoinTo(e,n,i){this.join_completed=!0,this.prev_pt.copy(e),this.prev_unit_normal.copy(i),this.prev_normal.copy(n),this.segment_count+=1}initQuad(e,n,i,s){this.stroke_type=e,this.found_tangents=!1,s.init(n,i)}quadStroke(e,n){let i=this,s=i.compareQuadQuad(e,n);if(s==2)return(i.stroke_type==1?i.outer:i.inner).quadraticCurveTo(n.quad[1].x,n.quad[1].y,n.quad[2].x,n.quad[2].y),!0;if(s==1)return i.addDegenerateLine(n),!0;if(i.recursion_depth+=1,i.recursion_depth>Kd[jb])return!1;let o=xa.default();return o.initWithStart(n),!i.quadStroke(e,o)||(o.initWithEnd(n),!i.quadStroke(e,o))?!1:(i.recursion_depth-=1,!0)}compareQuadQuad(e,n){const i=this;if(!n.start_set){let h=O.zero();i.quadPerpRay(e,n.start_t,h,n.quad[0],n.tangent_start),n.start_set=!0}if(!n.end_set){let h=O.zero();i.quadPerpRay(e,n.end_t,h,n.quad[2],n.tangent_end),n.end_set=!0}let s=i.intersectRay(0,n);if(s!=2)return s;let o=O.zero(),a=O.zero();return i.quadPerpRay(e,n.mid_t,a,o),i.strokeCloseEnough(n.quad.slice(),[o,a],n)}setRayPoints(e,n,i,s){const o=this;n.setLength(o.radius)||n.copy(O.create(o.radius,0));let a=o.stroke_type;i.x=e.x+a*n.y,i.y=e.y-a*n.x,s&&(s.x=i.x+n.x,s.y=i.y+n.y)}quadPerpRay(e,n,i,s,o){let a=this,h=jr(e,n);i.set(h.x,h.y),h=Fd(e,n);let c=O.create(h.x,h.y);c.isZero()&&(c=e[2].sub(e[0])),a.setRayPoints(i,c,s,o)}strokeCloseEnough(e,n,i){const s=this;let a=jr(e,.5);if(jc(n[0],O.create(a.x,a.y),s.inv_res_scale))return Qd(i.quad)?0:2;if(!Db(e,n[0],s.inv_res_scale))return 0;let h=new Array(3).fill(.5);if(h=qb(n,e,h),h.length!=1)return 0;let c=jr(e,h[0]),l=s.inv_res_scale*(1-Math.abs(h[0]-.5)*2);return jc(n[0],O.create(c.x,c.y),l)?Qd(i.quad)?0:2:0}intersectRay(e,n){const i=this;let s=n.quad[0],o=n.quad[2],a=n.tangent_start.clone().sub(s),h=n.tangent_end.clone().sub(o),c=a.cross(h);if(c==0||!Number.isFinite(c))return n.opposite_tangents=a.dot(h)<0,1;n.opposite_tangents=!1;let l=s.clone().sub(o),u=h.cross(l),f=a.cross(l);if(u>=0==f>=0){let p=Gs(s,o,n.tangent_end),y=Gs(o,s,n.tangent_start);return Math.max(p,y)<=i.inv_res_scale_squared?1:0}return u/=c,u>u-1?(e==0&&(n.quad[1].x=s.x*(1-u)+n.tangent_start.x*u,n.quad[1].y=s.y*(1-u)+n.tangent_start.y*u),2):(n.opposite_tangents=a.dot(h)<0,1)}addDegenerateLine(e){const n=this;n.stroke_type==1?n.outer.lineTo(e.quad[2].x,e.quad[2].y):n.inner.lineTo(e.quad[2].x,e.quad[2].y)}setCubicEndNormal(e,n,i,s,o){let a=this,h=e[1].clone().sub(e[0]),c=e[3].clone().sub(e[2]),l=Jn(h),u=Jn(c);if(l&&u){s.copy(n),o.copy(i);return}if(l&&(h=e[2].clone().sub(e[0]),l=Jn(h)),u&&(c=e[3].clone().sub(e[1]),u=Jn(c)),l||u){s.copy(n),o.copy(i);return}return Bb(c,a.radius,s,o)}lineTo(e,n){const i=this;let s=i.prev_pt.equalsEpsilon(e,Yc*i.inv_res_scale);if(i.capper,Vc&&s||s&&(i.join_completed||n&&n.hasValidTangent()))return;let o=O.default(),a=O.default();i.preJoinTo(e,!0,o,a)&&(i.outer.lineTo(e.x+o.x,e.y+o.y),i.inner.lineTo(e.x-o.x,e.y-o.y),i.postJoinTo(e,o,a))}quadraticCurveTo(e,n){const i=this;let s=[i.prev_pt,e,n],[o,a]=Fb(s);if(a==0){i.lineTo(n);return}if(a==1){i.lineTo(n);return}if(a==3){i.lineTo(o);let p=i.joiner;i.joiner=Wc,i.lineTo(n),i.joiner=p;return}let h=O.default(),c=O.default(),l=O.default(),u=O.default();if(!i.preJoinTo(e,!1,h,c)){i.lineTo(n);return}let f=xa.default();i.initQuad(1,0,1,f),i.quadStroke(s,f),i.initQuad(-1,0,1,f),i.quadStroke(s,f),Jd(s[1],s[2],i.res_scale,i.radius,l,u)||(l=h,u=c),i.postJoinTo(n,l,u)}bezierCurveTo(e,n,i){const s=this;let o=[s.prev_pt,e,n,i],a=Array.from({length:3},()=>O.zero()),h=O.zero(),c=$b(o,a,h);if(c==0){s.lineTo(i);return}if(c==1){s.lineTo(i);return}if(3<=c&&5>=c){s.lineTo(a[0]);let m=s.joiner;s.joiner=Wc,4<=c&&s.lineTo(a[1]),c==5&&s.lineTo(a[2]),s.lineTo(i),s.joiner=m;return}let l=O.zero(),u=O.zero(),f=O.zero(),d=O.zero();if(!s.preJoinTo(h,!1,l,u)){s.lineTo(i);return}let p=new Array(3).fill(.5);p=$d(o,p);let y=0;for(let m=0,g=p.length;m<=g;m++){let w=Number.isFinite(p[m])?p[m]:1,M=xa.default();s.initQuad(1,y,w,M),s.cubicStroke(o,M),s.initQuad(-1,y,w,M),s.cubicStroke(o,M),y=w}let x=Vd(o);if(x){let m=fa(o,x);s.cusper.addCircle(m.x,m.y,s.radius)}s.setCubicEndNormal(o,l,u,f,d),s.postJoinTo(i,f,d)}cubicStroke(e,n){const i=this;if(!i.found_tangents){let o=i.tangentsMeet(e,n);if(o!=2){let a=jc(n.quad[0],n.quad[2],i.inv_res_scale);if((o==1||a)&&i.cubicMidOnLine(e,n))return i.addDegenerateLine(n),!0}else i.found_tangents=!0}if(i.found_tangents){let o=i.compareQuadCubic(e,n);if(o==2){let a=n.quad;return i.stroke_type==1?i.outer.quadraticCurveTo(a[1].x,a[1].y,a[2].x,a[2].y):i.inner.quadraticCurveTo(a[1].x,a[1].y,a[2].x,a[2].y),!0}if(o==1&&!n.opposite_tangents)return i.addDegenerateLine(n),!0}if(!Number.isFinite(n.quad[2].x)||!Number.isFinite(n.quad[2].x)||(i.recursion_depth+=1,i.recursion_depth>Kd[Number(i.found_tangents)]))return!1;let s=xa.default();return s.initWithStart(n)?i.cubicStroke(e,s)?s.initWithEnd(n)?i.cubicStroke(e,s)?(i.recursion_depth-=1,!0):!1:(i.addDegenerateLine(n),i.recursion_depth-=1,!0):!1:(i.addDegenerateLine(n),i.recursion_depth-=1,!0)}cubicMidOnLine(e,n){let i=this,s=O.zero();return i.cubicQuadMid(e,n,s),Gs(s,n.quad[0],n.quad[2])<i.inv_res_scale_squared}cubicQuadMid(e,n,i){let s=O.zero();this.cubicPerpRay(e,n.mid_t,s,i)}compareQuadCubic(e,n){let i=this;i.cubicQuadEnds(e,n);let s=i.intersectRay(0,n);if(s!=2)return s;let o=O.zero(),a=O.zero();return i.cubicPerpRay(e,n.mid_t,a,o),i.strokeCloseEnough(n.quad.slice(),[o,a],n)}cubicQuadEnds(e,n){const i=this;if(!n.start_set){let s=O.zero();i.cubicPerpRay(e,n.start_t,s,n.quad[0],n.tangent_start),n.start_set=!0}if(!n.end_set){let s=O.zero();i.cubicPerpRay(e,n.end_t,s,n.quad[2],n.tangent_end),n.end_set=!0}}tangentsMeet(e,n){return this.cubicQuadEnds(e,n),this.intersectRay(1,n)}cubicPerpRay(e,n,i,s,o){let a=this;i.copy(fa(e,n));let h=qd(e,n),c=Array.from({length:7},()=>O.zero());if(h.x==0&&h.y==0){let l=e;Wd(n)?h=e[2].clone().sub(e[0]):Wd(1-n)?h=e[3].clone().sub(e[1]):(Nc(e,n,c),h=c[3].clone().sub(c[2]),h.x==0&&h.y==0&&(h=c[3].clone().sub(c[1]),l=c)),h.x==0&&h.y==0&&(h=l[3].clone().sub(l[0]))}a.setRayPoints(i,h,s,o)}stroke(e,n){return this.strokeInner(e,n.strokeWidth,n.miterLimit,n.lineCap,n.lineJoin,this.res_scale)}strokeInner(e,n,i,s,o,a){const h=this;let c=0;o=="miter"&&(i<=1?o="bevel":c=1/i),o=="miter-clip"&&(c=1/i),h.res_scale=a,h.inv_res_scale=1/(a*4),h.inv_res_scale_squared=h.inv_res_scale**2,h.radius=n*.5,h.inv_miter_limit=c,h.first_normal=O.default(),h.prev_normal=O.default(),h.first_unit_normal=O.default(),h.prev_unit_normal=O.default(),h.first_pt=O.default(),h.prev_pt=O.default(),h.first_outer_pt=O.default(),h.first_outer_pt_index_in_contour=0,h.segment_count=-1,h.prev_is_line=!1,h.capper=Wb[s],h.joiner=Ub[o],h.inner.clear(),h.outer.clear(),h.cusper.clear(),h.stroke_type=1,h.recursion_depth=0,h.found_tangents=!1,h.join_completed=!1;let l=!1,u=new pa({path:e,verbIndex:0,pointsIndex:0,isAutoClose:!0});u.setAutoClose(!0);for(let f of u)switch(f.type){case ne.MoveTo:h.moveTo(f.p0);break;case ne.LineTo:h.lineTo(f.p0,u),l=!0;break;case ne.QuadCurveTo:h.quadraticCurveTo(f.p1,f.p2),l=!1;break;case ne.CubicCurveTo:h.bezierCurveTo(f.p1,f.p2,f.p3),l=!1;break;case ne.Close:if(s!="butt"){if(h.hasOnlyMoveTo()){h.lineTo(h.moveToPt),l=!0;continue}if(h.isCurrentContourEmpty()){l=!0;continue}}h.close(l);break}return h.finish(l)}finish(e){return this.finishContour(!1,e),this.outer.clone()}hasOnlyMoveTo(){return this.segment_count==0}isCurrentContourEmpty(){return this.inner.isZeroLengthSincePoint(0)&&this.outer.isZeroLengthSincePoint(this.first_outer_pt_index_in_contour)}}const vi={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0},Hb=new Set(Object.keys(vi).concat(Object.keys(vi).map(r=>r.toLowerCase()))),Xb=/([mlhvaqtcsz])([^mlhvaqtcsz]+)?/gi,Zb=/-?\d*\.?\d+(e[-+]?\d+)?/gi;function Hc(r,e,n){return r>=e&&r<=n}function tp(r){return Hc(r.charCodeAt(0),1,32)}function ma(r){return Hc(r.charCodeAt(0),48,57)}function ep(r){return tp(r)||r===","}function Gb(r){return Hc(r.charCodeAt(0),97,122)}function Jb(r){return String.fromCharCode(r.charCodeAt(0)-97+65)}function Xc(r){let e=0;for(;r.length>0&&tp(r[e]);)e++;return r.slice(e)}function ga(r){let e=0;for(;r.length>0&&ep(r[e]);)e++;return r.slice(e)}function Qb(r,e){r=Xc(r);let n=0;for(n<r.length&&(r[n]==="+"||r[n]==="-")&&n++;n<r.length&&ma(r[n]);)n++;if(n<r.length&&r[n]===".")for(n++;n<r.length&&ma(r[n]);)n++;if(n<r.length&&(r[n]==="e"||r[n]==="E"))for(n++,n<r.length&&(r[n]==="+"||r[n]==="-")&&n++;n<r.length&&ma(r[n]);)n++;return n==0?(e.value=r,0):(e.value=r.substring(n),Number(r.substring(0,n)))}function np(r,e){r=Xc(r);let n={value:""},i=Qb(r,n);return r==n.value?"":(e&&(e.value=i),n.value)}function ip(r,e,n,i){return r=np(r,e),r?(n&&(e.value+=i),r=ga(r),r):""}function Kb(r,e,n){if(n>0){let i=0,s={value:0};for(;r=np(r,s),e[i]=s.value,!(--n==0||r.length<=0);)r=ga(r),i++}return r}function Vi(r,e,n,i,s){if(r=Kb(r,e,n),i)for(let o=0;o<n;o+=2)e[o]+=s.x,e[o+1]+=s.y;return r}function sp(r,e){let n=0,i=0,s=0,o=0,a=0,h=0,c=0,l=0,u="";for(let f=0,d=e.length;f<d;f++){const p=e[f];switch(p[0]){case"M":r.moveTo(p[1],p[2]),n=p[1],i=p[2],s=n,o=i;break;case"L":r.lineTo(p[1],p[2]),n=p[1],i=p[2];break;case"H":r.lineTo(p[1],i),n=p[1];break;case"V":r.lineTo(n,p[1]),i=p[1];break;case"Q":r.quadraticCurveTo(p[1],p[2],p[3],p[4]),a=p[1],h=p[2],n=p[3],i=p[4];break;case"T":c=n,l=i,(u==="Q"||u==="T")&&(c-=a-n,l-=h-i),r.quadraticCurveTo(c,l,p[1],p[2]),a=c,h=l,n=p[1],i=p[2];break;case"C":r.bezierCurveTo(p[1],p[2],p[3],p[4],p[5],p[6]),a=p[3],h=p[4],n=p[5],i=p[6];break;case"S":c=n,l=i,(u==="C"||u==="S")&&(c-=a-n,l-=h-i),r.bezierCurveTo(c,l,p[1],p[2],p[3],p[4]),a=p[1],h=p[2],n=p[3],i=p[4];break;case"A":{let y=n,x=i,m=p[1],g=p[2],w=p[3],M=!!p[4],S=!!p[5],E=p[6],A=p[7],I=E,b=A;ta(y,x,E,A,m,g,w,M,S,(v,_,z,P,k,B,R,L,N)=>{r.bezierCurveTo(z,P,k,B,R,L),I=R,b=L}),n=I,i=b}break;case"Z":r.closePath(),n=s,i=o;break}u=p[0]}}function tv(r,e){const n=op(e);sp(r,n)}function ev(r){const e=r.match(Zb);return e?e.map(Number):[]}function rp(r){const e=[],n=String(r).trim();return n[0]!=="M"&&n[0]!=="m"||n.replace(Xb,(i,s,o)=>{const a=ev(o);let h=s.toUpperCase(),c=s;if(h==="M"&&a.length>2&&(e.push([c,...a.splice(0,2)]),c=c==="m"?"l":"L"),a.length<vi[h])return"";for(e.push([c,...a.splice(0,vi[h])]);a.length>=vi[h]&&a.length&&vi[h];)e.push([c,...a.splice(0,vi[h])]);return""}),e}function Zc(r,e){let n={x:0,y:0},i={x:0,y:0},s={x:0,y:0},o=new Float32Array(7),a={value:0},h="",c="",l=!1;for(;e.length&&(e=Xc(e),e[0]!=="");){let u=e[0];if(ma(u)||u==="-"||u==="+"||u==="."){if(h==""||h=="Z")return!1}else ep(u)||(h=u,l=!1,Gb(u)&&(l=!0,h=Jb(u)),e=e.substring(1)),e=ga(e);switch(h){case"M":e=Vi(e,o,2,l,i),r.moveTo(o[0],o[1]),c="",h="L",i.x=o[0],i.y=o[1];break;case"L":e=Vi(e,o,2,l,i),r.lineTo(o[0],o[1]),i.x=o[0],i.y=o[1];break;case"H":e=ip(e,a,l,i.x),r.lineTo(a.value,i.y),i.x=a.value;break;case"V":e=ip(e,a,l,i.y),r.lineTo(i.x,a.value),i.y=a.value;break;case"C":e=Vi(e,o,6,l,i),r.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]),s.x=o[2],s.y=o[3],i.x=o[4],i.y=o[5];break;case"S":e=Vi(e,o.subarray(2),4,l,i),o[0]=i.x,o[1]=i.y,(c=="C"||c=="S")&&(o[0]-=s.x-i.x,o[1]-=s.y-i.y),r.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]),s.x=o[2],s.y=o[3],i.x=o[4],i.y=o[5];break;case"Q":e=Vi(e,o,4,l,i),r.quadraticCurveTo(o[0],o[1],o[2],o[3]),s.x=o[0],s.y=o[1],i.x=o[2],i.y=o[3];break;case"T":e=Vi(e,o.subarray(1),2,l,i),o[0]=i.x,o[1]=i.y,(c=="Q"||c=="T")&&(o[0]-=s.x-i.x,o[1]-=s.y-i.y),r.quadraticCurveTo(o[0],o[1],o[2],o[3]),s.x=o[0],s.y=o[1],i.x=o[2],i.y=o[3];break;case"A":e=Vi(e,o,7,!1);let f=i.x,d=i.y,p=o[0],y=o[1],x=o[2],m=!!o[3],g=!!o[4],w=o[5],M=o[6];w=l?w+i.x:w,M=l?M+i.y:M,ta(f,d,w,M,p,y,x,m,g,(S,E,A,I,b,v,_,z,P)=>{r.bezierCurveTo(A,I,b,v,_,z),i.x=_,i.y=z});break;case"Z":r.closePath(),i.x=n.x,i.y=n.y;break;default:return!1}c==""&&(n.x=i.x,n.y=i.y),c=h}return!0}function op(r){const e=[];let n=rp(r),i=0,s=0,o=0,a=0,h=0,c=0,l=0,u=0;for(let f=0,d=n.length;f<d;f++){const p=n[f];let y=p[0].toUpperCase(),x=y!==p[0],m=p.slice(1);switch(y){case"M":i=x?i+m[0]:m[0],s=x?s+m[1]:m[1],m[0]=i,m[1]=s,o=i,a=s;break;case"L":i=x?i+m[0]:m[0],s=x?s+m[1]:m[1],m[0]=i,m[1]=s;break;case"H":i=x?i+m[0]:m[0],m[0]=i;break;case"V":s=x?s+m[0]:m[0],m[0]=s;break;case"Q":h=x?i+m[0]:m[0],c=x?s+m[1]:m[1],i=x?i+m[2]:m[2],s=x?s+m[3]:m[3],m[0]=h,m[1]=c,m[2]=i,m[3]=s;break;case"T":i=x?i+m[0]:m[0],s=x?s+m[1]:m[1],m[0]=i,m[1]=s;break;case"C":h=x?i+m[0]:m[0],c=x?s+m[1]:m[1],l=x?i+m[2]:m[2],u=x?s+m[3]:m[3],i=x?i+m[4]:m[4],s=x?s+m[5]:m[5],m[0]=h,m[1]=c,m[2]=l,m[3]=u,m[4]=i,m[5]=s;break;case"S":l=x?i+m[0]:m[0],u=x?s+m[1]:m[1],i=x?i+m[2]:m[2],s=x?s+m[3]:m[3],m[0]=l,m[1]=u,m[2]=i,m[3]=s;break;case"A":let g=m[0],w=m[1],M=m[2],S=m[3],E=m[4];i=x?i+m[5]:m[5],s=x?s+m[6]:m[6],m[0]=g,m[1]=w,m[2]=M,m[3]=S,m[4]=E,m[5]=i,m[6]=s;break;case"Z":i=o,s=a;break}e.push([y].concat(m))}return e}class Gc{commands=[];dirty=!1;_cb=null;constructor(e){typeof e=="string"?Zc(this,e):e instanceof Gc&&(this.commands=[...e.commands])}fromSvgPath(e){Zc(this,e)}onChange(e){this._cb=e}equals(e){if(this.commands.length!==e.commands.length)return!1;for(let n=0;n<this.commands.length;n++){const i=this.commands[n],s=e.commands[n];if(i[0]!==s[0])return!1;for(let o=1;o<i.length;o++)if(i[o]!==s[o])return!1}return!0}reset(){this.commands.length=0,this.dirty=!0,this._cb?.()}clone(){return new this.constructor(this)}addCmd(e,n){this.commands.push([e].concat(n)),this.dirty=!0,this._cb?.()}addPath(e,n){this.commands=e.commands.slice()}arc(e,n,i,s,o,a=!1){this.addCmd("AC",[e,n,i,s,o,a])}arcTo(e,n,i,s,o){this.addCmd("AT",[e,n,i,s,o])}bezierCurveTo(e,n,i,s,o,a){this.addCmd("C",[e,n,i,s,o,a])}closePath(){this.commands.length>0&&this.commands[this.commands.length-1][0]!=="Z"&&this.addCmd("Z",[])}ellipse(e,n,i,s,o,a,h,c=!1){this.addCmd("E",[e,n,i,s,o,a,h,c])}lineTo(e,n){this.addCmd("L",[e,n])}moveTo(e,n){this.addCmd("M",[e,n])}quadraticCurveTo(e,n,i,s){this.addCmd("Q",[e,n,i,s])}rect(e,n,i,s){this.addCmd("R",[e,n,i,s])}roundRect(e,n,i,s,o){this.addCmd("RR",[e,n,i,s,o])}toPath2D(e=new Path2D){return this.toCanvas(e)}toCanvas(e){for(const n of this.commands)switch(n[0]){case"M":e.moveTo(n[1],n[2]);break;case"L":e.lineTo(n[1],n[2]);break;case"Q":e.quadraticCurveTo(n[1],n[2],n[3],n[4]);break;case"C":e.bezierCurveTo(n[1],n[2],n[3],n[4],n[5],n[6]);break;case"AC":e.arc(n[1],n[2],n[3],n[4],n[5],n[6]);break;case"E":e.ellipse(n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8]);break;case"AT":e.arcTo(n[1],n[2],n[3],n[4],n[5]);break;case"RR":e.roundRect(n[1],n[2],n[3],n[4],n[5]);break;case"R":e.rect(n[1],n[2],n[3],n[4]);break;case"Z":e.closePath();break}return e}}const nv=Object.freeze(Object.defineProperty({__proto__:null,AutoConicToQuads:Ab,Command:vi,CommandSet:Hb,Conic:pn,CubicCoeff:Od,FillRule:Hd,LineCap:Yd,LineJoin:jd,PathBuilder:Di,PathDirection:ua,PathIterVerb:Pd,PathSegmentsIter:pa,PathStroker:Yb,PathVerb:ne,ProxyPath2D:Gc,QuadCoeff:Bc,SCALAR_MAX:xb,SCALAR_NEARLY_ZERO:Oc,SCALAR_ROOT_2_OVER_2:Lc,SegmentMask:Id,build_unit_arc:Eb,chop_cubic_at:Cb,chop_cubic_at2:Nc,chop_quad_at:gb,eval_cubic_pos_at:fa,eval_cubic_tangent_at:qd,eval_quad_at:jr,eval_quad_tangent_at:Fd,find_cubic_cusp:Vd,find_cubic_extrema:Sb,find_cubic_inflections:$d,find_cubic_max_curvature:qc,find_quad_extrema:wb,find_quad_max_curvature:Bd,find_unit_quad_roots:Ur,new_t_values:Ld,parseSvgPath:op,parseSvgPathData:rp,pathFromSvgPath:Zc,pathFromSvgPath2:tv,pathFromSvgPathCommand:sp},Symbol.toStringTag,{value:"Module"})),ap=Math.PI*2;function wa(r){return r%=ap,r<0&&(r+=ap),r}const Yr=Math.PI*2;function hp(r,e,n,i,s,o,a,h,c){if(a===0)return!1;const l=a;h-=r,c-=e;const u=Math.sqrt(h*h+c*c);if(u-l>n||u+l<n)return!1;if(Math.abs(i-s)%Yr<1e-4)return!0;if(o){const d=i;i=wa(s),s=wa(d)}else i=wa(i),s=wa(s);i>s&&(s+=Yr);let f=Math.atan2(c,h);return f<0&&(f+=Yr),f>=i&&f<=s||f+Yr>=i&&f+Yr<=s}const iv=Object.freeze(Object.defineProperty({__proto__:null,containStroke:hp},Symbol.toStringTag,{value:"Module"}));function cp(r,e,n,i,s,o,a,h,c,l,u){if(c===0)return!1;const f=c;return u>e+f&&u>i+f&&u>o+f&&u>h+f||u<e-f&&u<i-f&&u<o-f&&u<h-f||l>r+f&&l>n+f&&l>s+f&&l>a+f||l<r-f&&l<n-f&&l<s-f&&l<a-f?!1:dd(r,e,n,i,s,o,a,h,l,u,null)<=f/2}const sv=Object.freeze(Object.defineProperty({__proto__:null,containStroke:cp},Symbol.toStringTag,{value:"Module"}));function Ui(r,e,n,i,s,o,a){if(s===0)return!1;const h=s;let c=0,l=r;if(a>e+h&&a>i+h||a<e-h&&a<i-h||o>r+h&&o>n+h||o<r-h&&o<n-h)return!1;if(r!==n)c=(e-i)/(r-n),l=(r*i-n*e)/(r-n);else return Math.abs(o-r)<=h/2;const u=c*o-a+l;return u*u/(c*c+1)<=h/2*h/2}const rv=Object.freeze(Object.defineProperty({__proto__:null,containStroke:Ui},Symbol.toStringTag,{value:"Module"}));function lp(r,e,n,i,s,o,a,h,c){if(a===0)return!1;const l=a;return c>e+l&&c>i+l&&c>o+l||c<e-l&&c<i-l&&c<o-l||h>r+l&&h>n+l&&h>s+l||h<r-l&&h<n-l&&h<s-l?!1:fd(r,e,n,i,s,o,h,c,null)<=l/2}const ov=Object.freeze(Object.defineProperty({__proto__:null,containStroke:lp},Symbol.toStringTag,{value:"Module"}));function Qn(r,e,n,i,s,o){if(o>e&&o>i||o<e&&o<i||i===e)return 0;const a=(o-e)/(i-e);let h=i<e?1:-1;(a===1||a===0)&&(h=i<e?.5:-.5);const c=a*(n-r)+r;return c===s?1/0:c>s?h:0}const av=Object.freeze(Object.defineProperty({__proto__:null,default:Qn},Symbol.toStringTag,{value:"Module"})),Wi={M:"M",L:"L",C:"C",Q:"Q",Z:"Z",R:"R",E:"E"},ji=Math.PI*2,hv=1e-4;function cv(r,e){return Math.abs(r-e)<hv}const Te=[-1,-1,-1],Ke=[-1,-1];function lv(){const r=Ke[0];Ke[0]=Ke[1],Ke[1]=r}function up(r,e,n,i,s,o,a,h,c,l){if(l>e&&l>i&&l>o&&l>h||l<e&&l<i&&l<o&&l<h)return 0;const u=bd(e,i,o,h,l,Te);if(u===0)return 0;{let f=0,d=-1,p=0,y=0;for(let x=0;x<u;x++){let m=Te[x],g=m===0||m===1?.5:1;_e(r,n,s,a,m)<c||(d<0&&(d=Ac(e,i,o,h,Ke),Ke[1]<Ke[0]&&d>1&&lv(),p=_e(e,i,o,h,Ke[0]),d>1&&(y=_e(e,i,o,h,Ke[1]))),d===2?m<Ke[0]?f+=p<e?g:-g:m<Ke[1]?f+=y<p?g:-g:f+=h<y?g:-g:m<Ke[0]?f+=p<e?g:-g:f+=h<p?g:-g)}return f}}function fp(r,e,n,i,s,o,a,h){if(h>e&&h>i&&h>o||h<e&&h<i&&h<o)return 0;const c=Md(e,i,o,h,Te);if(c===0)return 0;{const l=Pc(e,i,o);if(l>=0&&l<=1){let u=0,f=Se(e,i,o,l);for(let d=0;d<c;d++){let p=Te[d]===0||Te[d]===1?.5:1;Se(r,n,s,Te[d])<a||(Te[d]<l?u+=f<e?p:-p:u+=o<f?p:-p)}return u}else{const u=Te[0]===0||Te[0]===1?.5:1;return Se(r,n,s,Te[0])<a?0:o<e?u:-u}}}function dp(r,e,n,i,s,o,a,h){if(h-=e,h>n||h<-n)return 0;const c=Math.sqrt(n*n-h*h);Te[0]=-c,Te[1]=c;const l=Math.abs(i-s);if(l<1e-4)return 0;if(l>=ji-1e-4){i=0,s=ji;const f=o?1:-1;return a>=Te[0]+r&&a<=Te[1]+r?f:0}if(i>s){const f=i;i=s,s=f}i<0&&(i+=ji,s+=ji);let u=0;for(let f=0;f<2;f++){const d=Te[f];if(d+r>a){let p=Math.atan2(h,d),y=o?1:-1;p<0&&(p=ji+p),(p>=i&&p<=s||p+ji>=i&&p+ji<=s)&&(p>Math.PI/2&&p<Math.PI*1.5&&(y=-y),u+=y)}}return u}function pp(r,e,n,i,s){const o=r.commands,a=r.commands.length;let h=0,c=0,l=0,u=0,f=0,d,p;for(let y=0;y<a;){let x=0,m=o[y];const g=m[x++];switch(c=m[x],l=m[x+1],u=c,f=l,g){case Wi.M:u=m[x++],f=m[x++],c=u,l=f;break;case Wi.L:if(n){if(Ui(c,l,m[x],m[x+1],e,i,s))return!0}else h+=Qn(c,l,m[x],m[x+1],i,s)||0;c=m[x++],l=m[x++];break;case Wi.C:if(n){if(cp(c,l,m[x++],m[x++],m[x++],m[x++],m[x],m[x+1],e,i,s))return!0}else h+=up(c,l,m[x++],m[x++],m[x++],m[x++],m[x],m[x+1],i,s)||0;c=m[x++],l=m[x++];break;case Wi.Q:if(n){if(lp(c,l,m[x++],m[x++],m[x],m[x+1],e,i,s))return!0}else h+=fp(c,l,m[x++],m[x++],m[x],m[x+1],i,s)||0;c=m[x++],l=m[x++];break;case Wi.E:const w=m[x++],M=m[x++],S=m[x++],E=m[x++],A=m[x++],I=m[x++];x+=1;const b=!!(1-m[x++]);d=Math.cos(A)*S+w,p=Math.sin(A)*E+M,u=d,f=p;const v=(i-w)*E/S+w;if(n){if(hp(w,M,E,A,A+I,b,e,v,s))return!0}else h+=dp(w,M,E,A,A+I,b,v,s);c=Math.cos(A+I)*S+w,l=Math.sin(A+I)*E+M;break;case Wi.R:u=c=m[x++],f=l=m[x++];const _=m[x++],z=m[x++];if(d=u+_,p=f+z,n){if(Ui(u,f,d,f,e,i,s)||Ui(d,f,d,p,e,i,s)||Ui(d,p,u,p,e,i,s)||Ui(u,p,u,f,e,i,s))return!0}else h+=Qn(d,f,d,p,i,s),h+=Qn(u,p,u,f,i,s);break;case Wi.Z:if(n){if(Ui(c,l,u,f,e,i,s))return!0}else h+=Qn(c,l,u,f,i,s);c=u,l=f;break}}return!n&&!cv(l,f)&&(h+=Qn(c,l,u,f,i,s)||0),h!==0}function uv(r,e,n){return pp(r,0,!1,e,n)}function fv(r,e,n,i){return pp(r,e,!0,n,i)}const dv=Object.freeze(Object.defineProperty({__proto__:null,contain:uv,containStroke:fv,windingArc:dp,windingCubic:up,windingLine:Qn,windingQuadratic:fp},Symbol.toStringTag,{value:"Module"})),pv=1e-8;function yp(r,e){return Math.abs(r-e)<pv}function yv(r,e,n){let i=0,s=r[0];if(!s)return!1;for(let a=1;a<r.length;a++){const h=r[a];i+=Qn(s[0],s[1],h[0],h[1],e,n),s=h}const o=r[0];return(!yp(s[0],o[0])||!yp(s[1],o[1]))&&(i+=Qn(s[0],s[1],o[0],o[1],e,n)),i!==0}const xv=Object.freeze(Object.defineProperty({__proto__:null,contain:yv},Symbol.toStringTag,{value:"Module"}));let yn=class Wg{x;y;constructor(e,n){this.x=e||0,this.y=n||0}copy(e){return this.x=e.x,this.y=e.y,this}clone(){return new Wg(this.x,this.y)}set(e,n){return this.x=e,this.y=n,this}equal(e){return e.x===this.x&&e.y===this.y}add(e){return this.x+=e.x,this.y+=e.y,this}scale(e){this.x*=e,this.y*=e}scaleAndAdd(e,n){this.x+=e.x*n,this.y+=e.y*n}sub(e){return this.x-=e.x,this.y-=e.y,this}dot(e){return this.x*e.x+this.y*e.y}len(){return Math.sqrt(this.x*this.x+this.y*this.y)}lenSquare(){return this.x*this.x+this.y*this.y}normalize(){const e=this.len();return this.x/=e,this.y/=e,this}distance(e){const n=this.x-e.x,i=this.y-e.y;return Math.sqrt(n*n+i*i)}distanceSquare(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}negate(){return this.x=-this.x,this.y=-this.y,this}transform(e){if(!e)return;const n=this.x,i=this.y;return this.x=e[0]*n+e[2]*i+e[4],this.y=e[1]*n+e[3]*i+e[5],this}toArray(e){return e[0]=this.x,e[1]=this.y,e}fromArray(e){this.x=e[0],this.y=e[1]}static set(e,n,i){e.x=n,e.y=i}static copy(e,n){e.x=n.x,e.y=n.y}static len(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static lenSquare(e){return e.x*e.x+e.y*e.y}static dot(e,n){return e.x*n.x+e.y*n.y}static add(e,n,i){e.x=n.x+i.x,e.y=n.y+i.y}static sub(e,n,i){e.x=n.x-i.x,e.y=n.y-i.y}static scale(e,n,i){e.x=n.x*i,e.y=n.y*i}static scaleAndAdd(e,n,i,s){e.x=n.x+i.x*s,e.y=n.y+i.y*s}static lerp(e,n,i,s){const o=1-s;e.x=o*n.x+s*i.x,e.y=o*n.y+s*i.y}};const Yi=Math.min,Js=Math.max,Jc=Math.abs,xp=["x","y"],mv=["width","height"],Hi=new yn,Xi=new yn,Zi=new yn,Gi=new yn,Ue=gp(),Hr=Ue.minTv,Qc=Ue.maxTv,Xr=[0,0];class ae{x=0;y=0;width=0;height=0;constructor(e,n,i,s){ae.set(this,e,n,i,s)}static set(e,n,i,s,o){return s<0&&(n=n+s,s=-s),o<0&&(i=i+o,o=-o),e.x=n,e.y=i,e.width=s,e.height=o,e}union(e){const n=Yi(e.x,this.x),i=Yi(e.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=Js(e.x+e.width,this.x+this.width)-n:this.width=e.width,isFinite(this.y)&&isFinite(this.height)?this.height=Js(e.y+e.height,this.y+this.height)-i:this.height=e.height,this.x=n,this.y=i}applyTransform(e){ae.applyTransform(this,this,e)}calculateTransform(e){const n=this,i=e.width/n.width,s=e.height/n.height,o=re.default();return re.translate(o,o,[-n.x,-n.y]),re.scale(o,o,[i,s]),re.translate(o,o,[e.x,e.y]),o}intersect(e,n,i){return ae.intersect(this,e,n,i)}static intersect(e,n,i,s){i&&yn.set(i,0,0);const o=s&&s.outIntersectRect||null,a=s&&s.clamp;if(o&&(o.x=o.y=o.width=o.height=NaN),!e||!n)return!1;e instanceof ae||(e=ae.set(gv,e.x,e.y,e.width,e.height)),n instanceof ae||(n=ae.set(wv,n.x,n.y,n.width,n.height));const h=!!i;Ue.reset(s,h);const c=Ue.touchThreshold,l=e.x+c,u=e.x+e.width-c,f=e.y+c,d=e.y+e.height-c,p=n.x+c,y=n.x+n.width-c,x=n.y+c,m=n.y+n.height-c;if(l>u||f>d||p>y||x>m)return!1;const g=!(u<p||y<l||d<x||m<f);return(h||o)&&(Xr[0]=1/0,Xr[1]=0,mp(l,u,p,y,0,h,o,a),mp(f,d,x,m,1,h,o,a),h&&yn.copy(i,g?Ue.useDir?Ue.dirMinTv:Hr:Qc)),g}static contain(e,n,i){return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}contain(e,n){return ae.contain(this,e,n)}clone(){return new ae(this.x,this.y,this.width,this.height)}copy(e){ae.copy(this,e)}plain(){return{x:this.x,y:this.y,width:this.width,height:this.height}}isFinite(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)}isZero(){return this.width===0||this.height===0}static create(e){return new ae(e.x,e.y,e.width,e.height)}static copy(e,n){return e.x=n.x,e.y=n.y,e.width=n.width,e.height=n.height,e}static applyTransform(e,n,i){if(!i){e!==n&&ae.copy(e,n);return}if(i[1]<1e-5&&i[1]>-1e-5&&i[2]<1e-5&&i[2]>-1e-5){const a=i[0],h=i[3],c=i[4],l=i[5];e.x=n.x*a+c,e.y=n.y*h+l,e.width=n.width*a,e.height=n.height*h,e.width<0&&(e.x+=e.width,e.width=-e.width),e.height<0&&(e.y+=e.height,e.height=-e.height);return}Hi.x=Zi.x=n.x,Hi.y=Gi.y=n.y,Xi.x=Gi.x=n.x+n.width,Xi.y=Zi.y=n.y+n.height,Hi.transform(i),Gi.transform(i),Xi.transform(i),Zi.transform(i),e.x=Yi(Hi.x,Xi.x,Zi.x,Gi.x),e.y=Yi(Hi.y,Xi.y,Zi.y,Gi.y);const s=Js(Hi.x,Xi.x,Zi.x,Gi.x),o=Js(Hi.y,Xi.y,Zi.y,Gi.y);e.width=s-e.x,e.height=o-e.y}}const gv=new ae(0,0,0,0),wv=new ae(0,0,0,0);function mp(r,e,n,i,s,o,a,h){const c=Jc(e-n),l=Jc(i-r),u=Yi(c,l),f=xp[s],d=xp[1-s],p=mv[s];e<n||i<r?c<l?(o&&(Qc[f]=-c),h&&(a[f]=e,a[p]=0)):(o&&(Qc[f]=l),h&&(a[f]=r,a[p]=0)):(a&&(a[f]=Js(r,n),a[p]=Yi(e,i)-a[f]),o&&(u<Xr[0]||Ue.useDir)&&(Xr[0]=Yi(u,Xr[0]),(c<l||!Ue.bidirectional)&&(Hr[f]=c,Hr[d]=0,Ue.useDir&&Ue.calcDirMTV()),(c>=l||!Ue.bidirectional)&&(Hr[f]=-l,Hr[d]=0,Ue.useDir&&Ue.calcDirMTV())))}function gp(){let r=0;const e=new yn,n=new yn,i={minTv:new yn,maxTv:new yn,useDir:!1,dirMinTv:new yn,touchThreshold:0,bidirectional:!0,negativeSize:!1,reset(o,a){i.touchThreshold=0,o&&o.touchThreshold!=null&&(i.touchThreshold=Js(0,o.touchThreshold)),i.negativeSize=!1,a&&(i.minTv.set(1/0,1/0),i.maxTv.set(0,0),i.useDir=!1,o&&o.direction!=null&&(i.useDir=!0,i.dirMinTv.copy(i.minTv),n.copy(i.minTv),r=o.direction,i.bidirectional=o.bidirectional==null||!!o.bidirectional,i.bidirectional||e.set(Math.cos(r),Math.sin(r))))},calcDirMTV(){const o=i.minTv,a=i.dirMinTv,h=o.y*o.y+o.x*o.x,c=Math.sin(r),l=Math.cos(r),u=c*o.y+l*o.x;if(s(u)){s(o.x)&&s(o.y)&&a.set(0,0);return}if(n.x=h*l/u,n.y=h*c/u,s(n.x)&&s(n.y)){a.set(0,0);return}(i.bidirectional||e.dot(n)>0)&&n.len()<a.len()&&a.copy(n)}};function s(o){return Jc(o)<1e-10}return i}class Kc{value;key;next;prev;constructor(e){this.value=e}}let wp=class{head;tail;_len=0;insert(e){const n=new Kc(e);return this.insertEntry(n),n}insertEntry(e){this.head?(this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e):this.head=this.tail=e,this._len++}remove(e){const n=e.prev,i=e.next;n?n.next=i:this.head=i,i?i.prev=n:this.tail=n,e.next=e.prev=null,this._len--}len(){return this._len}clear(){this.head=this.tail=null,this._len=0}};class bp{_list=new wp;_maxSize=10;_lastRemovedEntry;_map={};constructor(e){this._maxSize=e}put(e,n){const i=this._list,s=this._map;let o=null;if(s[e]==null){const a=i.len();let h=this._lastRemovedEntry;if(a>=this._maxSize&&a>0){const c=i.head;i.remove(c),delete s[c.key],o=c.value,this._lastRemovedEntry=c}h?h.value=n:h=new Kc(n),h.key=e,i.insertEntry(h),s[e]=h}return o}get(e){const n=this._map[e],i=this._list;if(n!=null)return n!==i.tail&&(i.remove(n),i.insertEntry(n)),n.value}clear(){this._list.clear(),this._map={}}len(){return this._list.len()}}const vp=12,ba=`${vp}px sans-serif`,bv=20,vv=100,Mv="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function _v(r){const e={};if(typeof JSON>"u")return e;for(let n=0;n<r.length;n++){const i=String.fromCharCode(n+32),s=(r.charCodeAt(n)-bv)/vv;e[i]=s}return e}const Sv=_v(Mv),Qs={createCanvas(){return typeof document<"u"&&document.createElement("canvas")},measureText:function(){let r,e;return(n,i)=>{if(!r){const s=Qs.createCanvas();r=s&&s.getContext("2d")}if(r)return e!==i&&(e=r.font=i||ba),r.measureText(n);{n=n||"",i=i||ba;const s=/((?:\d+)?\.?\d*)px/.exec(i),o=s&&+s[1]||vp;let a=0;if(i.indexOf("mono")>=0)a=o*n.length;else for(let h=0;h<n.length;h++){const c=Sv[n[h]];a+=c==null?o:c*o}return{width:a}}}}(),loadImage(r,e,n){const i=new Image;return i.onload=e,i.onerror=n,i.src=r,i}};function Tv(r,e){return el(va(e),r)}function va(r){Ma||(Ma=new bp(100)),r=r||ba;let e=Ma.get(r);return e||(e={font:r,strWidthCache:new bp(500),asciiWidthMap:null,asciiWidthMapTried:!1,stWideCharWidth:Qs.measureText("国",r).width,asciiCharWidth:Qs.measureText("a",r).width},Ma.put(r,e)),e}let Ma;function Ev(r){if(tl>=Mp)return;r=r||ba;const e=[],n=+new Date;for(let s=0;s<=127;s++)e[s]=Qs.measureText(String.fromCharCode(s),r).width;const i=+new Date-n;return i>16?tl=Mp:i>2&&tl++,e}let tl=0;const Mp=5;function zv(r,e){return r.asciiWidthMapTried||(r.asciiWidthMap=Ev(r.font),r.asciiWidthMapTried=!0),0<=e&&e<=127?r.asciiWidthMap!=null?r.asciiWidthMap[e]:r.asciiCharWidth:r.stWideCharWidth}function el(r,e){const n=r.strWidthCache;let i=n.get(e);return i==null&&(i=Qs.measureText(e,r.font).width,n.put(e,i)),i}function nl(r,e,n,i){const s=el(va(e),r),o=Tp(e),a=_p(0,s,n),h=Sp(0,o,i);return new ae(a,h,s,o)}function Av(r,e,n,i){const s=((r||"")+"").split(`
`);if(s.length===1)return nl(s[0],e,n,i);{const a=new ae(0,0,0,0);for(let h=0;h<s.length;h++){const c=nl(s[h],e,n,i);h===0?a.copy(c):a.union(c)}return a}}function _p(r,e,n,i){return n==="right"?i?r+=e:r-=e:n==="center"&&(i?r+=e/2:r-=e/2),r}function Sp(r,e,n,i){return n==="middle"?i?r+=e/2:r-=e/2:n==="bottom"&&(i?r+=e:r-=e),r}function Tp(r){return va(r).stWideCharWidth}function Cv(r,e){return Qs.measureText(r,e)}function il(r,e){return typeof r=="string"?r.lastIndexOf("%")>=0?parseFloat(r)/100*e:parseFloat(r):r}function Pv(r,e,n){const i=e.position||"inside",s=e.distance!=null?e.distance:5,o=n.height,a=n.width,h=o/2;let c=n.x,l=n.y,u="left",f="top";if(i instanceof Array)c+=il(i[0],n.width),l+=il(i[1],n.height),u=null,f=null;else switch(i){case"left":c-=s,l+=h,u="right",f="middle";break;case"right":c+=s+a,l+=h,f="middle";break;case"top":c+=a/2,l-=s,u="center",f="bottom";break;case"bottom":c+=a/2,l+=o+s,u="center";break;case"inside":c+=a/2,l+=h,u="center",f="middle";break;case"insideLeft":c+=s,l+=h,f="middle";break;case"insideRight":c+=a-s,l+=h,u="right",f="middle";break;case"insideTop":c+=a/2,l+=s,u="center";break;case"insideBottom":c+=a/2,l+=o-s,u="center",f="bottom";break;case"insideTopLeft":c+=s,l+=s;break;case"insideTopRight":c+=a-s,l+=s,u="right";break;case"insideBottomLeft":c+=s,l+=o-s,f="bottom";break;case"insideBottomRight":c+=a-s,l+=o-s,u="right",f="bottom";break}return r=r||{},r.x=c,r.y=l,r.align=u,r.verticalAlign=f,r}const Iv=Object.freeze(Object.defineProperty({__proto__:null,arc:iv,cubic:sv,line:rv,path:dv,polygon:xv,quadratic:ov,text:Object.freeze(Object.defineProperty({__proto__:null,adjustTextX:_p,adjustTextY:Sp,calculateTextPosition:Pv,ensureFontMeasureInfo:va,getBoundingRect:Av,getLineHeight:Tp,getWidth:Tv,innerGetBoundingRect:nl,measureCharWidth:zv,measureText:Cv,measureWidth:el,parsePercent:il},Symbol.toStringTag,{value:"Module"})),windingLine:av},Symbol.toStringTag,{value:"Module"})),Oe=Math.min,Le=Math.max,sl=Math.sin,rl=Math.cos,Ji=Math.PI*2,_a=et.create(),Sa=et.create(),Ta=et.create();function kv(r,e,n){if(r.length===0)return;let i=r[0],s=i[0],o=i[0],a=i[1],h=i[1];for(let c=1;c<r.length;c++)i=r[c],s=Oe(s,i[0]),o=Le(o,i[0]),a=Oe(a,i[1]),h=Le(h,i[1]);e[0]=s,e[1]=a,n[0]=o,n[1]=h}function ol(r,e,n,i,s,o){s[0]=Oe(r,n),s[1]=Oe(e,i),o[0]=Le(r,n),o[1]=Le(e,i)}const Ep=[],zp=[];function Ap(r,e,n,i,s,o,a,h,c,l){const u=Ac,f=_e;let d=u(r,n,s,a,Ep);c[0]=1/0,c[1]=1/0,l[0]=-1/0,l[1]=-1/0;for(let p=0;p<d;p++){const y=f(r,n,s,a,Ep[p]);c[0]=Oe(y,c[0]),l[0]=Le(y,l[0])}d=u(e,i,o,h,zp);for(let p=0;p<d;p++){const y=f(e,i,o,h,zp[p]);c[1]=Oe(y,c[1]),l[1]=Le(y,l[1])}c[0]=Oe(r,c[0]),l[0]=Le(r,l[0]),c[0]=Oe(a,c[0]),l[0]=Le(a,l[0]),c[1]=Oe(e,c[1]),l[1]=Le(e,l[1]),c[1]=Oe(h,c[1]),l[1]=Le(h,l[1])}function Cp(r,e,n,i,s,o,a,h){const c=Pc,l=Se,u=Le(Oe(c(r,n,s),1),0),f=Le(Oe(c(e,i,o),1),0),d=l(r,n,s,u),p=l(e,i,o,f);a[0]=Oe(r,s,d),a[1]=Oe(e,o,p),h[0]=Le(r,s,d),h[1]=Le(e,o,p)}function Pp(r,e,n,i,s,o,a,h,c){const l=et.min,u=et.max,f=Math.abs(s-o);if(f%Ji<1e-4&&f>1e-4){h[0]=r-n,h[1]=e-i,c[0]=r+n,c[1]=e+i;return}if(_a[0]=rl(s)*n+r,_a[1]=sl(s)*i+e,Sa[0]=rl(o)*n+r,Sa[1]=sl(o)*i+e,l(h,_a,Sa),u(c,_a,Sa),s=s%Ji,s<0&&(s=s+Ji),o=o%Ji,o<0&&(o=o+Ji),s>o&&!a?o+=Ji:s<o&&a&&(s+=Ji),a){const d=o;o=s,s=d}for(let d=0;d<o;d+=Math.PI/2)d>s&&(Ta[0]=rl(d)*n+r,Ta[1]=sl(d)*i+e,l(h,Ta,h),u(c,Ta,c))}const Rv=()=>typeof window<"u"&&typeof window.document<"u";let al=1;Rv()&&(al=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));const Lt={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},Qi=et.create(),Ki=et.create(),Rn=et.create(),Mi=et.create(),On=et.create(),Ln=et.create(),hl=Math.min,cl=Math.max,ts=Math.cos,es=Math.sin,Kn=Math.abs,ll=Math.PI,_i=ll*2,ul=typeof Float32Array<"u",Zr=[];function fl(r){return Math.round(r/ll*1e8)/1e8%2*ll}function Ip(r,e){let n=fl(r[0]);n<0&&(n+=_i);let i=n-r[0],s=r[1];s+=i,!e&&s-n>=_i?s=n+_i:e&&n-s>=_i?s=n-_i:!e&&n>s?s=n+(_i-fl(n-s)):e&&n<s&&(s=n-(_i-fl(s-n))),r[0]=n,r[1]=s}class dl{dpr=1;data;_version;_saveData;_pendingPtX;_pendingPtY;_pendingPtDist;_ctx;_xi=0;_yi=0;_x0=0;_y0=0;_len=0;_pathSegLen;_pathLen;_ux;_uy;static CMD=Lt;constructor(e){e&&(this._saveData=!1),this._saveData&&(this.data=[])}increaseVersion(){this._version++}getVersion(){return this._version}setScale(e,n,i){i=i||0,i>0&&(this._ux=Kn(i/al/e)||0,this._uy=Kn(i/al/n)||0)}setDPR(e){this.dpr=e}setContext(e){this._ctx=e}getContext(){return this._ctx}beginPath(){return this._ctx&&this._ctx.beginPath(),this.reset(),this}reset(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++}moveTo(e,n){return this._drawPendingPt(),this.addData(Lt.M,e,n),this._ctx&&this._ctx.moveTo(e,n),this._x0=e,this._y0=n,this._xi=e,this._yi=n,this}lineTo(e,n){const i=Kn(e-this._xi),s=Kn(n-this._yi),o=i>this._ux||s>this._uy;if(this.addData(Lt.L,e,n),this._ctx&&o&&this._ctx.lineTo(e,n),o)this._xi=e,this._yi=n,this._pendingPtDist=0;else{const a=i*i+s*s;a>this._pendingPtDist&&(this._pendingPtX=e,this._pendingPtY=n,this._pendingPtDist=a)}return this}bezierCurveTo(e,n,i,s,o,a){return this._drawPendingPt(),this.addData(Lt.C,e,n,i,s,o,a),this._ctx&&this._ctx.bezierCurveTo(e,n,i,s,o,a),this._xi=o,this._yi=a,this}quadraticCurveTo(e,n,i,s){return this._drawPendingPt(),this.addData(Lt.Q,e,n,i,s),this._ctx&&this._ctx.quadraticCurveTo(e,n,i,s),this._xi=i,this._yi=s,this}arc(e,n,i,s,o,a=!1){this._drawPendingPt(),Zr[0]=s,Zr[1]=o,Ip(Zr,a),s=Zr[0],o=Zr[1];let h=o-s;return this.addData(Lt.A,e,n,i,i,s,h,0,a?0:1),this._ctx&&this._ctx.arc(e,n,i,s,o,a),this._xi=ts(o)*i+e,this._yi=es(o)*i+n,this}arcTo(e,n,i,s,o){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(e,n,i,s,o),this}rect(e,n,i,s){return this._drawPendingPt(),this._ctx&&this._ctx.rect(e,n,i,s),this.addData(Lt.R,e,n,i,s),this}closePath(){this._drawPendingPt(),this.addData(Lt.Z);const e=this._ctx,n=this._x0,i=this._y0;return e&&e.closePath(),this._xi=n,this._yi=i,this}fill(e){e&&e.fill(),this.toStatic()}stroke(e){e&&e.stroke(),this.toStatic()}len(){return this._len}setData(e){if(!this._saveData)return;const n=e.length;!(this.data&&this.data.length===n)&&ul&&(this.data=new Float32Array(n));for(let i=0;i<n;i++)this.data[i]=e[i];this._len=n}appendPath(e){if(!this._saveData)return;e instanceof Array||(e=[e]);const n=e.length;let i=0,s=this._len;for(let a=0;a<n;a++)i+=e[a].len();const o=this.data;if(ul&&(o instanceof Float32Array||!o)&&(this.data=new Float32Array(s+i),s>0&&o))for(let a=0;a<s;a++)this.data[a]=o[a];for(let a=0;a<n;a++){const h=e[a].data;for(let c=0;c<h.length;c++)this.data[s++]=h[c]}this._len=s}addData(e,n,i,s,o,a,h,c,l){if(!this._saveData)return;let u=this.data;this._len+arguments.length>u.length&&(this._expandData(),u=this.data);for(let f=0;f<arguments.length;f++)u[this._len++]=arguments[f]}_drawPendingPt(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)}_expandData(){if(!(this.data instanceof Array)){const e=[];for(let n=0;n<this._len;n++)e[n]=this.data[n];this.data=e}}toStatic(){if(!this._saveData)return;this._drawPendingPt();const e=this.data;e instanceof Array&&(e.length=this._len,ul&&this._len>11&&(this.data=new Float32Array(e)))}getBoundingRect(){Rn[0]=Rn[1]=On[0]=On[1]=Number.MAX_VALUE,Mi[0]=Mi[1]=Ln[0]=Ln[1]=-Number.MAX_VALUE;const e=this.data;let n=0,i=0,s=0,o=0,a;for(a=0;a<this._len;){const h=e[a++],c=a===1;switch(c&&(n=e[a],i=e[a+1],s=n,o=i),h){case Lt.M:n=s=e[a++],i=o=e[a++],On[0]=s,On[1]=o,Ln[0]=s,Ln[1]=o;break;case Lt.L:ol(n,i,e[a],e[a+1],On,Ln),n=e[a++],i=e[a++];break;case Lt.C:Ap(n,i,e[a++],e[a++],e[a++],e[a++],e[a],e[a+1],On,Ln),n=e[a++],i=e[a++];break;case Lt.Q:Cp(n,i,e[a++],e[a++],e[a],e[a+1],On,Ln),n=e[a++],i=e[a++];break;case Lt.A:const l=e[a++],u=e[a++],f=e[a++],d=e[a++],p=e[a++],y=e[a++]+p;a+=1;const x=!e[a++];c&&(s=ts(p)*f+l,o=es(p)*d+u),Pp(l,u,f,d,p,y,x,On,Ln),n=ts(y)*f+l,i=es(y)*d+u;break;case Lt.R:s=n=e[a++],o=i=e[a++];const m=e[a++],g=e[a++];ol(s,o,s+m,o+g,On,Ln);break;case Lt.Z:n=s,i=o;break}et.min(Rn,Rn,On),et.max(Mi,Mi,Ln)}return a===0&&(Rn[0]=Rn[1]=Mi[0]=Mi[1]=0),new ae(Rn[0],Rn[1],Mi[0]-Rn[0],Mi[1]-Rn[1])}_calculateLength(){const e=this.data,n=this._len,i=this._ux,s=this._uy;let o=0,a=0,h=0,c=0;this._pathSegLen||(this._pathSegLen=[]);const l=this._pathSegLen;let u=0,f=0;for(let d=0;d<n;){const p=e[d++],y=d===1;y&&(o=e[d],a=e[d+1],h=o,c=a);let x=-1;switch(p){case Lt.M:o=h=e[d++],a=c=e[d++];break;case Lt.L:{const I=e[d++],b=e[d++],v=I-o,_=b-a;(Kn(v)>i||Kn(_)>s||d===n-1)&&(x=Math.sqrt(v*v+_*_),o=I,a=b);break}case Lt.C:{const I=e[d++],b=e[d++],v=e[d++],_=e[d++],z=e[d++],P=e[d++];x=vd(o,a,I,b,v,_,z,P,10),o=z,a=P;break}case Lt.Q:{const I=e[d++],b=e[d++],v=e[d++],_=e[d++];x=_d(o,a,I,b,v,_,10),o=v,a=_;break}case Lt.A:const m=e[d++],g=e[d++],w=e[d++],M=e[d++],S=e[d++];let E=e[d++];const A=E+S;d+=1,y&&(h=ts(S)*w+m,c=es(S)*M+g),x=cl(w,M)*hl(_i,Math.abs(E)),o=ts(A)*w+m,a=es(A)*M+g;break;case Lt.R:{h=o=e[d++],c=a=e[d++];const I=e[d++],b=e[d++];x=I*2+b*2;break}case Lt.Z:{const I=h-o,b=c-a;x=Math.sqrt(I*I+b*b),o=h,a=c;break}}x>=0&&(l[f++]=x,u+=x)}return this._pathLen=u,u}rebuildPath(e,n){const i=this.data,s=this._ux,o=this._uy,a=this._len;let h=0,c=0,l=0,u=0,f=0,d=0;const p=n<1;let y=[],x,m=0,g=0,w=0,M=0,S=0,E=0;if(!(p&&(this._pathSegLen||this._calculateLength(),y=this._pathSegLen,x=this._pathLen,w=n*x,!w)))t:for(let A=0;A<a;){const I=i[A++],b=A===1;switch(b&&(l=i[A],u=i[A+1],h=l,c=u),I!==Lt.L&&M>0&&(e.lineTo(S,E),M=0),I){case Lt.M:h=l=i[A++],c=u=i[A++],e.moveTo(l,u);break;case Lt.L:{f=i[A++],d=i[A++];const ot=Kn(f-l),ut=Kn(d-u);if(ot>s||ut>o){if(p){const ct=y[g++];if(m+ct>w){const gt=(w-m)/ct;e.lineTo(l*(1-gt)+f*gt,u*(1-gt)+d*gt);break t}m+=ct}e.lineTo(f,d),l=f,u=d,M=0}else{const ct=ot*ot+ut*ut;ct>M&&(S=f,E=d,M=ct)}break}case Lt.C:{const ot=i[A++],ut=i[A++],ct=i[A++],gt=i[A++],Nt=i[A++],se=i[A++];if(p){const ee=y[g++];if(m+ee>w){const $e=(w-m)/ee;Cc(l,ot,ct,Nt,$e,Qi),Cc(u,ut,gt,se,$e,Ki),e.bezierCurveTo(Qi[1],Ki[1],Qi[2],Ki[2],Qi[3],Ki[3]);break t}m+=ee}e.bezierCurveTo(ot,ut,ct,gt,Nt,se),l=Nt,u=se;break}case Lt.Q:{const ot=i[A++],ut=i[A++],ct=i[A++],gt=i[A++];if(p){const Nt=y[g++];if(m+Nt>w){const se=(w-m)/Nt;Ic(l,ot,ct,se,Qi),Ic(u,ut,gt,se,Ki),e.quadraticCurveTo(Qi[1],Ki[1],Qi[2],Ki[2]);break t}m+=Nt}e.quadraticCurveTo(ot,ut,ct,gt),l=ct,u=gt;break}case Lt.A:const v=i[A++],_=i[A++],z=i[A++],P=i[A++];let k=i[A++],B=i[A++];const R=i[A++],L=!i[A++],N=z>P?z:P,q=Kn(z-P)>.001;let U=k+B,J=!1;if(p){const ot=y[g++];m+ot>w&&(U=k+B*(w-m)/ot,J=!0),m+=ot}if(q&&e.ellipse?e.ellipse(v,_,z,P,R,k,U,L):e.arc(v,_,N,k,U,L),J)break t;b&&(h=ts(k)*z+v,c=es(k)*P+_),l=ts(U)*z+v,u=es(U)*P+_;break;case Lt.R:h=l=i[A],c=u=i[A+1],f=i[A++],d=i[A++];const X=i[A++],lt=i[A++];if(p){const ot=y[g++];if(m+ot>w){let ut=w-m;e.moveTo(f,d),e.lineTo(f+hl(ut,X),d),ut-=X,ut>0&&e.lineTo(f+X,d+hl(ut,lt)),ut-=lt,ut>0&&e.lineTo(f+cl(X-ut,0),d+lt),ut-=X,ut>0&&e.lineTo(f,d+cl(lt-ut,0));break t}m+=ot}e.rect(f,d,X,lt);break;case Lt.Z:if(p){const ot=y[g++];if(m+ot>w){const ut=(w-m)/ot;e.lineTo(l*(1-ut)+h*ut,u*(1-ut)+c*ut);break t}m+=ot}e.closePath(),l=h,u=c}}}clone(){const e=new dl,n=this.data;return e.data=n.slice?n.slice():Array.prototype.slice.call(n),e._len=this._len,e}canSave(){return!!this._saveData}static initDefaultProps=function(){const e=dl.prototype;e._saveData=!0,e._ux=0,e._uy=0,e._pendingPtDist=0,e._version=0}()}const Ov=Object.freeze(Object.defineProperty({__proto__:null,Entry:Kc,LinkedList:wp,createIntersectContext:gp,fromArc:Pp,fromCubic:Ap,fromLine:ol,fromPoints:kv,fromQuadratic:Cp,normalizeArcAngles:Ip},Symbol.toStringTag,{value:"Module"})),kp=r=>()=>r,pl=r=>{const e=r?(n,i)=>i.minus(n).abs().isLessThanOrEqualTo(r):kp(!1);return(n,i)=>e(n,i)?0:n.comparedTo(i)};function Lv(r){const e=r?(n,i,s,o,a)=>n.exponentiatedBy(2).isLessThanOrEqualTo(o.minus(i).exponentiatedBy(2).plus(a.minus(s).exponentiatedBy(2)).times(r)):kp(!1);return(n,i,s)=>{const o=n.x,a=n.y,h=s.x,c=s.y,l=a.minus(c).times(i.x.minus(h)).minus(o.minus(h).times(i.y.minus(c)));return e(l,o,a,h,c)?0:l.comparedTo(0)}}var Bv=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,yl=Math.ceil,tn=Math.floor,Be="[BigNumber Error] ",Rp=Be+"Number primitive has more than 15 significant digits: ",xn=1e14,vt=14,xl=9007199254740991,ml=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Si=1e7,he=1e9;function Op(r){var e,n,i,s=w.prototype={constructor:w,toString:null,valueOf:null},o=new w(1),a=20,h=4,c=-7,l=21,u=-1e7,f=1e7,d=!1,p=1,y=0,x={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},m="0123456789abcdefghijklmnopqrstuvwxyz",g=!0;function w(b,v){var _,z,P,k,B,R,L,N,q=this;if(!(q instanceof w))return new w(b,v);if(v==null){if(b&&b._isBigNumber===!0){q.s=b.s,!b.c||b.e>f?q.c=q.e=null:b.e<u?q.c=[q.e=0]:(q.e=b.e,q.c=b.c.slice());return}if((R=typeof b=="number")&&b*0==0){if(q.s=1/b<0?(b=-b,-1):1,b===~~b){for(k=0,B=b;B>=10;B/=10,k++);k>f?q.c=q.e=null:(q.e=k,q.c=[b]);return}N=String(b)}else{if(!Bv.test(N=String(b)))return i(q,N,R);q.s=N.charCodeAt(0)==45?(N=N.slice(1),-1):1}(k=N.indexOf("."))>-1&&(N=N.replace(".","")),(B=N.search(/e/i))>0?(k<0&&(k=B),k+=+N.slice(B+1),N=N.substring(0,B)):k<0&&(k=N.length)}else{if(jt(v,2,m.length,"Base"),v==10&&g)return q=new w(b),A(q,a+q.e+1,h);if(N=String(b),R=typeof b=="number"){if(b*0!=0)return i(q,N,R,v);if(q.s=1/b<0?(N=N.slice(1),-1):1,w.DEBUG&&N.replace(/^0\.0*|\./,"").length>15)throw Error(Rp+b)}else q.s=N.charCodeAt(0)===45?(N=N.slice(1),-1):1;for(_=m.slice(0,v),k=B=0,L=N.length;B<L;B++)if(_.indexOf(z=N.charAt(B))<0){if(z=="."){if(B>k){k=L;continue}}else if(!P&&(N==N.toUpperCase()&&(N=N.toLowerCase())||N==N.toLowerCase()&&(N=N.toUpperCase()))){P=!0,B=-1,k=0;continue}return i(q,String(b),R,v)}R=!1,N=n(N,v,10,q.s),(k=N.indexOf("."))>-1?N=N.replace(".",""):k=N.length}for(B=0;N.charCodeAt(B)===48;B++);for(L=N.length;N.charCodeAt(--L)===48;);if(N=N.slice(B,++L)){if(L-=B,R&&w.DEBUG&&L>15&&(b>xl||b!==tn(b)))throw Error(Rp+q.s*b);if((k=k-B-1)>f)q.c=q.e=null;else if(k<u)q.c=[q.e=0];else{if(q.e=k,q.c=[],B=(k+1)%vt,k<0&&(B+=vt),B<L){for(B&&q.c.push(+N.slice(0,B)),L-=vt;B<L;)q.c.push(+N.slice(B,B+=vt));B=vt-(N=N.slice(B)).length}else B-=L;for(;B--;N+="0");q.c.push(+N)}}else q.c=[q.e=0]}w.clone=Op,w.ROUND_UP=0,w.ROUND_DOWN=1,w.ROUND_CEIL=2,w.ROUND_FLOOR=3,w.ROUND_HALF_UP=4,w.ROUND_HALF_DOWN=5,w.ROUND_HALF_EVEN=6,w.ROUND_HALF_CEIL=7,w.ROUND_HALF_FLOOR=8,w.EUCLID=9,w.config=w.set=function(b){var v,_;if(b!=null)if(typeof b=="object"){if(b.hasOwnProperty(v="DECIMAL_PLACES")&&(_=b[v],jt(_,0,he,v),a=_),b.hasOwnProperty(v="ROUNDING_MODE")&&(_=b[v],jt(_,0,8,v),h=_),b.hasOwnProperty(v="EXPONENTIAL_AT")&&(_=b[v],_&&_.pop?(jt(_[0],-he,0,v),jt(_[1],0,he,v),c=_[0],l=_[1]):(jt(_,-he,he,v),c=-(l=_<0?-_:_))),b.hasOwnProperty(v="RANGE"))if(_=b[v],_&&_.pop)jt(_[0],-he,-1,v),jt(_[1],1,he,v),u=_[0],f=_[1];else if(jt(_,-he,he,v),_)u=-(f=_<0?-_:_);else throw Error(Be+v+" cannot be zero: "+_);if(b.hasOwnProperty(v="CRYPTO"))if(_=b[v],_===!!_)if(_)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))d=_;else throw d=!_,Error(Be+"crypto unavailable");else d=_;else throw Error(Be+v+" not true or false: "+_);if(b.hasOwnProperty(v="MODULO_MODE")&&(_=b[v],jt(_,0,9,v),p=_),b.hasOwnProperty(v="POW_PRECISION")&&(_=b[v],jt(_,0,he,v),y=_),b.hasOwnProperty(v="FORMAT"))if(_=b[v],typeof _=="object")x=_;else throw Error(Be+v+" not an object: "+_);if(b.hasOwnProperty(v="ALPHABET"))if(_=b[v],typeof _=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(_))g=_.slice(0,10)=="0123456789",m=_;else throw Error(Be+v+" invalid: "+_)}else throw Error(Be+"Object expected: "+b);return{DECIMAL_PLACES:a,ROUNDING_MODE:h,EXPONENTIAL_AT:[c,l],RANGE:[u,f],CRYPTO:d,MODULO_MODE:p,POW_PRECISION:y,FORMAT:x,ALPHABET:m}},w.isBigNumber=function(b){if(!b||b._isBigNumber!==!0)return!1;if(!w.DEBUG)return!0;var v,_,z=b.c,P=b.e,k=b.s;t:if({}.toString.call(z)=="[object Array]"){if((k===1||k===-1)&&P>=-he&&P<=he&&P===tn(P)){if(z[0]===0){if(P===0&&z.length===1)return!0;break t}if(v=(P+1)%vt,v<1&&(v+=vt),String(z[0]).length==v){for(v=0;v<z.length;v++)if(_=z[v],_<0||_>=xn||_!==tn(_))break t;if(_!==0)return!0}}}else if(z===null&&P===null&&(k===null||k===1||k===-1))return!0;throw Error(Be+"Invalid BigNumber: "+b)},w.maximum=w.max=function(){return S(arguments,-1)},w.minimum=w.min=function(){return S(arguments,1)},w.random=function(){var b=9007199254740992,v=Math.random()*b&2097151?function(){return tn(Math.random()*b)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(_){var z,P,k,B,R,L=0,N=[],q=new w(o);if(_==null?_=a:jt(_,0,he),B=yl(_/vt),d)if(crypto.getRandomValues){for(z=crypto.getRandomValues(new Uint32Array(B*=2));L<B;)R=z[L]*131072+(z[L+1]>>>11),R>=9e15?(P=crypto.getRandomValues(new Uint32Array(2)),z[L]=P[0],z[L+1]=P[1]):(N.push(R%1e14),L+=2);L=B/2}else if(crypto.randomBytes){for(z=crypto.randomBytes(B*=7);L<B;)R=(z[L]&31)*281474976710656+z[L+1]*1099511627776+z[L+2]*4294967296+z[L+3]*16777216+(z[L+4]<<16)+(z[L+5]<<8)+z[L+6],R>=9e15?crypto.randomBytes(7).copy(z,L):(N.push(R%1e14),L+=7);L=B/7}else throw d=!1,Error(Be+"crypto unavailable");if(!d)for(;L<B;)R=v(),R<9e15&&(N[L++]=R%1e14);for(B=N[--L],_%=vt,B&&_&&(R=ml[vt-_],N[L]=tn(B/R)*R);N[L]===0;N.pop(),L--);if(L<0)N=[k=0];else{for(k=-1;N[0]===0;N.splice(0,1),k-=vt);for(L=1,R=N[0];R>=10;R/=10,L++);L<vt&&(k-=vt-L)}return q.e=k,q.c=N,q}}(),w.sum=function(){for(var b=1,v=arguments,_=new w(v[0]);b<v.length;)_=_.plus(v[b++]);return _},n=function(){var b="0123456789";function v(_,z,P,k){for(var B,R=[0],L,N=0,q=_.length;N<q;){for(L=R.length;L--;R[L]*=z);for(R[0]+=k.indexOf(_.charAt(N++)),B=0;B<R.length;B++)R[B]>P-1&&(R[B+1]==null&&(R[B+1]=0),R[B+1]+=R[B]/P|0,R[B]%=P)}return R.reverse()}return function(_,z,P,k,B){var R,L,N,q,U,J,X,lt,ot=_.indexOf("."),ut=a,ct=h;for(ot>=0&&(q=y,y=0,_=_.replace(".",""),lt=new w(z),J=lt.pow(_.length-ot),y=q,lt.c=v(ti(nn(J.c),J.e,"0"),10,P,b),lt.e=lt.c.length),X=v(_,z,P,B?(R=m,b):(R=b,m)),N=q=X.length;X[--q]==0;X.pop());if(!X[0])return R.charAt(0);if(ot<0?--N:(J.c=X,J.e=N,J.s=k,J=e(J,lt,ut,ct,P),X=J.c,U=J.r,N=J.e),L=N+ut+1,ot=X[L],q=P/2,U=U||L<0||X[L+1]!=null,U=ct<4?(ot!=null||U)&&(ct==0||ct==(J.s<0?3:2)):ot>q||ot==q&&(ct==4||U||ct==6&&X[L-1]&1||ct==(J.s<0?8:7)),L<1||!X[0])_=U?ti(R.charAt(1),-ut,R.charAt(0)):R.charAt(0);else{if(X.length=L,U)for(--P;++X[--L]>P;)X[L]=0,L||(++N,X=[1].concat(X));for(q=X.length;!X[--q];);for(ot=0,_="";ot<=q;_+=R.charAt(X[ot++]));_=ti(_,N,R.charAt(0))}return _}}(),e=function(){function b(z,P,k){var B,R,L,N,q=0,U=z.length,J=P%Si,X=P/Si|0;for(z=z.slice();U--;)L=z[U]%Si,N=z[U]/Si|0,B=X*L+N*J,R=J*L+B%Si*Si+q,q=(R/k|0)+(B/Si|0)+X*N,z[U]=R%k;return q&&(z=[q].concat(z)),z}function v(z,P,k,B){var R,L;if(k!=B)L=k>B?1:-1;else for(R=L=0;R<k;R++)if(z[R]!=P[R]){L=z[R]>P[R]?1:-1;break}return L}function _(z,P,k,B){for(var R=0;k--;)z[k]-=R,R=z[k]<P[k]?1:0,z[k]=R*B+z[k]-P[k];for(;!z[0]&&z.length>1;z.splice(0,1));}return function(z,P,k,B,R){var L,N,q,U,J,X,lt,ot,ut,ct,gt,Nt,se,ee,$e,be,de,Wt=z.s==P.s?1:-1,G=z.c,Q=P.c;if(!G||!G[0]||!Q||!Q[0])return new w(!z.s||!P.s||(G?Q&&G[0]==Q[0]:!Q)?NaN:G&&G[0]==0||!Q?Wt*0:Wt/0);for(ot=new w(Wt),ut=ot.c=[],N=z.e-P.e,Wt=k+N+1,R||(R=xn,N=en(z.e/vt)-en(P.e/vt),Wt=Wt/vt|0),q=0;Q[q]==(G[q]||0);q++);if(Q[q]>(G[q]||0)&&N--,Wt<0)ut.push(1),U=!0;else{for(ee=G.length,be=Q.length,q=0,Wt+=2,J=tn(R/(Q[0]+1)),J>1&&(Q=b(Q,J,R),G=b(G,J,R),be=Q.length,ee=G.length),se=be,ct=G.slice(0,be),gt=ct.length;gt<be;ct[gt++]=0);de=Q.slice(),de=[0].concat(de),$e=Q[0],Q[1]>=R/2&&$e++;do{if(J=0,L=v(Q,ct,be,gt),L<0){if(Nt=ct[0],be!=gt&&(Nt=Nt*R+(ct[1]||0)),J=tn(Nt/$e),J>1)for(J>=R&&(J=R-1),X=b(Q,J,R),lt=X.length,gt=ct.length;v(X,ct,lt,gt)==1;)J--,_(X,be<lt?de:Q,lt,R),lt=X.length,L=1;else J==0&&(L=J=1),X=Q.slice(),lt=X.length;if(lt<gt&&(X=[0].concat(X)),_(ct,X,gt,R),gt=ct.length,L==-1)for(;v(Q,ct,be,gt)<1;)J++,_(ct,be<gt?de:Q,gt,R),gt=ct.length}else L===0&&(J++,ct=[0]);ut[q++]=J,ct[0]?ct[gt++]=G[se]||0:(ct=[G[se]],gt=1)}while((se++<ee||ct[0]!=null)&&Wt--);U=ct[0]!=null,ut[0]||ut.splice(0,1)}if(R==xn){for(q=1,Wt=ut[0];Wt>=10;Wt/=10,q++);A(ot,k+(ot.e=q+N*vt-1)+1,B,U)}else ot.e=N,ot.r=+U;return ot}}();function M(b,v,_,z){var P,k,B,R,L;if(_==null?_=h:jt(_,0,8),!b.c)return b.toString();if(P=b.c[0],B=b.e,v==null)L=nn(b.c),L=z==1||z==2&&(B<=c||B>=l)?za(L,B):ti(L,B,"0");else if(b=A(new w(b),v,_),k=b.e,L=nn(b.c),R=L.length,z==1||z==2&&(v<=k||k<=c)){for(;R<v;L+="0",R++);L=za(L,k)}else if(v-=B,L=ti(L,k,"0"),k+1>R){if(--v>0)for(L+=".";v--;L+="0");}else if(v+=k-R,v>0)for(k+1==R&&(L+=".");v--;L+="0");return b.s<0&&P?"-"+L:L}function S(b,v){for(var _,z,P=1,k=new w(b[0]);P<b.length;P++)z=new w(b[P]),(!z.s||(_=ns(k,z))===v||_===0&&k.s===v)&&(k=z);return k}function E(b,v,_){for(var z=1,P=v.length;!v[--P];v.pop());for(P=v[0];P>=10;P/=10,z++);return(_=z+_*vt-1)>f?b.c=b.e=null:_<u?b.c=[b.e=0]:(b.e=_,b.c=v),b}i=function(){var b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,v=/^([^.]+)\.$/,_=/^\.([^.]+)$/,z=/^-?(Infinity|NaN)$/,P=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(k,B,R,L){var N,q=R?B:B.replace(P,"");if(z.test(q))k.s=isNaN(q)?null:q<0?-1:1;else{if(!R&&(q=q.replace(b,function(U,J,X){return N=(X=X.toLowerCase())=="x"?16:X=="b"?2:8,!L||L==N?J:U}),L&&(N=L,q=q.replace(v,"$1").replace(_,"0.$1")),B!=q))return new w(q,N);if(w.DEBUG)throw Error(Be+"Not a"+(L?" base "+L:"")+" number: "+B);k.s=null}k.c=k.e=null}}();function A(b,v,_,z){var P,k,B,R,L,N,q,U=b.c,J=ml;if(U){t:{for(P=1,R=U[0];R>=10;R/=10,P++);if(k=v-P,k<0)k+=vt,B=v,L=U[N=0],q=tn(L/J[P-B-1]%10);else if(N=yl((k+1)/vt),N>=U.length)if(z){for(;U.length<=N;U.push(0));L=q=0,P=1,k%=vt,B=k-vt+1}else break t;else{for(L=R=U[N],P=1;R>=10;R/=10,P++);k%=vt,B=k-vt+P,q=B<0?0:tn(L/J[P-B-1]%10)}if(z=z||v<0||U[N+1]!=null||(B<0?L:L%J[P-B-1]),z=_<4?(q||z)&&(_==0||_==(b.s<0?3:2)):q>5||q==5&&(_==4||z||_==6&&(k>0?B>0?L/J[P-B]:0:U[N-1])%10&1||_==(b.s<0?8:7)),v<1||!U[0])return U.length=0,z?(v-=b.e+1,U[0]=J[(vt-v%vt)%vt],b.e=-v||0):U[0]=b.e=0,b;if(k==0?(U.length=N,R=1,N--):(U.length=N+1,R=J[vt-k],U[N]=B>0?tn(L/J[P-B]%J[B])*R:0),z)for(;;)if(N==0){for(k=1,B=U[0];B>=10;B/=10,k++);for(B=U[0]+=R,R=1;B>=10;B/=10,R++);k!=R&&(b.e++,U[0]==xn&&(U[0]=1));break}else{if(U[N]+=R,U[N]!=xn)break;U[N--]=0,R=1}for(k=U.length;U[--k]===0;U.pop());}b.e>f?b.c=b.e=null:b.e<u&&(b.c=[b.e=0])}return b}function I(b){var v,_=b.e;return _===null?b.toString():(v=nn(b.c),v=_<=c||_>=l?za(v,_):ti(v,_,"0"),b.s<0?"-"+v:v)}return s.absoluteValue=s.abs=function(){var b=new w(this);return b.s<0&&(b.s=1),b},s.comparedTo=function(b,v){return ns(this,new w(b,v))},s.decimalPlaces=s.dp=function(b,v){var _,z,P,k=this;if(b!=null)return jt(b,0,he),v==null?v=h:jt(v,0,8),A(new w(k),b+k.e+1,v);if(!(_=k.c))return null;if(z=((P=_.length-1)-en(this.e/vt))*vt,P=_[P])for(;P%10==0;P/=10,z--);return z<0&&(z=0),z},s.dividedBy=s.div=function(b,v){return e(this,new w(b,v),a,h)},s.dividedToIntegerBy=s.idiv=function(b,v){return e(this,new w(b,v),0,1)},s.exponentiatedBy=s.pow=function(b,v){var _,z,P,k,B,R,L,N,q,U=this;if(b=new w(b),b.c&&!b.isInteger())throw Error(Be+"Exponent not an integer: "+I(b));if(v!=null&&(v=new w(v)),R=b.e>14,!U.c||!U.c[0]||U.c[0]==1&&!U.e&&U.c.length==1||!b.c||!b.c[0])return q=new w(Math.pow(+I(U),R?b.s*(2-Ea(b)):+I(b))),v?q.mod(v):q;if(L=b.s<0,v){if(v.c?!v.c[0]:!v.s)return new w(NaN);z=!L&&U.isInteger()&&v.isInteger(),z&&(U=U.mod(v))}else{if(b.e>9&&(U.e>0||U.e<-1||(U.e==0?U.c[0]>1||R&&U.c[1]>=24e7:U.c[0]<8e13||R&&U.c[0]<=9999975e7)))return k=U.s<0&&Ea(b)?-0:0,U.e>-1&&(k=1/k),new w(L?1/k:k);y&&(k=yl(y/vt+2))}for(R?(_=new w(.5),L&&(b.s=1),N=Ea(b)):(P=Math.abs(+I(b)),N=P%2),q=new w(o);;){if(N){if(q=q.times(U),!q.c)break;k?q.c.length>k&&(q.c.length=k):z&&(q=q.mod(v))}if(P){if(P=tn(P/2),P===0)break;N=P%2}else if(b=b.times(_),A(b,b.e+1,1),b.e>14)N=Ea(b);else{if(P=+I(b),P===0)break;N=P%2}U=U.times(U),k?U.c&&U.c.length>k&&(U.c.length=k):z&&(U=U.mod(v))}return z?q:(L&&(q=o.div(q)),v?q.mod(v):k?A(q,y,h,B):q)},s.integerValue=function(b){var v=new w(this);return b==null?b=h:jt(b,0,8),A(v,v.e+1,b)},s.isEqualTo=s.eq=function(b,v){return ns(this,new w(b,v))===0},s.isFinite=function(){return!!this.c},s.isGreaterThan=s.gt=function(b,v){return ns(this,new w(b,v))>0},s.isGreaterThanOrEqualTo=s.gte=function(b,v){return(v=ns(this,new w(b,v)))===1||v===0},s.isInteger=function(){return!!this.c&&en(this.e/vt)>this.c.length-2},s.isLessThan=s.lt=function(b,v){return ns(this,new w(b,v))<0},s.isLessThanOrEqualTo=s.lte=function(b,v){return(v=ns(this,new w(b,v)))===-1||v===0},s.isNaN=function(){return!this.s},s.isNegative=function(){return this.s<0},s.isPositive=function(){return this.s>0},s.isZero=function(){return!!this.c&&this.c[0]==0},s.minus=function(b,v){var _,z,P,k,B=this,R=B.s;if(b=new w(b,v),v=b.s,!R||!v)return new w(NaN);if(R!=v)return b.s=-v,B.plus(b);var L=B.e/vt,N=b.e/vt,q=B.c,U=b.c;if(!L||!N){if(!q||!U)return q?(b.s=-v,b):new w(U?B:NaN);if(!q[0]||!U[0])return U[0]?(b.s=-v,b):new w(q[0]?B:h==3?-0:0)}if(L=en(L),N=en(N),q=q.slice(),R=L-N){for((k=R<0)?(R=-R,P=q):(N=L,P=U),P.reverse(),v=R;v--;P.push(0));P.reverse()}else for(z=(k=(R=q.length)<(v=U.length))?R:v,R=v=0;v<z;v++)if(q[v]!=U[v]){k=q[v]<U[v];break}if(k&&(P=q,q=U,U=P,b.s=-b.s),v=(z=U.length)-(_=q.length),v>0)for(;v--;q[_++]=0);for(v=xn-1;z>R;){if(q[--z]<U[z]){for(_=z;_&&!q[--_];q[_]=v);--q[_],q[z]+=xn}q[z]-=U[z]}for(;q[0]==0;q.splice(0,1),--N);return q[0]?E(b,q,N):(b.s=h==3?-1:1,b.c=[b.e=0],b)},s.modulo=s.mod=function(b,v){var _,z,P=this;return b=new w(b,v),!P.c||!b.s||b.c&&!b.c[0]?new w(NaN):!b.c||P.c&&!P.c[0]?new w(P):(p==9?(z=b.s,b.s=1,_=e(P,b,0,3),b.s=z,_.s*=z):_=e(P,b,0,p),b=P.minus(_.times(b)),!b.c[0]&&p==1&&(b.s=P.s),b)},s.multipliedBy=s.times=function(b,v){var _,z,P,k,B,R,L,N,q,U,J,X,lt,ot,ut,ct=this,gt=ct.c,Nt=(b=new w(b,v)).c;if(!gt||!Nt||!gt[0]||!Nt[0])return!ct.s||!b.s||gt&&!gt[0]&&!Nt||Nt&&!Nt[0]&&!gt?b.c=b.e=b.s=null:(b.s*=ct.s,!gt||!Nt?b.c=b.e=null:(b.c=[0],b.e=0)),b;for(z=en(ct.e/vt)+en(b.e/vt),b.s*=ct.s,L=gt.length,U=Nt.length,L<U&&(lt=gt,gt=Nt,Nt=lt,P=L,L=U,U=P),P=L+U,lt=[];P--;lt.push(0));for(ot=xn,ut=Si,P=U;--P>=0;){for(_=0,J=Nt[P]%ut,X=Nt[P]/ut|0,B=L,k=P+B;k>P;)N=gt[--B]%ut,q=gt[B]/ut|0,R=X*N+q*J,N=J*N+R%ut*ut+lt[k]+_,_=(N/ot|0)+(R/ut|0)+X*q,lt[k--]=N%ot;lt[k]=_}return _?++z:lt.splice(0,1),E(b,lt,z)},s.negated=function(){var b=new w(this);return b.s=-b.s||null,b},s.plus=function(b,v){var _,z=this,P=z.s;if(b=new w(b,v),v=b.s,!P||!v)return new w(NaN);if(P!=v)return b.s=-v,z.minus(b);var k=z.e/vt,B=b.e/vt,R=z.c,L=b.c;if(!k||!B){if(!R||!L)return new w(P/0);if(!R[0]||!L[0])return L[0]?b:new w(R[0]?z:P*0)}if(k=en(k),B=en(B),R=R.slice(),P=k-B){for(P>0?(B=k,_=L):(P=-P,_=R),_.reverse();P--;_.push(0));_.reverse()}for(P=R.length,v=L.length,P-v<0&&(_=L,L=R,R=_,v=P),P=0;v;)P=(R[--v]=R[v]+L[v]+P)/xn|0,R[v]=xn===R[v]?0:R[v]%xn;return P&&(R=[P].concat(R),++B),E(b,R,B)},s.precision=s.sd=function(b,v){var _,z,P,k=this;if(b!=null&&b!==!!b)return jt(b,1,he),v==null?v=h:jt(v,0,8),A(new w(k),b,v);if(!(_=k.c))return null;if(P=_.length-1,z=P*vt+1,P=_[P]){for(;P%10==0;P/=10,z--);for(P=_[0];P>=10;P/=10,z++);}return b&&k.e+1>z&&(z=k.e+1),z},s.shiftedBy=function(b){return jt(b,-xl,xl),this.times("1e"+b)},s.squareRoot=s.sqrt=function(){var b,v,_,z,P,k=this,B=k.c,R=k.s,L=k.e,N=a+4,q=new w("0.5");if(R!==1||!B||!B[0])return new w(!R||R<0&&(!B||B[0])?NaN:B?k:1/0);if(R=Math.sqrt(+I(k)),R==0||R==1/0?(v=nn(B),(v.length+L)%2==0&&(v+="0"),R=Math.sqrt(+v),L=en((L+1)/2)-(L<0||L%2),R==1/0?v="5e"+L:(v=R.toExponential(),v=v.slice(0,v.indexOf("e")+1)+L),_=new w(v)):_=new w(R+""),_.c[0]){for(L=_.e,R=L+N,R<3&&(R=0);;)if(P=_,_=q.times(P.plus(e(k,P,N,1))),nn(P.c).slice(0,R)===(v=nn(_.c)).slice(0,R))if(_.e<L&&--R,v=v.slice(R-3,R+1),v=="9999"||!z&&v=="4999"){if(!z&&(A(P,P.e+a+2,0),P.times(P).eq(k))){_=P;break}N+=4,R+=4,z=1}else{(!+v||!+v.slice(1)&&v.charAt(0)=="5")&&(A(_,_.e+a+2,1),b=!_.times(_).eq(k));break}}return A(_,_.e+a+1,h,b)},s.toExponential=function(b,v){return b!=null&&(jt(b,0,he),b++),M(this,b,v,1)},s.toFixed=function(b,v){return b!=null&&(jt(b,0,he),b=b+this.e+1),M(this,b,v)},s.toFormat=function(b,v,_){var z,P=this;if(_==null)b!=null&&v&&typeof v=="object"?(_=v,v=null):b&&typeof b=="object"?(_=b,b=v=null):_=x;else if(typeof _!="object")throw Error(Be+"Argument not an object: "+_);if(z=P.toFixed(b,v),P.c){var k,B=z.split("."),R=+_.groupSize,L=+_.secondaryGroupSize,N=_.groupSeparator||"",q=B[0],U=B[1],J=P.s<0,X=J?q.slice(1):q,lt=X.length;if(L&&(k=R,R=L,L=k,lt-=k),R>0&&lt>0){for(k=lt%R||R,q=X.substr(0,k);k<lt;k+=R)q+=N+X.substr(k,R);L>0&&(q+=N+X.slice(k)),J&&(q="-"+q)}z=U?q+(_.decimalSeparator||"")+((L=+_.fractionGroupSize)?U.replace(new RegExp("\\d{"+L+"}\\B","g"),"$&"+(_.fractionGroupSeparator||"")):U):q}return(_.prefix||"")+z+(_.suffix||"")},s.toFraction=function(b){var v,_,z,P,k,B,R,L,N,q,U,J,X=this,lt=X.c;if(b!=null&&(R=new w(b),!R.isInteger()&&(R.c||R.s!==1)||R.lt(o)))throw Error(Be+"Argument "+(R.isInteger()?"out of range: ":"not an integer: ")+I(R));if(!lt)return new w(X);for(v=new w(o),N=_=new w(o),z=L=new w(o),J=nn(lt),k=v.e=J.length-X.e-1,v.c[0]=ml[(B=k%vt)<0?vt+B:B],b=!b||R.comparedTo(v)>0?k>0?v:N:R,B=f,f=1/0,R=new w(J),L.c[0]=0;q=e(R,v,0,1),P=_.plus(q.times(z)),P.comparedTo(b)!=1;)_=z,z=P,N=L.plus(q.times(P=N)),L=P,v=R.minus(q.times(P=v)),R=P;return P=e(b.minus(_),z,0,1),L=L.plus(P.times(N)),_=_.plus(P.times(z)),L.s=N.s=X.s,k=k*2,U=e(N,z,k,h).minus(X).abs().comparedTo(e(L,_,k,h).minus(X).abs())<1?[N,z]:[L,_],f=B,U},s.toNumber=function(){return+I(this)},s.toPrecision=function(b,v){return b!=null&&jt(b,1,he),M(this,b,v,2)},s.toString=function(b){var v,_=this,z=_.s,P=_.e;return P===null?z?(v="Infinity",z<0&&(v="-"+v)):v="NaN":(b==null?v=P<=c||P>=l?za(nn(_.c),P):ti(nn(_.c),P,"0"):b===10&&g?(_=A(new w(_),a+P+1,h),v=ti(nn(_.c),_.e,"0")):(jt(b,2,m.length,"Base"),v=n(ti(nn(_.c),P,"0"),10,b,z,!0)),z<0&&_.c[0]&&(v="-"+v)),v},s.valueOf=s.toJSON=function(){return I(this)},s._isBigNumber=!0,s[Symbol.toStringTag]="BigNumber",s[Symbol.for("nodejs.util.inspect.custom")]=s.valueOf,r!=null&&w.set(r),w}function en(r){var e=r|0;return r>0||r===e?e:e-1}function nn(r){for(var e,n,i=1,s=r.length,o=r[0]+"";i<s;){for(e=r[i++]+"",n=vt-e.length;n--;e="0"+e);o+=e}for(s=o.length;o.charCodeAt(--s)===48;);return o.slice(0,s+1||1)}function ns(r,e){var n,i,s=r.c,o=e.c,a=r.s,h=e.s,c=r.e,l=e.e;if(!a||!h)return null;if(n=s&&!s[0],i=o&&!o[0],n||i)return n?i?0:-h:a;if(a!=h)return a;if(n=a<0,i=c==l,!s||!o)return i?0:!s^n?1:-1;if(!i)return c>l^n?1:-1;for(h=(c=s.length)<(l=o.length)?c:l,a=0;a<h;a++)if(s[a]!=o[a])return s[a]>o[a]^n?1:-1;return c==l?0:c>l^n?1:-1}function jt(r,e,n,i){if(r<e||r>n||r!==tn(r))throw Error(Be+(i||"Argument")+(typeof r=="number"?r<e||r>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(r))}function Ea(r){var e=r.c.length-1;return en(r.e/vt)==e&&r.c[e]%2!=0}function za(r,e){return(r.length>1?r.charAt(0)+"."+r.slice(1):r)+(e<0?"e":"e+")+e}function ti(r,e,n){var i,s;if(e<0){for(s=n+".";++e;s+=n);r=s+r}else if(i=r.length,++e>i){for(s=n,e-=i;--e;s+=n);r+=s}else e<i&&(r=r.slice(0,e)+"."+r.slice(e));return r}var mn=Op(),Fv=class{key;left=null;right=null;constructor(r){this.key=r}},Gr=class extends Fv{constructor(r){super(r)}},Nv=class{size=0;modificationCount=0;splayCount=0;splay(r){const e=this.root;if(e==null)return this.compare(r,r),-1;let n=null,i=null,s=null,o=null,a=e;const h=this.compare;let c;for(;;)if(c=h(a.key,r),c>0){let l=a.left;if(l==null||(c=h(l.key,r),c>0&&(a.left=l.right,l.right=a,a=l,l=a.left,l==null)))break;n==null?i=a:n.left=a,n=a,a=l}else if(c<0){let l=a.right;if(l==null||(c=h(l.key,r),c<0&&(a.right=l.left,l.left=a,a=l,l=a.right,l==null)))break;s==null?o=a:s.right=a,s=a,a=l}else break;return s!=null&&(s.right=a.left,a.left=o),n!=null&&(n.left=a.right,a.right=i),this.root!==a&&(this.root=a,this.splayCount++),c}splayMin(r){let e=r,n=e.left;for(;n!=null;){const i=n;e.left=i.right,i.right=e,e=i,n=e.left}return e}splayMax(r){let e=r,n=e.right;for(;n!=null;){const i=n;e.right=i.left,i.left=e,e=i,n=e.right}return e}_delete(r){if(this.root==null||this.splay(r)!=0)return null;let n=this.root;const i=n,s=n.left;if(this.size--,s==null)this.root=n.right;else{const o=n.right;n=this.splayMax(s),n.right=o,this.root=n}return this.modificationCount++,i}addNewRoot(r,e){this.size++,this.modificationCount++;const n=this.root;if(n==null){this.root=r;return}e<0?(r.left=n,r.right=n.right,n.right=null):(r.right=n,r.left=n.left,n.left=null),this.root=r}_first(){const r=this.root;return r==null?null:(this.root=this.splayMin(r),this.root)}_last(){const r=this.root;return r==null?null:(this.root=this.splayMax(r),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(r){return this.validKey(r)&&this.splay(r)==0}defaultCompare(){return(r,e)=>r<e?-1:r>e?1:0}wrap(){return{getRoot:()=>this.root,setRoot:r=>{this.root=r},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:r=>{this.splayCount=r},splay:r=>this.splay(r),has:r=>this.has(r)}}},Aa=class jo extends Nv{root=null;compare;validKey;constructor(e,n){super(),this.compare=e??this.defaultCompare(),this.validKey=n??(i=>i!=null&&i!=null)}delete(e){return this.validKey(e)?this._delete(e)!=null:!1}deleteAll(e){for(const n of e)this.delete(n)}forEach(e){const n=this[Symbol.iterator]();let i;for(;i=n.next(),!i.done;)e(i.value,i.value,this)}add(e){const n=this.splay(e);return n!=0&&this.addNewRoot(new Gr(e),n),this}addAndReturn(e){const n=this.splay(e);return n!=0&&this.addNewRoot(new Gr(e),n),this.root.key}addAll(e){for(const n of e)this.add(n)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)<0)return this.root.key;let i=this.root.left;if(i==null)return null;let s=i.right;for(;s!=null;)i=s,s=i.right;return i.key}firstAfter(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)>0)return this.root.key;let i=this.root.right;if(i==null)return null;let s=i.left;for(;s!=null;)i=s,s=i.left;return i.key}retainAll(e){const n=new jo(this.compare,this.validKey),i=this.modificationCount;for(const s of e){if(i!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(s)&&this.splay(s)==0&&n.add(this.root.key)}n.size!=this.size&&(this.root=n.root,this.size=n.size,this.modificationCount++)}lookup(e){return!this.validKey(e)||this.splay(e)!=0?null:this.root.key}intersection(e){const n=new jo(this.compare,this.validKey);for(const i of this)e.has(i)&&n.add(i);return n}difference(e){const n=new jo(this.compare,this.validKey);for(const i of this)e.has(i)||n.add(i);return n}union(e){const n=this.clone();return n.addAll(e),n}clone(){const e=new jo(this.compare,this.validKey);return e.size=this.size,e.root=this.copyNode(this.root),e}copyNode(e){if(e==null)return null;function n(s,o){let a,h;do{if(a=s.left,h=s.right,a!=null){const c=new Gr(a.key);o.left=c,n(a,c)}if(h!=null){const c=new Gr(h.key);o.right=c,s=h,o=c}}while(h!=null)}const i=new Gr(e.key);return n(e,i),i}toSet(){return this.clone()}entries(){return new Dv(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[Symbol.iterator](){return new qv(this.wrap())}[Symbol.toStringTag]="[object Set]"},Lp=class{tree;path=new Array;modificationCount=null;splayCount;constructor(r){this.tree=r,this.splayCount=r.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const r=this.path[this.path.length-1];return this.getValue(r)}rebuildPath(r){this.path.splice(0,this.path.length),this.tree.splay(r),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(r){for(;r!=null;)this.path.push(r),r=r.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let n=this.tree.getRoot();for(;n!=null;)this.path.push(n),n=n.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let r=this.path[this.path.length-1],e=r.right;if(e!=null){for(;e!=null;)this.path.push(e),e=e.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===r;)r=this.path.pop();return this.path.length>0}},qv=class extends Lp{getValue(r){return r.key}},Dv=class extends Lp{getValue(r){return[r.key,r.key]}};const $v=r=>r,Vv=r=>{if(r){const e=new Aa(pl(r)),n=new Aa(pl(r)),i=(o,a)=>a.addAndReturn(o),s=o=>({x:i(o.x,e),y:i(o.y,n)});return s({x:new mn(0),y:new mn(0)}),s}return $v},gl=r=>({set:e=>{ei=gl(e)},reset:()=>gl(r),compare:pl(r),snap:Vv(r),orient:Lv(r)});let ei=gl();const Jr=(r,e)=>r.ll.x.isLessThanOrEqualTo(e.x)&&e.x.isLessThanOrEqualTo(r.ur.x)&&r.ll.y.isLessThanOrEqualTo(e.y)&&e.y.isLessThanOrEqualTo(r.ur.y),wl=(r,e)=>{if(e.ur.x.isLessThan(r.ll.x)||r.ur.x.isLessThan(e.ll.x)||e.ur.y.isLessThan(r.ll.y)||r.ur.y.isLessThan(e.ll.y))return null;const n=r.ll.x.isLessThan(e.ll.x)?e.ll.x:r.ll.x,i=r.ur.x.isLessThan(e.ur.x)?r.ur.x:e.ur.x,s=r.ll.y.isLessThan(e.ll.y)?e.ll.y:r.ll.y,o=r.ur.y.isLessThan(e.ur.y)?r.ur.y:e.ur.y;return{ll:{x:n,y:s},ur:{x:i,y:o}}},Ca=(r,e)=>r.x.times(e.y).minus(r.y.times(e.x)),Bp=(r,e)=>r.x.times(e.x).plus(r.y.times(e.y)),Pa=r=>Bp(r,r).sqrt(),Uv=(r,e,n)=>{const i={x:e.x.minus(r.x),y:e.y.minus(r.y)},s={x:n.x.minus(r.x),y:n.y.minus(r.y)};return Ca(s,i).div(Pa(s)).div(Pa(i))},Wv=(r,e,n)=>{const i={x:e.x.minus(r.x),y:e.y.minus(r.y)},s={x:n.x.minus(r.x),y:n.y.minus(r.y)};return Bp(s,i).div(Pa(s)).div(Pa(i))},Fp=(r,e,n)=>e.y.isZero()?null:{x:r.x.plus(e.x.div(e.y).times(n.minus(r.y))),y:n},Np=(r,e,n)=>e.x.isZero()?null:{x:n,y:r.y.plus(e.y.div(e.x).times(n.minus(r.x)))},jv=(r,e,n,i)=>{if(e.x.isZero())return Np(n,i,r.x);if(i.x.isZero())return Np(r,e,n.x);if(e.y.isZero())return Fp(n,i,r.y);if(i.y.isZero())return Fp(r,e,n.y);const s=Ca(e,i);if(s.isZero())return null;const o={x:n.x.minus(r.x),y:n.y.minus(r.y)},a=Ca(o,e).div(s),h=Ca(o,i).div(s),c=r.x.plus(h.times(e.x)),l=n.x.plus(a.times(i.x)),u=r.y.plus(h.times(e.y)),f=n.y.plus(a.times(i.y)),d=c.plus(l).div(2),p=u.plus(f).div(2);return{x:d,y:p}};class sn{point;isLeft;segment;otherSE;consumedBy;static compare(e,n){const i=sn.comparePoints(e.point,n.point);return i!==0?i:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:Ia.compare(e.segment,n.segment))}static comparePoints(e,n){return e.x.isLessThan(n.x)?-1:e.x.isGreaterThan(n.x)?1:e.y.isLessThan(n.y)?-1:e.y.isGreaterThan(n.y)?1:0}constructor(e,n){e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}link(e){if(e.point===this.point)throw new Error("Tried to link already linked events");const n=e.point.events;for(let i=0,s=n.length;i<s;i++){const o=n[i];this.point.events.push(o),o.point=this.point}this.checkForConsuming()}checkForConsuming(){const e=this.point.events.length;for(let n=0;n<e;n++){const i=this.point.events[n];if(i.segment.consumedBy===void 0)for(let s=n+1;s<e;s++){const o=this.point.events[s];o.consumedBy===void 0&&i.otherSE.point.events===o.otherSE.point.events&&i.segment.consume(o.segment)}}}getAvailableLinkedEvents(){const e=[];for(let n=0,i=this.point.events.length;n<i;n++){const s=this.point.events[n];s!==this&&!s.segment.ringOut&&s.segment.isInResult()&&e.push(s)}return e}getLeftmostComparator(e){const n=new Map,i=s=>{const o=s.otherSE;n.set(s,{sine:Uv(this.point,e.point,o.point),cosine:Wv(this.point,e.point,o.point)})};return(s,o)=>{n.has(s)||i(s),n.has(o)||i(o);const{sine:a,cosine:h}=n.get(s),{sine:c,cosine:l}=n.get(o);return a.isGreaterThanOrEqualTo(0)&&c.isGreaterThanOrEqualTo(0)?h.isLessThan(l)?1:h.isGreaterThan(l)?-1:0:a.isLessThan(0)&&c.isLessThan(0)?h.isLessThan(l)?-1:h.isGreaterThan(l)?1:0:c.isLessThan(a)?-1:c.isGreaterThan(a)?1:0}}}let Yv=0,Ia=class Kh{id;leftSE;rightSE;rings;windings;ringOut;consumedBy;prev;_prevInResult;_beforeState;_afterState;_isInResult;static compare(e,n){const i=e.leftSE.point.x,s=n.leftSE.point.x,o=e.rightSE.point.x,a=n.rightSE.point.x;if(a.isLessThan(i))return 1;if(o.isLessThan(s))return-1;const h=e.leftSE.point.y,c=n.leftSE.point.y,l=e.rightSE.point.y,u=n.rightSE.point.y;if(i.isLessThan(s)){if(c.isLessThan(h)&&c.isLessThan(l))return 1;if(c.isGreaterThan(h)&&c.isGreaterThan(l))return-1;const f=e.comparePoint(n.leftSE.point);if(f<0)return 1;if(f>0)return-1;const d=n.comparePoint(e.rightSE.point);return d!==0?d:-1}if(i.isGreaterThan(s)){if(h.isLessThan(c)&&h.isLessThan(u))return-1;if(h.isGreaterThan(c)&&h.isGreaterThan(u))return 1;const f=n.comparePoint(e.leftSE.point);if(f!==0)return f;const d=e.comparePoint(n.rightSE.point);return d<0?1:d>0?-1:1}if(h.isLessThan(c))return-1;if(h.isGreaterThan(c))return 1;if(o.isLessThan(a)){const f=n.comparePoint(e.rightSE.point);if(f!==0)return f}if(o.isGreaterThan(a)){const f=e.comparePoint(n.rightSE.point);if(f<0)return 1;if(f>0)return-1}if(!o.eq(a)){const f=l.minus(h),d=o.minus(i),p=u.minus(c),y=a.minus(s);if(f.isGreaterThan(d)&&p.isLessThan(y))return 1;if(f.isLessThan(d)&&p.isGreaterThan(y))return-1}return o.isGreaterThan(a)?1:o.isLessThan(a)||l.isLessThan(u)?-1:l.isGreaterThan(u)?1:e.id<n.id?-1:e.id>n.id?1:0}constructor(e,n,i,s){this.id=++Yv,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=i,this.windings=s}static fromRing(e,n,i){let s,o,a;const h=sn.comparePoints(e,n);if(h<0)s=e,o=n,a=1;else if(h>0)s=n,o=e,a=-1;else throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);const c=new sn(s,!0),l=new sn(o,!1);return new Kh(c,l,[i],[a])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const e=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e.isLessThan(n)?e:n},ur:{x:this.rightSE.point.x,y:e.isGreaterThan(n)?e:n}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(e){return e.x.eq(this.leftSE.point.x)&&e.y.eq(this.leftSE.point.y)||e.x.eq(this.rightSE.point.x)&&e.y.eq(this.rightSE.point.y)}comparePoint(e){return ei.orient(this.leftSE.point,e,this.rightSE.point)}getIntersection(e){const n=this.bbox(),i=e.bbox(),s=wl(n,i);if(s===null)return null;const o=this.leftSE.point,a=this.rightSE.point,h=e.leftSE.point,c=e.rightSE.point,l=Jr(n,h)&&this.comparePoint(h)===0,u=Jr(i,o)&&e.comparePoint(o)===0,f=Jr(n,c)&&this.comparePoint(c)===0,d=Jr(i,a)&&e.comparePoint(a)===0;if(u&&l)return d&&!f?a:!d&&f?c:null;if(u)return f&&o.x.eq(c.x)&&o.y.eq(c.y)?null:o;if(l)return d&&a.x.eq(h.x)&&a.y.eq(h.y)?null:h;if(d&&f)return null;if(d)return a;if(f)return c;const p=jv(o,this.vector(),h,e.vector());return p===null||!Jr(s,p)?null:ei.snap(p)}split(e){const n=[],i=e.events!==void 0,s=new sn(e,!0),o=new sn(e,!1),a=this.rightSE;this.replaceRightSE(o),n.push(o),n.push(s);const h=new Kh(s,a,this.rings.slice(),this.windings.slice());return sn.comparePoints(h.leftSE.point,h.rightSE.point)>0&&h.swapEvents(),sn.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(s.checkForConsuming(),o.checkForConsuming()),n}swapEvents(){const e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let n=0,i=this.windings.length;n<i;n++)this.windings[n]*=-1}consume(e){let n=this,i=e;for(;n.consumedBy;)n=n.consumedBy;for(;i.consumedBy;)i=i.consumedBy;const s=Kh.compare(n,i);if(s!==0){if(s>0){const o=n;n=i,i=o}if(n.prev===i){const o=n;n=i,i=o}for(let o=0,a=i.rings.length;o<a;o++){const h=i.rings[o],c=i.windings[o],l=n.rings.indexOf(h);l===-1?(n.rings.push(h),n.windings.push(c)):n.windings[l]+=c}i.rings=null,i.windings=null,i.consumedBy=n,i.leftSE.consumedBy=n.leftSE,i.rightSE.consumedBy=n.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};const n=this._afterState.rings,i=this._afterState.windings,s=this._afterState.multiPolys;for(let h=0,c=this.rings.length;h<c;h++){const l=this.rings[h],u=this.windings[h],f=n.indexOf(l);f===-1?(n.push(l),i.push(u)):i[f]+=u}const o=[],a=[];for(let h=0,c=n.length;h<c;h++){if(i[h]===0)continue;const l=n[h],u=l.poly;if(a.indexOf(u)===-1)if(l.isExterior)o.push(u);else{a.indexOf(u)===-1&&a.push(u);const f=o.indexOf(l.poly);f!==-1&&o.splice(f,1)}}for(let h=0,c=o.length;h<c;h++){const l=o[h].multiPoly;s.indexOf(l)===-1&&s.push(l)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const e=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(Bn.type){case"union":{const i=e.length===0,s=n.length===0;this._isInResult=i!==s;break}case"intersection":{let i,s;e.length<n.length?(i=e.length,s=n.length):(i=n.length,s=e.length),this._isInResult=s===Bn.numMultiPolys&&i<s;break}case"xor":{const i=Math.abs(e.length-n.length);this._isInResult=i%2===1;break}case"difference":{const i=s=>s.length===1&&s[0].isSubject;this._isInResult=i(e)!==i(n);break}}return this._isInResult}};class qp{poly;isExterior;segments;bbox;constructor(e,n,i){if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=i,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const s=ei.snap({x:new mn(e[0][0]),y:new mn(e[0][1])});this.bbox={ll:{x:s.x,y:s.y},ur:{x:s.x,y:s.y}};let o=s;for(let a=1,h=e.length;a<h;a++){if(typeof e[a][0]!="number"||typeof e[a][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const c=ei.snap({x:new mn(e[a][0]),y:new mn(e[a][1])});c.x.eq(o.x)&&c.y.eq(o.y)||(this.segments.push(Ia.fromRing(o,c,this)),c.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=c.x),c.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=c.y),c.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=c.x),c.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=c.y),o=c)}(!s.x.eq(o.x)||!s.y.eq(o.y))&&this.segments.push(Ia.fromRing(o,s,this))}getSweepEvents(){const e=[];for(let n=0,i=this.segments.length;n<i;n++){const s=this.segments[n];e.push(s.leftSE),e.push(s.rightSE)}return e}}class Hv{multiPoly;exteriorRing;interiorRings;bbox;constructor(e,n){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new qp(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let i=1,s=e.length;i<s;i++){const o=new qp(e[i],this,!1);o.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=n}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let n=0,i=this.interiorRings.length;n<i;n++){const s=this.interiorRings[n].getSweepEvents();for(let o=0,a=s.length;o<a;o++)e.push(s[o])}return e}}class Dp{isSubject;polys;bbox;constructor(e,n){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:new mn(Number.POSITIVE_INFINITY),y:new mn(Number.POSITIVE_INFINITY)},ur:{x:new mn(Number.NEGATIVE_INFINITY),y:new mn(Number.NEGATIVE_INFINITY)}};for(let i=0,s=e.length;i<s;i++){const o=new Hv(e[i],this);o.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=n}getSweepEvents(){const e=[];for(let n=0,i=this.polys.length;n<i;n++){const s=this.polys[n].getSweepEvents();for(let o=0,a=s.length;o<a;o++)e.push(s[o])}return e}}class ka{events;poly;_isExteriorRing;_enclosingRing;static factory(e){const n=[];for(let i=0,s=e.length;i<s;i++){const o=e[i];if(!o.isInResult()||o.ringOut)continue;let a=null,h=o.leftSE,c=o.rightSE;const l=[h],u=h.point,f=[];for(;a=h,h=c,l.push(h),h.point!==u;)for(;;){const d=h.getAvailableLinkedEvents();if(d.length===0){const x=l[0].point,m=l[l.length-1].point;throw new Error(`Unable to complete output ring starting at [${x.x}, ${x.y}]. Last matching segment found ends at [${m.x}, ${m.y}].`)}if(d.length===1){c=d[0].otherSE;break}let p=null;for(let x=0,m=f.length;x<m;x++)if(f[x].point===h.point){p=x;break}if(p!==null){const x=f.splice(p)[0],m=l.splice(x.index);m.unshift(m[0].otherSE),n.push(new ka(m.reverse()));continue}f.push({index:l.length,point:h.point});const y=h.getLeftmostComparator(a);c=d.sort(y)[0].otherSE;break}n.push(new ka(l))}return n}constructor(e){this.events=e;for(let n=0,i=e.length;n<i;n++)e[n].segment.ringOut=this;this.poly=null}getGeom(){let e=this.events[0].point;const n=[e];for(let l=1,u=this.events.length-1;l<u;l++){const f=this.events[l].point,d=this.events[l+1].point;ei.orient(f,e,d)!==0&&(n.push(f),e=f)}if(n.length===1)return null;const i=n[0],s=n[1];ei.orient(i,e,s)===0&&n.shift(),n.push(n[0]);const o=this.isExteriorRing()?1:-1,a=this.isExteriorRing()?0:n.length-1,h=this.isExteriorRing()?n.length:-1,c=[];for(let l=a;l!=h;l+=o)c.push([n[l].x.toNumber(),n[l].y.toNumber()]);return c}isExteriorRing(){if(this._isExteriorRing===void 0){const e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let e=this.events[0];for(let s=1,o=this.events.length;s<o;s++){const a=this.events[s];sn.compare(e,a)>0&&(e=a)}let n=e.segment.prevInResult(),i=n?n.prevInResult():null;for(;;){if(!n)return null;if(!i)return n.ringOut;if(i.ringOut!==n.ringOut)return i.ringOut?.enclosingRing()!==n.ringOut?n.ringOut:n.ringOut?.enclosingRing();n=i.prevInResult(),i=n?n.prevInResult():null}}}class $p{exteriorRing;interiorRings;constructor(e){this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=this.exteriorRing.getGeom();if(e===null)return null;const n=[e];for(let i=0,s=this.interiorRings.length;i<s;i++){const o=this.interiorRings[i].getGeom();o!==null&&n.push(o)}return n}}class Xv{rings;polys;constructor(e){this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let n=0,i=this.polys.length;n<i;n++){const s=this.polys[n].getGeom();s!==null&&e.push(s)}return e}_composePolys(e){const n=[];for(let i=0,s=e.length;i<s;i++){const o=e[i];if(!o.poly)if(o.isExteriorRing())n.push(new $p(o));else{const a=o.enclosingRing();a?.poly||n.push(new $p(a)),a?.poly?.addInterior(o)}}return n}}class Zv{queue;tree;segments;constructor(e,n=Ia.compare){this.queue=e,this.tree=new Aa(n),this.segments=[]}process(e){const n=e.segment,i=[];if(e.consumedBy)return e.isLeft?this.queue.delete(e.otherSE):this.tree.delete(n),i;e.isLeft&&this.tree.add(n);let s=n,o=n;do s=this.tree.lastBefore(s);while(s!=null&&s.consumedBy!=null);do o=this.tree.firstAfter(o);while(o!=null&&o.consumedBy!=null);if(e.isLeft){let a=null;if(s){const c=s.getIntersection(n);if(c!==null&&(n.isAnEndpoint(c)||(a=c),!s.isAnEndpoint(c))){const l=this._splitSafely(s,c);for(let u=0,f=l.length;u<f;u++)i.push(l[u])}}let h=null;if(o){const c=o.getIntersection(n);if(c!==null&&(n.isAnEndpoint(c)||(h=c),!o.isAnEndpoint(c))){const l=this._splitSafely(o,c);for(let u=0,f=l.length;u<f;u++)i.push(l[u])}}if(a!==null||h!==null){let c=null;a===null?c=h:h===null?c=a:c=sn.comparePoints(a,h)<=0?a:h,this.queue.delete(n.rightSE),i.push(n.rightSE);const l=n.split(c);for(let u=0,f=l.length;u<f;u++)i.push(l[u])}i.length>0?(this.tree.delete(n),i.push(e)):(this.segments.push(n),n.prev=s)}else{if(s&&o){const a=s.getIntersection(o);if(a!==null){if(!s.isAnEndpoint(a)){const h=this._splitSafely(s,a);for(let c=0,l=h.length;c<l;c++)i.push(h[c])}if(!o.isAnEndpoint(a)){const h=this._splitSafely(o,a);for(let c=0,l=h.length;c<l;c++)i.push(h[c])}}}this.tree.delete(n)}return i}_splitSafely(e,n){this.tree.delete(e);const i=e.rightSE;this.queue.delete(i);const s=e.split(n);return s.push(i),e.consumedBy===void 0&&this.tree.add(e),s}}class Gv{type;numMultiPolys;run(e,n,i){Bn.type=e;const s=[new Dp(n,!0)];for(let u=0,f=i.length;u<f;u++)s.push(new Dp(i[u],!1));if(Bn.numMultiPolys=s.length,Bn.type==="difference"){const u=s[0];let f=1;for(;f<s.length;)wl(s[f].bbox,u.bbox)!==null?f++:s.splice(f,1)}if(Bn.type==="intersection")for(let u=0,f=s.length;u<f;u++){const d=s[u];for(let p=u+1,y=s.length;p<y;p++)if(wl(d.bbox,s[p].bbox)===null)return[]}const o=new Aa(sn.compare);for(let u=0,f=s.length;u<f;u++){const d=s[u].getSweepEvents();for(let p=0,y=d.length;p<y;p++)o.add(d[p])}const a=new Zv(o);let h=null;for(o.size!=0&&(h=o.first(),o.delete(h));h;){const u=a.process(h);for(let f=0,d=u.length;f<d;f++){const p=u[f];p.consumedBy===void 0&&o.add(p)}o.size!=0?(h=o.first(),o.delete(h)):h=null}ei.reset();const c=ka.factory(a.segments);return new Xv(c).getGeom()}}const Bn=new Gv,Jv=(r,...e)=>Bn.run("union",r,e),Qv=(r,...e)=>Bn.run("intersection",r,e),Kv=(r,...e)=>Bn.run("xor",r,e),tM=(r,...e)=>Bn.run("difference",r,e),eM=ei.set,nM=Object.freeze(Object.defineProperty({__proto__:null,difference:tM,intersection:Qv,setPrecision:eM,union:Jv,xor:Kv},Symbol.toStringTag,{value:"Module"})),iM=0,Vp=1,Up=2,Wp=4,jp=8;function Ra(r,e,n){let i=iM;return r<n.left?i|=Vp:r>n.right&&(i|=Up),e<n.top?i|=Wp:e>n.bottom&&(i|=jp),i}function Oa(r,e){let[[n,i],[s,o]]=r,a=Ra(n,i,e),h=Ra(s,o,e);for(;;)if(a|h){if(a&h)return!1;{const{top:c,right:l,bottom:u,left:f}=e;let d,p;const y=h>a?h:a;y&jp?(d=n+(s-n)*(u-i)/(o-i),p=u):y&Wp?(d=n+(s-n)*(c-i)/(o-i),p=c):y&Up?(p=i+(o-i)*(l-n)/(s-n),d=l):y&Vp&&(p=i+(o-i)*(f-n)/(s-n),d=f),y==a?(n=d,i=p,a=Ra(n,i,e)):(s=d,o=p,h=Ra(s,o,e))}}else return!0}function La(r,e){return r.left<=e.right&&e.left<=r.right&&r.top<=e.bottom&&e.top<=r.bottom}function Yp(r,e){return r?{top:Math.min(r.top,e.top),right:Math.max(r.right,e.right),bottom:Math.max(r.bottom,e.bottom),left:Math.min(r.left,e.left)}:e}function Ks(r,e){return r?{top:Math.min(r.top,e[1]),right:Math.max(r.right,e[0]),bottom:Math.max(r.bottom,e[1]),left:Math.min(r.left,e[0])}:{top:e[1],right:e[0],bottom:e[1],left:e[0]}}function Hp(r){return Math.max(r.right-r.left,r.bottom-r.top)}function Ba(r,e){return{top:r[1]-e,right:r[0]+e,bottom:r[1]+e,left:r[0]-e}}function sM(r,e){return{top:r.top-e,right:r.right+e,bottom:r.bottom+e,left:r.left-e}}class is{constructor(e,n,i=16){this.boundingBox=e,this.depth=n,this.innerNodeCapacity=i}subtrees=null;pairs=[];insert(e,n){if(!La(e,this.boundingBox))return!1;if(this.depth>0&&this.pairs.length>=this.innerNodeCapacity){this.ensureSubtrees();for(let i=0;i<this.subtrees.length;i++)this.subtrees[i].insert(e,n)}else this.pairs.push([e,n]);return!0}find(e,n=new Set){if(!La(e,this.boundingBox))return n;for(let i=0;i<this.pairs.length;i++){const[s,o]=this.pairs[i];La(e,s)&&n.add(o)}if(this.subtrees)for(let i=0;i<this.subtrees.length;i++)this.subtrees[i].find(e,n);return n}findOnLineSegment(e,n=new Set){if(!Oa(e,this.boundingBox))return n;for(const[i,s]of this.pairs)Oa(e,i)&&n.add(s);if(this.subtrees)for(const i of this.subtrees)i.findOnLineSegment(e,n);return n}ensureSubtrees(){if(this.subtrees)return;const{top:e,right:n,bottom:i,left:s}=this.boundingBox,o=(this.boundingBox.left+this.boundingBox.right)/2,a=(this.boundingBox.top+this.boundingBox.bottom)/2;this.subtrees=[new is({top:e,right:o,bottom:a,left:s},this.depth-1,this.innerNodeCapacity),new is({top:e,right:n,bottom:a,left:o},this.depth-1,this.innerNodeCapacity),new is({top:a,right:o,bottom:i,left:s},this.depth-1,this.innerNodeCapacity),new is({top:a,right:n,bottom:i,left:o},this.depth-1,this.innerNodeCapacity)]}}class Fa extends Error{constructor(e){super("Assertion error: "+e)}}function Xp(r,e){if(!r)throw new Fa(`Expected 'cond' to be truthy: ${e}`)}function Fn(r,e){if(r==null)throw new Fa(`Expected 'val' to be defined, but received ${r}: ${e}`)}function Zp(r,e,n){if(r!==e)throw new Fa(`Expected 'lhs' to equal ${e}, but received ${r}: ${n}`)}function rM(r){throw new Fa(`Reached code that was supposed to be unreachable: ${r}`)}const Na=1e-12;function Gp(r){const e=r[1],n=r[2],i=r[3],s=r[4],o=-e[0]+3*n[0]-3*i[0]+s[0],a=-e[1]+3*n[1]-3*i[1]+s[1],h=3*e[0]-6*n[0]+3*i[0],c=3*e[1]-6*n[1]+3*i[1],l=-3*e[0]+3*n[0],u=-3*e[1]+3*n[1],f=a*h-o*c,d=o*u-a*l,p=(-3*o*o*u*u+6*o*a*l*u+4*o*h*c*u-4*o*c*c*l-3*a*a*l*l-4*a*h*h*u+4*a*h*c*l)/(o*o*c*c-2*o*a*h*c+a*a*h*h);if(p<0)return null;const y=(d/f+Math.sqrt(p))/2,x=(d/f-Math.sqrt(p))/2;return Na<=y&&y<=1-Na&&Na<=x&&x<=1-Na?[y,x]:null}const Jp=2*Math.PI;function oM(r,e,n,i,s){return(r-e)/(n-e)*(s-i)+i}function gn(r,e,n){return r+(e-r)*n}function Qp(r){return r/180*Math.PI}function Kp(r,e){const i=Math.sign(r[0]*e[1]-r[1]*e[0]);return i===0&&Math.abs(r[0]+e[0])<1e-12&&Math.abs(r[1]+e[1])<1e-12?Math.PI:i*Math.acos(et.dot(r,e)/et.len(r)/et.len(e))}function Dt(){return[0,0]}function Ee(r,e,n=0){return Math.abs(r[0]-e[0])<=n&&Math.abs(r[1]-e[1])<=n}function bl(r){return r[1]}function t1(r){switch(r[0]){case"L":return r[2];case"C":return r[4];case"Q":return r[3];case"A":return r[7]}}function qa(r){switch(r[0]){case"L":return["L",r[2],r[1]];case"C":return["C",r[4],r[3],r[2],r[1]];case"Q":return["Q",r[3],r[2],r[1]];case"A":return["A",r[7],r[2],r[3],r[4],r[5],!r[6],r[1]]}}const Da=(()=>{const r=Dt(),e=Us.create(),n=Dt(),i=Dt();return function([o,a,h,c,l,u,f,d]){if(h===0||c===0)return null;Us.fromRotation(e,-Qp(l)),et.sub(r,a,d),et.scale(r,r,.5),et.transformMat2(r,r,e);let p=h*h,y=c*c;const x=r[0]*r[0],m=r[1]*r[1];h=Math.abs(h),c=Math.abs(c);const g=x/p+m/y+1e-12;if(g>1){const v=Math.sqrt(g);h*=v,c*=v;const _=Math.abs(g);p*=_,y*=_}const w=u===f?-1:1,M=Math.sqrt((p*y-p*m-y*x)/(p*m+y*x)),S=w*M*(h*r[1]/c),E=w*M*(-c*r[0]/h);Us.transpose(e,e),et.add(n,a,d),et.scale(n,n,.5),et.transformMat2(i,[S,E],e),et.add(i,i,n);const A=[(r[0]-S)/h,(r[1]-E)/c],I=Kp([1,0],A);let b=Kp(A,[(-r[0]-S)/h,(-r[1]-E)/c]);return!f&&b>0?b-=Jp:f&&b<0&&(b+=Jp),{center:[i[0],i[1]],theta1:I,deltaTheta:b,rx:h,ry:c,phi:l}}})(),e1=(()=>{const r=Dt(),e=Dt(),n=Us.create();return function({center:s,theta1:o,deltaTheta:a,rx:h,ry:c,phi:l}){Us.fromRotation(n,l),et.set(r,h*Math.cos(o),c*Math.sin(o)),et.transformMat2(r,r,n),et.add(r,r,s),et.set(e,h*Math.cos(o+a),c*Math.sin(o+a)),et.transformMat2(e,e,n),et.add(e,e,s);const u=Math.abs(a)>Math.PI,f=a>0;return["A",[r[0],r[1]],h,c,l,u,f,[e[0],e[1]]]}})(),tr=(()=>{const r=Dt(),e=Dt(),n=Dt(),i=Dt(),s=Dt(),o=Dt();return function(h,c){switch(h[0]){case"L":et.lerp(o,h[1],h[2],c);break;case"C":et.lerp(r,h[1],h[2],c),et.lerp(e,h[2],h[3],c),et.lerp(n,h[3],h[4],c),et.lerp(i,r,e,c),et.lerp(s,e,n,c),et.lerp(o,i,s,c);break;case"Q":et.lerp(r,h[1],h[2],c),et.lerp(e,h[2],h[3],c),et.lerp(o,r,e,c);break;case"A":{const l=Da(h);if(!l){et.lerp(o,h[1],h[7],c);break}const{deltaTheta:u,phi:f,theta1:d,rx:p,ry:y,center:x}=l,m=d+c*u;et.set(o,p*Math.cos(m),y*Math.sin(m)),et.rotate(o,o,[0,0],f),et.add(o,o,x);break}}return[o[0],o[1]]}})(),n1=(()=>{const r=xi.create(),e=xi.create();return function(i,s=Math.PI/2){const o=Da(i);if(!o)return[["L",i[1],i[7]]];const{center:a,theta1:h,deltaTheta:c,rx:l,ry:u}=o,f=Math.ceil(Math.abs(c)/s);xi.fromTranslation(r,a),xi.rotate(r,r,Qp(i[4])),xi.scale(r,r,[l,u]);const d=[],p=c/f,y=4/3*Math.tan(p/4),x=Math.sin(p),m=Math.cos(p);for(let g=0;g<f;g++){const w=[1,0],M=[1,y],S=[m+y*x,x-y*m],E=[m,x];xi.fromRotation(e,h+g*p),xi.mul(e,r,e),et.transformMat2d(w,w,e),et.transformMat2d(M,M,e),et.transformMat2d(S,S,e),et.transformMat2d(E,E,e),d.push(["C",w,M,S,E])}return d}})();function i1(r,e,n,i,s){const o=gn(r,e,s),a=gn(e,n,s),h=gn(n,i,s),c=gn(o,a,s),l=gn(a,h,s);return gn(c,l,s)}function s1(r,e,n,i){let s=Math.min(r,i),o=Math.max(r,i);const a=3*(-r+3*e-3*n+i),h=6*(r-2*e+n),c=3*(e-r),l=h*h-4*a*c;if(l<0||a===0)return[s,o];const u=Math.sqrt(l),f=(-h-u)/(2*a);if(0<f&&f<1){const p=i1(r,e,n,i,f);s=Math.min(s,p),o=Math.max(o,p)}const d=(-h+u)/(2*a);if(0<d&&d<1){const p=i1(r,e,n,i,d);s=Math.min(s,p),o=Math.max(o,p)}return[s,o]}function aM(r,e,n,i){const s=gn(r,e,i),o=gn(e,n,i);return gn(s,o,i)}function r1(r,e,n){let i=Math.min(r,n),s=Math.max(r,n);const o=r-2*e+n;if(o===0)return[i,s];const a=(r-e)/o;if(0<=a&&a<=1){const h=aM(r,e,n,a);i=Math.min(i,h),s=Math.max(s,h)}return[i,s]}function Ti(r,e,n){const i=(r-e)/(n-e);return 0<=i&&i<=1}function rn(r){switch(r[0]){case"L":return{top:Math.min(r[1][1],r[2][1]),right:Math.max(r[1][0],r[2][0]),bottom:Math.max(r[1][1],r[2][1]),left:Math.min(r[1][0],r[2][0])};case"C":{const[e,n]=s1(r[1][0],r[2][0],r[3][0],r[4][0]),[i,s]=s1(r[1][1],r[2][1],r[3][1],r[4][1]);return{top:i,right:n,bottom:s,left:e}}case"Q":{const[e,n]=r1(r[1][0],r[2][0],r[3][0]),[i,s]=r1(r[1][1],r[2][1],r[3][1]);return{top:i,right:n,bottom:s,left:e}}case"A":{const e=Da(r);if(!e)return Ks(Ba(r[1],0),r[7]);const{theta1:n,deltaTheta:i,phi:s,center:o,rx:a,ry:h}=e;if(s===0||a===h){const u=n+i;let f=Ks(Ba(r[1],0),r[7]);return(Ti(-Math.PI,n,u)||Ti(Math.PI,n,u))&&(f=Ks(f,[o[0]-a,o[1]])),(Ti(-Math.PI/2,n,u)||Ti(3*Math.PI/2,n,u))&&(f=Ks(f,[o[0],o[1]-h])),(Ti(0,n,u)||Ti(2*Math.PI,n,u))&&(f=Ks(f,[o[0]+a,o[1]])),(Ti(Math.PI/2,n,u)||Ti(5*Math.PI/2,n,u))&&(f=Ks(f,[o[0],o[1]+h])),sM(f,1e-11)}const c=n1(r,Math.PI/16);let l=null;for(const u of c)l=Yp(l,rn(u));return l||Ba(r[1],0)}}}function o1(r,e){const n=r[1],i=r[2],s=et.lerp(Dt(),n,i,e);return[["L",n,s],["L",s,i]]}function $a(r,e){const n=r[1],i=r[2],s=r[3],o=r[4],a=et.lerp(Dt(),n,i,e),h=et.lerp(Dt(),i,s,e),c=et.lerp(Dt(),s,o,e),l=et.lerp(Dt(),a,h,e),u=et.lerp(Dt(),h,c,e),f=et.lerp(Dt(),l,u,e);return[["C",n,a,l,f],["C",f,u,c,o]]}function hM(r,e){const n=r[1],i=r[2],s=r[3],o=et.lerp(Dt(),n,i,e),a=et.lerp(Dt(),i,s,e),h=et.lerp(Dt(),o,a,e);return[["Q",n,o,h],["Q",h,a,s]]}function cM(r,e){const n=Da(r);if(!n)return o1(["L",r[1],r[7]],e);const i=n.deltaTheta*e;return[e1({...n,deltaTheta:i}),e1({...n,theta1:n.theta1+i,deltaTheta:n.deltaTheta-i})]}function vl(r,e){switch(r[0]){case"L":return o1(r,e);case"C":return $a(r,e);case"Q":return hM(r,e);case"A":return cM(r,e)}}function Ml([[r,e],[n,i]],[[s,o],[a,h]],c){const l=n-r,u=s-a,f=s-r,d=i-e,p=o-h,y=o-e,x=l*p-d*u;if(Math.abs(x)<c.collinear)return null;const m=(f*p-y*u)/x,g=(l*y-d*f)/x;return-c.param<=m&&m<=1+c.param&&-c.param<=g&&g<=1+c.param?[m,g]:null}function lM(r,e,n){return!!Ml(r,e,n)}function a1(r){const[e,n]=vl(r.seg,.5),i=(r.startParam+r.endParam)/2;return[{seg:e,startParam:r.startParam,endParam:i,boundingBox:rn(e)},{seg:n,startParam:i,endParam:r.endParam,boundingBox:rn(n)}]}function h1(r){switch(r[0]){case"L":return[r[1],r[2]];case"C":return[r[1],r[4]];case"Q":return[r[1],r[3]];case"A":return[r[1],r[7]]}}function uM({seg:r,boundingBox:e},{seg:n,boundingBox:i},s){return r[0]==="L"?n[0]==="L"?lM([r[1],r[2]],[n[1],n[2]],s):Oa([r[1],r[2]],i):n[0]==="L"?Oa([n[1],n[2]],e):La(e,i)}function _l(r,e,n){const i=r[0];if(e[0]!==i)return!1;switch(i){case"L":return Ee(r[1],e[1],n)&&Ee(r[2],e[2],n);case"C":return Ee(r[1],e[1],n)&&Ee(r[2],e[2],n)&&Ee(r[3],e[3],n)&&Ee(r[4],e[4],n);case"Q":return Ee(r[1],e[1],n)&&Ee(r[2],e[2],n)&&Ee(r[3],e[3],n);case"A":return Ee(r[1],e[1],n)&&Math.abs(r[2]-e[2])<n&&Math.abs(r[3]-e[3])<n&&(Math.abs(r[2]-r[3])<n||Math.abs(r[4]-e[4])<n)&&r[5]===e[5]&&r[6]===e[6]&&Ee(r[7],e[7],n)}}function fM(r,e,n){const i=et.sub([0,0],r[1],r[0]),s=et.sub([0,0],e[1],e[0]);et.normalize(i,i),et.normalize(s,s);const o=Math.abs(et.dot(i,s));return Math.abs(o-1)<n}const dM=(()=>{const r=Dt(),e=Dt(),n=Dt(),i=Dt(),s=Dt(),o=Dt();return function(h,c){et.sub(r,h[1],h[0]),et.sub(e,c[1],c[0]),et.scale(r,r,1/et.sqrLen(r)),et.scale(e,e,1/et.sqrLen(e));const l=[];et.sub(n,c[0],h[0]);const u=et.dot(n,r);u>=0&&u<=1&&l.push([u,0]),et.sub(i,c[1],h[0]);const f=et.dot(i,r);f>=0&&f<=1&&l.push([f,1]),et.sub(s,h[0],c[0]);const d=et.dot(s,e);d>=0&&d<=1&&l.push([0,d]),et.sub(o,h[1],c[0]);const p=et.dot(o,e);return p>=0&&p<=1&&l.push([1,p]),l}})();function c1(r,e,n){if(r[0]==="L"&&e[0]==="L"){const a=[r[1],r[2]],h=[e[1],e[2]];if(fM(a,h,n.collinear))return dM(a,h);const c=Ml(a,h,n);return c?[c]:[]}let i=[[{seg:r,startParam:0,endParam:1,boundingBox:rn(r)},{seg:e,startParam:0,endParam:1,boundingBox:rn(e)}]];const s=[];function o(a){return Hp(a.boundingBox)<=n.linear||a.endParam-a.startParam<n.param}for(;i.length;){const a=[];for(const[h,c]of i){if(_l(h.seg,c.seg,n.point))continue;const l=o(h),u=o(c);if(l&&u){const f=h1(h.seg),d=h1(c.seg),p=Ml(f,d,n);p&&s.push([gn(h.startParam,h.endParam,p[0]),gn(c.startParam,c.endParam,p[1])])}else{const f=l?[h]:a1(h),d=u?[c]:a1(c);for(const p of f)for(const y of d)uM(p,y,n)&&a.push([p,y])}}i=a}return s}function pM(r){return typeof r=="number"}function yM(r){return typeof r=="string"}function xM(r){return typeof r=="boolean"}const Qr=Object.hasOwn;function Va(r){const e=new WeakMap;return(n,...i)=>{if(e.has(n))return e.get(n);{const s=r(n,...i);return e.set(n,s),s}}}function mM(r,e){return r.reduce((n,i)=>n+(e(i)?1:0),0)}function*Ua(r,e){let n=0;for(const i of r)yield e(i,n++)}const gM=8,wM=8,Fe={point:1e-6,linear:1e-4,param:1e-8,collinear:Number.MIN_VALUE*64};var l1=(r=>(r[r.Union=0]="Union",r[r.Difference=1]="Difference",r[r.Intersection=2]="Intersection",r[r.Exclusion=3]="Exclusion",r[r.Division=4]="Division",r[r.Fracture=5]="Fracture",r))(l1||{}),u1=(r=>(r[r.NonZero=0]="NonZero",r[r.EvenOdd=1]="EvenOdd",r))(u1||{});function bM(r){return r.values().next().value}function f1(){let r=0;return Va(()=>r++)}function d1(r){return e=>({seg:e,parent:r})}function vM(r){for(let e=0;e<r.length;e++){const n=r[e];if(n.seg[0]!=="C")continue;const i=Gp(n.seg);if(!i)continue;i[0]>i[1]&&i.reverse();const[s,o]=i;if(Math.abs(s-o)<Fe.param){const[a,h]=$a(n.seg,s);r[e]={seg:a,parent:n.parent},r.push({seg:h,parent:n.parent})}else{const[a,h]=$a(n.seg,s),[c,l]=$a(h,(o-s)/(1-s));r[e]={seg:a,parent:n.parent},r.push({seg:c,parent:n.parent},{seg:l,parent:n.parent})}}}function MM(r){const e=r.map(h=>({...h,boundingBox:rn(h.seg)})),n=e.reduce((h,{boundingBox:c})=>Yp(h,c),null);if(!n)return{edges:[],totalBoundingBox:null};const i=new is(n,gM),s={};function o(h,c){Qr(s,h)||(s[h]=[]),s[h].push(c)}for(let h=0;h<e.length;h++){const c=e[h],l=i.find(c.boundingBox);for(const u of l){const f=r[u],d=c1(c.seg,f.seg,Fe);for(const[p,y]of d)o(h,p),o(u,y)}i.insert(c.boundingBox,h)}const a=[];for(let h=0;h<e.length;h++){const c=e[h];if(!Qr(s,h)){a.push(c);continue}const l=s[h];l.sort();let u=c.seg,f=0;for(let d=0;d<l.length;d++){const p=l[d];if(p>1-Fe.param)break;const y=(p-f)/(1-f);if(f=p,y<Fe.param||y>1-Fe.param)continue;const[x,m]=vl(u,y);a.push({seg:x,boundingBox:rn(x),parent:c.parent}),u=m}a.push({seg:u,boundingBox:rn(u),parent:c.parent})}return{edges:a,totalBoundingBox:n}}function _M(r,e){const n=new is(e,wM),i=[];function s(c){const l=Ba(c,Fe.point),u=n.find(l);if(u.size)return bM(u);{const f={point:c,outgoingEdges:[]};return n.insert(l,f),i.push(f),f}}const o=f1(),a={};return{edges:r.flatMap(c=>{const l=s(bl(c.seg)),u=s(t1(c.seg));if(l===u)switch(c.seg[0]){case"L":return[];case"C":if(Ee(c.seg[1],c.seg[2],Fe.point)&&Ee(c.seg[3],c.seg[4],Fe.point))return[];break;case"Q":if(Ee(c.seg[1],c.seg[2],Fe.point))return[];break;case"A":if(c.seg[5]===!1)return[];break}const f=`${o(l)}:${o(u)}`;if(Qr(a,f)){const x=a[f].find(m=>_l(m[0].seg,c.seg,Fe.point));if(x)return x[1].parent|=c.parent,x[2].parent|=c.parent,[]}const d=`${o(u)}:${o(l)}`;if(Qr(a,d)){const x=qa(c.seg),m=a[d].find(g=>_l(g[0].seg,x,Fe.point));if(m)return m[0].parent===c.parent?[]:(m[1].parent|=c.parent,m[1].directionFlagA=c.parent===1,m[1].directionFlagB=c.parent===2,m[2].parent|=c.parent,m[2].directionFlagA=c.parent===1,m[2].directionFlagB=c.parent===2,[])}const p={...c,incidentVertices:[l,u],directionFlag:!1,directionFlagA:!1,directionFlagB:!1,twin:null},y={...c,incidentVertices:[u,l],directionFlag:!0,directionFlagA:c.parent===1,directionFlagB:c.parent===2,twin:p};return p.twin=y,l.outgoingEdges.push(p),u.outgoingEdges.push(y),Qr(a,f)?a[f].push([c,p,y]):a[f]=[[c,p,y]],[p,y]}),vertices:i}}function Kr(r){return r.outgoingEdges.length}function SM({vertices:r}){const e=[],n=[],i=Va(c=>{const l={outgoingEdges:[]};return n.push(l),l}),s=f1(),o={},a=new WeakSet;for(const c of r){if(Kr(c)===2)continue;const l=i(c);for(const u of c.outgoingEdges){const f=[];let d=u;for(;d.parent===u.parent&&d.directionFlag===u.directionFlag&&d.directionFlagA===u.directionFlagA&&d.directionFlagB===u.directionFlagB&&Kr(d.incidentVertices[1])===2;){f.push(d.seg),a.add(d.incidentVertices[1]);const[w,M]=d.incidentVertices[1].outgoingEdges;Xp(w.twin===d||M.twin===d,"Wrong twin structure."),d=w.twin===d?M:w}f.push(d.seg);const p=i(d.incidentVertices[1]);Fn(d.twin,"Edge doesn't have a twin."),Fn(u.twin,"Edge doesn't have a twin.");const y=`${s(u)}-${s(d)}`,x=`${s(d.twin)}-${s(u.twin)}`,m=o[x]??null,g={segments:f,parent:u.parent,incidentVertices:[l,p],directionFlag:u.directionFlag,directionFlagA:u.directionFlagA,directionFlagB:u.directionFlagB,twin:m};m&&(m.twin=g),o[y]=g,l.outgoingEdges.push(g),e.push(g)}}const h=[];for(const c of r){if(Kr(c)!==2||a.has(c))continue;let l=c.outgoingEdges[0];const u={segments:[],parent:l.parent,directionFlag:l.directionFlag,directionFlagA:l.directionFlagA,directionFlagB:l.directionFlagB};do{u.segments.push(l.seg),a.add(l.incidentVertices[0]),Zp(Kr(l.incidentVertices[1]),2,"Found an unvisited vertex of order != 2.");const[f,d]=l.incidentVertices[1].outgoingEdges;Xp(f.twin===l||d.twin===l,"Wrong twin structure."),l=f.twin===l?d:f}while(l.incidentVertices[0]!==c);h.push(u)}return{edges:e,vertices:n,cycles:h}}function TM(r){function e(a){const h=new WeakSet,c=new WeakMap;function l(u,f,d){if(c.has(u))return c.get(u);c.set(u,d);let p=1/0;for(const y of u.outgoingEdges)y.parent&a&&y!==f&&(p=Math.min(p,l(y.incidentVertices[1],y.twin,d+1)));return p<=d&&h.add(u),p}for(const u of r.edges)u.parent&a&&l(u.incidentVertices[0],null,0);return h}const n=e(1),i=e(2);function s(a){return n.has(a)||i.has(a)}function o(a){return(a.parent&1)===1&&n.has(a.incidentVertices[0])&&n.has(a.incidentVertices[1])||(a.parent&2)===2&&i.has(a.incidentVertices[0])&&i.has(a.incidentVertices[1])}r.vertices=r.vertices.filter(s);for(const a of r.vertices)a.outgoingEdges=a.outgoingEdges.filter(o);r.edges=r.edges.filter(o)}function EM({directionFlag:r,segments:e}){let n,i;const s=e[0];return r?(n=tr(s,1),i=tr(s,1-Fe.param)):(n=tr(s,0),i=tr(s,Fe.param)),Math.atan2(i[1]-n[1],i[0]-n[0])}function zM({vertices:r}){const e=Va(EM);for(const n of r)Kr(n)>2&&n.outgoingEdges.sort((i,s)=>e(i)-e(s))}function AM(r){const{outgoingEdges:e}=r.incidentVertices[1],n=e.findIndex(i=>i.twin===r);return e[(n+1)%e.length]}const CM=Va(r=>r.incidentEdges.flatMap(e=>{const i=[];for(const s of e.segments)for(let o=0;o<64;o++){const a=o/64,h=e.directionFlag?1-a:a;i.push(tr(s,h))}return i}));function p1(r,e,n){const i=r>=n,s=e<n;return i===s}function y1(r,e,n){return p1(r[1],e[1],n[1])?oM(n[1],r[1],e[1],r[0],e[0])>=n[0]:!1}function PM(r,e){if(r.length<=2)return 0;let n=r[r.length-1],i=0;for(const s of r)y1(n,s,e)&&(i+=s[1]>n[1]?-1:1),n=s;return i}function x1(r){const e=CM(r);for(let n=0;n<e.length;n++){const i=e[n],s=e[(n+1)%e.length],o=e[(n+2)%e.length],a=[(i[0]+s[0]+o[0])/3,(i[1]+s[1]+o[1])/3],h=PM(e,a);if(h!==0)return{winding:h,point:a}}rM("No ear in polygon found.")}function IM({edges:r,cycles:e}){const n=[],i=new WeakMap;for(const h of r){if(i.has(h))continue;const c={incidentEdges:[],flag:0};let l=h;do{Fn(l.twin,"Edge doesn't have a twin");const u=i.get(l.twin)??null,f={segments:l.segments,parent:l.parent,incidentVertex:c,directionFlag:l.directionFlag,directionFlagA:l.directionFlagA,directionFlagB:l.directionFlagB,twin:u};u&&(u.twin=f),i.set(l,f),c.incidentEdges.push(f),l=AM(l)}while(l!==h);n.push(c)}for(const h of e){const c={incidentEdges:[],flag:0},l={segments:h.segments,parent:h.parent,incidentVertex:c,directionFlag:h.directionFlag,directionFlagA:h.directionFlagA,directionFlagB:h.directionFlagB,twin:null},u={incidentEdges:[],flag:0},f={segments:[...h.segments].reverse(),parent:h.parent,incidentVertex:u,directionFlag:!h.directionFlag,directionFlagA:!h.directionFlagA,directionFlagB:!h.directionFlagB,twin:l};l.twin=f,c.incidentEdges.push(l),u.incidentEdges.push(f),n.push(c,u)}const s=[],o=new WeakSet,a=new WeakSet;for(const h of n){if(o.has(h))continue;const c=[],l=[],u=d=>{o.has(d)||c.push(d),o.add(d);for(const p of d.incidentEdges){if(a.has(p))continue;const{twin:y}=p;Fn(y,"Edge doesn't have a twin."),l.push(p,y),a.add(p),a.add(y),u(y.incidentVertex)}};u(h);const f=c.find(d=>x1(d).winding<0);Fn(f,"No outer face of a component found."),Zp(mM(c,d=>x1(d).winding<0),1,"Multiple outer faces found."),s.push({vertices:c,edges:l,outerFace:f})}return s}function Sl(r,e){return p1(r.top,r.bottom,e[1])&&r.right>=e[0]}function kM(r,e){const n=rn(r);if(!Sl(n,e))return 0;let i=[{boundingBox:n,seg:r}],s=0;for(;i.length>0;){const o=[];for(const{boundingBox:a,seg:h}of i)if(Hp(a)<Fe.linear)y1(bl(h),t1(h),e)&&s++;else{const c=vl(h,.5),l=rn(c[0]);Sl(l,e)&&o.push({boundingBox:l,seg:c[0]});const u=rn(c[1]);Sl(u,e)&&o.push({boundingBox:u,seg:c[1]})}i=o}return s}function m1(r,e){const n=bl(r.edges[0].segments[0]);for(const i of e.vertices){if(i===e.outerFace)continue;let s=0;for(const o of i.incidentEdges)for(const a of o.segments)s+=kM(a,n);if(s%2===1)return i}return null}function RM(r){let e=[];function n(i,s){let o=!1;for(const a of i){const h=m1(s,a.component);if(h){if(a.outgoingEdges.has(h)){const c=a.outgoingEdges.get(h);a.outgoingEdges.set(h,n(c,s))}else a.outgoingEdges.set(h,[{component:s,outgoingEdges:new Map}]);o=!0;break}}if(o)return i;{const a={component:s,outgoingEdges:new Map},h=[a];for(const c of i){const l=m1(c.component,s);l?a.outgoingEdges.has(l)?a.outgoingEdges.get(l).push(c):a.outgoingEdges.set(l,[c]):h.push(c)}return h}}for(const i of r)e=n(e,i);return e}function g1(r,e){switch(e){case 0:return r===0?0:1;case 1:return r%2===0?0:1}}function OM(r,e,n){function i(s,o,a){const h=new WeakSet;function c(l,u,f){if(h.has(l))return;h.add(l);const d=g1(u,e),p=g1(f,n);l.flag=d|p<<1;for(const y of l.incidentEdges){const x=y.twin;Fn(x,"Edge doesn't have a twin.");let m=u;y.parent&1&&(m+=y.directionFlagA?-1:1);let g=f;y.parent&2&&(g+=y.directionFlagB?-1:1),c(x.incidentVertex,m,g)}if(s.outgoingEdges.has(l)){const y=s.outgoingEdges.get(l);for(const x of y)i(x,u,f)}}Fn(s.component.outerFace,"Component doesn't have an outer face."),c(s.component.outerFace,o,a)}for(const s of r)i(s,0,0)}function*LM(r,e){function*n(i){for(const s of i.component.vertices)e(s)&&(yield s);for(const s of i.outgoingEdges.values())for(const o of s)yield*n(o)}for(const i of r)yield*n(i)}function*BM(r){function e(s){return Fn(s.twin,"Edge doesn't have a twin."),r.has(s.incidentVertex)===r.has(s.twin.incidentVertex)}const n=new WeakMap;for(const s of r){let o=s.incidentEdges[s.incidentEdges.length-1];for(const a of s.incidentEdges)n.set(o,a),o=a}const i=new WeakSet;for(const s of r)for(const o of s.incidentEdges){if(e(o)||i.has(o))continue;let a=o;do for(a.directionFlag?yield*Ua(a.segments,qa):yield*a.segments,i.add(a),a=n.get(a);e(a);)Fn(a.twin,"Edge doesn't have a twin."),a=n.get(a.twin);while(a!==o)}}function FM(r,e){const n=[];function i(s){for(const o of s.component.vertices){if(!e(o)||o===s.component.outerFace)continue;const a=[];for(const h of o.incidentEdges)h.directionFlag?a.push(...h.segments.map(qa)):a.push(...h.segments);if(s.outgoingEdges.has(o))for(const h of s.outgoingEdges.get(o)){const{outerFace:c}=h.component;Fn(c,"Component has no outer face.");for(const l of c.incidentEdges)l.directionFlag?a.push(...l.segments.map(qa)):a.push(...l.segments)}n.push(a)}for(const o of s.outgoingEdges.values())for(const a of o)i(a)}for(const s of r)i(s);return n}const NM={0:({flag:r})=>r>0,1:({flag:r})=>r===1,2:({flag:r})=>r===3,3:({flag:r})=>r===1||r===2,4:({flag:r})=>(r&1)===1,5:({flag:r})=>r>0};function qM(r,e,n,i,s){const o=[...Ua(r,d1(1)),...Ua(n,d1(2))];vM(o);const{edges:a,totalBoundingBox:h}=MM(o);if(!h)return[];const c=_M(a,h),l=SM(c);TM(l),zM(l);const u=IM(l),f=RM(u);OM(f,e,i);const d=NM[s];switch(s){case 4:case 5:return FM(f,d);default:{const p=new Set(LM(f,d));return[[...BM(p)]]}}}function*DM(r){let e=[0,0],n=e;for(const i of r)switch(i[0]){case"M":yield i,e=n=i[1];break;case"L":yield i,e=i[1];break;case"C":yield i,e=i[3];break;case"S":yield i,e=i[2];break;case"Q":yield i,e=i[2];break;case"T":yield i,e=i[1];break;case"A":yield i,e=i[6];break;case"Z":case"z":e=n,yield["Z"];break;case"H":e=[i[1],e[1]],yield["L",e];break;case"V":e=[e[0],i[1]],yield["L",e];break;case"m":e=n=[e[0]+i[1],e[1]+i[2]],yield["M",e];break;case"l":e=[e[0]+i[1],e[1]+i[2]],yield["L",e];break;case"h":e=[e[0]+i[1],e[1]],yield["L",e];break;case"v":e=[e[0],e[1]+i[1]],yield["L",e];break;case"c":yield["C",[e[0]+i[1],e[1]+i[2]],[e[0]+i[3],e[1]+i[4]],e=[e[0]+i[5],e[1]+i[6]]];break;case"s":yield["S",[e[0]+i[1],e[1]+i[2]],e=[e[0]+i[3],e[1]+i[4]]];break;case"q":yield["Q",[e[0]+i[1],e[1]+i[2]],e=[e[0]+i[3],e[1]+i[4]]];break;case"t":yield["T",e=[e[0]+i[1],e[1]+i[2]]];break;case"a":yield["A",i[1],i[2],i[3],i[4],i[5],e=[e[0]+i[6],e[1]+i[7]]];break}}function w1(r,e){return[2*r[0]-e[0],2*r[1]-e[1]]}function*b1(r){let e=null,n=null,i=null;function s(){throw new Error("Bad SVG path data sequence.")}for(const o of DM(r))switch(o[0]){case"M":n=e=o[1],i=null;break;case"L":n||s(),yield["L",n,o[1]],n=o[1],i=null;break;case"C":n||s(),yield["C",n,o[1],o[2],o[3]],n=o[3],i=o[2];break;case"S":n||s(),i||s(),yield["C",n,w1(n,i),o[1],o[2]],n=o[2],i=o[1];break;case"Q":n||s(),yield["Q",n,o[1],o[2]],n=o[2],i=o[1];break;case"T":n||s(),i||s(),i=w1(n,i),yield["Q",n,i,o[1]],n=o[1];break;case"A":n||s(),yield["A",n,o[1],o[2],o[3],o[4],o[5],o[6]],n=o[6],i=null;break;case"Z":case"z":n||s(),e||s(),yield["L",n,e],n=e,i=null;break}}function*v1(r,e=1e-4){let n=null;for(const i of r)switch((!n||!Ee(i[1],n,e))&&(yield["M",i[1]]),i[0]){case"L":yield["L",n=i[2]];break;case"C":yield["C",i[2],i[3],n=i[4]];break;case"Q":yield["Q",i[2],n=i[3]];break;case"A":yield["A",i[2],i[3],i[4],i[5],i[6],n=i[7]];break}}const M1=Symbol();function*_1(r){const e=/(-?\d*(?:\d\.|\.\d|\d)\d*(?:[eE][+\-]?\d+)?)/y,n=/([MLCSQTAZHVmlhvcsqtaz])/y,i=/([01])/y,s=/\s*,?\s*/y;let o=0;function a(){s.lastIndex=o,s.exec(r)!==null&&(o=s.lastIndex)}let h="M",c=-1;function l(){if(a(),o>r.length-1)return M1;n.lastIndex=o;const d=n.exec(r);if(!d)switch(h){case"M":return"L";case"m":return"l";case"Z":case"z":if(o===c)throw new Error(`Invalid path data. Invalid syntax at index ${o}.`);return c=o,h;default:return h}return o=n.lastIndex,d[1]}function u(){a(),e.lastIndex=o;const d=e.exec(r);if(!d)throw new Error(`Invalid path data. Expected a number at index ${o}.`);return o=e.lastIndex,Number(d[1])}function f(){a(),i.lastIndex=o;const d=i.exec(r);if(!d)throw new Error(`Invalid path data. Expected a flag at index ${o}.`);return o=i.lastIndex,d[1]==="1"}for(;;)switch(l()){case"M":yield[h="M",[u(),u()]];break;case"L":yield[h="L",[u(),u()]];break;case"C":yield[h="C",[u(),u()],[u(),u()],[u(),u()]];break;case"S":yield[h="S",[u(),u()],[u(),u()]];break;case"Q":yield[h="Q",[u(),u()],[u(),u()]];break;case"T":yield[h="T",[u(),u()]];break;case"A":yield[h="A",u(),u(),u(),f(),f(),[u(),u()]];break;case"Z":case"z":yield[h="Z"];break;case"H":yield[h="H",u()];break;case"V":yield[h="V",u()];break;case"m":yield[h="m",u(),u()];break;case"l":yield[h="l",u(),u()];break;case"h":yield[h="h",u()];break;case"v":yield[h="v",u()];break;case"c":yield[h="c",u(),u(),u(),u(),u(),u()];break;case"s":yield[h="s",u(),u(),u(),u()];break;case"q":yield[h="q",u(),u(),u(),u()];break;case"t":yield[h="t",u(),u()];break;case"a":yield[h="a",u(),u(),u(),f(),f(),u(),u()];break;case M1:return}}function $M(r){return[...b1(_1(r))]}function VM(r,e=1e-4){function n(i){return yM(i)?i:pM(i)?i.toFixed(12):xM(i)?i?"1":"0":i.map(s=>s.toFixed(12)).join(",")}return[...Ua(v1(r,e),i=>i.map(n).join(" "))].join(" ")}const UM=Object.freeze(Object.defineProperty({__proto__:null,FillRule:u1,PathBooleanOperation:l1,arcSegmentToCubics:n1,commandsFromPathData:_1,pathBoolean:qM,pathCubicSegmentSelfIntersection:Gp,pathFromCommands:b1,pathFromPathData:$M,pathSegmentBoundingBox:rn,pathSegmentIntersection:c1,pathToCommands:v1,pathToPathData:VM,samplePathSegmentAt:tr},Symbol.toStringTag,{value:"Module"}));function S1(r){return"("+r.x+";"+r.y+")"}function Tl(r){var e=r.toString();return e==="[object Object]"?S1(r):e}function T1(r,e){return r.y===e.y?r.x-e.x:r.y-e.y}function WM(r,e){return r.x===e.x&&r.y===e.y}var ni=function(r,e){this.name="PointError",this.points=e=e||[],this.message=r||"Invalid Points!";for(var n=0;n<e.length;n++)this.message+=" "+Tl(e[n])};ni.prototype=new Error,ni.prototype.constructor=ni;var Ct=function(r,e){this.x=+r||0,this.y=+e||0,this._p2t_edge_list=null};Ct.prototype.toString=function(){return S1(this)},Ct.prototype.toJSON=function(){return{x:this.x,y:this.y}},Ct.prototype.clone=function(){return new Ct(this.x,this.y)},Ct.prototype.set_zero=function(){return this.x=0,this.y=0,this},Ct.prototype.set=function(r,e){return this.x=+r||0,this.y=+e||0,this},Ct.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},Ct.prototype.add=function(r){return this.x+=r.x,this.y+=r.y,this},Ct.prototype.sub=function(r){return this.x-=r.x,this.y-=r.y,this},Ct.prototype.mul=function(r){return this.x*=r,this.y*=r,this},Ct.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Ct.prototype.normalize=function(){var r=this.length();return this.x/=r,this.y/=r,r},Ct.prototype.equals=function(r){return this.x===r.x&&this.y===r.y},Ct.negate=function(r){return new Ct(-r.x,-r.y)},Ct.add=function(r,e){return new Ct(r.x+e.x,r.y+e.y)},Ct.sub=function(r,e){return new Ct(r.x-e.x,r.y-e.y)},Ct.mul=function(r,e){return new Ct(r*e.x,r*e.y)},Ct.cross=function(r,e){return typeof r=="number"?typeof e=="number"?r*e:new Ct(-r*e.y,r*e.x):typeof e=="number"?new Ct(e*r.y,-e*r.x):r.x*e.y-r.y*e.x},Ct.toString=Tl,Ct.compare=T1,Ct.cmp=T1,Ct.equals=WM,Ct.dot=function(r,e){return r.x*e.x+r.y*e.y};var zt=function(r,e,n){this.points_=[r,e,n],this.neighbors_=[null,null,null],this.interior_=!1,this.constrained_edge=[!1,!1,!1],this.delaunay_edge=[!1,!1,!1]},El=Tl;zt.prototype.toString=function(){return"["+El(this.points_[0])+El(this.points_[1])+El(this.points_[2])+"]"},zt.prototype.getPoint=function(r){return this.points_[r]},zt.prototype.GetPoint=zt.prototype.getPoint,zt.prototype.getPoints=function(){return this.points_},zt.prototype.getNeighbor=function(r){return this.neighbors_[r]},zt.prototype.containsPoint=function(r){var e=this.points_;return r===e[0]||r===e[1]||r===e[2]},zt.prototype.containsEdge=function(r){return this.containsPoint(r.p)&&this.containsPoint(r.q)},zt.prototype.containsPoints=function(r,e){return this.containsPoint(r)&&this.containsPoint(e)},zt.prototype.isInterior=function(){return this.interior_},zt.prototype.setInterior=function(r){return this.interior_=r,this},zt.prototype.markNeighborPointers=function(r,e,n){var i=this.points_;if(r===i[2]&&e===i[1]||r===i[1]&&e===i[2])this.neighbors_[0]=n;else if(r===i[0]&&e===i[2]||r===i[2]&&e===i[0])this.neighbors_[1]=n;else if(r===i[0]&&e===i[1]||r===i[1]&&e===i[0])this.neighbors_[2]=n;else throw new Error("poly2tri Invalid Triangle.markNeighborPointers() call")},zt.prototype.markNeighbor=function(r){var e=this.points_;r.containsPoints(e[1],e[2])?(this.neighbors_[0]=r,r.markNeighborPointers(e[1],e[2],this)):r.containsPoints(e[0],e[2])?(this.neighbors_[1]=r,r.markNeighborPointers(e[0],e[2],this)):r.containsPoints(e[0],e[1])&&(this.neighbors_[2]=r,r.markNeighborPointers(e[0],e[1],this))},zt.prototype.clearNeighbors=function(){this.neighbors_[0]=null,this.neighbors_[1]=null,this.neighbors_[2]=null},zt.prototype.clearDelaunayEdges=function(){this.delaunay_edge[0]=!1,this.delaunay_edge[1]=!1,this.delaunay_edge[2]=!1},zt.prototype.pointCW=function(r){var e=this.points_;return r===e[0]?e[2]:r===e[1]?e[0]:r===e[2]?e[1]:null},zt.prototype.pointCCW=function(r){var e=this.points_;return r===e[0]?e[1]:r===e[1]?e[2]:r===e[2]?e[0]:null},zt.prototype.neighborCW=function(r){return r===this.points_[0]?this.neighbors_[1]:r===this.points_[1]?this.neighbors_[2]:this.neighbors_[0]},zt.prototype.neighborCCW=function(r){return r===this.points_[0]?this.neighbors_[2]:r===this.points_[1]?this.neighbors_[0]:this.neighbors_[1]},zt.prototype.getConstrainedEdgeCW=function(r){return r===this.points_[0]?this.constrained_edge[1]:r===this.points_[1]?this.constrained_edge[2]:this.constrained_edge[0]},zt.prototype.getConstrainedEdgeCCW=function(r){return r===this.points_[0]?this.constrained_edge[2]:r===this.points_[1]?this.constrained_edge[0]:this.constrained_edge[1]},zt.prototype.getConstrainedEdgeAcross=function(r){return r===this.points_[0]?this.constrained_edge[0]:r===this.points_[1]?this.constrained_edge[1]:this.constrained_edge[2]},zt.prototype.setConstrainedEdgeCW=function(r,e){r===this.points_[0]?this.constrained_edge[1]=e:r===this.points_[1]?this.constrained_edge[2]=e:this.constrained_edge[0]=e},zt.prototype.setConstrainedEdgeCCW=function(r,e){r===this.points_[0]?this.constrained_edge[2]=e:r===this.points_[1]?this.constrained_edge[0]=e:this.constrained_edge[1]=e},zt.prototype.getDelaunayEdgeCW=function(r){return r===this.points_[0]?this.delaunay_edge[1]:r===this.points_[1]?this.delaunay_edge[2]:this.delaunay_edge[0]},zt.prototype.getDelaunayEdgeCCW=function(r){return r===this.points_[0]?this.delaunay_edge[2]:r===this.points_[1]?this.delaunay_edge[0]:this.delaunay_edge[1]},zt.prototype.setDelaunayEdgeCW=function(r,e){r===this.points_[0]?this.delaunay_edge[1]=e:r===this.points_[1]?this.delaunay_edge[2]=e:this.delaunay_edge[0]=e},zt.prototype.setDelaunayEdgeCCW=function(r,e){r===this.points_[0]?this.delaunay_edge[2]=e:r===this.points_[1]?this.delaunay_edge[0]=e:this.delaunay_edge[1]=e},zt.prototype.neighborAcross=function(r){return r===this.points_[0]?this.neighbors_[0]:r===this.points_[1]?this.neighbors_[1]:this.neighbors_[2]},zt.prototype.oppositePoint=function(r,e){var n=r.pointCW(e);return this.pointCW(n)},zt.prototype.legalize=function(r,e){var n=this.points_;if(r===n[0])n[1]=n[0],n[0]=n[2],n[2]=e;else if(r===n[1])n[2]=n[1],n[1]=n[0],n[0]=e;else if(r===n[2])n[0]=n[2],n[2]=n[1],n[1]=e;else throw new Error("poly2tri Invalid Triangle.legalize() call")},zt.prototype.index=function(r){var e=this.points_;if(r===e[0])return 0;if(r===e[1])return 1;if(r===e[2])return 2;throw new Error("poly2tri Invalid Triangle.index() call")},zt.prototype.edgeIndex=function(r,e){var n=this.points_;if(r===n[0]){if(e===n[1])return 2;if(e===n[2])return 1}else if(r===n[1]){if(e===n[2])return 0;if(e===n[0])return 2}else if(r===n[2]){if(e===n[0])return 1;if(e===n[1])return 0}return-1},zt.prototype.markConstrainedEdgeByIndex=function(r){this.constrained_edge[r]=!0},zt.prototype.markConstrainedEdgeByEdge=function(r){this.markConstrainedEdgeByPoints(r.p,r.q)},zt.prototype.markConstrainedEdgeByPoints=function(r,e){var n=this.points_;e===n[0]&&r===n[1]||e===n[1]&&r===n[0]?this.constrained_edge[2]=!0:e===n[0]&&r===n[2]||e===n[2]&&r===n[0]?this.constrained_edge[1]=!0:(e===n[1]&&r===n[2]||e===n[2]&&r===n[1])&&(this.constrained_edge[0]=!0)};function zl(r,e){if(!r)throw new Error(e||"Assert Failed")}var Al=function(r,e){this.point=r,this.triangle=e||null,this.next=null,this.prev=null,this.value=r.x},Nn=function(r,e){this.head_=r,this.tail_=e,this.search_node_=r};Nn.prototype.head=function(){return this.head_},Nn.prototype.setHead=function(r){this.head_=r},Nn.prototype.tail=function(){return this.tail_},Nn.prototype.setTail=function(r){this.tail_=r},Nn.prototype.search=function(){return this.search_node_},Nn.prototype.setSearch=function(r){this.search_node_=r},Nn.prototype.findSearchNode=function(){return this.search_node_},Nn.prototype.locateNode=function(r){var e=this.search_node_;if(r<e.value){for(;e=e.prev;)if(r>=e.value)return this.search_node_=e,e}else for(;e=e.next;)if(r<e.value)return this.search_node_=e.prev,e.prev;return null},Nn.prototype.locatePoint=function(r){var e=r.x,n=this.findSearchNode(e),i=n.point.x;if(e===i){if(r!==n.point)if(r===n.prev.point)n=n.prev;else if(r===n.next.point)n=n.next;else throw new Error("poly2tri Invalid AdvancingFront.locatePoint() call")}else if(e<i)for(;(n=n.prev)&&r!==n.point;);else for(;(n=n.next)&&r!==n.point;);return n&&(this.search_node_=n),n};const jM=Object.freeze(Object.defineProperty({__proto__:null,AdvancingFront:Nn,Node:Al},Symbol.toStringTag,{value:"Module"}));var to=1e-12,Wa={CW:1,CCW:-1,COLLINEAR:0};function YM(r,e,n){var i=(r.x-n.x)*(e.y-n.y),s=(r.y-n.y)*(e.x-n.x),o=i-s;return o>-to&&o<to?Wa.COLLINEAR:o>0?Wa.CCW:Wa.CW}function HM(r,e,n,i){var s=(r.x-e.x)*(i.y-e.y)-(i.x-e.x)*(r.y-e.y);if(s>=-to)return!1;var o=(r.x-n.x)*(i.y-n.y)-(i.x-n.x)*(r.y-n.y);return!(o<=to)}function XM(r,e,n){var i=e.x-r.x,s=e.y-r.y,o=n.x-r.x,a=n.y-r.y;return i*o+s*a<0}var ZM=to,Jt=Wa,ie=YM,E1=HM,z1=XM;function A1(r){r.initTriangulation(),r.createAdvancingFront(),GM(r),JM(r)}function GM(r){var e,n=r.pointCount();for(e=1;e<n;++e)for(var i=r.getPoint(e),s=QM(r,i),o=i._p2t_edge_list,a=0;o&&a<o.length;++a)KM(r,o[a],s)}function JM(r){for(var e=r.front().head().next.triangle,n=r.front().head().next.point;!e.getConstrainedEdgeCW(n);)e=e.neighborCCW(n);r.meshClean(e)}function QM(r,e){var n=r.locateNode(e),i=t_(r,e,n);return e.x<=n.point.x+ZM&&er(r,n),e_(r,i),i}function KM(r,e,n){r.edge_event.constrained_edge=e,r.edge_event.right=e.p.x>e.q.x,!C1(n.triangle,e.p,e.q)&&(o_(r,e,n),Cl(r,e.p,e.q,n.triangle,e.q))}function Cl(r,e,n,i,s){if(!C1(i,e,n)){var o=i.pointCCW(s),a=ie(n,o,e);if(a===Jt.COLLINEAR)throw new ni("poly2tri EdgeEvent: Collinear not supported!",[n,o,e]);var h=i.pointCW(s),c=ie(n,h,e);if(c===Jt.COLLINEAR)throw new ni("poly2tri EdgeEvent: Collinear not supported!",[n,h,e]);a===c?(a===Jt.CW?i=i.neighborCCW(s):i=i.neighborCW(s),Cl(r,e,n,i,s)):kl(r,e,n,i,s)}}function C1(r,e,n){var i=r.edgeIndex(e,n);if(i!==-1){r.markConstrainedEdgeByIndex(i);var s=r.getNeighbor(i);return s&&s.markConstrainedEdgeByPoints(e,n),!0}return!1}function t_(r,e,n){var i=new zt(e,n.point,n.next.point);i.markNeighbor(n.triangle),r.addToMap(i);var s=new Al(e);return s.next=n.next,s.prev=n,n.next.prev=s,n.next=s,Ei(r,i)||r.mapTriangleToNodes(i),s}function er(r,e){var n=new zt(e.prev.point,e.point,e.next.point);n.markNeighbor(e.prev.triangle),n.markNeighbor(e.triangle),r.addToMap(n),e.prev.next=e.next,e.next.prev=e.prev,Ei(r,n)||r.mapTriangleToNodes(n)}function e_(r,e){for(var n=e.next;n.next&&!z1(n.point,n.next.point,n.prev.point);)er(r,n),n=n.next;for(n=e.prev;n.prev&&!z1(n.point,n.next.point,n.prev.point);)er(r,n),n=n.prev;e.next&&e.next.next&&n_(e)&&s_(r,e)}function n_(r){var e=r.point.x-r.next.next.point.x,n=r.point.y-r.next.next.point.y;return zl(n>=0,"unordered y"),e>=0||Math.abs(e)<n}function Ei(r,e){for(var n=0;n<3;++n)if(!e.delaunay_edge[n]){var i=e.getNeighbor(n);if(i){var s=e.getPoint(n),o=i.oppositePoint(e,s),a=i.index(o);if(i.constrained_edge[a]||i.delaunay_edge[a]){e.constrained_edge[n]=i.constrained_edge[a];continue}var h=i_(s,e.pointCCW(s),e.pointCW(s),o);if(h){e.delaunay_edge[n]=!0,i.delaunay_edge[a]=!0,P1(e,s,i,o);var c=!Ei(r,e);return c&&r.mapTriangleToNodes(e),c=!Ei(r,i),c&&r.mapTriangleToNodes(i),e.delaunay_edge[n]=!1,i.delaunay_edge[a]=!1,!0}}}return!1}function i_(r,e,n,i){var s=r.x-i.x,o=r.y-i.y,a=e.x-i.x,h=e.y-i.y,c=s*h,l=a*o,u=c-l;if(u<=0)return!1;var f=n.x-i.x,d=n.y-i.y,p=f*o,y=s*d,x=p-y;if(x<=0)return!1;var m=a*d,g=f*h,w=s*s+o*o,M=a*a+h*h,S=f*f+d*d,E=w*(m-g)+M*x+S*u;return E>0}function P1(r,e,n,i){var s,o,a,h;s=r.neighborCCW(e),o=r.neighborCW(e),a=n.neighborCCW(i),h=n.neighborCW(i);var c,l,u,f;c=r.getConstrainedEdgeCCW(e),l=r.getConstrainedEdgeCW(e),u=n.getConstrainedEdgeCCW(i),f=n.getConstrainedEdgeCW(i);var d,p,y,x;d=r.getDelaunayEdgeCCW(e),p=r.getDelaunayEdgeCW(e),y=n.getDelaunayEdgeCCW(i),x=n.getDelaunayEdgeCW(i),r.legalize(e,i),n.legalize(i,e),n.setDelaunayEdgeCCW(e,d),r.setDelaunayEdgeCW(e,p),r.setDelaunayEdgeCCW(i,y),n.setDelaunayEdgeCW(i,x),n.setConstrainedEdgeCCW(e,c),r.setConstrainedEdgeCW(e,l),r.setConstrainedEdgeCCW(i,u),n.setConstrainedEdgeCW(i,f),r.clearNeighbors(),n.clearNeighbors(),s&&n.markNeighbor(s),o&&r.markNeighbor(o),a&&r.markNeighbor(a),h&&n.markNeighbor(h),r.markNeighbor(n)}function s_(r,e){for(ie(e.point,e.next.point,e.next.next.point)===Jt.CCW?r.basin.left_node=e.next.next:r.basin.left_node=e.next,r.basin.bottom_node=r.basin.left_node;r.basin.bottom_node.next&&r.basin.bottom_node.point.y>=r.basin.bottom_node.next.point.y;)r.basin.bottom_node=r.basin.bottom_node.next;if(r.basin.bottom_node!==r.basin.left_node){for(r.basin.right_node=r.basin.bottom_node;r.basin.right_node.next&&r.basin.right_node.point.y<r.basin.right_node.next.point.y;)r.basin.right_node=r.basin.right_node.next;r.basin.right_node!==r.basin.bottom_node&&(r.basin.width=r.basin.right_node.point.x-r.basin.left_node.point.x,r.basin.left_highest=r.basin.left_node.point.y>r.basin.right_node.point.y,I1(r,r.basin.bottom_node))}}function I1(r,e){if(!r_(r,e)){er(r,e);var n;if(!(e.prev===r.basin.left_node&&e.next===r.basin.right_node)){if(e.prev===r.basin.left_node){if(n=ie(e.point,e.next.point,e.next.next.point),n===Jt.CW)return;e=e.next}else if(e.next===r.basin.right_node){if(n=ie(e.point,e.prev.point,e.prev.prev.point),n===Jt.CCW)return;e=e.prev}else e.prev.point.y<e.next.point.y?e=e.prev:e=e.next;I1(r,e)}}}function r_(r,e){var n;return r.basin.left_highest?n=r.basin.left_node.point.y-e.point.y:n=r.basin.right_node.point.y-e.point.y,r.basin.width>n}function o_(r,e,n){r.edge_event.right?a_(r,e,n):h_(r,e,n)}function a_(r,e,n){for(;n.next.point.x<e.p.x;)ie(e.q,n.next.point,e.p)===Jt.CCW?k1(r,e,n):n=n.next}function k1(r,e,n){n.point.x<e.p.x&&(ie(n.point,n.next.point,n.next.next.point)===Jt.CCW?Pl(r,e,n):(R1(r,e,n),k1(r,e,n)))}function Pl(r,e,n){er(r,n.next),n.next.point!==e.p&&ie(e.q,n.next.point,e.p)===Jt.CCW&&ie(n.point,n.next.point,n.next.next.point)===Jt.CCW&&Pl(r,e,n)}function R1(r,e,n){ie(n.next.point,n.next.next.point,n.next.next.next.point)===Jt.CCW?Pl(r,e,n.next):ie(e.q,n.next.next.point,e.p)===Jt.CCW&&R1(r,e,n.next)}function h_(r,e,n){for(;n.prev.point.x>e.p.x;)ie(e.q,n.prev.point,e.p)===Jt.CW?O1(r,e,n):n=n.prev}function O1(r,e,n){n.point.x>e.p.x&&(ie(n.point,n.prev.point,n.prev.prev.point)===Jt.CW?Il(r,e,n):(L1(r,e,n),O1(r,e,n)))}function L1(r,e,n){ie(n.prev.point,n.prev.prev.point,n.prev.prev.prev.point)===Jt.CW?Il(r,e,n.prev):ie(e.q,n.prev.prev.point,e.p)===Jt.CW&&L1(r,e,n.prev)}function Il(r,e,n){er(r,n.prev),n.prev.point!==e.p&&ie(e.q,n.prev.point,e.p)===Jt.CW&&ie(n.point,n.prev.point,n.prev.prev.point)===Jt.CW&&Il(r,e,n)}function kl(r,e,n,i,s){var o=i.neighborAcross(s);zl(o,"FLIP failed due to missing triangle!");var a=o.oppositePoint(i,s);if(i.getConstrainedEdgeAcross(s)){var h=i.index(s);throw new ni("poly2tri Intersecting Constraints",[s,a,i.getPoint((h+1)%3),i.getPoint((h+2)%3)])}if(E1(s,i.pointCCW(s),i.pointCW(s),a))if(P1(i,s,o,a),r.mapTriangleToNodes(i),r.mapTriangleToNodes(o),s===n&&a===e)n===r.edge_event.constrained_edge.q&&e===r.edge_event.constrained_edge.p&&(i.markConstrainedEdgeByPoints(e,n),o.markConstrainedEdgeByPoints(e,n),Ei(r,i),Ei(r,o));else{var c=ie(n,a,e);i=c_(r,c,i,o,s,a),kl(r,e,n,i,s)}else{var l=B1(e,n,o,a);F1(r,e,n,i,o,l),Cl(r,e,n,i,s)}}function c_(r,e,n,i,s,o){var a;return e===Jt.CCW?(a=i.edgeIndex(s,o),i.delaunay_edge[a]=!0,Ei(r,i),i.clearDelaunayEdges(),n):(a=n.edgeIndex(s,o),n.delaunay_edge[a]=!0,Ei(r,n),n.clearDelaunayEdges(),i)}function B1(r,e,n,i){var s=ie(e,i,r);if(s===Jt.CW)return n.pointCCW(i);if(s===Jt.CCW)return n.pointCW(i);throw new ni("poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!",[e,i,r])}function F1(r,e,n,i,s,o){var a=s.neighborAcross(o);zl(a,"FLIP failed due to missing triangle");var h=a.oppositePoint(s,o);if(E1(n,i.pointCCW(n),i.pointCW(n),h))kl(r,n,h,a,h);else{var c=B1(e,n,a,h);F1(r,e,n,i,a,c)}}const l_=Object.freeze(Object.defineProperty({__proto__:null,triangulate:A1},Symbol.toStringTag,{value:"Module"})),Rl=Al;var N1=.3,u_=function(r,e){if(this.p=r,this.q=e,r.y>e.y)this.q=r,this.p=e;else if(r.y===e.y){if(r.x>e.x)this.q=r,this.p=e;else if(r.x===e.x)throw new ni("poly2tri Invalid Edge constructor: repeated points!",[r])}this.q._p2t_edge_list||(this.q._p2t_edge_list=[]),this.q._p2t_edge_list.push(this)},q1=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};q1.prototype.clear=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};var f_=function(){this.constrained_edge=null,this.right=!1},Ot=function(r,e){e=e||{},this.triangles_=[],this.map_=[],this.points_=e.cloneArrays?r.slice(0):r,this.edge_list=[],this.pmin_=this.pmax_=null,this.front_=null,this.head_=null,this.tail_=null,this.af_head_=null,this.af_middle_=null,this.af_tail_=null,this.basin=new q1,this.edge_event=new f_,this.initEdges(this.points_)};Ot.prototype.addHole=function(r){this.initEdges(r);var e,n=r.length;for(e=0;e<n;e++)this.points_.push(r[e]);return this},Ot.prototype.AddHole=Ot.prototype.addHole,Ot.prototype.addHoles=function(r){var e,n=r.length;for(e=0;e<n;e++)this.initEdges(r[e]);return this.points_=this.points_.concat.apply(this.points_,r),this},Ot.prototype.addPoint=function(r){return this.points_.push(r),this},Ot.prototype.AddPoint=Ot.prototype.addPoint,Ot.prototype.addPoints=function(r){return this.points_=this.points_.concat(r),this},Ot.prototype.triangulate=function(){return A1(this),this},Ot.prototype.getBoundingBox=function(){return{min:this.pmin_,max:this.pmax_}},Ot.prototype.getTriangles=function(){return this.triangles_},Ot.prototype.GetTriangles=Ot.prototype.getTriangles,Ot.prototype.front=function(){return this.front_},Ot.prototype.pointCount=function(){return this.points_.length},Ot.prototype.head=function(){return this.head_},Ot.prototype.setHead=function(r){this.head_=r},Ot.prototype.tail=function(){return this.tail_},Ot.prototype.setTail=function(r){this.tail_=r},Ot.prototype.getMap=function(){return this.map_},Ot.prototype.initTriangulation=function(){var r=this.points_[0].x,e=this.points_[0].x,n=this.points_[0].y,i=this.points_[0].y,s,o=this.points_.length;for(s=1;s<o;s++){var a=this.points_[s];a.x>r&&(r=a.x),a.x<e&&(e=a.x),a.y>n&&(n=a.y),a.y<i&&(i=a.y)}this.pmin_=new Ct(e,i),this.pmax_=new Ct(r,n);var h=N1*(r-e),c=N1*(n-i);this.head_=new Ct(r+h,i-c),this.tail_=new Ct(e-h,i-c),this.points_.sort(Ct.compare)},Ot.prototype.initEdges=function(r){var e,n=r.length;for(e=0;e<n;++e)this.edge_list.push(new u_(r[e],r[(e+1)%n]))},Ot.prototype.getPoint=function(r){return this.points_[r]},Ot.prototype.addToMap=function(r){this.map_.push(r)},Ot.prototype.locateNode=function(r){return this.front_.locateNode(r.x)},Ot.prototype.createAdvancingFront=function(){var r,e,n,i=new zt(this.points_[0],this.tail_,this.head_);this.map_.push(i),r=new Rl(i.getPoint(1),i),e=new Rl(i.getPoint(0),i),n=new Rl(i.getPoint(2)),this.front_=new jM(r,n),r.next=e,e.next=n,e.prev=r,n.prev=e},Ot.prototype.removeNode=function(r){},Ot.prototype.mapTriangleToNodes=function(r){for(var e=0;e<3;++e)if(!r.getNeighbor(e)){var n=this.front_.locatePoint(r.pointCW(r.getPoint(e)));n&&(n.triangle=r)}},Ot.prototype.removeFromMap=function(r){var e,n=this.map_,i=n.length;for(e=0;e<i;e++)if(n[e]===r){n.splice(e,1);break}},Ot.prototype.meshClean=function(r){for(var e=[r],n,i;n=e.pop();)if(!n.isInterior())for(n.setInterior(!0),this.triangles_.push(n),i=0;i<3;i++)n.constrained_edge[i]||e.push(n.getNeighbor(i))};var d_=window.poly2tri;const p_=Object.freeze(Object.defineProperty({__proto__:null,Point:Ct,PointError:ni,SweepContext:Ot,Triangle:zt,noConflict:function(){return global.poly2tri=d_,Ze},sweep:l_},Symbol.toStringTag,{value:"Module"})),D1=Ni.default();let y_=class jg{constructor(e,n,i){this.cx=e,this.cy=n,this.radius=i}clone(){return new jg(this.cx,this.cy,this.radius)}copy(e){return this.cx=e.cx,this.cy=e.cy,this.radius=e.radius,this}setRadius(e){return this.radius=e,this}setCenter(e,n){return this.cx=e,this.cy=n,this}getArea(){return Math.PI*this.radius**2}getCircumference(){return 2*Math.PI*this.radius}distanceTo(e,n){return Math.sqrt((e-this.cx)**2+(n-this.cy)**2)}contains(e,n){return this.distanceTo(e,n)<=this.radius}containsStroke(e,n,i,s=.5){const o=this.distanceTo(e,n),a=i*.5,h=(s-.5)*2*a,c=this.radius+h;return Math.abs(o-c)<=a}containsBoundingRect(e,n){return D1.fromCircle(this.cx,this.cy,this.radius),D1.containsXY(e,n)}getBoundingBox(e){return e.fromCircle(this.cx,this.cy,this.radius),e}},x_=class Yg{start=O.default();end=O.default();constructor(e=O.default(),n=O.default()){this.start.copy(e),this.end.copy(n)}get length(){return this.end.distance(this.start)}get lengthSquared(){return this.end.distanceSquared(this.start)}clone(){return new Yg(this.start,this.end)}copy(e){this.start.copy(e.start),this.end.copy(e.end)}offset(e){const n=this.end.clone().sub(this.start).normalize().perp();return this.start.add(n.clone().multiplyScalar(e)),this.end.add(n.clone().multiplyScalar(e)),this}getDelta(e=O.default()){return e.subVectors(this.end,this.start)}getCenter(e=O.default()){return O.lerp(e,this.start,this.end,.5)}distanceTo(e,n){const i=O.create(e,n),s=this.end.clone().sub(this.start),o=i.clone().sub(this.start);let a=o.dot(s)/s.dot(s);return a=ve(a,0,1),o.distance(s.multiplyScalar(a))}intersectionFromLine(e,n=O.default()){const i=this.getDelta(),s=e.getDelta(),o=i.cross(s);if(o===0)return null;const a=e.start.clone().sub(this.start),h=a.cross(s)/o,c=a.cross(i)/o;return h<0||h>1||c<0||c>1?null:(n.copy(i).multiplyScalar(h).add(this.start),n)}intercept(){const e=this.getDelta(),n=e.y,i=-e.x,s=e.cross(this.start);return{x:-s/n,y:-s/i}}contains(e,n){return this.distanceTo(e,n)<1e-6}containsStroke(e,n,i,s=.5){const o=i*.5,a=(s-.5)*2*o;return this.clone().offset(a).distanceTo(e,n)<=o}getBoundingBox(e){let n=Math.min(this.start.x,this.end.x),i=Math.min(this.start.y,this.end.y),s=Math.abs(this.start.x-this.end.x),o=Math.abs(this.start.y-this.end.y);return e.fromRect(n,i,s,o),e}};function m_(r,e,n,i,s,o){let a=s-n,h=o-i,c=r-n,l=e-i;if(a!==0||h!==0){let u=(c*a+l*h)/(a*a+h*h);return u=ve(u,0,1),Math.hypot(c-a*u,c-h*u)}return Number.POSITIVE_INFINITY}let g_=class{vertices;constructor(e){this.vertices=e}getVectors(){return this.vertices.map(e=>O.create(e.x,e.y))}getArea(){let e=0;for(let n=0;n<this.vertices.length;n++){const i=this.vertices[n],s=this.vertices[(n+1)%this.vertices.length];e+=i.x*s.y-i.y*s.x}return Math.abs(e/2)}getBoundingBox(e){return e.setFromPoints(this.vertices),e}contains(e,n,i){let s=0;for(let o=0;o<this.vertices.length;o++){let a=this.vertices[o],h=this.vertices[(o+1)%this.vertices.length],c=a.x,l=a.y,u=h.x,f=h.y;n>l!=n>f&&e<(u-c)*(n-l)/(f-l)+c&&(i==="nonzero"?s+=l<f?1:-1:i==="evenodd"&&s++)}return s%2!==0}containsStroke(e,n,i,s=.5){const o=i*.5,a=(s-.5)*2*o;for(let h=0;h<this.vertices.length;h++){let{x:c,y:l}=this.vertices[h],{x:u,y:f}=this.vertices[(h+1)%this.vertices.length];const d=Math.hypot(u-c,f-l),p=(u-c)/d,y=(f-l)/d;c=c-y*a,l=l+p*a,u=u-y*a,f=f+p*a;const x=m_(e,n,c,l,u,f);if(Math.abs(x)<=o)return!0}return!1}},w_=class{constructor(e,n,i,s){this.x=e,this.y=n,this.width=i,this.height=s}getCenter(){return O.create(this.x+this.width/2,this.y+this.height/2)}getArea(){return this.width*this.height}getPerimeter(){return 2*(this.width+this.height)}distanceTo(e,n){const i=this.getCenter(),s=this.width/2,o=this.height/2,a=Math.abs(e-i.x)-s,h=Math.abs(n-i.y)-o,c=Math.max(0,a),l=Math.max(0,h);return c>0||l>0?Math.sqrt(c*c+l*l):Math.min(0,Math.max(a,h))}containsPoint(e,n){return!(e<this.x||e>this.x+this.width||n<this.y||n>this.y+this.height)}containsStroke(e,n,i,s=.5){const o=this.distanceTo(e,n),a=i*.5,h=(s-.5)*2*a;return Math.abs(o-h)<=a}};class b_{constructor(e,n){this.m=e,this.x0=n}static from(e,n){return new this(e,n.x-e*n.y)}static fromPoint(e,n){return this.from((n.x-e.x)/(n.y-e.y),e)}static fromFloat(e){return new this(0,e)}getX(e){return this.m*e+this.x0}}class v_{static fromLine(e,n,i,s){return new this(e,n,i.getX(e),i.getX(n),s.getX(e),s.getX(n))}y0=0;y1=0;x0=0;x1=0;x2=0;x3=0;constructor(e,n,i,s,o,a){this.y0=e,this.y1=n,this.x0=i,this.x1=s,this.x2=o,this.x3=a}getArea(){const{y0:e,y1:n,x2:i,x3:s,x0:o,x1:a}=this;return(n-e)*(i+s-o-a)*.5}}const M_=Object.freeze(Object.defineProperty({__proto__:null,Circle:y_,Line:x_,Polygon:g_,RasterizeLine:b_,Rectangle:w_,Trapezoid:v_,Triangle:class qs{constructor(e,n,i,s,o,a){this.x1=e,this.y1=n,this.x2=i,this.y2=s,this.x3=o,this.y3=a}getArea(){return Math.abs(.5*(this.x1*(this.y2-this.y3)+this.x2*(this.y3-this.y1)+this.x3*(this.y1-this.y2)))}containsPoint(e,n){const i=this.getArea(),s=new qs(e,n,this.x1,this.y1,this.x2,this.y2).getArea(),o=new qs(e,n,this.x2,this.y2,this.x3,this.y3).getArea(),a=new qs(e,n,this.x3,this.y3,this.x1,this.y1).getArea();return Math.abs(i-(s+o+a))<1e-9}getBarycentricCoordinates(e,n){const i=this.getArea(),s=new qs(e,n,this.x2,this.y2,this.x3,this.y3).getArea(),o=new qs(e,n,this.x3,this.y3,this.x1,this.y1).getArea(),a=new qs(e,n,this.x1,this.y1,this.x2,this.y2).getArea(),h=s/i,c=o/i,l=a/i;return{u:h,v:c,w:l}}}},Symbol.toStringTag,{value:"Module"}));function ja(r,e,n){let i=0,s=1;const o=e.x-r.x,a=e.y-r.y,h=(c,l)=>{if(c==0&&l<0)return!1;const u=l/c;if(c<0){if(u>s)return!1;u>i&&(i=u)}else if(c>0){if(u<i)return!1;u<s&&(s=u)}return!0};return!h(-o,r.x-n.xmin)||!h(o,n.xmax-r.x)||!h(-a,r.y-n.ymin)||!h(a,n.ymax-r.y)?null:[{x:r.x+i*o,y:r.y+i*a},{x:r.x+s*o,y:r.y+s*a}]}function __(r,e,n){return ja(r,e,n)}const S_=0,$1=1,V1=2,U1=4,W1=8;function nr(r,e){let n=S_;return r.x<e.xmin?n|=$1:r.x>e.xmax&&(n|=V1),r.y<e.ymin?n|=U1:r.y>e.ymax&&(n|=W1),n}function T_(r,e,n){let i=nr(r,n),s=nr(e,n);for(;;){if(!(i|s))return[r,e];if(i&s)return null;let o=0,a=0;const h=i||s;h&W1?(o=r.x+(e.x-r.x)*(n.ymax-r.y)/(e.y-r.y),a=n.ymax):h&U1?(o=r.x+(e.x-r.x)*(n.ymin-r.y)/(e.y-r.y),a=n.ymin):h&V1?(a=r.y+(e.y-r.y)*(n.xmax-r.x)/(e.x-r.x),o=n.xmax):h&$1&&(a=r.y+(e.y-r.y)*(n.xmin-r.x)/(e.x-r.x),o=n.xmin),h===i?(r={x:o,y:a},i=nr(r,n)):(e={x:o,y:a},s=nr(e,n))}}function Ol(r,e,n){let i=nr(r,n),s=nr(e,n);if(!(i|s))return[r,e];if(i&s||Math.abs(e.x-r.x)<1e-6&&Math.abs(e.y-r.y)<1e-6)return null;const o={x:(r.x+e.x)/2,y:(r.y+e.y)/2};return[...Ol(r,o,n)||[],...Ol(o,e,n)||[]]}function E_(r,e,n){return ja(r,e,n)}function z_(r,e,n){return ja(r,e,n)}const A_=(r,e)=>{const n=h=>{let c=0;return h.x<e.left&&(c|=1),h.x>e.right&&(c|=2),h.y<e.bottom&&(c|=4),h.y>e.top&&(c|=8),c};let[i,s]=r,o=n(i),a=n(s);for(;;){if((o|a)===0)return[i,s];if((o&a)!==0)return null;const h=o!==0?o:a;let c={x:0,y:0};h&8?(c.x=i.x+(s.x-i.x)*(e.top-i.y)/(s.y-i.y),c.y=e.top):h&4?(c.x=i.x+(s.x-i.x)*(e.bottom-i.y)/(s.y-i.y),c.y=e.bottom):h&2?(c.y=i.y+(s.y-i.y)*(e.right-i.x)/(s.x-i.x),c.x=e.right):h&1&&(c.y=i.y+(s.y-i.y)*(e.left-i.x)/(s.x-i.x),c.x=e.left),h===o?(i=c,o=n(i)):(s=c,a=n(s))}},C_=(r,e)=>{let n=[r[0],r[1]];for(const i of e){const s=[];for(let o=0;o<n.length;o++){const a=n[o],h=n[(o+1)%n.length],c=i.normal[0]*(a.x-i.point.x)+i.normal[1]*(a.y-i.point.y),l=i.normal[0]*(h.x-i.point.x)+i.normal[1]*(h.y-i.point.y);if(c<=0&&s.push(a),c<0&&l>0||c>0&&l<0){const u=-c/(l-c);s.push({x:a.x+u*(h.x-a.x),y:a.y+u*(h.y-a.y)})}}n=s}return n},P_=(r,e,n=1)=>{const i=(a,h)=>{let c=a,l=h;for(;Math.hypot(l.x-c.x,l.y-c.y)>n;){const u={x:(c.x+l.x)/2,y:(c.y+l.y)/2};u.x<e.left||u.x>e.right||u.y<e.bottom||u.y>e.top?l=u:c=u}return c},s=i(r[0],r[1]),o=i(r[1],r[0]);return Math.abs(s.x-o.x)>n||Math.abs(s.y-o.y)>n?[s,o]:null};function I_(r,e){let n=r;for(let i=0;i<e.length;i++){const s=e[i],o=e[(i+1)%e.length],a=n;if(n=[],a.length===0)break;let h=a[a.length-1];for(const c of a){const l=j1(h,s,o);if(j1(c,s,o)){if(!l){const f=Y1(h,c,s,o);f&&n.push(f)}n.push(c)}else if(l){const f=Y1(h,c,s,o);f&&n.push(f)}h=c}}return n}function j1(r,e,n){return(n.x-e.x)*(r.y-e.y)>(n.y-e.y)*(r.x-e.x)}function Y1(r,e,n,i){const s=e.x-r.x,o=e.y-r.y,a=i.x-n.x,h=i.y-n.y,c=s*h-o*a;if(c===0)return null;const l=n.x-r.x,u=n.y-r.y,f=(l*h-u*a)/c;return{x:r.x+f*(e.x-r.x),y:r.y+f*(e.y-r.y)}}const k_=Object.freeze(Object.defineProperty({__proto__:null,CohenSutherlandClip:A_,MidpointClip:P_,SutherlandHodgmanClip:C_,cohenSutherland:T_,cyrusBeck:z_,equationBasedClipping:E_,liangBarsky:ja,midpointSubdivision:Ol,nichollLeeNicholl:__,sutherlandHodgmanClip:I_},Symbol.toStringTag,{value:"Module"}));var ze=(r=>(r[r.ODD=0]="ODD",r[r.NONZERO=1]="NONZERO",r[r.POSITIVE=2]="POSITIVE",r[r.NEGATIVE=3]="NEGATIVE",r[r.ABS_GEQ_TWO=4]="ABS_GEQ_TWO",r))(ze||{}),wn=(r=>(r[r.POLYGONS=0]="POLYGONS",r[r.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",r[r.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS",r))(wn||{});function pt(r,e=void 0){if(!r)throw e||"Assertion Failed!"}class tt{static vertEq(e,n){return e.s===n.s&&e.t===n.t}static vertLeq(e,n){return e.s<n.s||e.s===n.s&&e.t<=n.t}static transLeq(e,n){return e.t<n.t||e.t===n.t&&e.s<=n.s}static edgeGoesLeft(e){return tt.vertLeq(e.Dst,e.Org)}static edgeGoesRight(e){return tt.vertLeq(e.Org,e.Dst)}static vertL1dist(e,n){return Math.abs(e.s-n.s)+Math.abs(e.t-n.t)}static edgeEval(e,n,i){pt(tt.vertLeq(e,n)&&tt.vertLeq(n,i));var s=n.s-e.s,o=i.s-n.s;return s+o>0?s<o?n.t-e.t+(e.t-i.t)*(s/(s+o)):n.t-i.t+(i.t-e.t)*(o/(s+o)):0}static edgeSign(e,n,i){pt(tt.vertLeq(e,n)&&tt.vertLeq(n,i));var s=n.s-e.s,o=i.s-n.s;return s+o>0?(n.t-i.t)*s+(n.t-e.t)*o:0}static transEval(e,n,i){pt(tt.transLeq(e,n)&&tt.transLeq(n,i));var s=n.t-e.t,o=i.t-n.t;return s+o>0?s<o?n.s-e.s+(e.s-i.s)*(s/(s+o)):n.s-i.s+(i.s-e.s)*(o/(s+o)):0}static transSign(e,n,i){pt(tt.transLeq(e,n)&&tt.transLeq(n,i));var s=n.t-e.t,o=i.t-n.t;return s+o>0?(n.s-i.s)*s+(n.s-e.s)*o:0}static vertCCW(e,n,i){return e.s*(n.t-i.t)+n.s*(i.t-e.t)+i.s*(e.t-n.t)>=0}static interpolate(e,n,i,s){return e=e<0?0:e,i=i<0?0:i,e<=i?i===0?(n+s)/2:n+(s-n)*(e/(e+i)):s+(n-s)*(i/(e+i))}static intersect(e,n,i,s,o){var a,h,c;tt.vertLeq(e,n)||(c=e,e=n,n=c),tt.vertLeq(i,s)||(c=i,i=s,s=c),tt.vertLeq(e,i)||(c=e,e=i,i=c,c=n,n=s,s=c),tt.vertLeq(i,n)?tt.vertLeq(n,s)?(a=tt.edgeEval(e,i,n),h=tt.edgeEval(i,n,s),a+h<0&&(a=-a,h=-h),o.s=tt.interpolate(a,i.s,h,n.s)):(a=tt.edgeSign(e,i,n),h=-tt.edgeSign(e,s,n),a+h<0&&(a=-a,h=-h),o.s=tt.interpolate(a,i.s,h,s.s)):o.s=(i.s+n.s)/2,tt.transLeq(e,n)||(c=e,e=n,n=c),tt.transLeq(i,s)||(c=i,i=s,s=c),tt.transLeq(e,i)||(c=e,e=i,i=c,c=n,n=s,s=c),tt.transLeq(i,n)?tt.transLeq(n,s)?(a=tt.transEval(e,i,n),h=tt.transEval(i,n,s),a+h<0&&(a=-a,h=-h),o.t=tt.interpolate(a,i.t,h,n.t)):(a=tt.transSign(e,i,n),h=-tt.transSign(e,s,n),a+h<0&&(a=-a,h=-h),o.t=tt.interpolate(a,i.t,h,s.t)):o.t=(i.t+n.t)/2}}class eo{next=null;prev=null;anEdge=null;trail=null;n=0;marked=!1;inside=!1}class Ya{constructor(e){this.side=e}next=null;Org=null;Sym=null;Onext=null;Lnext=null;Lface=null;activeRegion=null;winding=0;get Rface(){return this.Sym.Lface}set Rface(e){this.Sym.Lface=e}get Dst(){return this.Sym.Org}set Dst(e){this.Sym.Org=e}get Oprev(){return this.Sym.Lnext}set Oprev(e){this.Sym.Lnext=e}get Lprev(){return this.Onext.Sym}set Lprev(e){this.Onext.Sym=e}get Dprev(){return this.Lnext.Sym}set Dprev(e){this.Lnext.Sym=e}get Rprev(){return this.Sym.Onext}set Rprev(e){this.Sym.Onext=e}get Dnext(){return this.Sym.Onext.Sym}set Dnext(e){this.Sym.Onext.Sym=e}get Rnext(){return this.Sym.Lnext.Sym}set Rnext(e){this.Sym.Lnext.Sym=e}}class ir{next=null;prev=null;anEdge=null;coords=[0,0,0];s=0;t=0;pqHandle=0;n=0;idx=0}class H1{vHead;fHead;eHead;eHeadSym;constructor(){const e=new ir,n=new eo,i=new Ya(0),s=new Ya(1);e.next=e.prev=e,e.anEdge=null,n.next=n.prev=n,i.next=i,i.Sym=s,s.next=s,s.Sym=i,this.vHead=e,this.fHead=n,this.eHead=i,this.eHeadSym=s}makeEdge_(e){var n=new Ya(0),i=new Ya(1);e.Sym.side<e.side&&(e=e.Sym);var s=e.Sym.next;return i.next=s,s.Sym.next=n,n.next=e,e.Sym.next=i,n.Sym=i,n.Onext=n,n.Lnext=i,n.Org=null,n.Lface=null,n.winding=0,n.activeRegion=null,i.Sym=n,i.Onext=i,i.Lnext=n,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,n}splice_(e,n){var i=e.Onext,s=n.Onext;i.Sym.Lnext=n,s.Sym.Lnext=e,e.Onext=s,n.Onext=i}makeVertex_(e,n,i){var s=e;pt(s,"Vertex can't be null!");var o=i.prev;s.prev=o,o.next=s,s.next=i,i.prev=s,s.anEdge=n;var a=n;do a.Org=s,a=a.Onext;while(a!==n)}makeFace_(e,n,i){var s=e;pt(s,"Face can't be null");var o=i.prev;s.prev=o,o.next=s,s.next=i,i.prev=s,s.anEdge=n,s.trail=null,s.marked=!1,s.inside=i.inside;var a=n;do a.Lface=s,a=a.Lnext;while(a!==n)}killEdge_(e){e.Sym.side<e.side&&(e=e.Sym);var n=e.next,i=e.Sym.next;n.Sym.next=i,i.Sym.next=n}killVertex_(e,n){var i=e.anEdge,s=i;do s.Org=n,s=s.Onext;while(s!==i);var o=e.prev,a=e.next;a.prev=o,o.next=a}killFace_(e,n){var i=e.anEdge,s=i;do s.Lface=n,s=s.Lnext;while(s!==i);var o=e.prev,a=e.next;a.prev=o,o.next=a}makeEdge(){var e=new ir,n=new ir,i=new eo,s=this.makeEdge_(this.eHead);return this.makeVertex_(e,s,this.vHead),this.makeVertex_(n,s.Sym,this.vHead),this.makeFace_(i,s,this.fHead),s}splice(e,n){var i=!1,s=!1;if(e!==n){if(n.Org!==e.Org&&(s=!0,this.killVertex_(n.Org,e.Org)),n.Lface!==e.Lface&&(i=!0,this.killFace_(n.Lface,e.Lface)),this.splice_(n,e),!s){var o=new ir;this.makeVertex_(o,n,e.Org),e.Org.anEdge=e}if(!i){var a=new eo;this.makeFace_(a,n,e.Lface),e.Lface.anEdge=e}}}delete(e){var n=e.Sym,i=!1;if(e.Lface!==e.Rface&&(i=!0,this.killFace_(e.Lface,e.Rface)),e.Onext===e)this.killVertex_(e.Org,null);else if(e.Rface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev),!i){var s=new eo;this.makeFace_(s,e,e.Lface)}n.Onext===n?(this.killVertex_(n.Org,null),this.killFace_(n.Lface,null)):(e.Lface.anEdge=n.Oprev,n.Org.anEdge=n.Onext,this.splice_(n,n.Oprev)),this.killEdge_(e)}addEdgeVertex(e){var n=this.makeEdge_(e),i=n.Sym;this.splice_(n,e.Lnext),n.Org=e.Dst;var s=new ir;return this.makeVertex_(s,i,n.Org),n.Lface=i.Lface=e.Lface,n}splitEdge(e){var n=this.addEdgeVertex(e),i=n.Sym;return this.splice_(e.Sym,e.Sym.Oprev),this.splice_(e.Sym,i),e.Dst=i.Org,i.Dst.anEdge=i.Sym,i.Rface=e.Rface,i.winding=e.winding,i.Sym.winding=e.Sym.winding,i}connect(e,n){var i=!1,s=this.makeEdge_(e),o=s.Sym;if(n.Lface!==e.Lface&&(i=!0,this.killFace_(n.Lface,e.Lface)),this.splice_(s,e.Lnext),this.splice_(o,n),s.Org=e.Dst,o.Org=n.Org,s.Lface=o.Lface=e.Lface,e.Lface.anEdge=o,!i){var a=new eo;this.makeFace_(a,s,e.Lface)}return s}zapFace(e){var n=e.anEdge,i,s,o,a,h;s=n.Lnext;do i=s,s=i.Lnext,i.Lface=null,i.Rface===null&&(i.Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),o=i.Sym,o.Onext===o?this.killVertex_(o.Org,null):(o.Org.anEdge=o.Onext,this.splice_(o,o.Oprev)),this.killEdge_(i));while(i!=n);a=e.prev,h=e.next,h.prev=a,a.next=h}countFaceVerts_(e){var n=e.anEdge,i=0;do i++,n=n.Lnext;while(n!==e.anEdge);return i}mergeConvexFaces(e){var n,i,s,o,a,h,c;for(n=this.fHead.next;n!==this.fHead;n=n.next)if(n.inside)for(i=n.anEdge,a=i.Org;s=i.Lnext,o=i.Sym,o&&o.Lface&&o.Lface.inside&&(h=this.countFaceVerts_(n),c=this.countFaceVerts_(o.Lface),h+c-2<=e&&tt.vertCCW(i.Lprev.Org,i.Org,o.Lnext.Lnext.Org)&&tt.vertCCW(o.Lprev.Org,o.Org,i.Lnext.Lnext.Org)&&(s=o.Lnext,this.delete(o),i=null,o=null)),!(i&&i.Lnext.Org===a);)i=s;return!0}check(){var e=this.fHead,n=this.vHead,i=this.eHead,s,o,a,h,c,l;for(o=e,o=e;(s=o.next)!==e;o=s){pt(s.prev===o),c=s.anEdge;do pt(c.Sym!==c),pt(c.Sym.Sym===c),pt(c.Lnext.Onext.Sym===c),pt(c.Onext.Sym.Lnext===c),pt(c.Lface===s),c=c.Lnext;while(c!==s.anEdge)}for(pt(s.prev===o&&s.anEdge===null),h=n,h=n;(a=h.next)!==n;h=a){pt(a.prev===h),c=a.anEdge;do pt(c.Sym!==c),pt(c.Sym.Sym===c),pt(c.Lnext.Onext.Sym===c),pt(c.Onext.Sym.Lnext===c),pt(c.Org===a),c=c.Onext;while(c!==a.anEdge)}for(pt(a.prev===h&&a.anEdge===null),l=i,l=i;(c=l.next)!==i;l=c)pt(c.Sym.next===l.Sym),pt(c.Sym!==c),pt(c.Sym.Sym===c),pt(c.Org!==null),pt(c.Dst!==null),pt(c.Lnext.Onext.Sym===c),pt(c.Onext.Sym.Lnext===c);pt(c.Sym.next===l.Sym&&c.Sym===this.eHeadSym&&c.Sym.Sym===c&&c.Org===null&&c.Dst===null&&c.Lface===null&&c.Rface===null)}}class X1{handle=null}class Z1{key=null;node=0}class R_{constructor(e,n){this.leq=n,this.max=e,this.nodes=[],this.handles=[];for(let i=0;i<e+1;i++)this.nodes[i]=new X1,this.handles[i]=new Z1;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}max=0;nodes=[];handles=[];initialized=!1;freeList=0;size=0;floatDown_(e){var n=this.nodes,i=this.handles,s,o,a;for(s=n[e].handle;;){if(a=e<<1,a<this.size&&this.leq(i[n[a+1].handle].key,i[n[a].handle].key)&&++a,pt(a<=this.max),o=n[a].handle,a>this.size||this.leq(i[s].key,i[o].key)){n[e].handle=s,i[s].node=e;break}n[e].handle=o,i[o].node=e,e=a}}floatUp_(e){var n=this.nodes,i=this.handles,s,o,a;for(s=n[e].handle;;){if(a=e>>1,o=n[a].handle,a===0||this.leq(i[o].key,i[s].key)){n[e].handle=s,i[s].node=e;break}n[e].handle=o,i[o].node=e,e=a}}init(){for(let e=this.size;e>=1;--e)this.floatDown_(e);this.initialized=!0}min(){return this.handles[this.nodes[1].handle].key}insert(e){var n,i;if(n=++this.size,n*2>this.max){this.max*=2;var s,o;for(o=this.nodes.length,this.nodes.length=this.max+1,s=o;s<this.nodes.length;s++)this.nodes[s]=new X1;for(o=this.handles.length,this.handles.length=this.max+1,s=o;s<this.handles.length;s++)this.handles[s]=new Z1}return this.freeList===0?i=n:(i=this.freeList,this.freeList=this.handles[i].node),this.nodes[n].handle=i,this.handles[i].node=n,this.handles[i].key=e,this.initialized&&this.floatUp_(n),i}extractMin(){var e=this.nodes,n=this.handles,i=e[1].handle,s=n[i].key;return this.size>0&&(e[1].handle=e[this.size].handle,n[e[1].handle].node=1,n[i].key=null,n[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),s}delete(e){var n=this.nodes,i=this.handles,s;pt(e>=1&&e<=this.max&&i[e].key!==null),s=i[e].node,n[s].handle=n[this.size].handle,i[n[s].handle].node=s,--this.size,s<=this.size&&(s<=1||this.leq(i[n[s>>1].handle].key,i[n[s].handle].key)?this.floatDown_(s):this.floatUp_(s)),i[e].key=null,i[e].node=this.freeList,this.freeList=e}}class Ll{eUp=null;nodeUp=null;windingNumber=0;inside=!1;sentinel=!1;dirty=!1;fixUpperEdge=!1}class G1{key=null;next=null;prev=null}class O_{constructor(e,n){this.frame=e,this.leq=n,this.head.next=this.head,this.head.prev=this.head}head=new G1;min(){return this.head.next}max(){return this.head.prev}insert(e){return this.insertBefore(this.head,e)}search(e){let n=this.head;do n=n.next;while(n.key!==null&&!this.leq(this.frame,e,n.key));return n}insertBefore(e,n){do e=e.prev;while(e.key!==null&&!this.leq(this.frame,e.key,n));const i=new G1;return i.key=n,i.next=e.next,e.next.prev=i,i.prev=e,e.next=i,i}delete(e){e.next.prev=e.prev,e.prev.next=e.next}}class H{static regionBelow(e){return e.nodeUp.prev.key}static regionAbove(e){return e.nodeUp.next.key}static debugEvent(e){}static addWinding(e,n){e.winding+=n.winding,e.Sym.winding+=n.Sym.winding}static edgeLeq(e,n,i){var s=e.event,o=n.eUp,a=i.eUp;if(o.Dst===s)return a.Dst===s?tt.vertLeq(o.Org,a.Org)?tt.edgeSign(a.Dst,o.Org,a.Org)<=0:tt.edgeSign(o.Dst,a.Org,o.Org)>=0:tt.edgeSign(a.Dst,s,a.Org)<=0;if(a.Dst===s)return tt.edgeSign(o.Dst,s,o.Org)>=0;const h=tt.edgeEval(o.Dst,s,o.Org),c=tt.edgeEval(a.Dst,s,a.Org);return h>=c}static deleteRegion(e,n){n.fixUpperEdge&&pt(n.eUp.winding===0),n.eUp.activeRegion=null,e.dict.delete(n.nodeUp)}static fixUpperEdge(e,n,i){pt(n.fixUpperEdge),e.mesh.delete(n.eUp),n.fixUpperEdge=!1,n.eUp=i,i.activeRegion=n}static topLeftRegion(e,n){var i=n.eUp.Org,s;do n=H.regionAbove(n);while(n.eUp.Org===i);if(n.fixUpperEdge){if(s=e.mesh.connect(H.regionBelow(n).eUp.Sym,n.eUp.Lnext),s===null)return null;H.fixUpperEdge(e,n,s),n=H.regionAbove(n)}return n}static topRightRegion(e){var n=e.eUp.Dst;do e=H.regionAbove(e);while(e.eUp.Dst===n);return e}static addRegionBelow(e,n,i){var s=new Ll;return s.eUp=i,s.nodeUp=e.dict.insertBefore(n.nodeUp,s),s.fixUpperEdge=!1,s.sentinel=!1,s.dirty=!1,i.activeRegion=s,s}static isWindingInside(e,n){switch(e.windingRule){case ze.ODD:return(n&1)!==0;case ze.NONZERO:return n!==0;case ze.POSITIVE:return n>0;case ze.NEGATIVE:return n<0;case ze.ABS_GEQ_TWO:return n>=2||n<=-2}throw new Error("Invalid winding rulle")}static computeWinding(e,n){n.windingNumber=H.regionAbove(n).windingNumber+n.eUp.winding,n.inside=H.isWindingInside(e,n.windingNumber)}static finishRegion(e,n){var i=n.eUp,s=i.Lface;s.inside=n.inside,s.anEdge=i,H.deleteRegion(e,n)}static finishLeftRegions(e,n,i){for(var s,o=null,a=n,h=n.eUp;a!==i;){if(a.fixUpperEdge=!1,o=H.regionBelow(a),s=o.eUp,s.Org!=h.Org){if(!o.fixUpperEdge){H.finishRegion(e,a);break}s=e.mesh.connect(h.Lprev,s.Sym),H.fixUpperEdge(e,o,s)}h.Onext!==s&&(e.mesh.splice(s.Oprev,s),e.mesh.splice(h,s)),H.finishRegion(e,a),h=o.eUp,a=o}return h}static addRightEdges(e,n,i,s,o,a){var h,c,l,u,f=!0;l=i;do pt(tt.vertLeq(l.Org,l.Dst)),H.addRegionBelow(e,n,l.Sym),l=l.Onext;while(l!==s);for(o===null&&(o=H.regionBelow(n).eUp.Rprev),c=n,u=o;h=H.regionBelow(c),l=h.eUp.Sym,l.Org===u.Org;)l.Onext!==u&&(e.mesh.splice(l.Oprev,l),e.mesh.splice(u.Oprev,l)),h.windingNumber=c.windingNumber-l.winding,h.inside=H.isWindingInside(e,h.windingNumber),c.dirty=!0,!f&&H.checkForRightSplice(e,c)&&(H.addWinding(l,u),H.deleteRegion(e,c),e.mesh.delete(u)),f=!1,c=h,u=l;c.dirty=!0,pt(c.windingNumber-l.winding===h.windingNumber),a&&H.walkDirtyRegions(e,c)}static spliceMergeVertices(e,n,i){e.mesh.splice(n,i)}static vertexWeights(e,n,i){var s=tt.vertL1dist(n,e),o=tt.vertL1dist(i,e),a=.5*o/(s+o),h=.5*s/(s+o);e.coords[0]+=a*n.coords[0]+h*i.coords[0],e.coords[1]+=a*n.coords[1]+h*i.coords[1],e.coords[2]+=a*n.coords[2]+h*i.coords[2]}static getIntersectData(e,n,i,s,o,a){n.coords[0]=n.coords[1]=n.coords[2]=0,n.idx=-1,H.vertexWeights(n,i,s),H.vertexWeights(n,o,a)}static checkForRightSplice(e,n){var i=H.regionBelow(n),s=n.eUp,o=i.eUp;if(tt.vertLeq(s.Org,o.Org)){if(tt.edgeSign(o.Dst,s.Org,o.Org)>0)return!1;tt.vertEq(s.Org,o.Org)?s.Org!==o.Org&&(e.pq.delete(s.Org.pqHandle),H.spliceMergeVertices(e,o.Oprev,s)):(e.mesh.splitEdge(o.Sym),e.mesh.splice(s,o.Oprev),n.dirty=i.dirty=!0)}else{if(tt.edgeSign(s.Dst,o.Org,s.Org)<0)return!1;H.regionAbove(n).dirty=n.dirty=!0,e.mesh.splitEdge(s.Sym),e.mesh.splice(o.Oprev,s)}return!0}static checkForLeftSplice(e,n){var i=H.regionBelow(n),s=n.eUp,o=i.eUp,a;if(pt(!tt.vertEq(s.Dst,o.Dst)),tt.vertLeq(s.Dst,o.Dst)){if(tt.edgeSign(s.Dst,o.Dst,s.Org)<0)return!1;H.regionAbove(n).dirty=n.dirty=!0,a=e.mesh.splitEdge(s),e.mesh.splice(o.Sym,a),a.Lface.inside=n.inside}else{if(tt.edgeSign(o.Dst,s.Dst,o.Org)>0)return!1;n.dirty=i.dirty=!0,a=e.mesh.splitEdge(o),e.mesh.splice(s.Lnext,o.Sym),a.Rface.inside=n.inside}return!0}static checkForIntersect(e,n){var i=H.regionBelow(n),s=n.eUp,o=i.eUp,a=s.Org,h=o.Org,c=s.Dst,l=o.Dst,u,f,d=new ir,p,y;if(pt(!tt.vertEq(l,c)),pt(tt.edgeSign(c,e.event,a)<=0),pt(tt.edgeSign(l,e.event,h)>=0),pt(a!==e.event&&h!==e.event),pt(!n.fixUpperEdge&&!i.fixUpperEdge),a===h||(u=Math.min(a.t,c.t),f=Math.max(h.t,l.t),u>f))return!1;if(tt.vertLeq(a,h)){if(tt.edgeSign(l,a,h)>0)return!1}else if(tt.edgeSign(c,h,a)<0)return!1;return tt.intersect(c,a,l,h,d),pt(Math.min(a.t,c.t)<=d.t),pt(d.t<=Math.max(h.t,l.t)),pt(Math.min(l.s,c.s)<=d.s),pt(d.s<=Math.max(h.s,a.s)),tt.vertLeq(d,e.event)&&(d.s=e.event.s,d.t=e.event.t),p=tt.vertLeq(a,h)?a:h,tt.vertLeq(p,d)&&(d.s=p.s,d.t=p.t),tt.vertEq(d,a)||tt.vertEq(d,h)?(H.checkForRightSplice(e,n),!1):!tt.vertEq(c,e.event)&&tt.edgeSign(c,e.event,d)>=0||!tt.vertEq(l,e.event)&&tt.edgeSign(l,e.event,d)<=0?l===e.event?(e.mesh.splitEdge(s.Sym),e.mesh.splice(o.Sym,s),n=H.topLeftRegion(e,n),s=H.regionBelow(n).eUp,H.finishLeftRegions(e,H.regionBelow(n),i),H.addRightEdges(e,n,s.Oprev,s,s,!0),!0):c===e.event?(e.mesh.splitEdge(o.Sym),e.mesh.splice(s.Lnext,o.Oprev),i=n,n=H.topRightRegion(n),y=H.regionBelow(n).eUp.Rprev,i.eUp=o.Oprev,o=H.finishLeftRegions(e,i,null),H.addRightEdges(e,n,o.Onext,s.Rprev,y,!0),!0):(tt.edgeSign(c,e.event,d)>=0&&(H.regionAbove(n).dirty=n.dirty=!0,e.mesh.splitEdge(s.Sym),s.Org.s=e.event.s,s.Org.t=e.event.t),tt.edgeSign(l,e.event,d)<=0&&(n.dirty=i.dirty=!0,e.mesh.splitEdge(o.Sym),o.Org.s=e.event.s,o.Org.t=e.event.t),!1):(e.mesh.splitEdge(s.Sym),e.mesh.splitEdge(o.Sym),e.mesh.splice(o.Oprev,s),s.Org.s=d.s,s.Org.t=d.t,s.Org.pqHandle=e.pq.insert(s.Org),H.getIntersectData(e,s.Org,a,c,h,l),H.regionAbove(n).dirty=n.dirty=i.dirty=!0,!1)}static walkDirtyRegions(e,n){for(var i=H.regionBelow(n),s,o;;){for(;i.dirty;)n=i,i=H.regionBelow(i);if(!n.dirty&&(i=n,n=H.regionAbove(n),n===null||!n.dirty))return;if(n.dirty=!1,s=n.eUp,o=i.eUp,s.Dst!==o.Dst&&H.checkForLeftSplice(e,n)&&(i.fixUpperEdge?(H.deleteRegion(e,i),e.mesh.delete(o),i=H.regionBelow(n),o=i.eUp):n.fixUpperEdge&&(H.deleteRegion(e,n),e.mesh.delete(s),n=H.regionAbove(i),s=n.eUp)),s.Org!==o.Org)if(s.Dst!==o.Dst&&!n.fixUpperEdge&&!i.fixUpperEdge&&(s.Dst===e.event||o.Dst===e.event)){if(H.checkForIntersect(e,n))return}else H.checkForRightSplice(e,n);s.Org===o.Org&&s.Dst===o.Dst&&(H.addWinding(o,s),H.deleteRegion(e,n),e.mesh.delete(s),n=H.regionAbove(i))}}static connectRightVertex(e,n,i){var s,o=i.Onext,a=H.regionBelow(n),h=n.eUp,c=a.eUp,l=!1;if(h.Dst!==c.Dst&&H.checkForIntersect(e,n),tt.vertEq(h.Org,e.event)&&(e.mesh.splice(o.Oprev,h),n=H.topLeftRegion(e,n),o=H.regionBelow(n).eUp,H.finishLeftRegions(e,H.regionBelow(n),a),l=!0),tt.vertEq(c.Org,e.event)&&(e.mesh.splice(i,c.Oprev),i=H.finishLeftRegions(e,a,null),l=!0),l){H.addRightEdges(e,n,i.Onext,o,o,!0);return}tt.vertLeq(c.Org,h.Org)?s=c.Oprev:s=h,s=e.mesh.connect(i.Lprev,s),H.addRightEdges(e,n,s,s.Onext,s.Onext,!1),s.Sym.activeRegion.fixUpperEdge=!0,H.walkDirtyRegions(e,n)}static connectLeftDegenerate(e,n,i){var s,o,a,h,c;if(s=n.eUp,tt.vertEq(s.Org,i)){pt(!1),H.spliceMergeVertices(e,s,i.anEdge);return}if(!tt.vertEq(s.Dst,i)){e.mesh.splitEdge(s.Sym),n.fixUpperEdge&&(e.mesh.delete(s.Onext),n.fixUpperEdge=!1),e.mesh.splice(i.anEdge,s),H.sweepEvent(e,i);return}pt(!1),n=H.topRightRegion(n),c=H.regionBelow(n),a=c.eUp.Sym,o=h=a.Onext,c.fixUpperEdge&&(pt(o!==a),H.deleteRegion(e,c),e.mesh.delete(a),a=o.Oprev),e.mesh.splice(i.anEdge,a),tt.edgeGoesLeft(o)||(o=null),H.addRightEdges(e,n,a.Onext,h,o,!0)}static connectLeftVertex(e,n){var i,s,o,a,h,c,l=new Ll;if(l.eUp=n.anEdge.Sym,i=e.dict.search(l).key,s=H.regionBelow(i),!!s){if(a=i.eUp,h=s.eUp,tt.edgeSign(a.Dst,n,a.Org)===0){H.connectLeftDegenerate(e,i,n);return}if(o=tt.vertLeq(h.Dst,a.Dst)?i:s,i.inside||o.fixUpperEdge){if(o===i)c=e.mesh.connect(n.anEdge.Sym,a.Lnext);else{var u=e.mesh.connect(h.Dnext,n.anEdge);c=u.Sym}o.fixUpperEdge?H.fixUpperEdge(e,o,c):H.computeWinding(e,H.addRegionBelow(e,i,c)),H.sweepEvent(e,n)}else H.addRightEdges(e,i,n.anEdge,n.anEdge,null,!0)}}static sweepEvent(e,n){e.event=n;for(var i=n.anEdge;i.activeRegion===null;)if(i=i.Onext,i===n.anEdge){H.connectLeftVertex(e,n);return}var s=H.topLeftRegion(e,i.activeRegion);pt(s!==null);var o=H.regionBelow(s),a=o.eUp,h=H.finishLeftRegions(e,o,null);h.Onext===a?H.connectRightVertex(e,s,h):H.addRightEdges(e,s,h.Onext,a,a,!0)}static addSentinel(e,n,i,s){var o=new Ll,a=e.mesh.makeEdge();a.Org.s=i,a.Org.t=s,a.Dst.s=n,a.Dst.t=s,e.event=a.Dst,o.eUp=a,o.windingNumber=0,o.inside=!1,o.fixUpperEdge=!1,o.sentinel=!0,o.dirty=!1,o.nodeUp=e.dict.insert(o)}static initEdgeDict(e){e.dict=new O_(e,H.edgeLeq);var n=e.bmax[0]-e.bmin[0],i=e.bmax[1]-e.bmin[1],s=e.bmin[0]-n,o=e.bmax[0]+n,a=e.bmin[1]-i,h=e.bmax[1]+i;H.addSentinel(e,s,o,a),H.addSentinel(e,s,o,h)}static doneEdgeDict(e){for(var n,i=0;(n=e.dict.min().key)!==null;)n.sentinel||(pt(n.fixUpperEdge),pt(++i===1)),pt(n.windingNumber===0),H.deleteRegion(e,n)}static removeDegenerateEdges(e){var n,i,s,o=e.mesh.eHead;for(n=o.next;n!==o;n=i)i=n.next,s=n.Lnext,tt.vertEq(n.Org,n.Dst)&&n.Lnext.Lnext!==n&&(H.spliceMergeVertices(e,s,n),e.mesh.delete(n),n=s,s=n.Lnext),s.Lnext===n&&(s!==n&&((s===i||s===i.Sym)&&(i=i.next),e.mesh.delete(s)),(n===i||n===i.Sym)&&(i=i.next),e.mesh.delete(n))}static initPriorityQ(e){var n,i,s,o=0;for(s=e.mesh.vHead,i=s.next;i!==s;i=i.next)o++;for(o+=8,n=e.pq=new R_(o,tt.vertLeq),s=e.mesh.vHead,i=s.next;i!==s;i=i.next)i.pqHandle=n.insert(i);return i!==s?!1:(n.init(),!0)}static donePriorityQ(e){e.pq=null}static removeDegenerateFaces(e,n){var i,s,o;for(i=n.fHead.next;i!==n.fHead;i=s)s=i.next,o=i.anEdge,pt(o.Lnext!==o),o.Lnext.Lnext===o&&(H.addWinding(o.Onext,o),e.mesh.delete(o));return!0}static computeInterior(e,n=!0){var i,s;if(H.removeDegenerateEdges(e),!H.initPriorityQ(e))return!1;for(H.initEdgeDict(e);(i=e.pq.extractMin())!==null;){for(;s=e.pq.min(),!(s===null||!tt.vertEq(s,i));)s=e.pq.extractMin(),H.spliceMergeVertices(e,i.anEdge,s.anEdge);H.sweepEvent(e,i)}return e.event=e.dict.min().key.eUp.Org,H.doneEdgeDict(e),H.donePriorityQ(e),H.removeDegenerateFaces(e,e.mesh),n&&e.mesh.check(),!0}}class J1{mesh=new H1;normal=[0,0,0];sUnit=[0,0,0];tUnit=[0,0,0];bmin=[0,0];bmax=[0,0];windingRule=ze.ODD;dict=null;pq=null;event=null;vertexIndexCounter=0;vertices=[];vertexIndices=[];vertexCount=0;elements=[];elementCount=0;dot_(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}normalize_(e){let n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(!n)throw"Zero-size vector!";n=Math.sqrt(n),e[0]/=n,e[1]/=n,e[2]/=n}longAxis_(e){let n=0;return Math.abs(e[1])>Math.abs(e[0])&&(n=1),Math.abs(e[2])>Math.abs(e[n])&&(n=2),n}computeNormal_(e){let n,i,s,o,a,h,c=[0,0,0],l=[0,0,0],u=[0,0,0],f=[0,0,0],d=[0,0,0];const p=[null,null,null],y=[null,null,null],x=this.mesh.vHead;n=x.next;for(let g=0;g<3;++g)o=n.coords[g],l[g]=o,y[g]=n,c[g]=o,p[g]=n;for(n=x.next;n!==x;n=n.next)for(let g=0;g<3;++g)o=n.coords[g],o<l[g]&&(l[g]=o,y[g]=n),o>c[g]&&(c[g]=o,p[g]=n);let m=0;if(c[1]-l[1]>c[0]-l[0]&&(m=1),c[2]-l[2]>c[m]-l[m]&&(m=2),l[m]>=c[m]){e[0]=0,e[1]=0,e[2]=1;return}for(h=0,i=y[m],s=p[m],u[0]=i.coords[0]-s.coords[0],u[1]=i.coords[1]-s.coords[1],u[2]=i.coords[2]-s.coords[2],n=x.next;n!==x;n=n.next)f[0]=n.coords[0]-s.coords[0],f[1]=n.coords[1]-s.coords[1],f[2]=n.coords[2]-s.coords[2],d[0]=u[1]*f[2]-u[2]*f[1],d[1]=u[2]*f[0]-u[0]*f[2],d[2]=u[0]*f[1]-u[1]*f[0],a=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],a>h&&(h=a,e[0]=d[0],e[1]=d[1],e[2]=d[2]);h<=0&&(e[0]=e[1]=e[2]=0,e[this.longAxis_(u)]=1)}checkOrientation_(){var e=this.mesh.fHead,n,i=this.mesh.vHead,s;let o=0;for(let a=e.next;a!==e;a=a.next)if(s=a.anEdge,!(s.winding<=0))do o+=(s.Org.s-s.Dst.s)*(s.Org.t+s.Dst.t),s=s.Lnext;while(s!==a.anEdge);if(o<0){for(n=i.next;n!==i;n=n.next)n.t=-n.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}}projectPolygon_(){let e=this.mesh.vHead,n=[0,0,0],i,s,o=!1;n[0]=this.normal[0],n[1]=this.normal[1],n[2]=this.normal[2],!n[0]&&!n[1]&&!n[2]&&(this.computeNormal_(n),o=!0),i=this.sUnit,s=this.tUnit;let a=this.longAxis_(n);i[a]=0,i[(a+1)%3]=1,i[(a+2)%3]=0,s[a]=0,s[(a+1)%3]=0,s[(a+2)%3]=n[a]>0?1:-1;for(let c=e.next;c!==e;c=c.next)c.s=this.dot_(c.coords,i),c.t=this.dot_(c.coords,s);o&&this.checkOrientation_();let h=!0;for(let c=e.next;c!==e;c=c.next)h?(this.bmin[0]=this.bmax[0]=c.s,this.bmin[1]=this.bmax[1]=c.t,h=!1):(c.s<this.bmin[0]&&(this.bmin[0]=c.s),c.s>this.bmax[0]&&(this.bmax[0]=c.s),c.t<this.bmin[1]&&(this.bmin[1]=c.t),c.t>this.bmax[1]&&(this.bmax[1]=c.t))}addWinding_(e,n){e.winding+=n.winding,e.Sym.winding+=n.Sym.winding}tessellateMonoRegion_(e,n){let i,s;if(i=n.anEdge,!(i.Lnext!==i&&i.Lnext.Lnext!==i))throw"Mono region invalid";for(;tt.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;tt.vertLeq(i.Org,i.Dst);i=i.Lnext);s=i.Lprev;let o;for(;i.Lnext!==s;)if(tt.vertLeq(i.Dst,s.Org)){for(;s.Lnext!==i&&(tt.edgeGoesLeft(s.Lnext)||tt.edgeSign(s.Org,s.Dst,s.Lnext.Dst)<=0);)o=e.connect(s.Lnext,s),s=o.Sym;s=s.Lprev}else{for(;s.Lnext!==i&&(tt.edgeGoesRight(i.Lprev)||tt.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);)o=e.connect(i,i.Lprev),i=o.Sym;i=i.Lnext}if(s.Lnext===i)throw"Mono region invalid";for(;s.Lnext.Lnext!==i;)o=e.connect(s.Lnext,s),s=o.Sym;return!0}tessellateInterior_(e){let n;for(let i=e.fHead.next;i!==e.fHead;i=n)if(n=i.next,i.inside&&!this.tessellateMonoRegion_(e,i))return!1;return!0}discardExterior_(e){let n;for(let i=e.fHead.next;i!==e.fHead;i=n)n=i.next,i.inside||e.zapFace(i)}setWindingNumber_(e,n,i){let s;for(let o=e.eHead.next;o!==e.eHead;o=s)s=o.next,o.Rface.inside!==o.Lface.inside?o.winding=o.Lface.inside?n:-n:i?e.delete(o):o.winding=0}getNeighbourFace_(e){return!e.Rface||!e.Rface.inside?-1:e.Rface.n}outputPolymesh_(e,n,i,s){let o,a=0,h=0,c;i>3&&e.mergeConvexFaces(i);for(let f=e.vHead.next;f!==e.vHead;f=f.next)f.n=-1;for(let f=e.fHead.next;f!==e.fHead;f=f.next)if(f.n=-1,!!f.inside){o=f.anEdge,c=0;do{let d=o.Org;d.n===-1&&(d.n=h,h++),c++,o=o.Lnext}while(o!==f.anEdge);if(c>i)throw"Face vertex greater that support polygon";f.n=a,++a}this.elementCount=a,n===wn.CONNECTED_POLYGONS&&(a*=2),this.elements=[],this.elements.length=a*i,this.vertexCount=h,this.vertices=[],this.vertices.length=h*s,this.vertexIndices=[],this.vertexIndices.length=h;for(let f=e.vHead.next;f!==e.vHead;f=f.next)if(f.n!==-1){var l=f.n*s;this.vertices[l+0]=f.coords[0],this.vertices[l+1]=f.coords[1],s>2&&(this.vertices[l+2]=f.coords[2]),this.vertexIndices[f.n]=f.idx}let u=0;for(let f=e.fHead.next;f!==e.fHead;f=f.next)if(f.inside){o=f.anEdge,c=0;do{let d=o.Org;this.elements[u++]=d.n,c++,o=o.Lnext}while(o!==f.anEdge);for(let d=c;d<i;++d)this.elements[u++]=-1;if(n===wn.CONNECTED_POLYGONS){o=f.anEdge;do this.elements[u++]=this.getNeighbourFace_(o),o=o.Lnext;while(o!==f.anEdge);for(let d=c;d<i;++d)this.elements[u++]=-1}}}outputContours_(e,n){let i,s,o=0,a=0;this.vertexCount=0,this.elementCount=0;for(let u=e.fHead.next;u!==e.fHead;u=u.next)if(u.inside){s=i=u.anEdge;do this.vertexCount++,i=i.Lnext;while(i!==s);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*n,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;let h=0,c=0,l=0;o=0;for(let u=e.fHead.next;u!==e.fHead;u=u.next)if(u.inside){a=0,s=i=u.anEdge;do this.vertices[h++]=i.Org.coords[0],this.vertices[h++]=i.Org.coords[1],n>2&&(this.vertices[h++]=i.Org.coords[2]),this.vertexIndices[c++]=i.Org.idx,a++,i=i.Lnext;while(i!==s);this.elements[l++]=o,this.elements[l++]=a,o+=a}}addContour(e,n){this.mesh===null&&(this.mesh=new H1),e<2&&(e=2),e>3&&(e=3);let i=null;for(let s=0;s<n.length;s+=e)i===null?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=n[s+0],i.Org.coords[1]=n[s+1],e>2?i.Org.coords[2]=n[s+2]:i.Org.coords[2]=0,i.Org.idx=this.vertexIndexCounter++,i.winding=1,i.Sym.winding=-1}tesselate(e=ze.ODD,n=wn.POLYGONS,i,s,o,a=!0){if(this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,o&&(this.normal[0]=o[0],this.normal[1]=o[1],this.normal[2]=o[2]),this.windingRule=e,s<2&&(s=2),s>3&&(s=3),!this.mesh)return!1;this.projectPolygon_(),H.computeInterior(this,a);var h=this.mesh;return n===wn.BOUNDARY_CONTOURS?this.setWindingNumber_(h,1,!0):this.tessellateInterior_(h),a&&h.check(),n===wn.BOUNDARY_CONTOURS?this.outputContours_(h,s):this.outputPolymesh_(h,n,i,s),!0}}function L_({windingRule:r=ze.ODD,elementType:e=wn.POLYGONS,polySize:n=3,vertexSize:i=2,normal:s=[0,0,1],contours:o=[],strict:a=!0,debug:h=!1}){if(!o&&a)throw new Error("Contours can't be empty");if(!o)return;const c=new J1;for(let l=0;l<o.length;l++)c.addContour(i||2,o[l]);return c.tesselate(r,e,n,i,s,a),{vertices:c.vertices,vertexIndices:c.vertexIndices,vertexCount:c.vertexCount,elements:c.elements,elementCount:c.elementCount,mesh:h?c.mesh:void 0}}const B_=ze.ODD,F_=ze.NONZERO,N_=ze.POSITIVE,q_=ze.NEGATIVE,D_=ze.ABS_GEQ_TWO,$_=wn.POLYGONS,V_=wn.CONNECTED_POLYGONS,U_=wn.BOUNDARY_CONTOURS,W_=Object.freeze(Object.defineProperty({__proto__:null,BOUNDARY_CONTOURS:U_,CONNECTED_POLYGONS:V_,ELEMENT:wn,POLYGONS:$_,Tesselator:J1,WINDING:ze,WINDING_ABS_GEQ_TWO:D_,WINDING_NEGATIVE:q_,WINDING_NONZERO:F_,WINDING_ODD:B_,WINDING_POSITIVE:N_,tesselate:L_},Symbol.toStringTag,{value:"Module"}));function Q1(r=10){return Math.random().toString(36).substr(2,r)}function j_(r,...e){return r instanceof Function?r(...e):r}function no(r,...e){return e.includes(r)}const Y_=(r,e)=>r.concat(e);function K1(r,e,n=Y_){for(const i of Object.keys(e))i in r&&Array.isArray(r[i])&&Array.isArray(e[i])?r[i]=n(r[i],e[i]):i in r&&r[i]instanceof Object&&e[i]instanceof Object?K1(r[i],e[i]):r[i]=e[i]}function H_(r,e=0){return e?+setTimeout(r,e):(r(),0)}function X_(r){return new Promise(e=>setTimeout(e,r))}function Z_(){let r=()=>{},e=()=>{};const n=new Promise((i,s)=>{r=i,e=s});return n.catch(i=>i),{promise:n,resolve:r,reject:e}}class ty extends Error{constructor(e){super("[Cache Error]"),this.data=e}}function G_(r){const e=new Map;return function(...n){const i=n.join("--");if(!e.has(i))try{e.set(i,r(...n))}catch(o){e.set(i,new ty(o))}const s=e.get(i);if(s instanceof ty)throw s.data;return s}}function J_(r,e=0,n=!1){let i=!1,s=!1;return(...o)=>{i?s=!0:(n?s=!0:r(...o),i=!0,setTimeout(()=>{s&&r(...o),i=s=!1},e))}}function Q_(r){return function(e,n){if(!e||Array.isArray(this)||r.includes(e))return n}}function K_(r,e,n){if(!r)return e;try{return JSON.parse(r,n?Q_(n):void 0)||e}catch{return e}}function Bl(r,e){return new Array(e).fill(r)}function Fl(r,e,n){const i=[];for(let s=0;s<e;++s)i.push(Bl(r,n));return i}function Ha(r,e){const n=[];for(let i=0;i<e;++i)n.push(r(i));return n}function ey(r,e,n){const i=[];for(let s=0;s<e;++s){const o=[];for(let a=0;a<n;++a)o.push(r(s,a));i.push(o)}return i}function ny(r,e,n=1){const i=[];if(e===void 0&&r>=0)for(let s=0;s<r;s+=n)i.push(s);else if(e===void 0)for(let s=0;s>r;s-=n)i.push(s);else if(r<=e)for(let s=r;s<=e;s+=n)i.push(s);else for(let s=r;s>=e;s-=n)i.push(s);return i}function Nl(r,e=0){return r[r.length-1-e]}function xe(r){return r.reduce((e,n)=>e+n,0)}function iy(r,e,n=!1){return r.slice(0).sort((i,s)=>{const o=e(i),a=e(s);return o<a?n?1:-1:o>a?n?-1:1:0})}function t3(r){let e=0;return()=>r[e++%r.length]}function sy(r){return r.filter((e,n)=>r.indexOf(e)===n)}function ql(r){return r.reduce((e,n)=>e.concat(Array.isArray(n)?ql(n):n),[])}function e3(r){let e=0;return r.map(n=>e+=n)}function n3(r,e){const n=[];for(let i=0;i<r.length;i+=e)n.push(r.slice(i,i+e));return n}function i3(r,e=1){const n=r.length;e=(e%n+n)%n;const i=r.slice(0,e);return r.slice(e).concat(i)}function s3(r,e){return r.filter(n=>e.includes(n))}function r3(r,e){const n=e.filter(s=>!r.includes(s)),i=r.filter(s=>!e.includes(s));return[...n,...i]}function o3(...r){return r.reduce((e,n)=>e.concat(n),[])}function a3(r){return r.map(e=>e.map(n=>{let i=n?`${n}`:"";return i.match(/[,\n"']/)&&(i=`"${i.replace(/"/g,'""')}"`),i}).join(",")).join(`
`)}class h3{root;constructor(e){const n=e.length,i=e.map(s=>({val:s}));for(const[s,o]of i.entries())o.next=i[(s+1)%n],o.prev=i[(s-1+n)%n];this.root=i[0]}*traverse(){let e=this.root;for(;e;)if(yield e,e=e.next,e===this.root)return}get array(){return Array.from(this.traverse())}delete(e){if(e===this.root){if(e.next===e)return this.root=void 0;this.root=e.next}e.prev.next=e.next,e.next.prev=e.prev}}var ry=(r=>(r[r.first=0]="first",r[r.firstGreater=1]="firstGreater",r))(ry||{});function oy(r,e,n){let i=0,s=r.length-1,o=-1;for(;i<=s;){const a=Math.floor((i+s)/2),h=r[a].val;h<e?i=a+1:h>e?(n===1&&(o=a),s=a-1):n===0?(o=a,s=a-1):n===1&&(i=a+1)}return o}function c3(r,e,n){let i=oy(r,n,0);if(i<0)return-1;for(;r[i].val===n;){if(r[i].item===e)return i;i+=1}return-1}function Xa(r,e=/\s+/){return r?r.trim().split(e):[]}function l3(r){return r.replace(/\S+/g,e=>e.charAt(0).toUpperCase()+e.slice(1))}function u3(r){return r.toLowerCase().replace(/^-/,"").replace(/-(.)/g,(e,n)=>n.toUpperCase())}function f3(r){return r===r.split("").reverse().join("")}function ay(r,e,n=!1){const i=Fl(0,r.length+1,e.length+1);for(let s=0;s<=r.length;s++)i[s][0]=s;for(let s=0;s<=e.length;s++)i[0][s]=s;for(let s=1;s<=r.length;s++)for(let o=1;o<=e.length;o++)i[s][o]=Math.min(i[s-1][o-1]+(r.charAt(s-1)===e.charAt(o-1)?0:1),i[s-1][o]+1,i[s][o-1]+1);return n?Math.min(...i[r.length]):i[r.length][e.length]}function d3(r,e){const n=r.length/2,i=e.map(o=>({w:o,d:ay(r,o)})).filter(({d:o})=>o<n),s=iy(i,o=>o.d)[0];return s?s.w:void 0}class p3{events=new Map;on(e,n){for(const i of Xa(e))this.events.has(i)||this.events.set(i,[]),this.events.get(i).push(n)}one(e,n){const i=s=>{this.off(e,i),n(s)};this.on(e,i)}off(e,n){for(const i of Xa(e))this.events.has(i)&&this.events.set(i,this.events.get(i).filter(s=>s!==n))}trigger(e,n){for(const i of Xa(e))if(this.events.has(i))for(const s of this.events.get(i))s(n)}}const y3=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,x3=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i,m3=/rgba?\(([0-9.]+), ?([0-9.]+), ?([0-9.]+)(, ?([0-9.]+))?\)/,g3=["#22ab24","#009ea6","#0f82f2","#6d3bbf","#cd0e66","#eb4726","#fd8c00"];function hy(r){return r.length===1?`0${r}`:r}function cy(r,e){if(e<=0)return Za.from(r[0]);if(e>=1)return Za.from(Nl(r));const n=Math.floor(e*(r.length-1)),i=e*(r.length-1)-n;return Za.mix(r[n+1],r[n],i)}function Dl(r,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?r+(e-r)*6*n:n<1/2?e:n<2/3?r+(e-r)*(2/3-n)*6:r}let Za=class ye{constructor(e,n,i,s=1){this.r=e,this.g=n,this.b=i,this.a=s}get hex(){const e=[this.r,this.g,this.b].map(i=>hy(Math.round(i).toString(16))),n=this.a>=1?"":hy(Math.round(this.a*255).toString(16));return`#${e.join("")}${n}`}get rgb(){return`rgba(${[this.r,this.g,this.b].map(n=>Math.round(n)).join(",")},${this.a})`}get brightness(){return(this.r*299+this.g*587+this.g*114)/1e3}get hsl(){const e=this.r/255,n=this.g/255,i=this.b/255,s=Math.max(e,n,i),o=Math.min(e,n,i),a=(o+s)/2,h=s-o;if(s===o)return[0,0,Math.round(a*100)];let c=e===s?(n-i)/h:n===s?2+(i-e)/h:4+(e-n)/h;c=Math.min(c*60,360),c<0&&(c+=360);const l=a<=.5?h/(s+o):h/(2-s-o);return[Math.round(c),Math.round(l*100),Math.round(a*100)]}get chroma(){return Math.max(this.r,this.g,this.b)-Math.min(this.r,this.g,this.b)}toString(){return this.rgb}copy(){return new ye(this.r,this.g,this.b,this.a)}static from(e){return typeof e!="string"?e:e.startsWith("#")?ye.fromHex(e):ye.fromRgb(e)}static fromRgb(e){const n=e.match(m3);if(!n)return new ye(0,0,0);const i=n[4]?+n[5]||0:1;return new ye(+n[1],+n[2],+n[3],i)}static fromHex(e){e=e.replace(y3,(i,s,o,a)=>s+s+o+o+a+a);const n=x3.exec(e);return n?new ye(parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),n[4]?parseInt(n[4],16)/255:1):new ye(0,0,0)}static fromHsl(e,n,i){if(e/=360,n/=100,i/=100,n===0){const l=Math.round(i*255);return new ye(l,l,l)}const s=i<.5?i*(1+n):i+n-i*n,o=2*i-s,a=Dl(o,s,e+1/3),h=Dl(o,s,e),c=Dl(o,s,e-1/3);return new ye(Math.round(a*255),Math.round(h*255),Math.round(c*255))}static rainbow(e){return Ha(n=>cy(g3,n/(e-1)),e)}static gradient(e,n){return Ha(i=>cy(e,i/(n-1)),n)}static shades(e,n,i=.5){const s=ye.mix("#fff",e,i),o=ye.mix("#000",e,i);return ye.gradient([s,e,o],n)}static mix(e,n,i=.5){return e=ye.from(e),n=ye.from(n),new ye(i*e.r+(1-i)*n.r,i*e.g+(1-i)*n.g,i*e.b+(1-i)*n.b,i*e.a+(1-i)*n.a)}static mixMany(e,n){n||(n=e.map(()=>1));const i=xe(n),s=e.map(m=>m.hsl),o=s.map(m=>m[0]),a=o.map(m=>m<180?m+360:m),h=n.map((m,g)=>m*Math.sqrt(e[g].chroma)),c=xe(h),l=xe(o.map((m,g)=>m*h[g]))/c,u=xe(a.map((m,g)=>m*h[g]))/c,f=xe(o.map((m,g)=>Math.abs(m-l)*h[g])),d=xe(a.map((m,g)=>Math.abs(m-u)*h[g])),p=f<=d?l:u%360,y=xe(s.map((m,g)=>n[g]*m[1]))/i,x=xe(s.map((m,g)=>n[g]*m[2]))/i;return ye.fromHsl(p,y,x)}};class w3{constructor(e){this.maxSize=e}store=new Map;list=[];has(e){return this.store.has(e)}get(e){const n=this.store.get(e);return n&&this.touch(e,n),n?n.val:void 0}set(e,n){const i=this.store.get(e);if(i){i.val=n,this.touch(e,i);return}if(this.list.push(e),this.store.set(e,{val:n,i:this.list.length}),this.list.length>this.maxSize){const s=this.list.shift();this.store.delete(s)}}getOrSet(e,n){const i=this.get(e);if(i)return i;const s=n(e);return this.set(e,s),s}touch(e,n){this.list.splice(n.i,1).push(e),n.i=this.list.length}}function b3(r){return r[Symbol.iterator]().next().value}function*v3(...r){for(const e of r)yield*e}function M3(r,e){for(const n of r)if(!e(n))return!1;return!0}function _3(r,e){for(const n of r)if(e(n))return!0;return!1}function*S3(r,e){let n=0;for(const i of r)e(i,n)&&(yield i),n+=1}function*T3(r,e){let n=0;for(const i of r)yield e(i,n),n+=1}function*E3(r,e){for(const n of r)for(const i of e(n))yield i}function*z3(r,e){for(const n of r)for(const i of e)yield[n,i]}function*A3(r){const e=r.length;for(let n=0;n<e;++n)for(let i=n+1;i<e;++i)yield[r[n],r[i]]}function C3(r,e,n=1/0,i){let s,o=n;for(const a of r){const h=e(a);if(h<o&&(s=a,o=h,i!==void 0&&o<i))return s}return s}const P3=Object.freeze(Object.defineProperty({__proto__:null,BinarySearchType:ry,Cache:w3,Color:Za,EventTarget:p3,LinkedList:h3,autoCorrect:d3,binaryIndexOf:c3,binarySearch:oy,cache:G_,chunk:n3,concat:v3,cumulative:e3,deepExtend:K1,defer:Z_,delay:H_,difference:r3,every:M3,filter:S3,findMin:C3,first:b3,flatMap:E3,flatten:ql,intersect:s3,isOneOf:no,isPalindrome:f3,join:o3,last:Nl,list:ny,listPairs:A3,loop:t3,map:T3,pairs:z3,repeat:Bl,repeat2D:Fl,rotate:i3,run:j_,safeToJSON:K_,some:_3,sortBy:iy,stringDistance:ay,tabulate:Ha,tabulate2D:ey,throttle:J_,toCSV:a3,toCamelCase:u3,toTitleCase:l3,total:xe,uid:Q1,unique:sy,wait:X_,words:Xa},Symbol.toStringTag,{value:"Module"})),Ga=1e-6;function bt(r,e,n=Ga){return isNaN(r)||isNaN(e)?!1:Math.abs(r-e)<n}function ii(r,e=Ga){return bt(r,Math.round(r),e)}function bn(r,e,n,i=Ga){return e>n&&([e,n]=[n,e]),r>e+i&&r<n-i}function ly(r,e=Ga){return bt(r,0,e)?0:r>0?1:-1}const uy=/(\d+)(\d{3})/,I3=["","k","m","b","t","q"];function k3(r){let[e,n]=r.split(".");for(;uy.test(e);)e=e.replace(uy,"$1,$2");return e+(n?`.${n}`:"")}function R3(r,e=6){if(!e)return`${r}`;const n=`${Math.abs(Math.floor(r))}`.length,i=n+(r<0?1:0);if(i<=e)return`${so(r,e-i)}`;const s=Math.floor(Math.log10(Math.abs(r))/3),o=I3[s],a=e-(n%3||3)-(o?1:0)-(r<0?1:0);return so(r/Math.pow(10,3*s),a)+o}function io(r,e=0,n=!0){const i=R3(r,e).replace("-","–");return n?k3(i):i}function O3(r,e=6){const n=Math.abs(r);if(bn(n,Math.pow(10,-e),Math.pow(10,e)))return io(r,e);if(n>Number.MAX_VALUE)return`${Math.sign(r)<0?"–":""}∞`;if(n<Number.MIN_VALUE)return"0";const[i,s]=r.toExponential().split("e"),o=s.replace("+","").replace("-","–"),a=o.startsWith("–");return`${i.slice(0,5)} × 10^${(a?"(":"")+o+(a?")":"")}`}const L3=/^-?0,[0-9]+$/,B3=/^-?([0-9]+(,[0-9]{3})*)?\.?[0-9]*$/,F3=/^-?[0-9]+(\.[0-9]{3})*,?[0-9]*$/;function N3(r){return r=r.replace(/^–/,"-").trim(),!r||r.match(/[^0-9.,-]/)?NaN:L3.test(r)?parseFloat(r.replace(/,/,".")):B3.test(r)?parseFloat(r.replace(/,/g,"")):F3.test(r)?parseFloat(r.replace(/\./g,"").replace(/,/,".")):NaN}function q3(r){if(Math.abs(r)%100>=11&&Math.abs(r)%100<=13)return`${r}th`;switch(r%10){case 1:return`${r}st`;case 2:return`${r}nd`;case 3:return`${r}rd`;default:return`${r}th`}}const $l=["","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],fy=["","","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"],D3=[""," thousand"," million"," billion"," trillion"," quadrillion"," quintillion"," sextillion"];function $3(r){const[e,n,i]=r.split(""),s=e==="0"?"":` ${$l[+e]} hundred`;return n+i==="00"?s:+n<2?`${s} ${$l[+(n+i)]}`:i==="0"?`${s} ${fy[+n]}`:`${s} ${fy[+n]}-${$l[+i]}`}function V3(r){if(r===0)return"zero";const e=Math.round(Math.abs(r)).toString(),n=Math.ceil(e.length/3),i=e.padStart(3*n,"0");let s="";for(let o=0;o<n;o+=1){const a=i.substr(o*3,3);a!=="000"&&(s+=$3(a)+D3[n-1-o])}return s.trim()}function U3(r){return`${Math.abs(r)}`.split("").reverse().map(n=>+n)}function so(r,e=0){const n=Math.pow(10,e);return Math.round(r*n)/n}function Vl(r,e=1){return Math.round(r/e)*e}function vn(r,e=-1/0,n=1/0){return Math.min(n,Math.max(e,r))}function Ja(r,e,n=.5){return r+(e-r)*n}function on(r){return r*r}function W3(r){return r*r*r}function dy(r,e){return(r%e+e)%e}function j3(r,e){return e===void 0?Math.log(r):Math.log(r)/Math.log(e)}function py(r,e,n){if(bt(r,0)&&bt(e,0))return[];if(bt(r,0))return[-n/e];const i=-e/2/r,s=Math.sqrt(e*e-4*r*n)/2/r;return[i+s,i-s]}function Y3(r,e){let n=0,i=1;for(const s of e)n+=i*s,i*=r;return n}function H3(r){if(r===0)return 1;if(r<0)return NaN;let e=1;for(let n=2;n<=r;++n)e*=n;return e}function yy(r,e){if(e<0||e>r)return 0;if(e===0)return 1;if(2*e>r)return yy(r,r-e);let n=1;for(let i=1;i<=e;++i)n*=(r-i+1)/i;return Math.round(n)}function X3(r){const e=[];return xy(r,e,[]),e}function xy(r,e,n){for(let i=0;i<r.length;i++){const s=r.splice(i,1)[0];n.push(s),r.length===0&&e.push(n.slice()),xy(r,e,n),r.splice(i,0,s),n.pop()}}function my(r,e=0){const n=r.slice(0),i=gy(n);return e?i.filter(s=>s.length===e):i}function gy(r){if(r.length===1)return[[],r];const e=r.pop(),n=gy(r),i=[];for(const s of n)i.push(s,[...s,e]);return i}const Qa=(r,e)=>{const n=r<0?"–":"";return Math.abs(r)===1&&e?n+e:n+Math.abs(r)+(e||"")};class Yt{constructor(e=0,n=0){this.re=e,this.im=n}get modulus(){return Math.sqrt(this.re*this.re+this.im*this.im)}get argument(){return Math.atan2(this.im,this.re)}get conjugate(){return new Yt(this.re,-this.im)}root(e,n=0){const i=Math.pow(this.modulus,1/e),s=(this.argument+n*2*Math.PI)/e;return new Yt(i*Math.cos(s),i*Math.sin(s))}toString(e=2){const n=so(this.re,e),i=so(this.im,e);return i===0?Qa(n):n===0?Qa(i,"i"):[Qa(n),i<0?"–":"+",Qa(Math.abs(i),"i")].join(" ")}add(e){return Yt.sum(this,e)}subtract(e){return Yt.difference(this,e)}multiply(e){return Yt.product(this,e)}divide(e){return Yt.quotient(this,e)}static sum(e,n){return typeof e=="number"&&(e=new Yt(e,0)),typeof n=="number"&&(n=new Yt(n,0)),new Yt(e.re+n.re,e.im+n.im)}static difference(e,n){return typeof e=="number"&&(e=new Yt(e,0)),typeof n=="number"&&(n=new Yt(n,0)),new Yt(e.re-n.re,e.im-n.im)}static product(e,n){typeof e=="number"&&(e=new Yt(e,0)),typeof n=="number"&&(n=new Yt(n,0));const i=e.re*n.re-e.im*n.im,s=e.im*n.re+e.re*n.im;return new Yt(i,s)}static quotient(e,n){if(typeof e=="number"&&(e=new Yt(e,0)),typeof n=="number"&&(n=new Yt(n,0)),Math.abs(n.re)<Number.EPSILON||Math.abs(n.im)<Number.EPSILON)return new Yt(1/0,1/0);const i=n.re*n.re+n.im*n.im,s=(e.re*n.re+e.im*n.im)/i,o=(e.im*n.re-e.re*n.im)/i;return new Yt(s,o)}static exp(e){typeof e=="number"&&(e=new Yt(e,0));const n=Math.exp(e.re);return new Yt(n*Math.cos(e.im),n*Math.sin(e.im))}}function ro(...r){const[e,...n]=r;if(n.length>1)return ro(e,ro(...n));let i=Math.abs(e),s=Math.abs(n[0]);for(;s;)[i,s]=[s,i%s];return i}function Ka(...r){const[e,...n]=r;return n.length>1?Ka(e,Ka(...n)):Math.abs(e*n[0])/ro(e,n[0])}function oo(r){if(r%1!==0||r<2)return!1;if(r%2===0)return r===2;if(r%3===0)return r===3;const e=Math.sqrt(r);for(let n=5;n<=e;n+=6)if(r%n===0||r%(n+2)===0)return!1;return!0}function th(r){if(r===1)return[];if(oo(r))return[r];const e=Math.sqrt(r);for(let n=2;n<=e;++n)if(r%n===0)return th(n).concat(th(r/n));return[]}function wy(r){return sy(th(r))}function Z3(r=100){if(r<2)return[];const e=[2];for(let n=3;n<=r;n++){let i=!1;for(const s of e)i=i||n%s===0;i||e.push(n)}return e}function G3(r){if(r<2||r>16)throw new Error("Invalid number of digits.");const e=[1,3,7,9],n=Math.pow(10,r-2);for(;;){const s=10*(Math.floor(Math.random()*9*n)+n)+e[Math.floor(4*Math.random())];if(oo(s))return s}}function J3(r){if(r===4)return[2,2];let e=r/2,n=r/2;for(e%2===0&&(e--,n++);e>=3;){if(oo(e)&&oo(n))return[e,n];e-=2,n+=2}return[-1,-1]}function Q3(r){if(r<=0)throw Error("Number should be greater than zero");let e=r;for(const n of wy(r))e*=(n-1)/n;return e}const K3=/^([0-9\-.]*)([%πkmbtq]?)(\/([0-9\-.]+))?([%π]?)$/,by=r=>r>=Number.MAX_SAFE_INTEGER;class Rt{constructor(e,n,i){this.unit=i,this.num=n!==void 0&&n<0?-e:e,n!==void 0&&Math.abs(n)!==1&&e!==0&&(this.den=Math.abs(n))}num;den;valueOf(){return this.value}toMixed(){if(!this.den||this.unit)return this.toString();const e=Math.abs(this.num)%this.den,n=Math.abs(Math.trunc(this.value));return n?`${this.sign<0?"–":""}${n} ${e}/${this.den}`:this.toString()}toExpr(e,n=4){const i=this.value;if(Math.abs(i)>=Number.MAX_VALUE)return"∞";if((by(this.num)||this.den&&by(this.den))&&(e="decimal"),e==="scientific"||Math.abs(i)>=Number.MAX_SAFE_INTEGER){const[s,o]=this.value.toExponential(n-1).split("e");if(Math.abs(+o)>=n){const a=o.startsWith("-"),h=`${a?"(":""}${a?o:o.slice(1)}${a?")":""}`;return`${s.replace(/\.?0+$/,"")} × 10^${h}${this.unit||""}`}}if(!this.unit&&!this.den||e==="decimal"||e==="scientific"){const s=io(this.value,n);return s.match(/^[\d.]+$/g)?s:`"${s}"`}else return e==="mixed"?this.toMixed():this.toString()}toString(e=4){const n=!this.den&&!this.unit;let i=io(this.num,this.den?0:e,n),s=this.unit||"";const o=this.den?`/${io(this.den,0,n)}`:"";return i==="0"&&(s=""),s==="π"&&!this.den&&(i==="1"||i==="–1")&&(i=i.replace("1","")),`${i}${o}${s}`}toMathML(){let e=`<mn>${this.num}</mn>`;return this.den!==void 0&&(e=`<mfrac>${e}<mn>${this.den}</mn></mfrac>`),this.unit&&(e+=this.unit==="π"?"<mi>π</mi>":"<mo>%</mo>"),e}get value(){const e=this.unit==="%"?.01:this.unit==="π"?Math.PI:1;return this.num*e/(this.den||1)}get sign(){return Math.sign(this.num)}get simplified(){if(!this.den)return this;const e=ro(Math.abs(this.num),this.den);return new Rt(this.num/e,this.den/e,this.unit)}get inverse(){return this.den?new Rt(1/this.num,void 0,this.unit):new Rt(this.den,this.num)}get negative(){return new Rt(-this.num,this.den,this.unit)}get fraction(){if(!(this.unit||!ii(this.num)))return[this.num,this.den||1]}static fromString(e){e=e.toLowerCase().replace(/[\s,"]/g,"").replace("–","-").replace("pi","π");const n=e.match(K3);if(!n)return;let i=n[2]||n[5]||void 0,s=n[1]?+n[1]:void 0;const o=n[4]?+n[4]:void 0;if(i==="π"&&(!n[1]||n[1]==="-")&&(s=n[1]?-1:1),s===void 0||isNaN(s))return;const a=i?"kmbtq".indexOf(i):-1;if(a>=0&&(s*=1e3**(a+1),i=void 0),o===void 0)return new Rt(s,void 0,i);if(!(isNaN(o)||bt(o,0)))return!ii(s)||!ii(o)?new Rt(s/o,void 0,i):new Rt(s,o,i)}static fractionFromDecimal(e,n=1e3,i=1e-12){let s=[1,0],o=[0,1];const a=Math.abs(e);let h=a;for(;Math.abs(s[0]/o[0]-a)>i;){const c=Math.floor(h);if(s=[c*s[0]+s[1],s[0]],o=[c*o[0]+o[1],o[0]],o[0]>n)return new Rt(e);h=1/(h-c)}return bt(s[0]/o[0],a,i)?new Rt(ly(e)*s[0],o[0]===1?void 0:o[0]):new Rt(e)}clamp(e,n){const i=this.value;return e!==void 0&&i<e?new Rt(e):n!==void 0&&i>n?new Rt(n):this}add(e){return Rt.sum(this,e)}subtract(e){return Rt.difference(this,e)}multiply(e){return Rt.product(this,e)}divide(e){return Rt.quotient(this,e)}static sum(e,n){if(typeof n=="number"&&(n=new Rt(n)),e.num===0)return n;if(e.unit!==n.unit)return new Rt(e.value+n.value);if(!e.den&&!n.den)return new Rt(e.num+n.num,void 0,e.unit);if(e.den||([e,n]=[n,e]),!ii(n.num))return new Rt(e.value+n.value,void 0,e.unit);const i=Ka(e.den,n.den||1),s=i/e.den,o=i/(n.den||1);return new Rt(e.num*s+n.num*o,i,e.unit)}static difference(e,n){return typeof n=="number"&&(n=new Rt(n)),Rt.sum(e,n.negative)}static product(e,n){if(typeof n=="number"&&(n=new Rt(n)),!e.unit&&!e.den&&ii(e.num))return new Rt(e.num*n.num,n.den,n.unit);if(!n.unit&&!n.den&&ii(n.num))return new Rt(e.num*n.num,e.den,e.unit);if(e.unit==="π"||n.unit==="π"||!ii(e.num)||!ii(n.num))return new Rt(e.value*n.value);const i=(e.unit==="%"?100:1)*(n.unit==="%"?100:1);return new Rt(e.num*n.num,(e.den||1)*(n.den||1)*i)}static quotient(e,n){return typeof n=="number"&&(n=new Rt(n)),Rt.product(e,n.inverse)}}function vy(r,e,n){return Fl(r,e,n)}function My(r=2){const e=vy(0,r,r);for(let n=0;n<r;++n)e[n][n]=1;return e}function tS(r){const e=Math.sin(r),n=Math.cos(r);return[[n,-e],[e,n]]}function eS(r){return[[1,r],[0,1]]}function nS(r){const e=Math.sin(2*r),n=Math.cos(2*r);return[[n,e],[e,-n]]}function _y(...r){const[e,...n]=r,i=n.length>1?_y(...n):n[0];if(e.length!==i.length||e[0].length!==i[0].length)throw new Error("Matrix sizes don’t match");const s=[];for(let o=0;o<e.length;++o){const a=[];for(let h=0;h<e[o].length;++h)a.push(e[o][h]+i[o][h]);s.push(a)}return s}function iS(r,e){return r.map(n=>n.map(i=>i*e))}function eh(...r){const[e,...n]=r,i=n.length>1?eh(...n):n[0];if(e[0].length!==i.length)throw new Error("Matrix sizes don’t match.");const s=[];for(let o=0;o<e.length;++o){const a=[];for(let h=0;h<i[0].length;++h){let c=0;for(let l=0;l<i.length;++l)c+=e[o][l]*i[l][h];a.push(c)}s.push(a)}return s}function Sy(r){const e=[];for(let n=0;n<r[0].length;++n){const i=[];for(let s=0;s<r.length;++s)i.push(r[s][n]);e.push(i)}return e}function sS(r){if(r.length!==r[0].length)throw new Error("Not a square matrix.");const e=r.length;if(e===1)return r[0][0];if(e===2)return r[0][0]*r[1][1]-r[0][1]*r[1][0];let n=0;for(let i=0;i<e;++i){let s=r[0][i],o=r[0][i];for(let a=1;a<e;++a)o*=r[a][(i+a)%e],s*=r[a][(i-a+e)%e];n+=o-s}return n}function Ty(r){const e=r.length;if(e!==r[0].length)throw new Error("Not a square matrix.");const n=My(e),i=ey((s,o)=>r[s][o],e,e);for(let s=0;s<e;++s){let o=i[s][s];if(bt(o,0)){for(let a=s+1;a<e;++a)if(i[a][s]!==0){for(let h=0;h<e;++h)[i[a][h],i[s][h]]=[i[s][h],i[a][h]],[n[a][h],n[s][h]]=[n[s][h],n[a][h]];break}if(o=i[s][s],bt(o,0))throw new Error("Matrix not invertible.")}for(let a=0;a<e;++a)i[s][a]=i[s][a]/o,n[s][a]=n[s][a]/o;for(let a=0;a<e;++a){if(a===s)continue;const h=i[a][s];for(let c=0;c<e;++c)i[a][c]-=h*i[s][c],n[a][c]-=h*n[s][c]}}return n}const rS=Object.freeze(Object.defineProperty({__proto__:null,determinant:sS,fill:vy,identity:My,inverse:Ty,product:eh,reflection:nS,rotation:tS,scalarProduct:iS,shear:eS,sum:_y,transpose:Sy},Symbol.toStringTag,{value:"Module"}));function oS(r){r=r.slice(0);for(let e=r.length-1;e>0;--e){const n=Math.floor(Math.random()*(e+1));[r[e],r[n]]=[r[n],r[e]]}return r}function aS(r,e){const n=e===void 0?0:r,i=e===void 0?r:e-r+1;return n+Math.floor(i*Math.random())}function Ey(r){const e=Math.random()*xe(r);let n=0;return r.findIndex(i=>(n+=i)>=e)}function hS(r){return r[Math.floor(r.length*Math.random())]}const nh=new Map;function cS(r,e){e||(e=Q1()),nh.has(e)||nh.set(e,Bl(1,r));const n=nh.get(e),i=Ey(n.map(s=>s*s));return n[i]-=1,n[i]<=0&&nh.set(e,n.map(s=>s+1)),i}function zy(r=.5){return Math.random()<r?1:0}function lS(r=1,e=.5){let n=0;for(let i=0;i<r;++i)n+=zy(e);return n}function uS(r=1){if(r<=0)return 0;const e=Math.exp(-r);let n=1,i=0;for(;n>e;++i)n*=Math.random();return i-1}function Ul(r=0,e=1){return r+(e-r)*Math.random()}function fS(r=0,e=1){const n=Math.random(),i=Math.random();return Math.sqrt(-2*Math.log(n))*Math.cos(2*Math.PI*i)*Math.sqrt(e)+r}function dS(r=1){return r<=0?0:-Math.log(Math.random())/r}function pS(r=.5){if(!(r<=0||r>1))return Math.floor(Math.log(Math.random())/Math.log(1-r))}function yS(){let r,e,n;do e=2*Math.random()-1,n=2*Math.random()-1,r=e*e+n*n;while(r>=1);return e/n}function xS(r,e=1,n=0){return Math.exp(-((r-e)**2)/(2*n))/Math.sqrt(2*Math.PI*n)}const Ay=7,Cy=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];function Py(r){if(r<.5)return Math.PI/(Math.sin(Math.PI*r)*Py(1-r));r-=1;let e=Cy[0];for(let i=1;i<Ay+2;i++)e+=Cy[i]/(r+i);const n=r+Ay+.5;return Math.sqrt(2*Math.PI)*Math.pow(n,r+.5)*Math.exp(-n)*e}function Iy(r,e,n,i=1){let s=0;for(let o=e;o<n;o+=i)s+=r(o)*i||0;return s}function mS(r,e){return 1-Iy(i=>Math.pow(i,(e-2)/2)*Math.exp(-i/2),0,r)/Math.pow(2,e/2)/Py(e/2)}const gS=Object.freeze(Object.defineProperty({__proto__:null,bernoulli:zy,binomial:lS,cauchy:yS,chiCDF:mS,exponential:dS,find:hS,geometric:pS,integer:aS,integrate:Iy,normal:fS,normalPDF:xS,poisson:uS,shuffle:oS,smart:cS,uniform:Ul,weighted:Ey},Symbol.toStringTag,{value:"Module"}));function wS(r,e){let n=1,i=r[0];for(let s=1;s<r.length;++s)n*=e,i+=n*r[s];return i}function bS(r,e=!1){let n=0,i=0,s=0,o=0;const a=r.length;for(let l=0;l<a;l++)n+=r[l][0],i+=r[l][1],s+=r[l][0]*r[l][0],o+=r[l][0]*r[l][1];if(e)return[0,o/s];const h=(a*o-n*i)/(a*s-n*n);return[i/a-h*n/a,h]}function vS(r){const e=[0,0,0,0,0,0];for(const o of r)e[0]+=o[0],e[1]+=o[1],e[2]+=o[0]*o[0]*o[1],e[3]+=o[1]*Math.log(o[1]),e[4]+=o[0]*o[1]*Math.log(o[1]),e[5]+=o[0]*o[1];const n=e[1]*e[2]-e[5]*e[5],i=Math.exp((e[2]*e[3]-e[5]*e[4])/n),s=(e[1]*e[4]-e[5]*e[3])/n;return[i,s]}function MS(r){const e=[0,0,0,0],n=r.length;for(const o of r)e[0]+=Math.log(o[0]),e[1]+=o[1]*Math.log(o[0]),e[2]+=o[1],e[3]+=Math.pow(Math.log(o[0]),2);const i=(n*e[1]-e[2]*e[0])/(n*e[3]-e[0]*e[0]);return[(e[2]-i*e[0])/n,i]}function _S(r){const e=[0,0,0,0],n=r.length;for(const o of r)e[0]+=Math.log(o[0]),e[1]+=Math.log(o[1])*Math.log(o[0]),e[2]+=Math.log(o[1]),e[3]+=Math.pow(Math.log(o[0]),2);const i=(n*e[1]-e[2]*e[0])/(n*e[3]-e[0]*e[0]);return[Math.exp((e[2]-i*e[0])/n),i]}function ky(r,e=2){const n=r.map(c=>ny(e+1).map(l=>Math.pow(c[0],l))),i=Sy(n),s=r.map(c=>[c[1]]),o=eh(i,n),a=Ty(o);return eh(a,i,s).map(c=>c[0])}function Ry(r,e){const i=r.reduce((a,h)=>a+h[1],0)/r.length,s=r.reduce((a,h)=>a+(h[1]-i)**2,0);return 1-r.reduce((a,h)=>a+(h[1]-e(h[0]))**2,0)/s}function SS(r,e=.85,n=8){if(!(r.length<=1))for(let i=1;i<n;++i){const s=ky(r,i),o=h=>wS(s,h);if(Ry(r,o)>=e)return{order:i,coefficients:s,fn:o}}}const TS=Object.freeze(Object.defineProperty({__proto__:null,bestPolynomial:SS,coefficient:Ry,exponential:vS,linear:bS,logarithmic:MS,polynomial:ky,power:_S},Symbol.toStringTag,{value:"Module"}));function Oy(r){return r.length?xe(r)/r.length:0}function Ly(r,e,n=1){const i=r.length;if(!i)return 0;const s=r.slice(0).sort((h,c)=>h-c);if(e===0)return s[0];if(e===1)return s[i-1];if(![1,2,3].includes(n))throw new RangeError("Invalid quantile method.");const o=n===1?i*e-.5:n===2?(i-1)*e:(i+1)*e-1;if(Number.isInteger(o))return s[o];const a=Math.floor(o);return Ja(s[a],s[a+1],o-a)}function ES(r,e=1){return Ly(r,.5,e)}function zS(r){const e=new Map;let n=-1,i;for(const s of r){e.has(s)||e.set(s,0);const o=e.get(s)+1;e.set(s,o),o===n?i=void 0:o>n&&(n=o,i=s)}return i}function By(r){if(!r.length)return;const e=Oy(r);return r.reduce((i,s)=>i+(s-e)**2,0)/(r.length-1)}function Wl(r){const e=By(r);return e?Math.sqrt(e):0}function Fy(r,e){if(r.length!==e.length)throw new Error("Array length mismatch.");return(r.reduce((i,s,o)=>i+s*e[o],0)-xe(r)*xe(e)/r.length)/r.length}function AS(r,e){if(r.length!==e.length)throw new Error("Array length mismatch.");const n=Fy(r,e),i=Wl(r),s=Wl(e);return n/(i*s)}class ih extends Array{constructor(...e){super();for(const n of e)this.push(n)}get magnitude(){let e=0;for(let n=0;n<this.length;++n)e+=this[n]**2;return Math.sqrt(e)}get unitVector(){return this.scale(1/this.magnitude)}scale(e){return this.map(n=>e*n)}static sum(e,n){if(e.length!==n.length)throw new Error("Mismatched vector sizes.");return e.map((i,s)=>i+n[s])}static difference(e,n){if(e.length!==n.length)throw new Error("Mismatched vector sizes.");return e.map((i,s)=>i-n[s])}static product(e,n){if(e.length!==n.length)throw new Error("Mismatched vector sizes.");return e.map((i,s)=>i*n[s])}static dot(e,n){return xe(ih.product(e,n))}static cross(e,n){if(e.length!==3||n.length!==3)throw new Error("Cross product requires vectors of size 3.");return new ih(e[1]*n[2]-e[2]*n[1],e[2]*n[0]-e[0]*n[2],e[0]*n[1]-e[1]*n[0])}static equals(e,n){const i=e.length;if(i!==n.length)return!1;for(let s=0;s<i;++s)if(!bt(e[s],n[s]))return!1;return!0}}const CS=Object.freeze(Object.defineProperty({__proto__:null,Complex:Yt,Matrix:rS,Random:gS,Regression:TS,Vector:ih,XNumber:Rt,binomial:yy,clamp:vn,correlation:AS,covariance:Fy,cube:W3,digits:U3,eulerPhi:Q3,factorial:H3,gcd:ro,generatePrime:G3,goldbach:J3,isBetween:bn,isInteger:ii,isPrime:oo,lcm:Ka,lerp:Ja,listPrimes:Z3,log:j3,mean:Oy,median:ES,mod:dy,mode:zS,nearlyEquals:bt,numberFormat:io,parseNumber:N3,permutations:X3,polynomial:Y3,primeFactorisation:th,primeFactors:wy,quadratic:py,quantile:Ly,round:so,roundTo:Vl,scientificFormat:O3,sign:ly,square:on,stdDev:Wl,subsets:my,toOrdinal:q3,toWord:V3,variance:By},Symbol.toStringTag,{value:"Module"})),pe=2*Math.PI;function sr(r,e){const n=Math.atan2(r.y-(e?e.y:0),r.x-(e?e.x:0));return dy(n,pe)}function Ny(r,e){let n,i=1/0,s=-1;for(const[o,a]of e.entries()){const h=a.project(r),c=st.distance(r,h);c<i&&(n=h,i=c,s=o)}return n?[n,s]:void 0}let st=class qt{constructor(e=0,n=0){this.x=e,this.y=n}type="point";get unitVector(){return bt(this.length,0)?new qt(1,0):this.scale(1/this.length)}get length(){return Math.sqrt(this.x**2+this.y**2)}get inverse(){return new qt(-this.x,-this.y)}get flip(){return new qt(this.y,this.x)}get perpendicular(){return new qt(-this.y,this.x)}get array(){return[this.x,this.y]}distanceFromLine(e){return qt.distance(this,e.project(this))}clamp(e,n=0){const i=vn(this.x,e.xMin+n,e.xMax-n),s=vn(this.y,e.yMin+n,e.yMax-n);return new qt(i,s)}changeCoordinates(e,n){const i=n.xMin+(this.x-e.xMin)/e.dx*n.dx,s=n.yMin+(this.y-e.yMin)/e.dy*n.dy;return new qt(i,s)}add(e){return qt.sum(this,e)}subtract(e){return qt.difference(this,e)}round(e=1){return new qt(Vl(this.x,e),Vl(this.y,e))}floor(){return new qt(Math.floor(this.x),Math.floor(this.y))}mod(e,n=e){return new qt(this.x%e,this.y%n)}angle(e=We){return sr(this,e)}snap(e,n=5){return bt(this.x,e.x,n)?new qt(e.x,this.y):bt(this.y,e.y,n)?new qt(this.x,e.y):this}static average(...e){const n=xe(e.map(s=>s.x))/e.length,i=xe(e.map(s=>s.y))/e.length;return new qt(n,i)}static dot(e,n){return e.x*n.x+e.y*n.y}static sum(e,n){return new qt(e.x+n.x,e.y+n.y)}static difference(e,n){return new qt(e.x-n.x,e.y-n.y)}static distance(e,n){return Math.sqrt(on(e.x-n.x)+on(e.y-n.y))}static manhattan(e,n){return Math.abs(e.x-n.x)+Math.abs(e.y-n.y)}static interpolate(e,n,i=.5){return new qt(Ja(e.x,n.x,i),Ja(e.y,n.y,i))}static interpolateList(e,n=.5){const i=e.length-1,s=Math.floor(vn(n,0,1)*i);return qt.interpolate(e[s],e[s+1],i*n-s)}static fromPolar(e,n=1){return new qt(n*Math.cos(e),n*Math.sin(e))}static random(e){const n=Ul(e.xMin,e.xMax),i=Ul(e.yMin,e.yMax);return new qt(n,i)}static equals(e,n,i){return bt(e.x,n.x,i)&&bt(e.y,n.y,i)}static colinear(e,n,i,s){const o=e.x-n.x,a=e.y-n.y,h=n.x-i.x,c=n.y-i.y;return bt(o*c,h*a,s)}transform(e){const n=e[0][0]*this.x+e[0][1]*this.y+e[0][2],i=e[1][0]*this.x+e[1][1]*this.y+e[1][2];return new qt(n,i)}rotate(e,n=We){if(bt(e,0))return this;const i=this.x-n.x,s=this.y-n.y,o=Math.cos(e),a=Math.sin(e),h=i*o-s*a+n.x,c=i*a+s*o+n.y;return new qt(h,c)}reflect(e){const n=e.p2.x-e.p1.x,i=e.p2.y-e.p1.y,s=this.x-e.p1.x,o=this.y-e.p1.y,a=(n*o-i*s)/(n*n+i*i),h=this.x+2*a*i,c=this.y-2*a*n;return new qt(h,c)}scale(e,n=e){return new qt(this.x*e,this.y*n)}shift(e,n=e){return new qt(this.x+e,this.y+n)}translate(e){return this.shift(e.x,e.y)}equals(e,n){return qt.equals(this,e,n)}toString(){return`point(${this.x},${this.y})`}};const We=new st(0,0);function sh(r){return["polygon","polyline","rectangle","triangle"].includes(r.type)}function qy(r){return["polygon","triangle"].includes(r.type)}function jl(r){return r.type==="polyline"}function Yl(r){return r.type==="rectangle"}function ss(r){return["line","ray","segment"].includes(r.type)}function Dy(r){return r.type==="line"}function ao(r){return r.type==="ray"}function ho(r){return r.type==="segment"}function rs(r){return r.type==="circle"}function Hl(r){return r.type==="ellipse"}function co(r){return r.type==="arc"}function $y(r){return r.type==="sector"}function lo(r){return r.type==="angle"}function PS(r){return r.type==="point"}class ce{constructor(e,n){this.p1=e,this.p2=n}type="line";flag;["constructor"];get length(){return st.distance(this.p1,this.p2)}get lengthSquared(){return(this.p1.x-this.p2.x)**2+(this.p1.y-this.p2.y)**2}get midpoint(){return st.average(this.p1,this.p2)}get slope(){return(this.p2.y-this.p1.y)/(this.p2.x-this.p1.x)}get intercept(){return this.p1.y-this.slope*this.p1.x}get angle(){return sr(this.p2,this.p1)}get unitVector(){return this.p2.subtract(this.p1).unitVector}get perpendicularVector(){return new st(this.p2.y-this.p1.y,this.p1.x-this.p2.x).unitVector}parallel(e){return new ce(e,e.add(this.p2).subtract(this.p1))}perpendicular(e){const n=this.line.project(e);return st.equals(e,n)?new ce(n,n.add(this.perpendicularVector.scale(this.length/2))):new ce(n,e)}get perpendicularBisector(){return this.perpendicular(this.midpoint)}distanceSquared(e){const n=this.project(e);return(e.x-n.x)**2+(e.y-n.y)**2}get line(){return this.type==="line"?this:new ce(this.p1,this.p2)}get ray(){return ao(this)?this:new Vy(this.p1,this.p2)}get segment(){return ho(this)?this:new os(this.p1,this.p2)}offset(e){const n=st.difference(this.p2,this.p1),i=st.difference(e,this.p1);return st.dot(n,i)/this.lengthSquared}project(e){return this.at(this.offset(e))}side(e,n){const i=st.difference(this.p2,this.p1),s=st.difference(e,this.p1),o=s.x*i.y-s.y*i.x;return bt(o,0,n)?0:Math.sign(o)}contains(e,n){return this.side(e,n)===0}at(e){return st.interpolate(this.p1,this.p2,e)}transform(e){return new this.constructor(this.p1.transform(e),this.p2.transform(e))}rotate(e,n=We){return bt(e,0)?this:new this.constructor(this.p1.rotate(e,n),this.p2.rotate(e,n))}reflect(e){return new this.constructor(this.p1.reflect(e),this.p2.reflect(e))}scale(e,n=e){return new this.constructor(this.p1.scale(e,n),this.p2.scale(e,n))}shift(e,n=e){return new this.constructor(this.p1.shift(e,n),this.p2.shift(e,n))}translate(e){return this.shift(e.x,e.y)}equals(e,n){return this.contains(e.p1,n)&&this.contains(e.p2,n)}toString(){return`line(${this.p1},${this.p2})`}}let Vy=class extends ce{type="ray";equals(e,n){return e.type!=="ray"||!this.p1.equals(e.p1,n)?!1:this.p2.equals(e.p2,n)?!0:e.contains(this.p2,n)||this.contains(e.p2,n)}contains(e,n){if(!super.contains(e,n))return!1;const i=this.offset(e);return bt(i,0,n)||i>0}toString(){return`ray(${this.p1},${this.p2})`}};class os extends ce{type="segment";contains(e,n){return super.contains(e,n)?this.p1.equals(e,n)||this.p2.equals(e,n)?!0:bt(this.p1.x,this.p2.x,n)?bn(e.y,this.p1.y,this.p2.y):bn(e.x,this.p1.x,this.p2.x):!1}project(e){const n=st.difference(this.p2,this.p1),i=st.difference(e,this.p1),s=vn(st.dot(n,i)/this.lengthSquared,0,1);return this.p1.add(n.scale(s))}contract(e){return new os(this.at(e),this.at(1-e))}equals(e,n,i=!1){return e.type!=="segment"?!1:this.p1.equals(e.p1,n)&&this.p2.equals(e.p2,n)||!i&&this.p1.equals(e.p2,n)&&this.p2.equals(e.p1,n)}toString(){return`segment(${this.p1},${this.p2})`}}let rh=class Pr{constructor(e=We,n=1){this.c=e,this.r=n}type="circle";get circumference(){return pe*this.r}get area(){return Math.PI*this.r**2}get arc(){const e=this.c.shift(this.r,0);return new uo(this.c,e,pe)}tangentAt(e){const n=this.at(e),i=this.c.rotate(Math.PI/2,n);return new ce(n,i)}collision(e){const n=this.c.x<e.p.x?e.p.x:this.c.x>e.p.x+e.w?e.p.x+e.w:this.c.x,i=this.c.y<e.p.y?e.p.y:this.c.y>e.p.y+e.h?e.p.y+e.h:this.c.y;return st.distance(this.c,new st(n,i))<=this.r}project(e){const n=e.subtract(this.c).unitVector.scale(this.r);return st.sum(this.c,n)}at(e){const n=pe*e;return this.c.shift(this.r*Math.cos(n),this.r*Math.sin(n))}offset(e){return sr(e,this.c)/pe}contains(e){return st.distance(e,this.c)<=this.r}transform(e){const n=Math.abs(e[0][0])+Math.abs(e[1][1]);return new Pr(this.c.transform(e),this.r*n/2)}rotate(e,n=We){return bt(e,0)?this:new Pr(this.c.rotate(e,n),this.r)}reflect(e){return new Pr(this.c.reflect(e),this.r)}scale(e,n=e){return new Pr(this.c.scale(e,n),this.r*(e+n)/2)}shift(e,n=e){return new Pr(this.c.shift(e,n),this.r)}translate(e){return this.shift(e.x,e.y)}equals(e,n){return bt(this.r,e.r,n)&&this.c.equals(e.c,n)}toString(){return`circle(${this.c},${this.r})`}};class uo{constructor(e,n,i){this.c=e,this.start=n,this.angle=i}type="arc";["constructor"];get circle(){return new rh(this.c,this.radius)}get radius(){return st.distance(this.c,this.start)}get end(){return this.start.rotate(this.angle,this.c)}get startAngle(){return sr(this.start,this.c)}contract(e){return new this.constructor(this.c,this.at(e/2),this.angle*(1-e))}get minor(){return this.angle<=Math.PI?this:new this.constructor(this.c,this.end,pe-this.angle)}get major(){return this.angle>=Math.PI?this:new this.constructor(this.c,this.end,pe-this.angle)}get center(){return this.at(.5)}project(e){const n=this.startAngle,i=n+this.angle;let s=sr(e,this.c);return i>pe&&s<i-pe&&(s+=pe),s=vn(s,n,i),this.c.shift(this.radius,0).rotate(s,this.c)}at(e){return this.start.rotate(this.angle*e,this.c)}offset(e){return new Ae(this.start,this.c,e).rad/this.angle}contains(e){return e.equals(this.project(e))}transform(e){return new this.constructor(this.c.transform(e),this.start.transform(e),this.angle)}rotate(e,n=We){return bt(e,0)?this:new this.constructor(this.c.rotate(e,n),this.start.rotate(e,n),this.angle)}reflect(e){return new this.constructor(this.c.reflect(e),this.start.reflect(e),this.angle)}scale(e,n=e){return new this.constructor(this.c.scale(e,n),this.start.scale(e,n),this.angle)}shift(e,n=e){return new this.constructor(this.c.shift(e,n),this.start.shift(e,n),this.angle)}translate(e){return this.shift(e.x,e.y)}equals(){return!1}toString(){return`arc(${this.c},${this.start},${this.angle})`}}class Uy extends uo{type="sector";contains(e){return st.distance(e,this.c)<=this.radius&&new Ae(this.start,this.c,e).rad<=this.angle}toString(){return`sector(${this.c},${this.start},${this.angle})`}}function IS(r,e){return bt(r.p1.x,r.p2.x)?bn(e.y,r.p1.y,r.p2.y):bn(e.x,r.p1.x,r.p2.x)}function kS(r,e){return bt(r.p1.x,r.p2.x)?(e.y-r.p1.y)/(r.p2.y-r.p1.y)>0:(e.x-r.p1.x)/(r.p2.x-r.p1.x)>0}function RS(r,e){return bn(r.offset(e),0,1)}function OS(r,e){const n=r.p1.x-r.p2.x,i=r.p1.y-r.p2.y,s=e.p1.x-e.p2.x,o=e.p1.y-e.p2.y,a=n*o-i*s;if(bt(a,0))return[];const h=r.p1.x*r.p2.y-r.p1.y*r.p2.x,c=e.p1.x*e.p2.y-e.p1.y*e.p2.x,l=h*s-n*c,u=h*o-i*c;return[new st(l/a,u/a)]}function LS(r,e){const n=st.distance(r.c,e.c);if(n>r.r+e.r)return[];if(n<Math.abs(r.r-e.r))return[];if(bt(n,0)&&bt(r.r,e.r))return[];if(bt(n,r.r+e.r))return[new ce(r.c,e.c).midpoint];const i=(on(r.r)-on(e.r)+on(n))/(2*n),s=Math.sqrt(on(r.r)-on(i)),o=(e.c.x-r.c.x)*i/n+(e.c.y-r.c.y)*s/n+r.c.x,a=(e.c.y-r.c.y)*i/n-(e.c.x-r.c.x)*s/n+r.c.y,h=(e.c.x-r.c.x)*i/n-(e.c.y-r.c.y)*s/n+r.c.x,c=(e.c.y-r.c.y)*i/n+(e.c.x-r.c.x)*s/n+r.c.y;return[new st(o,a),new st(h,c)]}function Wy(r,e){const n=r.p2.x-r.p1.x,i=r.p2.y-r.p1.y,s=on(n)+on(i),o=e.c.x,a=e.c.y,h=(r.p1.x-o)*(r.p2.y-a)-(r.p2.x-o)*(r.p1.y-a),c=on(e.r)*s-on(h);if(c<0)return[];const l=h*i/s,u=-h*n/s;if(bt(c,0))return[e.c.shift(l,u)];const f=n*(i<0?-1:1)*Math.sqrt(c)/s,d=Math.abs(i)*Math.sqrt(c)/s;return[e.c.shift(l+f,u+d),e.c.shift(l-f,u-d)]}function BS(r,e){let n=[];const i=co(r)?r.circle:r,s=co(e)?e.circle:e;ss(r)&&ss(e)?n=OS(r,e):ss(i)&&rs(s)?n=Wy(i,s):rs(i)&&ss(s)?n=Wy(s,i):rs(i)&&rs(s)&&(n=LS(i,s));for(const o of[r,e])ho(o)&&(n=n.filter(a=>IS(o,a))),ao(o)&&(n=n.filter(a=>kS(o,a))),co(o)&&(n=n.filter(a=>RS(o,a)));return n}function zi(...r){if(r.length<2)return[];if(r.length>2)return ql(my(r,2).map(i=>zi(...i)));let[e,n]=r;if(lo(e)&&(e=e.shape(!0)),lo(n)&&(n=n.shape(!0)),sh(n)&&([e,n]=[n,e]),sh(e)){const i=ss(n)?e.points.filter(s=>n.contains(s)):[];for(const s of e.edges)i.push(...zi(s,n));return i}return BS(e,n)}let rr=class Yo{type="polygon";points;["constructor"];constructor(...e){this.points=e}get circumference(){if(this.points.length<=1)return 0;let e=st.distance(this.points[0],Nl(this.points));for(let n=1;n<this.points.length;++n)e+=st.distance(this.points[n-1],this.points[n]);return e}get signedArea(){const e=this.points,n=e.length;let i=e[n-1].x*e[0].y-e[0].x*e[n-1].y;for(let s=1;s<n;++s)i+=e[s-1].x*e[s].y-e[s].x*e[s-1].y;return i/2}get area(){return Math.abs(this.signedArea)}get centroid(){const e=this.points,n=e.length;let i=0;for(let o=0;o<n;++o)i+=e[o].x;let s=0;for(let o=0;o<n;++o)s+=e[o].y;return new st(i/n,s/n)}get edges(){const e=this.points.length,n=[];for(let i=0;i<e;++i)n.push(new os(this.points[i],this.points[(i+1)%e]));return n}get radius(){const e=this.centroid,n=this.points.map(i=>st.distance(i,e));return Math.max(...n)}get oriented(){if(this.signedArea>=0)return this;const e=[...this.points].reverse();return new this.constructor(...e)}static collision(e,n,i){if(e.points.some(s=>n.contains(s))||n.points.some(s=>e.contains(s)))return!0;for(const s of e.edges)for(const o of n.edges)if(zi(s,o)[0])return!0;return e.equals(n,i)}static regular(e,n=1){const i=pe/e,s=Math.PI/2-i/2,o=Ha(a=>st.fromPolar(s+i*a,n),e);return new Yo(...o)}static interpolate(e,n,i=.5){const s=e.points.map((o,a)=>st.interpolate(o,n.points[a],i));return new Yo(...s)}static convexHull(...e){if(e.length<=3)return new Yo(...e);const n=e.sort((a,h)=>a.x!==h.x?a.x-h.x:a.y-h.y),i=n.slice(0).reverse(),s=[],o=[];for(const[a,h]of[[n,s],[i,o]]){for(const c of a){for(;h.length>=2;){const l=h[h.length-1],u=h[h.length-2];if((l.x-u.x)*(c.y-u.y)>=(c.x-u.x)*(l.y-u.y))h.pop();else break}h.push(c)}h.pop()}return new Yo(...s.concat(o))}contains(e){let n=!1;for(const i of this.edges){if(i.p1.equals(e)||i.contains(e))return!1;if(i.p1.y>e.y==i.p2.y>e.y)continue;const s=(i.p2.x-i.p1.x)/(i.p2.y-i.p1.y);e.x<s*(e.y-i.p1.y)+i.p1.x&&(n=!n)}return n}at(e){e<0&&(e+=Math.floor(e));const n=e*this.circumference;let i=0;for(const s of this.edges){const o=s.length;if(i+o>n)return s.at((n-i)/o);i+=o}return this.points[0]}offset(e){const n=this.edges,i=Ny(e,this.edges)||[this.points[0],0];let s=0;for(let o=0;o<i[1];++o)s+=n[o].length;return s+=n[i[1]].offset(e)*n[i[1]].length,s/this.circumference}project(e){const n=Ny(e,this.edges);return n?n[0]:this.points[0]}centerAt(e=We){return this.translate(e.subtract(this.centroid))}transform(e){return new this.constructor(...this.points.map(n=>n.transform(e)))}rotate(e,n=We){if(bt(e,0))return this;const i=this.points.map(s=>s.rotate(e,n));return new this.constructor(...i)}reflect(e){const n=this.points.map(i=>i.reflect(e));return new this.constructor(...n)}scale(e,n=e){const i=this.points.map(s=>s.scale(e,n));return new this.constructor(...i)}shift(e,n=e){const i=this.points.map(s=>s.shift(e,n));return new this.constructor(...i)}translate(e){return this.shift(e.x,e.y)}equals(e,n,i){const s=this.points.length;if(s!==e.points.length)return!1;const o=i?this:this.oriented,a=i?e:e.oriented;for(let h=0;h<s;++h)if(o.points.every((c,l)=>c.equals(a.points[(l+h)%s],n)))return!0;return!1}toString(){return`polygon(${this.points.join(",")})`}};class jy extends rr{type="polyline";get circumference(){return this.length}get length(){let e=0;for(let n=1;n<this.points.length;++n)e+=st.distance(this.points[n-1],this.points[n]);return e}get edges(){const e=[];for(let n=0;n<this.points.length-1;++n)e.push(new os(this.points[n],this.points[n+1]));return e}toString(){return`polyline(${this.points.join(",")})`}}let FS=class extends rr{type="triangle";get circumcircle(){const[e,n,i]=this.points,s=2*(e.x*(n.y-i.y)+n.x*(i.y-e.y)+i.x*(e.y-n.y)),o=(e.x**2+e.y**2)*(n.y-i.y)+(n.x**2+n.y**2)*(i.y-e.y)+(i.x**2+i.y**2)*(e.y-n.y),a=(e.x**2+e.y**2)*(i.x-n.x)+(n.x**2+n.y**2)*(e.x-i.x)+(i.x**2+i.y**2)*(n.x-e.x),h=new st(o/s,a/s),c=st.distance(h,this.points[0]);if(!(isNaN(c)||c>Number.MAX_SAFE_INTEGER))return new rh(h,c)}get incircle(){const e=this.edges,n=e.map(f=>f.length),i=n[0]+n[1]+n[2],[s,o,a]=this.points,h=n[1]*s.x+n[2]*o.x+n[0]*a.x,c=n[1]*s.y+n[2]*o.y+n[0]*a.y,l=new st(h/i,c/i),u=l.distanceFromLine(e[0]);return isNaN(u)?void 0:new rh(l,u)}get orthocenter(){const[e,n,i]=this.points,s=new ce(e,n).perpendicular(i),o=new ce(e,i).perpendicular(n);return zi(s,o)[0]}};const NS=180/Math.PI,qS=Math.PI/180;function Yy(r){return r*NS}function DS(r){return r*qS}class Ae{constructor(e,n,i){this.a=e,this.b=n,this.c=i}type="angle";static fromDegrees(e){return Ae.fromRadians(e*(Math.PI/180))}static fromRadians(e){const n=new st(1,0),i=n.rotate(e);return new Ae(n,We,i)}static equals(e,n,i=Math.PI/360){return bt(e.rad,n.rad,i)}get rad(){const e=Math.atan2(this.a.y-this.b.y,this.a.x-this.b.x);let i=Math.atan2(this.c.y-this.b.y,this.c.x-this.b.x)-e;return i<0&&(i+=pe),i}get deg(){return this.rad*180/Math.PI}get isRight(){return bt(this.rad,Math.PI/2,Math.PI/360)}get bisector(){if(this.b.equals(this.a)||this.b.equals(this.c))return;const e=Math.atan2(this.a.y-this.b.y,this.a.x-this.b.x),n=Math.atan2(this.c.y-this.b.y,this.c.x-this.b.x);let i=(e+n)/2;e>n&&(i+=Math.PI);const s=Math.cos(i)+this.b.x,o=Math.sin(i)+this.b.y;return new ce(this.b,new st(s,o))}get sup(){return this.rad<Math.PI?this:new Ae(this.c,this.b,this.a)}get arc(){return new uo(this.b,this.a,this.rad)}get radius(){return 24+20*(1-vn(this.rad,0,Math.PI)/Math.PI)}shape(e=!0,n,i){if(this.a.equals(this.b)||this.c.equals(this.b))return new rr(We);const s=this.isRight&&!i;n||(n=s?20:this.radius);const o=new os(this.b,this.a),a=o.at(n/o.length);if(s){const h=st.difference(this.c,this.b).unitVector.scale(n);return e?new rr(this.b,a,a.add(h),this.b.add(h)):new jy(a,a.add(h),this.b.add(h))}return e?new Uy(this.b,a,this.rad):new uo(this.b,a,this.rad)}project(e){return this.contains(e)?e:this.shape(!0).project(e)}at(){return this.c}offset(){return 0}contains(e){return this.shape(!0).contains(e)}transform(e){return new Ae(this.a.transform(e),this.b.transform(e),this.c.transform(e))}rotate(e,n){return bt(e,0)?this:new Ae(this.a.rotate(e,n),this.b.rotate(e,n),this.c.rotate(e,n))}reflect(e){return new Ae(this.a.reflect(e),this.b.reflect(e),this.c.reflect(e))}scale(e,n=e){return new Ae(this.a.scale(e,n),this.b.scale(e,n),this.c.scale(e,n))}shift(e,n=e){return new Ae(this.a.shift(e,n),this.b.shift(e,n),this.c.shift(e,n))}translate(e){return new Ae(this.a.translate(e),this.b.translate(e),this.c.translate(e))}equals(e,n){return Ae.equals(e,this,n)}toString(){return`angle(${this.a},${this.b},${this.c})`}}let Hy=class Ir{constructor(e,n=1,i=n){this.p=e,this.w=n,this.h=i}type="rectangle";static aroundPoints(e){let n=1/0,i=-1/0,s=1/0,o=-1/0;for(const a of e)n=n<a.x?n:a.x,i=i>a.x?i:a.x,s=s<a.y?s:a.y,o=o>a.y?o:a.y;return new Ir(new st(n,s),i-n,o-s)}get center(){return new st(this.p.x+this.w/2,this.p.y+this.h/2)}get centroid(){return this.center}get circumference(){return 2*Math.abs(this.w)+2*Math.abs(this.h)}get area(){return Math.abs(this.signedArea)}get signedArea(){return this.w*this.h}get edges(){return this.polygon.edges}get points(){return this.polygon.points}get polygon(){const e=new st(this.p.x+this.w,this.p.y),n=new st(this.p.x+this.w,this.p.y+this.h),i=new st(this.p.x,this.p.y+this.h);return new rr(this.p,e,n,i)}get bounds(){return new or(this.p.x,this.p.x+this.w,this.p.y,this.p.y+this.h)}collision(e){return this.p.x<e.p.x+e.w&&this.p.x+this.w>e.p.x&&this.p.y<e.p.y+e.h&&this.p.y+this.h>e.p.y||this.equals(e.polygon)}padding(e,n,i,s){return new Ir(this.p.shift(-s,-e),this.w+s+n,this.h+e+i)}get unsigned(){if(this.w>0&&this.h>0)return this;const e=this.p.shift(this.w<0?this.w:0,this.h<0?this.h:0);return new Ir(e,Math.abs(this.w),Math.abs(this.h))}contains(e,n){return bn(e.x,this.p.x,this.p.x+this.w,n)&&bn(e.y,this.p.y,this.p.y+this.h,n)}project(e){let n;for(const i of this.edges){const s=i.project(e);(!n||st.distance(e,s)<st.distance(e,n))&&(n=s)}return n}at(e){return this.polygon.at(e)}offset(e){return this.polygon.offset(e)}get oriented(){return this.polygon.oriented}transform(e){return this.polygon.transform(e)}rotate(e,n=We){return bt(e,0)?this:this.polygon.rotate(e,n)}reflect(e){return this.polygon.reflect(e)}scale(e,n=e){return new Ir(this.p.scale(e,n),this.w*e,this.h*n)}shift(e,n=e){return new Ir(this.p.shift(e,n),this.w,this.h)}translate(e){return this.shift(e.x,e.y)}equals(e){return this.polygon.equals(e)}toString(){return`rectangle(${this.p},${this.w},${this.h})`}};class or{constructor(e,n,i,s,o){this.xMin=e,this.xMax=n,this.yMin=i,this.yMax=s,o==="swap"?(this.dx<0&&([this.xMin,this.xMax]=[n,e]),this.dy<0&&([this.yMin,this.yMax]=[s,i])):o==="center"&&(this.dx<0&&(this.xMin=this.xMax=(e+n)/2),this.dy<0&&(this.yMin=this.yMax=(i+s)/2))}contains(e){return this.containsX(e)&&this.containsY(e)}containsX(e){return bn(e.x,this.xMin,this.xMax)}containsY(e){return bn(e.y,this.yMin,this.yMax)}resize(e,n){return new or(this.xMin,this.xMax+e,this.yMin,this.yMax+n)}get dx(){return this.xMax-this.xMin}get dy(){return this.yMax-this.yMin}get xRange(){return[this.xMin,this.xMax]}get yRange(){return[this.yMin,this.yMax]}extend(e,n=e,i=e,s=n){return new or(this.xMin-s,this.xMax+n,this.yMin-e,this.yMax+i)}get rect(){return new Hy(new st(this.xMin,this.yMin),this.dx,this.dy)}get center(){return new st(this.xMin+this.dx/2,this.yMin+this.dy/2)}get flip(){return new or(this.yMin,this.yMax,this.xMin,this.xMax)}}function Xy(r,e,n={}){if(lo(e))return Xy(r,e.shape(!!n.fill),n);if(n.fill&&(r.fillStyle=n.fill),n.opacity&&(r.globalAlpha=n.opacity),n.stroke&&(r.strokeStyle=n.stroke,r.lineWidth=n.strokeWidth||1,n.lineCap&&(r.lineCap=n.lineCap),n.lineJoin&&(r.lineJoin=n.lineJoin)),r.beginPath(),ho(e))r.moveTo(e.p1.x,e.p1.y),r.lineTo(e.p2.x,e.p2.y);else if(ss(e)){if(!n.box)return;let[i,s]=zi(e,n.box);if(ao(e)&&(s=e.p1),!i||!s)return;r.moveTo(i.x,i.y),r.lineTo(s.x,s.y)}else if(rs(e))r.arc(e.c.x,e.c.y,e.r,0,pe);else if(sh(e)){const i=e.points;r.moveTo(i[0].x,i[0].y);for(const s of i.slice(1))r.lineTo(s.x,s.y);r.closePath()}else if(jl(e)){r.moveTo(e.points[0].x,e.points[0].y);for(const i of e.points.slice(1))r.lineTo(i.x,i.y)}else Hl(e)&&r.ellipse(e.c.x,e.c.y,e.a,e.b,e.angle,0,pe);n.fill&&r.fill(),n.stroke&&r.stroke()}const $S=4*(Math.sqrt(2)-1)/3;function Zy(r,e,n){const s=e.x*(n.y-r.y)+r.x*(e.y-n.y)+n.x*(r.y-e.y)>0?1:0,o=st.distance(e,r);return[r.x,`${r.y}A${o}`,o,0,s,1,n.x,n.y].join(",")}function je(...r){return`M${r.map(e=>`${e.x},${e.y}`).join("L")}`}function Xl(r,e){const n=r.perpendicularVector.scale(6),i=r.unitVector.scale(3),s=r.midpoint;switch(e){case"bar":return je(s.add(n),s.add(n.inverse));case"bar2":return je(s.add(i).add(n),s.add(i).add(n.inverse))+je(s.add(i.inverse).add(n),s.add(i.inverse).add(n.inverse));case"arrow":return je(s.add(i.inverse).add(n),s.add(i),s.add(i.inverse).add(n.inverse));case"arrow2":return je(s.add(i.scale(-2)).add(n),s,s.add(i.scale(-2)).add(n.inverse))+je(s.add(n),s.add(i.scale(2)),s.add(n.inverse));default:return""}}function oh(r,e){if(!r||!e)return"";const n=e.perpendicular,i=r.add(e.scale(9)).add(n.scale(9)),s=r.add(e.scale(9)).add(n.scale(-9));return je(i,r,s)}function VS(r,e){let n="";return no(e,"start","both")&&(n+=oh(r.p1,r.unitVector)),no(e,"end","both")&&(n+=oh(r.p2,r.unitVector.inverse)),n}function US(r,e){let n="";if(no(e,"start","both")){const i=new ce(r.c,r.start).perpendicularVector.inverse;n+=oh(r.start,i)}if(no(e,"end","both")){const i=new ce(r.c,r.end).perpendicularVector;n+=oh(r.end,i)}return n}function Zl(r,e){const n=st.distance(r[0],r[1]),i=st.distance(r[1],r[2]),s=Math.max(.1,n/2),o=Math.max(.1,i/2),a=Math.min(e,s,o),h=a/n,c=a/i,l=1-$S,u=st.interpolate(r[0],r[1],vn(1-h,0,1)),f=st.interpolate(r[0],r[1],vn(1-h*l,0,1)),d=st.interpolate(r[1],r[2],vn(c*l,0,1)),p=st.interpolate(r[1],r[2],vn(c,0,1));return[u,f,d,p]}function Gy(r,e,n=!1){e<0&&(e=0);let i="M";if(!n)i+=`${r[0].x} ${r[0].y}`;else{const s=r[r.length-1],o=r[0],a=r[1],h=Zl([s,o,a],e);i+=`${h[3].x} ${h[3].y}`}for(let s=0;s<r.length;s++)if(s<r.length-2||n){const o=r[s],a=r[(s+1)%r.length],h=r[(s+2)%r.length],c=Zl([o,a,h],e).map(l=>`${l.x} ${l.y}`);i+=`L${c[0]}C${c[1]} ${c[2]} ${c[3]}`}else s===r.length-2&&!n&&(i+=`L${r[s+1].x} ${r[s+1].y}`);return i}function WS(r,e,n=e,i=e,s=n){const{p:o,w:a,h}=r;return`M${o.x} ${o.y+e}a${e} ${e} 0 0 1 ${e} ${-e}h${a-e-n}a${n} ${n} 0 0 1 ${n} ${n}v${h-n-i}a${i} ${i} 0 0 1 ${-i} ${i}h${-a+s+i}a${s} ${s} 0 0 1 ${-s} ${-s}Z`}function Jy(r,e={}){if(lo(r)){const n=r.shape(!!e.fill,e.size,e.round);return Jy(n,e)}if(ho(r)){if(r.p1.equals(r.p2))return"";let n=je(r.p1,r.p2);return e.mark&&(n+=Xl(r,e.mark)),e.arrows&&(n+=VS(r,e.arrows)),n}if(ao(r)){if(!e.box)return"";const n=zi(r,e.box)[0];if(!n)return"";let i=je(r.p1,n);return e.mark&&(i+=Xl(r,e.mark)),i}if(Dy(r)){if(!e.box)return"";const n=zi(r,e.box);if(n.length<2)return"";let i=je(n[0],n[1]);return e.mark&&(i+=Xl(r,e.mark)),i}if(rs(r))return`M${r.c.x-r.r} ${r.c.y}a${r.r},${r.r} 0 1 0 ${2*r.r} 0a${r.r} ${r.r} 0 1 0 ${-2*r.r} 0Z`;if(Hl(r)){const[n,i]=r.majorVertices,s=Yy(r.angle);return`M${n.x} ${n.y}A${r.a} ${r.b} ${s} 0 0 ${i.x} ${i.y}A${r.a} ${r.b} ${s} 0 0 ${n.x} ${n.y}Z`}if(co(r)){let n=`M${Zy(r.start,r.c,r.end)}`;return e.arrows&&(n+=US(r,e.arrows)),n}return $y(r)?`M${r.c.x} ${r.c.y} L ${Zy(r.start,r.c,r.end)}Z`:jl(r)?e.cornerRadius?Gy(r.points,e.cornerRadius,!1):je(...r.points):qy(r)||Yl(r)&&e.cornerRadius?e.cornerRadius?Gy(r.points,e.cornerRadius,!0):`${je(...r.points)}Z`:Yl(r)?`${je(...r.polygon.points)}Z`:""}const jS=Object.freeze(Object.defineProperty({__proto__:null,mathigon:{core:P3,fermat:CS,euclid:Object.freeze(Object.defineProperty({__proto__:null,Angle:Ae,Arc:uo,Bounds:or,Circle:rh,Ellipse:class Ds{constructor(e,n,i,s=0){this.c=e,n<i&&([n,i]=[i,n],s+=Math.PI/2),this.a=n,this.b=i,this.angle=s;const o=Math.sqrt(n**2-i**2);this.f1=this.c.add(new st(-o,0).rotate(s)),this.f2=this.c.add(new st(o,0).rotate(s))}type="ellipse";a;b;angle;f1;f2;get rx(){return bt(this.angle,0)?this.a:bt(this.angle,Math.PI/2)?this.b:void 0}get ry(){return bt(this.angle,0)?this.b:bt(this.angle,Math.PI/2)?this.a:void 0}normalAt(e){return new Ae(this.f1,e,this.f2).bisector}intersect(e){e=e.rotate(-this.angle,this.c);const n=e.p1.x-e.p2.x,i=e.p1.y-e.p2.y,s=this.c.x-e.p1.x,o=this.c.y-e.p1.y,a=(n/this.a)**2+(i/this.b)**2,h=2*s*n/this.a**2+2*o*i/this.b**2,c=(s/this.a)**2+(o/this.b)**2-1;return py(a,h,c).map(u=>e.at(u).rotate(this.angle,this.c))}static fromFoci(e,n,i){const s=st.distance(e,n)/2,o=i/2,a=Math.sqrt(o**2-s**2),h=new ce(e,n).angle;return new Ds(st.interpolate(e,n),o,a,h)}get majorVertices(){return[this.c.add(new st(-this.a,0).rotate(this.angle)),this.c.add(new st(this.a,0).rotate(this.angle))]}get minorVertices(){return[this.c.add(new st(0,-this.b).rotate(this.angle)),this.c.add(new st(0,this.b).rotate(this.angle))]}get extremes(){const{a:e,b:n,angle:i}=this,s=Math.cos(i),o=Math.sin(i),a=e**2+n**2,h=(e**2-n**2)*Math.cos(2*i),c=Math.sqrt((a-h)/2),l=c*a*o*s/(e**2*o**2+n**2*s**2),u=Math.sqrt((a+h)/2),f=u*a*o*s/(e**2*s**2+n**2*o**2);return[new st(l,c).add(this.c),new st(l,c).inverse.add(this.c),new st(u,f).add(this.c),new st(u,f).inverse.add(this.c)]}project(e){e=e.rotate(-this.angle,this.c);const n=e.angle(this.c);return this.at(n/pe)}at(e){const n=pe*e;return this.c.shift(this.a*Math.cos(n),this.b*Math.sin(n)).rotate(this.angle,this.c)}offset(e){return .5}contains(e){const n=Math.cos(this.angle),i=Math.sin(this.angle),s=n**2/this.a**2+i**2/this.b**2,o=2*n*i*(1/this.a**2-1/this.b**2),a=i**2/this.a**2+n**2/this.b**2;return s*e.x**2+o*e.x*e.y+a*e.y**2<=1}transform(e){return this}rotate(e,n=We){const i=new ce(this.f1,this.f2).rotate(e,n);return Ds.fromFoci(i.p1,i.p2,this.a*2)}reflect(e){const n=new ce(this.f1,this.f2).reflect(e);return Ds.fromFoci(n.p1,n.p2,this.a*2)}scale(e,n=e){return new Ds(this.c.scale(e,n),this.a*e,this.b*n,this.angle)}shift(e,n=e){return new Ds(this.c.shift(e,n),this.a,this.b,this.angle)}translate(e){return new Ds(this.c.translate(e),this.a,this.b,this.angle)}equals(e,n){return bt(this.a,e.a,n)&&bt(this.b,e.b,n)&&bt(this.angle,e.angle,n)&&this.c.equals(e.c,n)}toString(){return`ellipse(${this.c},${this.a},${this.b},${this.angle})`}},Line:ce,ORIGIN:We,Point:st,Polygon:rr,Polyline:jy,Ray:Vy,Rectangle:Hy,Sector:Uy,Segment:os,TWO_PI:pe,Triangle:FS,drawCanvas:Xy,drawRoundedRect:WS,drawSVG:Jy,getBezierPoints:Zl,intersections:zi,isAngle:lo,isArc:co,isCircle:rs,isEllipse:Hl,isLine:Dy,isLineLike:ss,isPoint:PS,isPolygon:qy,isPolygonLike:sh,isPolyline:jl,isRay:ao,isRectangle:Yl,isSector:$y,isSegment:ho,rad:sr,toDeg:Yy,toRad:DS},Symbol.toStringTag,{value:"Module"}))}},Symbol.toStringTag,{value:"Module"}));var YS=20,HS=1,as=1e6,Qy=1e6,XS=-7,ZS=21,GS=!1,fo="[big.js] ",hs=fo+"Invalid ",ah=hs+"decimal places",JS=hs+"rounding mode",Ky=fo+"Division by zero",Bt={},qn=void 0,QS=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function tx(){function r(e){var n=this;if(!(n instanceof r))return e===qn&&arguments.length===0?tx():new r(e);if(e instanceof r)n.s=e.s,n.e=e.e,n.c=e.c.slice();else{if(typeof e!="string"){if(r.strict===!0&&typeof e!="bigint")throw TypeError(hs+"value");e=e===0&&1/e<0?"-0":String(e)}KS(n,e)}n.constructor=r}return r.prototype=Bt,r.DP=YS,r.RM=HS,r.NE=XS,r.PE=ZS,r.strict=GS,r.roundDown=0,r.roundHalfUp=1,r.roundHalfEven=2,r.roundUp=3,r}function KS(r,e){var n,i,s;if(!QS.test(e))throw Error(hs+"number");for(r.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(n=e.indexOf("."))>-1&&(e=e.replace(".","")),(i=e.search(/e/i))>0?(n<0&&(n=i),n+=+e.slice(i+1),e=e.substring(0,i)):n<0&&(n=e.length),s=e.length,i=0;i<s&&e.charAt(i)=="0";)++i;if(i==s)r.c=[r.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(r.e=n-i-1,r.c=[],n=0;i<=s;)r.c[n++]=+e.charAt(i++)}return r}function cs(r,e,n,i){var s=r.c;if(n===qn&&(n=r.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(JS);if(e<1)i=n===3&&(i||!!s[0])||e===0&&(n===1&&s[0]>=5||n===2&&(s[0]>5||s[0]===5&&(i||s[1]!==qn))),s.length=1,i?(r.e=r.e-e+1,s[0]=1):s[0]=r.e=0;else if(e<s.length){if(i=n===1&&s[e]>=5||n===2&&(s[e]>5||s[e]===5&&(i||s[e+1]!==qn||s[e-1]&1))||n===3&&(i||!!s[0]),s.length=e,i){for(;++s[--e]>9;)if(s[e]=0,e===0){++r.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return r}function ls(r,e,n){var i=r.e,s=r.c.join(""),o=s.length;if(e)s=s.charAt(0)+(o>1?"."+s.slice(1):"")+(i<0?"e":"e+")+i;else if(i<0){for(;++i;)s="0"+s;s="0."+s}else if(i>0)if(++i>o)for(i-=o;i--;)s+="0";else i<o&&(s=s.slice(0,i)+"."+s.slice(i));else o>1&&(s=s.charAt(0)+"."+s.slice(1));return r.s<0&&n?"-"+s:s}Bt.abs=function(){var r=new this.constructor(this);return r.s=1,r},Bt.cmp=function(r){var e,n=this,i=n.c,s=(r=new n.constructor(r)).c,o=n.s,a=r.s,h=n.e,c=r.e;if(!i[0]||!s[0])return i[0]?o:s[0]?-a:0;if(o!=a)return o;if(e=o<0,h!=c)return h>c^e?1:-1;for(a=(h=i.length)<(c=s.length)?h:c,o=-1;++o<a;)if(i[o]!=s[o])return i[o]>s[o]^e?1:-1;return h==c?0:h>c^e?1:-1},Bt.div=function(r){var e=this,n=e.constructor,i=e.c,s=(r=new n(r)).c,o=e.s==r.s?1:-1,a=n.DP;if(a!==~~a||a<0||a>as)throw Error(ah);if(!s[0])throw Error(Ky);if(!i[0])return r.s=o,r.c=[r.e=0],r;var h,c,l,u,f,d=s.slice(),p=h=s.length,y=i.length,x=i.slice(0,h),m=x.length,g=r,w=g.c=[],M=0,S=a+(g.e=e.e-r.e)+1;for(g.s=o,o=S<0?0:S,d.unshift(0);m++<h;)x.push(0);do{for(l=0;l<10;l++){if(h!=(m=x.length))u=h>m?1:-1;else for(f=-1,u=0;++f<h;)if(s[f]!=x[f]){u=s[f]>x[f]?1:-1;break}if(u<0){for(c=m==h?s:d;m;){if(x[--m]<c[m]){for(f=m;f&&!x[--f];)x[f]=9;--x[f],x[m]+=10}x[m]-=c[m]}for(;!x[0];)x.shift()}else break}w[M++]=u?l:++l,x[0]&&u?x[m]=i[p]||0:x=[i[p]]}while((p++<y||x[0]!==qn)&&o--);return!w[0]&&M!=1&&(w.shift(),g.e--,S--),M>S&&cs(g,S,n.RM,x[0]!==qn),g},Bt.eq=function(r){return this.cmp(r)===0},Bt.gt=function(r){return this.cmp(r)>0},Bt.gte=function(r){return this.cmp(r)>-1},Bt.lt=function(r){return this.cmp(r)<0},Bt.lte=function(r){return this.cmp(r)<1},Bt.minus=Bt.sub=function(r){var e,n,i,s,o=this,a=o.constructor,h=o.s,c=(r=new a(r)).s;if(h!=c)return r.s=-c,o.plus(r);var l=o.c.slice(),u=o.e,f=r.c,d=r.e;if(!l[0]||!f[0])return f[0]?r.s=-c:l[0]?r=new a(o):r.s=1,r;if(h=u-d){for((s=h<0)?(h=-h,i=l):(d=u,i=f),i.reverse(),c=h;c--;)i.push(0);i.reverse()}else for(n=((s=l.length<f.length)?l:f).length,h=c=0;c<n;c++)if(l[c]!=f[c]){s=l[c]<f[c];break}if(s&&(i=l,l=f,f=i,r.s=-r.s),(c=(n=f.length)-(e=l.length))>0)for(;c--;)l[e++]=0;for(c=e;n>h;){if(l[--n]<f[n]){for(e=n;e&&!l[--e];)l[e]=9;--l[e],l[n]+=10}l[n]-=f[n]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--d;return l[0]||(r.s=1,l=[d=0]),r.c=l,r.e=d,r},Bt.mod=function(r){var e,n=this,i=n.constructor,s=n.s,o=(r=new i(r)).s;if(!r.c[0])throw Error(Ky);return n.s=r.s=1,e=r.cmp(n)==1,n.s=s,r.s=o,e?new i(n):(s=i.DP,o=i.RM,i.DP=i.RM=0,n=n.div(r),i.DP=s,i.RM=o,this.minus(n.times(r)))},Bt.neg=function(){var r=new this.constructor(this);return r.s=-r.s,r},Bt.plus=Bt.add=function(r){var e,n,i,s=this,o=s.constructor;if(r=new o(r),s.s!=r.s)return r.s=-r.s,s.minus(r);var a=s.e,h=s.c,c=r.e,l=r.c;if(!h[0]||!l[0])return l[0]||(h[0]?r=new o(s):r.s=s.s),r;if(h=h.slice(),e=a-c){for(e>0?(c=a,i=l):(e=-e,i=h),i.reverse();e--;)i.push(0);i.reverse()}for(h.length-l.length<0&&(i=l,l=h,h=i),e=l.length,n=0;e;h[e]%=10)n=(h[--e]=h[e]+l[e]+n)/10|0;for(n&&(h.unshift(n),++c),e=h.length;h[--e]===0;)h.pop();return r.c=h,r.e=c,r},Bt.pow=function(r){var e=this,n=new e.constructor("1"),i=n,s=r<0;if(r!==~~r||r<-Qy||r>Qy)throw Error(hs+"exponent");for(s&&(r=-r);r&1&&(i=i.times(e)),r>>=1,!!r;)e=e.times(e);return s?n.div(i):i},Bt.prec=function(r,e){if(r!==~~r||r<1||r>as)throw Error(hs+"precision");return cs(new this.constructor(this),r,e)},Bt.round=function(r,e){if(r===qn)r=0;else if(r!==~~r||r<-as||r>as)throw Error(ah);return cs(new this.constructor(this),r+this.e+1,e)},Bt.sqrt=function(){var r,e,n,i=this,s=i.constructor,o=i.s,a=i.e,h=new s("0.5");if(!i.c[0])return new s(i);if(o<0)throw Error(fo+"No square root");o=Math.sqrt(+ls(i,!0,!0)),o===0||o===1/0?(e=i.c.join(""),e.length+a&1||(e+="0"),o=Math.sqrt(e),a=((a+1)/2|0)-(a<0||a&1),r=new s((o==1/0?"5e":(o=o.toExponential()).slice(0,o.indexOf("e")+1))+a)):r=new s(o+""),a=r.e+(s.DP+=4);do n=r,r=h.times(n.plus(i.div(n)));while(n.c.slice(0,a).join("")!==r.c.slice(0,a).join(""));return cs(r,(s.DP-=4)+r.e+1,s.RM)},Bt.times=Bt.mul=function(r){var e,n=this,i=n.constructor,s=n.c,o=(r=new i(r)).c,a=s.length,h=o.length,c=n.e,l=r.e;if(r.s=n.s==r.s?1:-1,!s[0]||!o[0])return r.c=[r.e=0],r;for(r.e=c+l,a<h&&(e=s,s=o,o=e,l=a,a=h,h=l),e=new Array(l=a+h);l--;)e[l]=0;for(c=h;c--;){for(h=0,l=a+c;l>c;)h=e[l]+o[c]*s[l-c-1]+h,e[l--]=h%10,h=h/10|0;e[l]=h}for(h?++r.e:e.shift(),c=e.length;!e[--c];)e.pop();return r.c=e,r},Bt.toExponential=function(r,e){var n=this,i=n.c[0];if(r!==qn){if(r!==~~r||r<0||r>as)throw Error(ah);for(n=cs(new n.constructor(n),++r,e);n.c.length<r;)n.c.push(0)}return ls(n,!0,!!i)},Bt.toFixed=function(r,e){var n=this,i=n.c[0];if(r!==qn){if(r!==~~r||r<0||r>as)throw Error(ah);for(n=cs(new n.constructor(n),r+n.e+1,e),r=r+n.e+1;n.c.length<r;)n.c.push(0)}return ls(n,!1,!!i)},Bt.toJSON=Bt.toString=function(){var r=this,e=r.constructor;return ls(r,r.e<=e.NE||r.e>=e.PE,!!r.c[0])},typeof Symbol<"u"&&(Bt[Symbol.for("nodejs.util.inspect.custom")]=Bt.toJSON),Bt.toNumber=function(){var r=+ls(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(r.toString()))throw Error(fo+"Imprecise conversion");return r},Bt.toPrecision=function(r,e){var n=this,i=n.constructor,s=n.c[0];if(r!==qn){if(r!==~~r||r<1||r>as)throw Error(hs+"precision");for(n=cs(new i(n),r,e);n.c.length<r;)n.c.push(0)}return ls(n,r<=n.e||n.e<=i.NE||n.e>=i.PE,!!s)},Bt.valueOf=function(){var r=this,e=r.constructor;if(e.strict===!0)throw Error(fo+"valueOf disallowed");return ls(r,r.e<=e.NE||r.e>=e.PE,!0)};var tT=tx(),le=function(r){var e=1e7,n=7,i=9007199254740992,s=d(i),o="0123456789abcdefghijklmnopqrstuvwxyz",a=typeof BigInt=="function";function h(T,C,F,D){return typeof T>"u"?h[0]:typeof C<"u"?+C==10&&!F?it(T):Q(T,C,F,D):it(T)}function c(T,C){this.value=T,this.sign=C,this.isSmall=!1}c.prototype=Object.create(h.prototype);function l(T){this.value=T,this.sign=T<0,this.isSmall=!0}l.prototype=Object.create(h.prototype);function u(T){this.value=T}u.prototype=Object.create(h.prototype);function f(T){return-i<T&&T<i}function d(T){return T<1e7?[T]:T<1e14?[T%1e7,Math.floor(T/1e7)]:[T%1e7,Math.floor(T/1e7)%1e7,Math.floor(T/1e14)]}function p(T){y(T);var C=T.length;if(C<4&&q(T,s)<0)switch(C){case 0:return 0;case 1:return T[0];case 2:return T[0]+T[1]*e;default:return T[0]+(T[1]+T[2]*e)*e}return T}function y(T){for(var C=T.length;T[--C]===0;);T.length=C+1}function x(T){for(var C=new Array(T),F=-1;++F<T;)C[F]=0;return C}function m(T){return T>0?Math.floor(T):Math.ceil(T)}function g(T,C){var F=T.length,D=C.length,W=new Array(F),V=0,j=e,Y,Z;for(Z=0;Z<D;Z++)Y=T[Z]+C[Z]+V,V=Y>=j?1:0,W[Z]=Y-V*j;for(;Z<F;)Y=T[Z]+V,V=Y===j?1:0,W[Z++]=Y-V*j;return V>0&&W.push(V),W}function w(T,C){return T.length>=C.length?g(T,C):g(C,T)}function M(T,C){var F=T.length,D=new Array(F),W=e,V,j;for(j=0;j<F;j++)V=T[j]-W+C,C=Math.floor(V/W),D[j]=V-C*W,C+=1;for(;C>0;)D[j++]=C%W,C=Math.floor(C/W);return D}c.prototype.add=function(T){var C=it(T);if(this.sign!==C.sign)return this.subtract(C.negate());var F=this.value,D=C.value;return C.isSmall?new c(M(F,Math.abs(D)),this.sign):new c(w(F,D),this.sign)},c.prototype.plus=c.prototype.add,l.prototype.add=function(T){var C=it(T),F=this.value;if(F<0!==C.sign)return this.subtract(C.negate());var D=C.value;if(C.isSmall){if(f(F+D))return new l(F+D);D=d(Math.abs(D))}return new c(M(D,Math.abs(F)),F<0)},l.prototype.plus=l.prototype.add,u.prototype.add=function(T){return new u(this.value+it(T).value)},u.prototype.plus=u.prototype.add;function S(T,C){var F=T.length,D=C.length,W=new Array(F),V=0,j=e,Y,Z;for(Y=0;Y<D;Y++)Z=T[Y]-V-C[Y],Z<0?(Z+=j,V=1):V=0,W[Y]=Z;for(Y=D;Y<F;Y++){if(Z=T[Y]-V,Z<0)Z+=j;else{W[Y++]=Z;break}W[Y]=Z}for(;Y<F;Y++)W[Y]=T[Y];return y(W),W}function E(T,C,F){var D;return q(T,C)>=0?D=S(T,C):(D=S(C,T),F=!F),D=p(D),typeof D=="number"?(F&&(D=-D),new l(D)):new c(D,F)}function A(T,C,F){var D=T.length,W=new Array(D),V=-C,j=e,Y,Z;for(Y=0;Y<D;Y++)Z=T[Y]+V,V=Math.floor(Z/j),Z%=j,W[Y]=Z<0?Z+j:Z;return W=p(W),typeof W=="number"?(F&&(W=-W),new l(W)):new c(W,F)}c.prototype.subtract=function(T){var C=it(T);if(this.sign!==C.sign)return this.add(C.negate());var F=this.value,D=C.value;return C.isSmall?A(F,Math.abs(D),this.sign):E(F,D,this.sign)},c.prototype.minus=c.prototype.subtract,l.prototype.subtract=function(T){var C=it(T),F=this.value;if(F<0!==C.sign)return this.add(C.negate());var D=C.value;return C.isSmall?new l(F-D):A(D,Math.abs(F),F>=0)},l.prototype.minus=l.prototype.subtract,u.prototype.subtract=function(T){return new u(this.value-it(T).value)},u.prototype.minus=u.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},l.prototype.negate=function(){var T=this.sign,C=new l(-this.value);return C.sign=!T,C},u.prototype.negate=function(){return new u(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},l.prototype.abs=function(){return new l(Math.abs(this.value))},u.prototype.abs=function(){return new u(this.value>=0?this.value:-this.value)};function I(T,C){var F=T.length,D=C.length,W=F+D,V=x(W),j=e,Y,Z,mt,It,Tt;for(mt=0;mt<F;++mt){It=T[mt];for(var Ft=0;Ft<D;++Ft)Tt=C[Ft],Y=It*Tt+V[mt+Ft],Z=Math.floor(Y/j),V[mt+Ft]=Y-Z*j,V[mt+Ft+1]+=Z}return y(V),V}function b(T,C){var F=T.length,D=new Array(F),W=e,V=0,j,Y;for(Y=0;Y<F;Y++)j=T[Y]*C+V,V=Math.floor(j/W),D[Y]=j-V*W;for(;V>0;)D[Y++]=V%W,V=Math.floor(V/W);return D}function v(T,C){for(var F=[];C-- >0;)F.push(0);return F.concat(T)}function _(T,C){var F=Math.max(T.length,C.length);if(F<=30)return I(T,C);F=Math.ceil(F/2);var D=T.slice(F),W=T.slice(0,F),V=C.slice(F),j=C.slice(0,F),Y=_(W,j),Z=_(D,V),mt=_(w(W,D),w(j,V)),It=w(w(Y,v(S(S(mt,Y),Z),F)),v(Z,2*F));return y(It),It}function z(T,C){return-.012*T-.012*C+15e-6*T*C>0}c.prototype.multiply=function(T){var C=it(T),F=this.value,D=C.value,W=this.sign!==C.sign,V;if(C.isSmall){if(D===0)return h[0];if(D===1)return this;if(D===-1)return this.negate();if(V=Math.abs(D),V<e)return new c(b(F,V),W);D=d(V)}return z(F.length,D.length)?new c(_(F,D),W):new c(I(F,D),W)},c.prototype.times=c.prototype.multiply;function P(T,C,F){return T<e?new c(b(C,T),F):new c(I(C,d(T)),F)}l.prototype._multiplyBySmall=function(T){return f(T.value*this.value)?new l(T.value*this.value):P(Math.abs(T.value),d(Math.abs(this.value)),this.sign!==T.sign)},c.prototype._multiplyBySmall=function(T){return T.value===0?h[0]:T.value===1?this:T.value===-1?this.negate():P(Math.abs(T.value),this.value,this.sign!==T.sign)},l.prototype.multiply=function(T){return it(T)._multiplyBySmall(this)},l.prototype.times=l.prototype.multiply,u.prototype.multiply=function(T){return new u(this.value*it(T).value)},u.prototype.times=u.prototype.multiply;function k(T){var C=T.length,F=x(C+C),D=e,W,V,j,Y,Z;for(j=0;j<C;j++){Y=T[j],V=0-Y*Y;for(var mt=j;mt<C;mt++)Z=T[mt],W=2*(Y*Z)+F[j+mt]+V,V=Math.floor(W/D),F[j+mt]=W-V*D;F[j+C]=V}return y(F),F}c.prototype.square=function(){return new c(k(this.value),!1)},l.prototype.square=function(){var T=this.value*this.value;return f(T)?new l(T):new c(k(d(Math.abs(this.value))),!1)},u.prototype.square=function(T){return new u(this.value*this.value)};function B(T,C){var F=T.length,D=C.length,W=e,V=x(C.length),j=C[D-1],Y=Math.ceil(W/(2*j)),Z=b(T,Y),mt=b(C,Y),It,Tt,Ft,Xe,Ve,qf,Df;for(Z.length<=F&&Z.push(0),mt.push(0),j=mt[D-1],Tt=F-D;Tt>=0;Tt--){for(It=W-1,Z[Tt+D]!==j&&(It=Math.floor((Z[Tt+D]*W+Z[Tt+D-1])/j)),Ft=0,Xe=0,qf=mt.length,Ve=0;Ve<qf;Ve++)Ft+=It*mt[Ve],Df=Math.floor(Ft/W),Xe+=Z[Tt+Ve]-(Ft-Df*W),Ft=Df,Xe<0?(Z[Tt+Ve]=Xe+W,Xe=-1):(Z[Tt+Ve]=Xe,Xe=0);for(;Xe!==0;){for(It-=1,Ft=0,Ve=0;Ve<qf;Ve++)Ft+=Z[Tt+Ve]-W+mt[Ve],Ft<0?(Z[Tt+Ve]=Ft+W,Ft=0):(Z[Tt+Ve]=Ft,Ft=1);Xe+=Ft}V[Tt]=It}return Z=L(Z,Y)[0],[p(V),p(Z)]}function R(T,C){for(var F=T.length,D=C.length,W=[],V=[],j=e,Y,Z,mt,It,Tt;F;){if(V.unshift(T[--F]),y(V),q(V,C)<0){W.push(0);continue}Z=V.length,mt=V[Z-1]*j+V[Z-2],It=C[D-1]*j+C[D-2],Z>D&&(mt=(mt+1)*j),Y=Math.ceil(mt/It);do{if(Tt=b(C,Y),q(Tt,V)<=0)break;Y--}while(Y);W.push(Y),V=S(V,Tt)}return W.reverse(),[p(W),p(V)]}function L(T,C){var F=T.length,D=x(F),W=e,V,j,Y,Z;for(Y=0,V=F-1;V>=0;--V)Z=Y*W+T[V],j=m(Z/C),Y=Z-j*C,D[V]=j|0;return[D,Y|0]}function N(T,C){var F,D=it(C);if(a)return[new u(T.value/D.value),new u(T.value%D.value)];var W=T.value,V=D.value,j;if(V===0)throw new Error("Cannot divide by zero");if(T.isSmall)return D.isSmall?[new l(m(W/V)),new l(W%V)]:[h[0],T];if(D.isSmall){if(V===1)return[T,h[0]];if(V==-1)return[T.negate(),h[0]];var Y=Math.abs(V);if(Y<e){F=L(W,Y),j=p(F[0]);var Z=F[1];return T.sign&&(Z=-Z),typeof j=="number"?(T.sign!==D.sign&&(j=-j),[new l(j),new l(Z)]):[new c(j,T.sign!==D.sign),new l(Z)]}V=d(Y)}var mt=q(W,V);if(mt===-1)return[h[0],T];if(mt===0)return[h[T.sign===D.sign?1:-1],h[0]];W.length+V.length<=200?F=B(W,V):F=R(W,V),j=F[0];var It=T.sign!==D.sign,Tt=F[1],Ft=T.sign;return typeof j=="number"?(It&&(j=-j),j=new l(j)):j=new c(j,It),typeof Tt=="number"?(Ft&&(Tt=-Tt),Tt=new l(Tt)):Tt=new c(Tt,Ft),[j,Tt]}c.prototype.divmod=function(T){var C=N(this,T);return{quotient:C[0],remainder:C[1]}},u.prototype.divmod=l.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(T){return N(this,T)[0]},u.prototype.over=u.prototype.divide=function(T){return new u(this.value/it(T).value)},l.prototype.over=l.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(T){return N(this,T)[1]},u.prototype.mod=u.prototype.remainder=function(T){return new u(this.value%it(T).value)},l.prototype.remainder=l.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(T){var C=it(T),F=this.value,D=C.value,W,V,j;if(D===0)return h[1];if(F===0)return h[0];if(F===1)return h[1];if(F===-1)return C.isEven()?h[1]:h[-1];if(C.sign)return h[0];if(!C.isSmall)throw new Error("The exponent "+C.toString()+" is too large.");if(this.isSmall&&f(W=Math.pow(F,D)))return new l(m(W));for(V=this,j=h[1];D&!0&&(j=j.times(V),--D),D!==0;)D/=2,V=V.square();return j},l.prototype.pow=c.prototype.pow,u.prototype.pow=function(T){var C=it(T),F=this.value,D=C.value,W=BigInt(0),V=BigInt(1),j=BigInt(2);if(D===W)return h[1];if(F===W)return h[0];if(F===V)return h[1];if(F===BigInt(-1))return C.isEven()?h[1]:h[-1];if(C.isNegative())return new u(W);for(var Y=this,Z=h[1];(D&V)===V&&(Z=Z.times(Y),--D),D!==W;)D/=j,Y=Y.square();return Z},c.prototype.modPow=function(T,C){if(T=it(T),C=it(C),C.isZero())throw new Error("Cannot take modPow with modulus 0");var F=h[1],D=this.mod(C);for(T.isNegative()&&(T=T.multiply(h[-1]),D=D.modInv(C));T.isPositive();){if(D.isZero())return h[0];T.isOdd()&&(F=F.multiply(D).mod(C)),T=T.divide(2),D=D.square().mod(C)}return F},u.prototype.modPow=l.prototype.modPow=c.prototype.modPow;function q(T,C){if(T.length!==C.length)return T.length>C.length?1:-1;for(var F=T.length-1;F>=0;F--)if(T[F]!==C[F])return T[F]>C[F]?1:-1;return 0}c.prototype.compareAbs=function(T){var C=it(T),F=this.value,D=C.value;return C.isSmall?1:q(F,D)},l.prototype.compareAbs=function(T){var C=it(T),F=Math.abs(this.value),D=C.value;return C.isSmall?(D=Math.abs(D),F===D?0:F>D?1:-1):-1},u.prototype.compareAbs=function(T){var C=this.value,F=it(T).value;return C=C>=0?C:-C,F=F>=0?F:-F,C===F?0:C>F?1:-1},c.prototype.compare=function(T){if(T===1/0)return-1;if(T===-1/0)return 1;var C=it(T),F=this.value,D=C.value;return this.sign!==C.sign?C.sign?1:-1:C.isSmall?this.sign?-1:1:q(F,D)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,l.prototype.compare=function(T){if(T===1/0)return-1;if(T===-1/0)return 1;var C=it(T),F=this.value,D=C.value;return C.isSmall?F==D?0:F>D?1:-1:F<0!==C.sign?F<0?-1:1:F<0?1:-1},l.prototype.compareTo=l.prototype.compare,u.prototype.compare=function(T){if(T===1/0)return-1;if(T===-1/0)return 1;var C=this.value,F=it(T).value;return C===F?0:C>F?1:-1},u.prototype.compareTo=u.prototype.compare,c.prototype.equals=function(T){return this.compare(T)===0},u.prototype.eq=u.prototype.equals=l.prototype.eq=l.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(T){return this.compare(T)!==0},u.prototype.neq=u.prototype.notEquals=l.prototype.neq=l.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(T){return this.compare(T)>0},u.prototype.gt=u.prototype.greater=l.prototype.gt=l.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(T){return this.compare(T)<0},u.prototype.lt=u.prototype.lesser=l.prototype.lt=l.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(T){return this.compare(T)>=0},u.prototype.geq=u.prototype.greaterOrEquals=l.prototype.geq=l.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(T){return this.compare(T)<=0},u.prototype.leq=u.prototype.lesserOrEquals=l.prototype.leq=l.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return(this.value[0]&1)===0},l.prototype.isEven=function(){return(this.value&1)===0},u.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return(this.value[0]&1)===1},l.prototype.isOdd=function(){return(this.value&1)===1},u.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},l.prototype.isPositive=function(){return this.value>0},u.prototype.isPositive=l.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},l.prototype.isNegative=function(){return this.value<0},u.prototype.isNegative=l.prototype.isNegative,c.prototype.isUnit=function(){return!1},l.prototype.isUnit=function(){return Math.abs(this.value)===1},u.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},l.prototype.isZero=function(){return this.value===0},u.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(T){var C=it(T);return C.isZero()?!1:C.isUnit()?!0:C.compareAbs(2)===0?this.isEven():this.mod(C).isZero()},u.prototype.isDivisibleBy=l.prototype.isDivisibleBy=c.prototype.isDivisibleBy;function U(T){var C=T.abs();if(C.isUnit())return!1;if(C.equals(2)||C.equals(3)||C.equals(5))return!0;if(C.isEven()||C.isDivisibleBy(3)||C.isDivisibleBy(5))return!1;if(C.lesser(49))return!0}function J(T,C){for(var F=T.prev(),D=F,W=0,V,j,Y;D.isEven();)D=D.divide(2),W++;t:for(j=0;j<C.length;j++)if(!T.lesser(C[j])&&(Y=le(C[j]).modPow(D,T),!(Y.isUnit()||Y.equals(F)))){for(V=W-1;V!=0;V--){if(Y=Y.square().mod(T),Y.isUnit())return!1;if(Y.equals(F))continue t}return!1}return!0}c.prototype.isPrime=function(T){var C=U(this);if(C!==r)return C;var F=this.abs(),D=F.bitLength();if(D<=64)return J(F,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var W=Math.log(2)*D.toJSNumber(),V=Math.ceil(T===!0?2*Math.pow(W,2):W),j=[],Y=0;Y<V;Y++)j.push(le(Y+2));return J(F,j)},u.prototype.isPrime=l.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(T,C){var F=U(this);if(F!==r)return F;for(var D=this.abs(),W=T===r?5:T,V=[],j=0;j<W;j++)V.push(le.randBetween(2,D.minus(2),C));return J(D,V)},u.prototype.isProbablePrime=l.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(T){for(var C=le.zero,F=le.one,D=it(T),W=this.abs(),V,j,Y;!W.isZero();)V=D.divide(W),j=C,Y=D,C=F,D=W,F=j.subtract(V.multiply(F)),W=Y.subtract(V.multiply(W));if(!D.isUnit())throw new Error(this.toString()+" and "+T.toString()+" are not co-prime");return C.compare(0)===-1&&(C=C.add(T)),this.isNegative()?C.negate():C},u.prototype.modInv=l.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var T=this.value;return this.sign?A(T,1,this.sign):new c(M(T,1),this.sign)},l.prototype.next=function(){var T=this.value;return T+1<i?new l(T+1):new c(s,!1)},u.prototype.next=function(){return new u(this.value+BigInt(1))},c.prototype.prev=function(){var T=this.value;return this.sign?new c(M(T,1),!0):A(T,1,this.sign)},l.prototype.prev=function(){var T=this.value;return T-1>-i?new l(T-1):new c(s,!0)},u.prototype.prev=function(){return new u(this.value-BigInt(1))};for(var X=[1];2*X[X.length-1]<=e;)X.push(2*X[X.length-1]);var lt=X.length,ot=X[lt-1];function ut(T){return Math.abs(T)<=e}c.prototype.shiftLeft=function(T){var C=it(T).toJSNumber();if(!ut(C))throw new Error(String(C)+" is too large for shifting.");if(C<0)return this.shiftRight(-C);var F=this;if(F.isZero())return F;for(;C>=lt;)F=F.multiply(ot),C-=lt-1;return F.multiply(X[C])},u.prototype.shiftLeft=l.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(T){var C,F=it(T).toJSNumber();if(!ut(F))throw new Error(String(F)+" is too large for shifting.");if(F<0)return this.shiftLeft(-F);for(var D=this;F>=lt;){if(D.isZero()||D.isNegative()&&D.isUnit())return D;C=N(D,ot),D=C[1].isNegative()?C[0].prev():C[0],F-=lt-1}return C=N(D,X[F]),C[1].isNegative()?C[0].prev():C[0]},u.prototype.shiftRight=l.prototype.shiftRight=c.prototype.shiftRight;function ct(T,C,F){C=it(C);for(var D=T.isNegative(),W=C.isNegative(),V=D?T.not():T,j=W?C.not():C,Y=0,Z=0,mt=null,It=null,Tt=[];!V.isZero()||!j.isZero();)mt=N(V,ot),Y=mt[1].toJSNumber(),D&&(Y=ot-1-Y),It=N(j,ot),Z=It[1].toJSNumber(),W&&(Z=ot-1-Z),V=mt[0],j=It[0],Tt.push(F(Y,Z));for(var Ft=F(D?1:0,W?1:0)!==0?le(-1):le(0),Xe=Tt.length-1;Xe>=0;Xe-=1)Ft=Ft.multiply(ot).add(le(Tt[Xe]));return Ft}c.prototype.not=function(){return this.negate().prev()},u.prototype.not=l.prototype.not=c.prototype.not,c.prototype.and=function(T){return ct(this,T,function(C,F){return C&F})},u.prototype.and=l.prototype.and=c.prototype.and,c.prototype.or=function(T){return ct(this,T,function(C,F){return C|F})},u.prototype.or=l.prototype.or=c.prototype.or,c.prototype.xor=function(T){return ct(this,T,function(C,F){return C^F})},u.prototype.xor=l.prototype.xor=c.prototype.xor;var gt=1<<30,Nt=(e&-e)*(e&-e)|gt;function se(T){var C=T.value,F=typeof C=="number"?C|gt:typeof C=="bigint"?C|BigInt(gt):C[0]+C[1]*e|Nt;return F&-F}function ee(T,C){if(C.compareTo(T)<=0){var F=ee(T,C.square(C)),D=F.p,W=F.e,V=D.multiply(C);return V.compareTo(T)<=0?{p:V,e:W*2+1}:{p:D,e:W*2}}return{p:le(1),e:0}}c.prototype.bitLength=function(){var T=this;return T.compareTo(le(0))<0&&(T=T.negate().subtract(le(1))),T.compareTo(le(0))===0?le(0):le(ee(T,le(2)).e).add(le(1))},u.prototype.bitLength=l.prototype.bitLength=c.prototype.bitLength;function $e(T,C){return T=it(T),C=it(C),T.greater(C)?T:C}function be(T,C){return T=it(T),C=it(C),T.lesser(C)?T:C}function de(T,C){if(T=it(T).abs(),C=it(C).abs(),T.equals(C))return T;if(T.isZero())return C;if(C.isZero())return T;for(var F=h[1],D,W;T.isEven()&&C.isEven();)D=be(se(T),se(C)),T=T.divide(D),C=C.divide(D),F=F.multiply(D);for(;T.isEven();)T=T.divide(se(T));do{for(;C.isEven();)C=C.divide(se(C));T.greater(C)&&(W=C,C=T,T=W),C=C.subtract(T)}while(!C.isZero());return F.isUnit()?T:T.multiply(F)}function Wt(T,C){return T=it(T).abs(),C=it(C).abs(),T.divide(de(T,C)).multiply(C)}function G(T,C,F){T=it(T),C=it(C);var D=F||Math.random,W=be(T,C),V=$e(T,C),j=V.subtract(W).add(1);if(j.isSmall)return W.add(Math.floor(D()*j));for(var Y=at(j,e).value,Z=[],mt=!0,It=0;It<Y.length;It++){var Tt=mt?Y[It]+(It+1<Y.length?Y[It+1]/e:0):e,Ft=m(D()*Tt);Z.push(Ft),Ft<Y[It]&&(mt=!1)}return W.add(h.fromArray(Z,e,!1))}var Q=function(T,C,F,D){F=F||o,T=String(T),D||(T=T.toLowerCase(),F=F.toLowerCase());var W=T.length,V,j=Math.abs(C),Y={};for(V=0;V<F.length;V++)Y[F[V]]=V;for(V=0;V<W;V++){var Z=T[V];if(Z!=="-"&&Z in Y&&Y[Z]>=j){if(Z==="1"&&j===1)continue;throw new Error(Z+" is not a valid digit in base "+C+".")}}C=it(C);var mt=[],It=T[0]==="-";for(V=It?1:0;V<T.length;V++){var Z=T[V];if(Z in Y)mt.push(it(Y[Z]));else if(Z==="<"){var Tt=V;do V++;while(T[V]!==">"&&V<T.length);mt.push(it(T.slice(Tt+1,V)))}else throw new Error(Z+" is not a valid character")}return rt(mt,C,It)};function rt(T,C,F){var D=h[0],W=h[1],V;for(V=T.length-1;V>=0;V--)D=D.add(T[V].times(W)),W=W.times(C);return F?D.negate():D}function ft(T,C){return C=C||o,T<C.length?C[T]:"<"+T+">"}function at(T,C){if(C=le(C),C.isZero()){if(T.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(C.equals(-1)){if(T.isZero())return{value:[0],isNegative:!1};if(T.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-T.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var F=Array.apply(null,Array(T.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return F.unshift([1]),{value:[].concat.apply([],F),isNegative:!1}}var D=!1;if(T.isNegative()&&C.isPositive()&&(D=!0,T=T.abs()),C.isUnit())return T.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(T.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:D};for(var W=[],V=T,j;V.isNegative()||V.compareAbs(C)>=0;){j=V.divmod(C),V=j.quotient;var Y=j.remainder;Y.isNegative()&&(Y=C.minus(Y).abs(),V=V.next()),W.push(Y.toJSNumber())}return W.push(V.toJSNumber()),{value:W.reverse(),isNegative:D}}function Pt(T,C,F){var D=at(T,C);return(D.isNegative?"-":"")+D.value.map(function(W){return ft(W,F)}).join("")}c.prototype.toArray=function(T){return at(this,T)},l.prototype.toArray=function(T){return at(this,T)},u.prototype.toArray=function(T){return at(this,T)},c.prototype.toString=function(T,C){if(T===r&&(T=10),T!==10||C)return Pt(this,T,C);for(var F=this.value,D=F.length,W=String(F[--D]),V="0000000",j;--D>=0;)j=String(F[D]),W+=V.slice(j.length)+j;var Y=this.sign?"-":"";return Y+W},l.prototype.toString=function(T,C){return T===r&&(T=10),T!=10||C?Pt(this,T,C):String(this.value)},u.prototype.toString=l.prototype.toString,u.prototype.toJSON=c.prototype.toJSON=l.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,l.prototype.valueOf=function(){return this.value},l.prototype.toJSNumber=l.prototype.valueOf,u.prototype.valueOf=u.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function St(T){if(f(+T)){var C=+T;if(C===m(C))return a?new u(BigInt(C)):new l(C);throw new Error("Invalid integer: "+T)}var F=T[0]==="-";F&&(T=T.slice(1));var D=T.split(/e/i);if(D.length>2)throw new Error("Invalid integer: "+D.join("e"));if(D.length===2){var W=D[1];if(W[0]==="+"&&(W=W.slice(1)),W=+W,W!==m(W)||!f(W))throw new Error("Invalid integer: "+W+" is not a valid exponent.");var V=D[0],j=V.indexOf(".");if(j>=0&&(W-=V.length-j-1,V=V.slice(0,j)+V.slice(j+1)),W<0)throw new Error("Cannot include negative exponent part for integers");V+=new Array(W+1).join("0"),T=V}var Y=/^([0-9][0-9]*)$/.test(T);if(!Y)throw new Error("Invalid integer: "+T);if(a)return new u(BigInt(F?"-"+T:T));for(var Z=[],mt=T.length,It=n,Tt=mt-It;mt>0;)Z.push(+T.slice(Tt,mt)),Tt-=It,Tt<0&&(Tt=0),mt-=It;return y(Z),new c(Z,F)}function Vt(T){if(a)return new u(BigInt(T));if(f(T)){if(T!==m(T))throw new Error(T+" is not an integer.");return new l(T)}return St(T.toString())}function it(T){return typeof T=="number"?Vt(T):typeof T=="string"?St(T):typeof T=="bigint"?new u(T):T}for(var $t=0;$t<1e3;$t++)h[$t]=it($t),$t>0&&(h[-$t]=it(-$t));return h.one=h[1],h.zero=h[0],h.minusOne=h[-1],h.max=$e,h.min=be,h.gcd=de,h.lcm=Wt,h.isInstance=function(T){return T instanceof c||T instanceof l||T instanceof u},h.randBetween=G,h.fromArray=function(T,C,F){return rt(T.map(it),it(C||10),F)},h}();function eT(r,e,n=2){const i=e&&e.length,s=i?e[0]*n:r.length;let o=ex(r,0,s,n,!0);const a=[];if(!o||o.next===o.prev)return a;let h,c,l;if(i&&(o=oT(r,e,o,n)),r.length>80*n){h=1/0,c=1/0;let u=-1/0,f=-1/0;for(let d=n;d<s;d+=n){const p=r[d],y=r[d+1];p<h&&(h=p),y<c&&(c=y),p>u&&(u=p),y>f&&(f=y)}l=Math.max(u-h,f-c),l=l!==0?32767/l:0}return po(o,a,n,h,c,l,0),a}function ex(r,e,n,i,s){let o;if(s===Ql(r,e,n,i)>0)for(let a=e;a<n;a+=i)o=rx(a/i|0,r[a],r[a+1],o);else for(let a=n-i;a>=e;a-=i)o=rx(a/i|0,r[a],r[a+1],o);return o&&ar(o,o.next)&&(mo(o),o=o.next),o}function us(r,e){if(!r)return r;e||(e=r);let n=r,i;do if(i=!1,!n.steiner&&(ar(n,n.next)||Ht(n.prev,n,n.next)===0)){if(mo(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function po(r,e,n,i,s,o,a){if(!r)return;!a&&o&&uT(r,i,s,o);let h=r;for(;r.prev!==r.next;){const c=r.prev,l=r.next;if(o?iT(r,i,s,o):nT(r)){e.push(c.i,r.i,l.i),mo(r),r=l.next,h=l.next;continue}if(r=l,r===h){a?a===1?(r=sT(us(r),e),po(r,e,n,i,s,o,2)):a===2&&rT(r,e,n,i,s,o):po(us(r),e,n,i,s,o,1);break}}}function nT(r){const e=r.prev,n=r,i=r.next;if(Ht(e,n,i)>=0)return!1;const s=e.x,o=n.x,a=i.x,h=e.y,c=n.y,l=i.y,u=Math.min(s,o,a),f=Math.min(h,c,l),d=Math.max(s,o,a),p=Math.max(h,c,l);let y=i.next;for(;y!==e;){if(y.x>=u&&y.x<=d&&y.y>=f&&y.y<=p&&yo(s,h,o,c,a,l,y.x,y.y)&&Ht(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function iT(r,e,n,i){const s=r.prev,o=r,a=r.next;if(Ht(s,o,a)>=0)return!1;const h=s.x,c=o.x,l=a.x,u=s.y,f=o.y,d=a.y,p=Math.min(h,c,l),y=Math.min(u,f,d),x=Math.max(h,c,l),m=Math.max(u,f,d),g=Gl(p,y,e,n,i),w=Gl(x,m,e,n,i);let M=r.prevZ,S=r.nextZ;for(;M&&M.z>=g&&S&&S.z<=w;){if(M.x>=p&&M.x<=x&&M.y>=y&&M.y<=m&&M!==s&&M!==a&&yo(h,u,c,f,l,d,M.x,M.y)&&Ht(M.prev,M,M.next)>=0||(M=M.prevZ,S.x>=p&&S.x<=x&&S.y>=y&&S.y<=m&&S!==s&&S!==a&&yo(h,u,c,f,l,d,S.x,S.y)&&Ht(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;M&&M.z>=g;){if(M.x>=p&&M.x<=x&&M.y>=y&&M.y<=m&&M!==s&&M!==a&&yo(h,u,c,f,l,d,M.x,M.y)&&Ht(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;S&&S.z<=w;){if(S.x>=p&&S.x<=x&&S.y>=y&&S.y<=m&&S!==s&&S!==a&&yo(h,u,c,f,l,d,S.x,S.y)&&Ht(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function sT(r,e){let n=r;do{const i=n.prev,s=n.next.next;!ar(i,s)&&ix(i,n,n.next,s)&&xo(i,s)&&xo(s,i)&&(e.push(i.i,n.i,s.i),mo(n),mo(n.next),n=r=s),n=n.next}while(n!==r);return us(n)}function rT(r,e,n,i,s,o){let a=r;do{let h=a.next.next;for(;h!==a.prev;){if(a.i!==h.i&&pT(a,h)){let c=sx(a,h);a=us(a,a.next),c=us(c,c.next),po(a,e,n,i,s,o,0),po(c,e,n,i,s,o,0);return}h=h.next}a=a.next}while(a!==r)}function oT(r,e,n,i){const s=[];for(let o=0,a=e.length;o<a;o++){const h=e[o]*i,c=o<a-1?e[o+1]*i:r.length,l=ex(r,h,c,i,!1);l===l.next&&(l.steiner=!0),s.push(dT(l))}s.sort(aT);for(let o=0;o<s.length;o++)n=hT(s[o],n);return n}function aT(r,e){let n=r.x-e.x;if(n===0&&(n=r.y-e.y,n===0)){const i=(r.next.y-r.y)/(r.next.x-r.x),s=(e.next.y-e.y)/(e.next.x-e.x);n=i-s}return n}function hT(r,e){const n=cT(r,e);if(!n)return e;const i=sx(n,r);return us(i,i.next),us(n,n.next)}function cT(r,e){let n=e;const i=r.x,s=r.y;let o=-1/0,a;if(ar(r,n))return n;do{if(ar(r,n.next))return n.next;if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){const f=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(f<=i&&f>o&&(o=f,a=n.x<n.next.x?n:n.next,f===i))return a}n=n.next}while(n!==e);if(!a)return null;const h=a,c=a.x,l=a.y;let u=1/0;n=a;do{if(i>=n.x&&n.x>=c&&i!==n.x&&nx(s<l?i:o,s,c,l,s<l?o:i,s,n.x,n.y)){const f=Math.abs(s-n.y)/(i-n.x);xo(n,r)&&(f<u||f===u&&(n.x>a.x||n.x===a.x&&lT(a,n)))&&(a=n,u=f)}n=n.next}while(n!==h);return a}function lT(r,e){return Ht(r.prev,r,e.prev)<0&&Ht(e.next,r,r.next)<0}function uT(r,e,n,i){let s=r;do s.z===0&&(s.z=Gl(s.x,s.y,e,n,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==r);s.prevZ.nextZ=null,s.prevZ=null,fT(s)}function fT(r){let e,n=1;do{let i=r,s;r=null;let o=null;for(e=0;i;){e++;let a=i,h=0;for(let l=0;l<n&&(h++,a=a.nextZ,!!a);l++);let c=n;for(;h>0||c>0&&a;)h!==0&&(c===0||!a||i.z<=a.z)?(s=i,i=i.nextZ,h--):(s=a,a=a.nextZ,c--),o?o.nextZ=s:r=s,s.prevZ=o,o=s;i=a}o.nextZ=null,n*=2}while(e>1);return r}function Gl(r,e,n,i,s){return r=(r-n)*s|0,e=(e-i)*s|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function dT(r){let e=r,n=r;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==r);return n}function nx(r,e,n,i,s,o,a,h){return(s-a)*(e-h)>=(r-a)*(o-h)&&(r-a)*(i-h)>=(n-a)*(e-h)&&(n-a)*(o-h)>=(s-a)*(i-h)}function yo(r,e,n,i,s,o,a,h){return!(r===a&&e===h)&&nx(r,e,n,i,s,o,a,h)}function pT(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!yT(r,e)&&(xo(r,e)&&xo(e,r)&&xT(r,e)&&(Ht(r.prev,r,e.prev)||Ht(r,e.prev,e))||ar(r,e)&&Ht(r.prev,r,r.next)>0&&Ht(e.prev,e,e.next)>0)}function Ht(r,e,n){return(e.y-r.y)*(n.x-e.x)-(e.x-r.x)*(n.y-e.y)}function ar(r,e){return r.x===e.x&&r.y===e.y}function ix(r,e,n,i){const s=ch(Ht(r,e,n)),o=ch(Ht(r,e,i)),a=ch(Ht(n,i,r)),h=ch(Ht(n,i,e));return!!(s!==o&&a!==h||s===0&&hh(r,n,e)||o===0&&hh(r,i,e)||a===0&&hh(n,r,i)||h===0&&hh(n,e,i))}function hh(r,e,n){return e.x<=Math.max(r.x,n.x)&&e.x>=Math.min(r.x,n.x)&&e.y<=Math.max(r.y,n.y)&&e.y>=Math.min(r.y,n.y)}function ch(r){return r>0?1:r<0?-1:0}function yT(r,e){let n=r;do{if(n.i!==r.i&&n.next.i!==r.i&&n.i!==e.i&&n.next.i!==e.i&&ix(n,n.next,r,e))return!0;n=n.next}while(n!==r);return!1}function xo(r,e){return Ht(r.prev,r,r.next)<0?Ht(r,e,r.next)>=0&&Ht(r,r.prev,e)>=0:Ht(r,e,r.prev)<0||Ht(r,r.next,e)<0}function xT(r,e){let n=r,i=!1;const s=(r.x+e.x)/2,o=(r.y+e.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&s<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==r);return i}function sx(r,e){const n=Jl(r.i,r.x,r.y),i=Jl(e.i,e.x,e.y),s=r.next,o=e.prev;return r.next=e,e.prev=r,n.next=s,s.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function rx(r,e,n,i){const s=Jl(r,e,n);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function mo(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Jl(r,e,n){return{i:r,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function mT(r,e,n,i){const s=e&&e.length,o=s?e[0]*n:r.length;let a=Math.abs(Ql(r,0,o,n));if(s)for(let c=0,l=e.length;c<l;c++){const u=e[c]*n,f=c<l-1?e[c+1]*n:r.length;a-=Math.abs(Ql(r,u,f,n))}let h=0;for(let c=0;c<i.length;c+=3){const l=i[c]*n,u=i[c+1]*n,f=i[c+2]*n;h+=Math.abs((r[l]-r[f])*(r[u+1]-r[l+1])-(r[l]-r[u])*(r[f+1]-r[l+1]))}return a===0&&h===0?0:Math.abs((h-a)/a)}function Ql(r,e,n,i){let s=0;for(let o=e,a=n-i;o<n;o+=i)s+=(r[a]-r[o])*(r[o+1]+r[a+1]),a=o;return s}function gT(r){const e=[],n=[],i=r[0][0].length;let s=0,o=0;for(const a of r){for(const h of a)for(let c=0;c<i;c++)e.push(h[c]);o&&(s+=o,n.push(s)),o=a.length}return{vertices:e,holes:n,dimensions:i}}const si=11102230246251565e-32,me=134217729,wT=(3+8*si)*si;function Kl(r,e,n,i,s){let o,a,h,c,l=e[0],u=i[0],f=0,d=0;u>l==u>-l?(o=l,l=e[++f]):(o=u,u=i[++d]);let p=0;if(f<r&&d<n)for(u>l==u>-l?(a=l+o,h=o-(a-l),l=e[++f]):(a=u+o,h=o-(a-u),u=i[++d]),o=a,h!==0&&(s[p++]=h);f<r&&d<n;)u>l==u>-l?(a=o+l,c=a-o,h=o-(a-c)+(l-c),l=e[++f]):(a=o+u,c=a-o,h=o-(a-c)+(u-c),u=i[++d]),o=a,h!==0&&(s[p++]=h);for(;f<r;)a=o+l,c=a-o,h=o-(a-c)+(l-c),l=e[++f],o=a,h!==0&&(s[p++]=h);for(;d<n;)a=o+u,c=a-o,h=o-(a-c)+(u-c),u=i[++d],o=a,h!==0&&(s[p++]=h);return(o!==0||p===0)&&(s[p++]=o),p}function bT(r,e){let n=e[0];for(let i=1;i<r;i++)n+=e[i];return n}function go(r){return new Float64Array(r)}const vT=(3+16*si)*si,MT=(2+12*si)*si,_T=(9+64*si)*si*si,hr=go(4),ox=go(8),ax=go(12),hx=go(16),Ce=go(4);function ST(r,e,n,i,s,o,a){let h,c,l,u,f,d,p,y,x,m,g,w,M,S,E,A,I,b;const v=r-s,_=n-s,z=e-o,P=i-o;S=v*P,d=me*v,p=d-(d-v),y=v-p,d=me*P,x=d-(d-P),m=P-x,E=y*m-(S-p*x-y*x-p*m),A=z*_,d=me*z,p=d-(d-z),y=z-p,d=me*_,x=d-(d-_),m=_-x,I=y*m-(A-p*x-y*x-p*m),g=E-I,f=E-g,hr[0]=E-(g+f)+(f-I),w=S+g,f=w-S,M=S-(w-f)+(g-f),g=M-A,f=M-g,hr[1]=M-(g+f)+(f-A),b=w+g,f=b-w,hr[2]=w-(b-f)+(g-f),hr[3]=b;let k=bT(4,hr),B=MT*a;if(k>=B||-k>=B||(f=r-v,h=r-(v+f)+(f-s),f=n-_,l=n-(_+f)+(f-s),f=e-z,c=e-(z+f)+(f-o),f=i-P,u=i-(P+f)+(f-o),h===0&&c===0&&l===0&&u===0)||(B=_T*a+wT*Math.abs(k),k+=v*u+P*h-(z*l+_*c),k>=B||-k>=B))return k;S=h*P,d=me*h,p=d-(d-h),y=h-p,d=me*P,x=d-(d-P),m=P-x,E=y*m-(S-p*x-y*x-p*m),A=c*_,d=me*c,p=d-(d-c),y=c-p,d=me*_,x=d-(d-_),m=_-x,I=y*m-(A-p*x-y*x-p*m),g=E-I,f=E-g,Ce[0]=E-(g+f)+(f-I),w=S+g,f=w-S,M=S-(w-f)+(g-f),g=M-A,f=M-g,Ce[1]=M-(g+f)+(f-A),b=w+g,f=b-w,Ce[2]=w-(b-f)+(g-f),Ce[3]=b;const R=Kl(4,hr,4,Ce,ox);S=v*u,d=me*v,p=d-(d-v),y=v-p,d=me*u,x=d-(d-u),m=u-x,E=y*m-(S-p*x-y*x-p*m),A=z*l,d=me*z,p=d-(d-z),y=z-p,d=me*l,x=d-(d-l),m=l-x,I=y*m-(A-p*x-y*x-p*m),g=E-I,f=E-g,Ce[0]=E-(g+f)+(f-I),w=S+g,f=w-S,M=S-(w-f)+(g-f),g=M-A,f=M-g,Ce[1]=M-(g+f)+(f-A),b=w+g,f=b-w,Ce[2]=w-(b-f)+(g-f),Ce[3]=b;const L=Kl(R,ox,4,Ce,ax);S=h*u,d=me*h,p=d-(d-h),y=h-p,d=me*u,x=d-(d-u),m=u-x,E=y*m-(S-p*x-y*x-p*m),A=c*l,d=me*c,p=d-(d-c),y=c-p,d=me*l,x=d-(d-l),m=l-x,I=y*m-(A-p*x-y*x-p*m),g=E-I,f=E-g,Ce[0]=E-(g+f)+(f-I),w=S+g,f=w-S,M=S-(w-f)+(g-f),g=M-A,f=M-g,Ce[1]=M-(g+f)+(f-A),b=w+g,f=b-w,Ce[2]=w-(b-f)+(g-f),Ce[3]=b;const N=Kl(L,ax,4,Ce,hx);return hx[N-1]}function lh(r,e,n,i,s,o){const a=(e-o)*(n-s),h=(r-s)*(i-o),c=a-h,l=Math.abs(a+h);return Math.abs(c)>=vT*l?c:-ST(r,e,n,i,s,o,l)}const cx=Math.pow(2,-52),uh=new Uint32Array(512);class tu{static from(e,n=CT,i=PT){const s=e.length,o=new Float64Array(s*2);for(let a=0;a<s;a++){const h=e[a];o[2*a]=n(h),o[2*a+1]=i(h)}return new tu(o)}constructor(e){const n=e.length>>1;if(n>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:e,_hullPrev:n,_hullNext:i,_hullTri:s,_hullHash:o}=this,a=e.length>>1;let h=1/0,c=1/0,l=-1/0,u=-1/0;for(let v=0;v<a;v++){const _=e[2*v],z=e[2*v+1];_<h&&(h=_),z<c&&(c=z),_>l&&(l=_),z>u&&(u=z),this._ids[v]=v}const f=(h+l)/2,d=(c+u)/2;let p,y,x;for(let v=0,_=1/0;v<a;v++){const z=eu(f,d,e[2*v],e[2*v+1]);z<_&&(p=v,_=z)}const m=e[2*p],g=e[2*p+1];for(let v=0,_=1/0;v<a;v++){if(v===p)continue;const z=eu(m,g,e[2*v],e[2*v+1]);z<_&&z>0&&(y=v,_=z)}let w=e[2*y],M=e[2*y+1],S=1/0;for(let v=0;v<a;v++){if(v===p||v===y)continue;const _=zT(m,g,w,M,e[2*v],e[2*v+1]);_<S&&(x=v,S=_)}let E=e[2*x],A=e[2*x+1];if(S===1/0){for(let z=0;z<a;z++)this._dists[z]=e[2*z]-e[0]||e[2*z+1]-e[1];cr(this._ids,this._dists,0,a-1);const v=new Uint32Array(a);let _=0;for(let z=0,P=-1/0;z<a;z++){const k=this._ids[z],B=this._dists[k];B>P&&(v[_++]=k,P=B)}this.hull=v.subarray(0,_),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(lh(m,g,w,M,E,A)<0){const v=y,_=w,z=M;y=x,w=E,M=A,x=v,E=_,A=z}const I=AT(m,g,w,M,E,A);this._cx=I.x,this._cy=I.y;for(let v=0;v<a;v++)this._dists[v]=eu(e[2*v],e[2*v+1],I.x,I.y);cr(this._ids,this._dists,0,a-1),this._hullStart=p;let b=3;i[p]=n[x]=y,i[y]=n[p]=x,i[x]=n[y]=p,s[p]=0,s[y]=1,s[x]=2,o.fill(-1),o[this._hashKey(m,g)]=p,o[this._hashKey(w,M)]=y,o[this._hashKey(E,A)]=x,this.trianglesLen=0,this._addTriangle(p,y,x,-1,-1,-1);for(let v=0,_,z;v<this._ids.length;v++){const P=this._ids[v],k=e[2*P],B=e[2*P+1];if(v>0&&Math.abs(k-_)<=cx&&Math.abs(B-z)<=cx||(_=k,z=B,P===p||P===y||P===x))continue;let R=0;for(let J=0,X=this._hashKey(k,B);J<this._hashSize&&(R=o[(X+J)%this._hashSize],!(R!==-1&&R!==i[R]));J++);R=n[R];let L=R,N;for(;N=i[L],lh(k,B,e[2*L],e[2*L+1],e[2*N],e[2*N+1])>=0;)if(L=N,L===R){L=-1;break}if(L===-1)continue;let q=this._addTriangle(L,P,i[L],-1,-1,s[L]);s[P]=this._legalize(q+2),s[L]=q,b++;let U=i[L];for(;N=i[U],lh(k,B,e[2*U],e[2*U+1],e[2*N],e[2*N+1])<0;)q=this._addTriangle(U,P,N,s[P],-1,s[U]),s[P]=this._legalize(q+2),i[U]=U,b--,U=N;if(L===R)for(;N=n[L],lh(k,B,e[2*N],e[2*N+1],e[2*L],e[2*L+1])<0;)q=this._addTriangle(N,P,L,-1,s[L],s[N]),this._legalize(q+2),s[N]=q,i[L]=L,b--,L=N;this._hullStart=n[P]=L,i[L]=n[U]=P,i[P]=U,o[this._hashKey(k,B)]=P,o[this._hashKey(e[2*L],e[2*L+1])]=L}this.hull=new Uint32Array(b);for(let v=0,_=this._hullStart;v<b;v++)this.hull[v]=_,_=i[_];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,n){return Math.floor(TT(e-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:n,_halfedges:i,coords:s}=this;let o=0,a=0;for(;;){const h=i[e],c=e-e%3;if(a=c+(e+2)%3,h===-1){if(o===0)break;e=uh[--o];continue}const l=h-h%3,u=c+(e+1)%3,f=l+(h+2)%3,d=n[a],p=n[e],y=n[u],x=n[f];if(ET(s[2*d],s[2*d+1],s[2*p],s[2*p+1],s[2*y],s[2*y+1],s[2*x],s[2*x+1])){n[e]=x,n[h]=d;const g=i[f];if(g===-1){let M=this._hullStart;do{if(this._hullTri[M]===f){this._hullTri[M]=e;break}M=this._hullPrev[M]}while(M!==this._hullStart)}this._link(e,g),this._link(h,i[a]),this._link(a,f);const w=l+(h+1)%3;o<uh.length&&(uh[o++]=w)}else{if(o===0)break;e=uh[--o]}}return a}_link(e,n){this._halfedges[e]=n,n!==-1&&(this._halfedges[n]=e)}_addTriangle(e,n,i,s,o,a){const h=this.trianglesLen;return this._triangles[h]=e,this._triangles[h+1]=n,this._triangles[h+2]=i,this._link(h,s),this._link(h+1,o),this._link(h+2,a),this.trianglesLen+=3,h}}function TT(r,e){const n=r/(Math.abs(r)+Math.abs(e));return(e>0?3-n:1+n)/4}function eu(r,e,n,i){const s=r-n,o=e-i;return s*s+o*o}function ET(r,e,n,i,s,o,a,h){const c=r-a,l=e-h,u=n-a,f=i-h,d=s-a,p=o-h,y=c*c+l*l,x=u*u+f*f,m=d*d+p*p;return c*(f*m-x*p)-l*(u*m-x*d)+y*(u*p-f*d)<0}function zT(r,e,n,i,s,o){const a=n-r,h=i-e,c=s-r,l=o-e,u=a*a+h*h,f=c*c+l*l,d=.5/(a*l-h*c),p=(l*u-h*f)*d,y=(a*f-c*u)*d;return p*p+y*y}function AT(r,e,n,i,s,o){const a=n-r,h=i-e,c=s-r,l=o-e,u=a*a+h*h,f=c*c+l*l,d=.5/(a*l-h*c),p=r+(l*u-h*f)*d,y=e+(a*f-c*u)*d;return{x:p,y}}function cr(r,e,n,i){if(i-n<=20)for(let s=n+1;s<=i;s++){const o=r[s],a=e[o];let h=s-1;for(;h>=n&&e[r[h]]>a;)r[h+1]=r[h--];r[h+1]=o}else{const s=n+i>>1;let o=n+1,a=i;wo(r,s,o),e[r[n]]>e[r[i]]&&wo(r,n,i),e[r[o]]>e[r[i]]&&wo(r,o,i),e[r[n]]>e[r[o]]&&wo(r,n,o);const h=r[o],c=e[h];for(;;){do o++;while(e[r[o]]<c);do a--;while(e[r[a]]>c);if(a<o)break;wo(r,o,a)}r[n+1]=r[a],r[a]=h,i-o+1>=a-n?(cr(r,e,o,i),cr(r,e,n,a-1)):(cr(r,e,n,a-1),cr(r,e,o,i))}}function wo(r,e,n){const i=r[e];r[e]=r[n],r[n]=i}function CT(r){return r[0]}function PT(r){return r[1]}const bo=1e20;class IT{constructor({fontSize:e=24,buffer:n=3,radius:i=8,cutoff:s=.25,fontFamily:o="sans-serif",fontWeight:a="normal",fontStyle:h="normal"}={}){this.buffer=n,this.cutoff=s,this.radius=i;const c=this.size=e+n*4,l=this._createCanvas(c),u=this.ctx=l.getContext("2d",{willReadFrequently:!0});u.font=`${h} ${a} ${e}px ${o}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(c*c),this.gridInner=new Float64Array(c*c),this.f=new Float64Array(c),this.z=new Float64Array(c+1),this.v=new Uint16Array(c)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:i,actualBoundingBoxDescent:s,actualBoundingBoxLeft:o,actualBoundingBoxRight:a}=this.ctx.measureText(e),h=Math.ceil(i),c=0,l=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(a-o))),u=Math.min(this.size-this.buffer,h+Math.ceil(s)),f=l+2*this.buffer,d=u+2*this.buffer,p=Math.max(f*d,0),y=new Uint8ClampedArray(p),x={data:y,width:f,height:d,glyphWidth:l,glyphHeight:u,glyphTop:h,glyphLeft:c,glyphAdvance:n};if(l===0||u===0)return x;const{ctx:m,buffer:g,gridInner:w,gridOuter:M}=this;m.clearRect(g,g,l,u),m.fillText(e,g,g+h);const S=m.getImageData(g,g,l,u);M.fill(bo,0,p),w.fill(0,0,p);for(let E=0;E<u;E++)for(let A=0;A<l;A++){const I=S.data[4*(E*l+A)+3]/255;if(I===0)continue;const b=(E+g)*f+A+g;if(I===1)M[b]=0,w[b]=bo;else{const v=.5-I;M[b]=v>0?v*v:0,w[b]=v<0?v*v:0}}lx(M,0,0,f,d,f,this.f,this.v,this.z),lx(w,g,g,l,u,f,this.f,this.v,this.z);for(let E=0;E<p;E++){const A=Math.sqrt(M[E])-Math.sqrt(w[E]);y[E]=Math.round(255-255*(A/this.radius+this.cutoff))}return x}}function lx(r,e,n,i,s,o,a,h,c){for(let l=e;l<e+i;l++)ux(r,n*o+l,o,s,a,h,c);for(let l=n;l<n+s;l++)ux(r,l*o+e,1,i,a,h,c)}function ux(r,e,n,i,s,o,a){o[0]=0,a[0]=-bo,a[1]=bo,s[0]=r[e];for(let h=1,c=0,l=0;h<i;h++){s[h]=r[e+h*n];const u=h*h;do{const f=o[c];l=(s[h]-s[f]+u-f*f)/(h-f)/2}while(l<=a[c]&&--c>-1);c++,o[c]=h,a[c]=l,a[c+1]=bo}for(let h=0,c=0;h<i;h++){for(;a[c+1]<h;)c++;const l=o[c],u=h-l;r[e+h*n]=s[l]+u*u}}class fx{constructor(e=[],n=(i,s)=>i<s?-1:i>s?1:0){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:i}=this,s=n[e];for(;e>0;){const o=e-1>>1,a=n[o];if(i(s,a)>=0)break;n[e]=a,e=o}n[e]=s}_down(e){const{data:n,compare:i}=this,s=this.length>>1,o=n[e];for(;e<s;){let a=(e<<1)+1;const h=a+1;if(h<this.length&&i(n[h],n[a])<0&&(a=h),i(n[a],o)>=0)break;n[e]=n[a],e=a}n[e]=o}}function kT(r,e=1,n=!1){let i=1/0,s=1/0,o=-1/0,a=-1/0;for(const[g,w]of r[0])g<i&&(i=g),w<s&&(s=w),g>o&&(o=g),w>a&&(a=w);const h=o-i,c=a-s,l=Math.max(e,Math.min(h,c));if(l===e){const g=[i,s];return g.distance=0,g}const u=new fx([],(g,w)=>w.max-g.max);let f=OT(r);const d=new fh(i+h/2,s+c/2,0,r);d.d>f.d&&(f=d);let p=2;function y(g,w,M){const S=new fh(g,w,M,r);p++,S.max>f.d+e&&u.push(S),S.d>f.d&&(f=S,n&&console.log(`found best ${Math.round(1e4*S.d)/1e4} after ${p} probes`))}let x=l/2;for(let g=i;g<o;g+=l)for(let w=s;w<a;w+=l)y(g+x,w+x,x);for(;u.length;){const{max:g,x:w,y:M,h:S}=u.pop();if(g-f.d<=e)break;x=S/2,y(w-x,M-x,x),y(w+x,M-x,x),y(w-x,M+x,x),y(w+x,M+x,x)}n&&console.log(`num probes: ${p}
best distance: ${f.d}`);const m=[f.x,f.y];return m.distance=f.d,m}function fh(r,e,n,i){this.x=r,this.y=e,this.h=n,this.d=RT(r,e,i),this.max=this.d+this.h*Math.SQRT2}function RT(r,e,n){let i=!1,s=1/0;for(const o of n)for(let a=0,h=o.length,c=h-1;a<h;c=a++){const l=o[a],u=o[c];l[1]>e!=u[1]>e&&r<(u[0]-l[0])*(e-l[1])/(u[1]-l[1])+l[0]&&(i=!i),s=Math.min(s,LT(r,e,l,u))}return s===0?0:(i?1:-1)*Math.sqrt(s)}function OT(r){let e=0,n=0,i=0;const s=r[0];for(let a=0,h=s.length,c=h-1;a<h;c=a++){const l=s[a],u=s[c],f=l[0]*u[1]-u[0]*l[1];n+=(l[0]+u[0])*f,i+=(l[1]+u[1])*f,e+=f*3}const o=new fh(n/e,i/e,0,r);return e===0||o.d<0?new fh(s[0][0],s[0][1],0,r):o}function LT(r,e,n,i){let s=n[0],o=n[1],a=i[0]-s,h=i[1]-o;if(a!==0||h!==0){const c=((r-s)*a+(e-o)*h)/(a*a+h*h);c>1?(s=i[0],o=i[1]):c>0&&(s+=a*c,o+=h*c)}return a=r-s,h=e-o,a*a+h*h}const BT=Object.freeze(Object.defineProperty({__proto__:null,Delaunator:tu,TinySDF:IT,deviation:mT,earcut:eT,flatten:gT,polylabel:kT},Symbol.toStringTag,{value:"Module"})),dx=Math.PI*2,FT=180/Math.PI,NT=Math.PI/180;var fs=(r=>(r[r.POLY=0]="POLY",r[r.RECT=1]="RECT",r[r.CIRC=2]="CIRC",r[r.ELIP=3]="ELIP",r[r.RREC=4]="RREC",r))(fs||{});class Dn{x=0;y=0;constructor(e=0,n=0){this.x=e,this.y=n}clone(){return new Dn(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,n=e){return this.x=e,this.y=n,this}}process.env.DEBUG&&(Dn.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`});const dh=[new Dn,new Dn,new Dn,new Dn];class ds{x;y;width;height;type;constructor(e=0,n=0,i=0,s=0){this.x=Number(e),this.y=Number(n),this.width=Number(i),this.height=Number(s),this.type=fs.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new ds(0,0,0,0)}clone(){return new ds(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,n){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&n>=this.y&&n<this.y+this.height}intersects(e,n){if(!n){const b=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=b)return!1;const _=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>_}const i=this.left,s=this.right,o=this.top,a=this.bottom;if(s<=i||a<=o)return!1;const h=dh[0].set(e.left,e.top),c=dh[1].set(e.left,e.bottom),l=dh[2].set(e.right,e.top),u=dh[3].set(e.right,e.bottom);if(l.x<=h.x||c.y<=h.y)return!1;const f=Math.sign(n.a*n.d-n.b*n.c);if(f===0||(n.apply(h,h),n.apply(c,c),n.apply(l,l),n.apply(u,u),Math.max(h.x,c.x,l.x,u.x)<=i||Math.min(h.x,c.x,l.x,u.x)>=s||Math.max(h.y,c.y,l.y,u.y)<=o||Math.min(h.y,c.y,l.y,u.y)>=a))return!1;const d=f*(c.y-h.y),p=f*(h.x-c.x),y=d*i+p*o,x=d*s+p*o,m=d*i+p*a,g=d*s+p*a;if(Math.max(y,x,m,g)<=d*h.x+p*h.y||Math.min(y,x,m,g)>=d*u.x+p*u.y)return!1;const w=f*(h.y-l.y),M=f*(l.x-h.x),S=w*i+M*o,E=w*s+M*o,A=w*i+M*a,I=w*s+M*a;return!(Math.max(S,E,A,I)<=w*h.x+M*h.y||Math.min(S,E,A,I)>=w*u.x+M*u.y)}pad(e=0,n=e){return this.x-=e,this.y-=n,this.width+=e*2,this.height+=n*2,this}fit(e){const n=Math.max(this.x,e.x),i=Math.min(this.x+this.width,e.x+e.width),s=Math.max(this.y,e.y),o=Math.min(this.y+this.height,e.y+e.height);return this.x=n,this.width=Math.max(i-n,0),this.y=s,this.height=Math.max(o-s,0),this}ceil(e=1,n=.001){const i=Math.ceil((this.x+this.width-n)*e)/e,s=Math.ceil((this.y+this.height-n)*e)/e;return this.x=Math.floor((this.x+n)*e)/e,this.y=Math.floor((this.y+n)*e)/e,this.width=i-this.x,this.height=s-this.y,this}enlarge(e){const n=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),s=Math.min(this.y,e.y),o=Math.max(this.y+this.height,e.y+e.height);return this.x=n,this.width=i-n,this.y=s,this.height=o-s,this}}process.env.DEBUG&&(ds.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`});class ph{x;y;radius;type;constructor(e=0,n=0,i=0){this.x=e,this.y=n,this.radius=i,this.type=fs.CIRC}clone(){return new ph(this.x,this.y,this.radius)}contains(e,n){if(this.radius<=0)return!1;const i=this.radius*this.radius;let s=this.x-e,o=this.y-n;return s*=s,o*=o,s+o<=i}getBounds(){return new ds(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}process.env.DEBUG&&(ph.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`});class yh{x;y;width;height;type;constructor(e=0,n=0,i=0,s=0){this.x=e,this.y=n,this.width=i,this.height=s,this.type=fs.ELIP}clone(){return new yh(this.x,this.y,this.width,this.height)}contains(e,n){if(this.width<=0||this.height<=0)return!1;let i=(e-this.x)/this.width,s=(n-this.y)/this.height;return i*=i,s*=s,i+s<=1}getBounds(){return new ds(this.x-this.width,this.y-this.height,this.width,this.height)}}process.env.DEBUG&&(yh.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`});class xh{points;closeStroke;type;constructor(...e){let n=Array.isArray(e[0])?e[0]:e;if(typeof n[0]!="number"){const i=[];for(let s=0,o=n.length;s<o;s++)i.push(n[s].x,n[s].y);n=i}this.points=n,this.type=fs.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),n=new xh(e);return n.closeStroke=this.closeStroke,n}contains(e,n){let i=!1;const s=this.points.length/2;for(let o=0,a=s-1;o<s;a=o++){const h=this.points[o*2],c=this.points[o*2+1],l=this.points[a*2],u=this.points[a*2+1];c>n!=u>n&&e<(l-h)*((n-c)/(u-c))+h&&(i=!i)}return i}}process.env.DEBUG&&(xh.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((e,n)=>`${e}, ${n}`,"")}]`});class mh{x;y;width;height;radius;type;constructor(e=0,n=0,i=0,s=0,o=20){this.x=e,this.y=n,this.width=i,this.height=s,this.radius=o,this.type=fs.RREC}clone(){return new mh(this.x,this.y,this.width,this.height,this.radius)}contains(e,n){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&n>=this.y&&n<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(n>=this.y+i&&n<=this.y+this.height-i||e>=this.x+i&&e<=this.x+this.width-i)return!0;let s=e-(this.x+i),o=n-(this.y+i);const a=i*i;if(s*s+o*o<=a||(s=e-(this.x+this.width-i),s*s+o*o<=a)||(o=n-(this.y+this.height-i),s*s+o*o<=a)||(s=e-(this.x+i),s*s+o*o<=a))return!0}return!1}}process.env.DEBUG&&(mh.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`});class ri{a;b;c;d;tx;ty;array=null;constructor(e=1,n=0,i=0,s=1,o=0,a=0){this.a=e,this.b=n,this.c=i,this.d=s,this.tx=o,this.ty=a}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,n,i,s,o,a){return this.a=e,this.b=n,this.c=i,this.d=s,this.tx=o,this.ty=a,this}toArray(e,n){this.array||(this.array=new Float32Array(9));const i=n||this.array;return e?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(e,n){n=n||new Dn;const i=e.x,s=e.y;return n.x=this.a*i+this.c*s+this.tx,n.y=this.b*i+this.d*s+this.ty,n}applyInverse(e,n){n=n||new Dn;const i=1/(this.a*this.d+this.c*-this.b),s=e.x,o=e.y;return n.x=this.d*i*s+-this.c*i*o+(this.ty*this.c-this.tx*this.d)*i,n.y=this.a*i*o+-this.b*i*s+(-this.ty*this.a+this.tx*this.b)*i,n}translate(e,n){return this.tx+=e,this.ty+=n,this}scale(e,n){return this.a*=e,this.d*=n,this.c*=e,this.b*=n,this.tx*=e,this.ty*=n,this}rotate(e){const n=Math.cos(e),i=Math.sin(e),s=this.a,o=this.c,a=this.tx;return this.a=s*n-this.b*i,this.b=s*i+this.b*n,this.c=o*n-this.d*i,this.d=o*i+this.d*n,this.tx=a*n-this.ty*i,this.ty=a*i+this.ty*n,this}append(e){const n=this.a,i=this.b,s=this.c,o=this.d;return this.a=e.a*n+e.b*s,this.b=e.a*i+e.b*o,this.c=e.c*n+e.d*s,this.d=e.c*i+e.d*o,this.tx=e.tx*n+e.ty*s+this.tx,this.ty=e.tx*i+e.ty*o+this.ty,this}setTransform(e,n,i,s,o,a,h,c,l){return this.a=Math.cos(h+l)*o,this.b=Math.sin(h+l)*o,this.c=-Math.sin(h-c)*a,this.d=Math.cos(h-c)*a,this.tx=e-(i*this.a+s*this.c),this.ty=n-(i*this.b+s*this.d),this}prepend(e){const n=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const i=this.a,s=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=s*e.a+this.d*e.c,this.d=s*e.b+this.d*e.d}return this.tx=n*e.a+this.ty*e.c+e.tx,this.ty=n*e.b+this.ty*e.d+e.ty,this}decompose(e){const n=this.a,i=this.b,s=this.c,o=this.d,a=e.pivot,h=-Math.atan2(-s,o),c=Math.atan2(i,n),l=Math.abs(h+c);return l<1e-5||Math.abs(dx-l)<1e-5?(e.rotation=c,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=h,e.skew.y=c),e.scale.x=Math.sqrt(n*n+i*i),e.scale.y=Math.sqrt(s*s+o*o),e.position.x=this.tx+(a.x*n+a.y*s),e.position.y=this.ty+(a.x*i+a.y*o),e}invert(){const e=this.a,n=this.b,i=this.c,s=this.d,o=this.tx,a=e*s-n*i;return this.a=s/a,this.b=-n/a,this.c=-i/a,this.d=e/a,this.tx=(i*this.ty-s*o)/a,this.ty=-(e*this.ty-n*o)/a,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new ri;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new ri}static get TEMP_MATRIX(){return new ri}}process.env.DEBUG&&(ri.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`});const ps=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ys=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],xs=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ms=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],nu=[],px=[],gh=Math.sign;function qT(){for(let r=0;r<16;r++){const e=[];nu.push(e);for(let n=0;n<16;n++){const i=gh(ps[r]*ps[n]+xs[r]*ys[n]),s=gh(ys[r]*ps[n]+ms[r]*ys[n]),o=gh(ps[r]*xs[n]+xs[r]*ms[n]),a=gh(ys[r]*xs[n]+ms[r]*ms[n]);for(let h=0;h<16;h++)if(ps[h]===i&&ys[h]===s&&xs[h]===o&&ms[h]===a){e.push(h);break}}}for(let r=0;r<16;r++){const e=new ri;e.set(ps[r],ys[r],xs[r],ms[r],0,0),px.push(e)}}qT();const Mn={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:r=>ps[r],uY:r=>ys[r],vX:r=>xs[r],vY:r=>ms[r],inv:r=>r&8?r&15:-r&7,add:(r,e)=>nu[r][e],sub:(r,e)=>nu[r][Mn.inv(e)],rotate180:r=>r^4,isVertical:r=>(r&3)===2,byDirection:(r,e)=>Math.abs(r)*2<=Math.abs(e)?e>=0?Mn.S:Mn.N:Math.abs(e)*2<=Math.abs(r)?r>0?Mn.E:Mn.W:e>0?r>0?Mn.SE:Mn.SW:r>0?Mn.NE:Mn.NW,matrixAppendRotationInv:(r,e,n=0,i=0)=>{const s=px[Mn.inv(e)];s.tx=n,s.ty=i,r.append(s)}};class gs{cb;scope;_x;_y;constructor(e,n,i=0,s=0){this._x=i,this._y=s,this.cb=e,this.scope=n}clone(e=this.cb,n=this.scope){return new gs(e,n,this._x,this._y)}set(e=0,n=e){return(this._x!==e||this._y!==n)&&(this._x=e,this._y=n,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}class iu{static IDENTITY=new iu;worldTransform;localTransform;position;scale;pivot;skew;_parentID;_worldID;_rotation;_cx;_sx;_cy;_sy;_localID;_currentLocalID;constructor(){this.worldTransform=new ri,this.localTransform=new ri,this.position=new gs(this.onChange,this,0,0),this.scale=new gs(this.onChange,this,1,1),this.pivot=new gs(this.onChange,this,0,0),this.skew=new gs(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(e){const n=this.localTransform;if(this._localID!==this._currentLocalID&&(n.a=this._cx*this.scale.x,n.b=this._sx*this.scale.x,n.c=this._cy*this.scale.y,n.d=this._sy*this.scale.y,n.tx=this.position.x-(this.pivot.x*n.a+this.pivot.y*n.c),n.ty=this.position.y-(this.pivot.x*n.b+this.pivot.y*n.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){const i=e.worldTransform,s=this.worldTransform;s.a=n.a*i.a+n.b*i.c,s.b=n.a*i.b+n.b*i.d,s.c=n.c*i.a+n.d*i.c,s.d=n.c*i.b+n.d*i.d,s.tx=n.tx*i.a+n.ty*i.c+i.tx,s.ty=n.tx*i.b+n.ty*i.d+i.ty,this._parentID=e._worldID,this._worldID++}}setFromMatrix(e){e.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}}const DT=Object.freeze(Object.defineProperty({__proto__:null,Circle:ph,DEG_TO_RAD:NT,Ellipse:yh,Matrix:ri,ObservablePoint:gs,PI_2:dx,Point:Dn,Polygon:xh,RAD_TO_DEG:FT,Rectangle:ds,RoundedRectangle:mh,SHAPES:fs,Transform:iu,groupD8:Mn},Symbol.toStringTag,{value:"Module"}));function yx(r,e,n=0,i=r.length-1,s=$T){for(;i>n;){if(i-n>600){const c=i-n+1,l=e-n+1,u=Math.log(c),f=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*f*(c-f)/c)*(l-c/2<0?-1:1),p=Math.max(n,Math.floor(e-l*f/c+d)),y=Math.min(i,Math.floor(e+(c-l)*f/c+d));yx(r,e,p,y,s)}const o=r[e];let a=n,h=i;for(vo(r,n,e),s(r[i],o)>0&&vo(r,n,i);a<h;){for(vo(r,a,h),a++,h--;s(r[a],o)<0;)a++;for(;s(r[h],o)>0;)h--}s(r[n],o)===0?vo(r,n,h):(h++,vo(r,h,i)),h<=e&&(n=h+1),e<=h&&(i=h-1)}}function vo(r,e,n){const i=r[e];r[e]=r[n],r[n]=i}function $T(r,e){return r<e?-1:r>e?1:0}class VT{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let n=this.data;const i=[];if(!bh(e,n))return i;const s=this.toBBox,o=[];for(;n;){for(let a=0;a<n.children.length;a++){const h=n.children[a],c=n.leaf?s(h):h;bh(e,c)&&(n.leaf?i.push(h):ru(e,c)?this._all(h,i):o.push(h))}n=o.pop()}return i}collides(e){let n=this.data;if(!bh(e,n))return!1;const i=[];for(;n;){for(let s=0;s<n.children.length;s++){const o=n.children[s],a=n.leaf?this.toBBox(o):o;if(bh(e,a)){if(n.leaf||ru(e,a))return!0;i.push(o)}}n=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let n=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=ur([]),this}remove(e,n){if(!e)return this;let i=this.data;const s=this.toBBox(e),o=[],a=[];let h,c,l;for(;i||o.length;){if(i||(i=o.pop(),c=o[o.length-1],h=a.pop(),l=!0),i.leaf){const u=UT(e,i.children,n);if(u!==-1)return i.children.splice(u,1),o.push(i),this._condense(o),this}!l&&!i.leaf&&ru(i,s)?(o.push(i),a.push(h),h=0,c=i,i=i.children[0]):c?(h++,i=c.children[h],l=!1):i=null}return this}toBBox(e){return e}compareMinX(e,n){return e.minX-n.minX}compareMinY(e,n){return e.minY-n.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,n){const i=[];for(;e;)e.leaf?n.push(...e.children):i.push(...e.children),e=i.pop();return n}_build(e,n,i,s){const o=i-n+1;let a=this._maxEntries,h;if(o<=a)return h=ur(e.slice(n,i+1)),lr(h,this.toBBox),h;s||(s=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,s-1))),h=ur([]),h.leaf=!1,h.height=s;const c=Math.ceil(o/a),l=c*Math.ceil(Math.sqrt(a));xx(e,n,i,l,this.compareMinX);for(let u=n;u<=i;u+=l){const f=Math.min(u+l-1,i);xx(e,u,f,c,this.compareMinY);for(let d=u;d<=f;d+=c){const p=Math.min(d+c-1,f);h.children.push(this._build(e,d,p,s-1))}}return lr(h,this.toBBox),h}_chooseSubtree(e,n,i,s){for(;s.push(n),!(n.leaf||s.length-1===i);){let o=1/0,a=1/0,h;for(let c=0;c<n.children.length;c++){const l=n.children[c],u=su(l),f=YT(e,l)-u;f<a?(a=f,o=u<o?u:o,h=l):f===a&&u<o&&(o=u,h=l)}n=h||n.children[0]}return n}_insert(e,n,i){const s=i?e:this.toBBox(e),o=[],a=this._chooseSubtree(s,this.data,n,o);for(a.children.push(e),_o(a,s);n>=0&&o[n].children.length>this._maxEntries;)this._split(o,n),n--;this._adjustParentBBoxes(s,o,n)}_split(e,n){const i=e[n],s=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,s);const a=this._chooseSplitIndex(i,o,s),h=ur(i.children.splice(a,i.children.length-a));h.height=i.height,h.leaf=i.leaf,lr(i,this.toBBox),lr(h,this.toBBox),n?e[n-1].children.push(h):this._splitRoot(i,h)}_splitRoot(e,n){this.data=ur([e,n]),this.data.height=e.height+1,this.data.leaf=!1,lr(this.data,this.toBBox)}_chooseSplitIndex(e,n,i){let s,o=1/0,a=1/0;for(let h=n;h<=i-n;h++){const c=Mo(e,0,h,this.toBBox),l=Mo(e,h,i,this.toBBox),u=HT(c,l),f=su(c)+su(l);u<o?(o=u,s=h,a=f<a?f:a):u===o&&f<a&&(a=f,s=h)}return s||i-n}_chooseSplitAxis(e,n,i){const s=e.leaf?this.compareMinX:WT,o=e.leaf?this.compareMinY:jT,a=this._allDistMargin(e,n,i,s),h=this._allDistMargin(e,n,i,o);a<h&&e.children.sort(s)}_allDistMargin(e,n,i,s){e.children.sort(s);const o=this.toBBox,a=Mo(e,0,n,o),h=Mo(e,i-n,i,o);let c=wh(a)+wh(h);for(let l=n;l<i-n;l++){const u=e.children[l];_o(a,e.leaf?o(u):u),c+=wh(a)}for(let l=i-n-1;l>=n;l--){const u=e.children[l];_o(h,e.leaf?o(u):u),c+=wh(h)}return c}_adjustParentBBoxes(e,n,i){for(let s=i;s>=0;s--)_o(n[s],e)}_condense(e){for(let n=e.length-1,i;n>=0;n--)e[n].children.length===0?n>0?(i=e[n-1].children,i.splice(i.indexOf(e[n]),1)):this.clear():lr(e[n],this.toBBox)}}function UT(r,e,n){if(!n)return e.indexOf(r);for(let i=0;i<e.length;i++)if(n(r,e[i]))return i;return-1}function lr(r,e){Mo(r,0,r.children.length,e,r)}function Mo(r,e,n,i,s){s||(s=ur(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let o=e;o<n;o++){const a=r.children[o];_o(s,r.leaf?i(a):a)}return s}function _o(r,e){return r.minX=Math.min(r.minX,e.minX),r.minY=Math.min(r.minY,e.minY),r.maxX=Math.max(r.maxX,e.maxX),r.maxY=Math.max(r.maxY,e.maxY),r}function WT(r,e){return r.minX-e.minX}function jT(r,e){return r.minY-e.minY}function su(r){return(r.maxX-r.minX)*(r.maxY-r.minY)}function wh(r){return r.maxX-r.minX+(r.maxY-r.minY)}function YT(r,e){return(Math.max(e.maxX,r.maxX)-Math.min(e.minX,r.minX))*(Math.max(e.maxY,r.maxY)-Math.min(e.minY,r.minY))}function HT(r,e){const n=Math.max(r.minX,e.minX),i=Math.max(r.minY,e.minY),s=Math.min(r.maxX,e.maxX),o=Math.min(r.maxY,e.maxY);return Math.max(0,s-n)*Math.max(0,o-i)}function ru(r,e){return r.minX<=e.minX&&r.minY<=e.minY&&e.maxX<=r.maxX&&e.maxY<=r.maxY}function bh(r,e){return e.minX<=r.maxX&&e.minY<=r.maxY&&e.maxX>=r.minX&&e.maxY>=r.minY}function ur(r){return{children:r,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function xx(r,e,n,i,s){const o=[e,n];for(;o.length;){if(n=o.pop(),e=o.pop(),n-e<=i)continue;const a=e+Math.ceil((n-e)/i/2)*i;yx(r,a,e,n,s),o.push(e,a,a,n)}}const XT=Object.freeze(Object.defineProperty({__proto__:null,Bezier:Ut,Big:tT,BigNumber:mn,BoundingRect:Ni,CubicBezier:yc,Matrix:uc,Matrix2D:re,Matrix3:E2,ObservablePoint:Vs,QuadBezier:Ws,RBush:VT,Spline:ob,TinyQueue:fx,TransformableMixin:z2,Vector2:O,bernstein:js,bezierCurvatureAt:Cw,bezierDerivative:Ow,bezierFirstDerivative:hd,bezierSecondDerivative:cd,bigInt:le,center_to_endpoint:U0,chopBezierAt:Br,chopBezierBetween:Bw,chopCubicBezierAt:gc,chopQuadBezierAt:ea,chopQuadBezierAtMaxCurature:Fw,clipper:k_,computeCubicExtremas:Tc,computeQuadExtremas:Sc,conicBezierAt:Ew,conicBezierPointAt:zw,contains:Iv,core:Ov,cubicBezierAt:Ge,cubicBezierPointAt:mc,cubicBezierWithMatrixAt:Iw,cubicLength:Hw,cubicProjectPoint:dd,curve:rb,ellipseArcToCubicBezier:ta,endpoint_to_center:W0,evalCubicBezierTangentAt:$w,evalQuadBezierTangentAt:Dw,findCubicExtrema:Mc,findCubicMaxCurvature:jw,findQuadExtrema:vc,findQuadMaxCurvature:ld,findUnitQuadRoots:_c,flattenCubicBezier:bc,flattenQuadBezier:wc,getBezierDerivativeControlPoints:Lw,getBezierPointWithBernstein:Tw,getBezierPointWithDeCasteljau:xc,getRationalBezierPointWithBernstein:Aw,mapbox:BT,mathigon:jS,pathBool:UM,pathUtil:nv,pixi:DT,pointOnEllipse:j0,pointOnLineDistance:na,pointOnSegmentDistance:Nw,points:D2,polyClip:nM,polytri:p_,quadBezierToCubic:qw,quadBezierWithMatrixAt:Pw,quadraticBezierAt:fn,quadraticBezierPointAt:ad,quadraticLength:Yw,quadraticProjectPoint:fd,quarterArcToCubicBezier:fc,raiseBezier:kw,shapes:F2,shapes2:M_,tess:W_,utils:pw},Symbol.toStringTag,{value:"Module"})),ZT="179dev",GT={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},JT={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},QT=0,KT=1,tE=2,eE=3,nE=0,iE=1,sE=2,rE=3,oE=0,aE=1,hE=2,cE=0,lE=1,uE=2,fE=3,dE=4,pE=5,yE=100,xE=101,mE=102,gE=103,wE=104,bE=200,vE=201,ME=202,_E=203,SE=204,TE=205,EE=206,zE=207,AE=208,CE=209,PE=210,IE=211,kE=212,RE=213,OE=214,LE=0,BE=1,FE=2,NE=3,qE=4,DE=5,$E=6,VE=7,UE=0,WE=1,jE=2,YE=0,HE=1,XE=2,ZE=3,GE=4,JE=5,QE=6,KE=7,tz="attached",ez="detached",ou=300,au=301,nz=302,iz=303,sz=304,rz=306,hu=1e3,Ai=1001,cu=1002,_n=1003,oz=1004,az=1004,hz=1005,cz=1005,fr=1006,lz=1007,uz=1007,mx=1008,fz=1008,lu=1009,gx=1010,wx=1011,bx=1012,vx=1013,uu=1014,fu=1015,Mx=1016,_x=1017,Sx=1018,dz=1020,Tx=35902,Ex=1021,zx=1022,du=1023,pu=1026,Ax=1027,Cx=1028,Px=1029,Ix=1030,kx=1031,pz=1032,Rx=1033,Ox=33776,Lx=33777,Bx=33778,Fx=33779,Nx=35840,qx=35841,Dx=35842,$x=35843,Vx=36196,Ux=37492,Wx=37496,jx=37808,Yx=37809,Hx=37810,Xx=37811,Zx=37812,Gx=37813,Jx=37814,Qx=37815,Kx=37816,tm=37817,em=37818,nm=37819,im=37820,sm=37821,rm=36492,om=36494,am=36495,hm=36283,cm=36284,lm=36285,um=36286,fm=2200,dm=2201,pm=2202,So=2300,vh=2301,Mh=2302,ws=2400,bs=2401,To=2402,_h=2500,yu=2501,yz=0,xz=1,mz=2,gz=3200,wz=3201,bz=3202,vz=3203,Mz=0,_z=1,xu="",an="srgb",mu="srgb-linear",gu="linear",Sh="srgb",Sz=0,Tz=7680,Ez=7681,zz=7682,Az=7683,Cz=34055,Pz=34056,Iz=5386,kz=512,Rz=513,Oz=514,Lz=515,Bz=516,Fz=517,Nz=518,qz=519,Dz=512,$z=513,Vz=514,Uz=515,Wz=516,jz=517,Yz=518,Hz=519,Eo=35044,Xz=35048,Zz=35040,Gz=35045,Jz=35049,Qz=35041,Kz=35046,tA=35050,eA=35042,nA="100",iA="300 es",$n=2e3,zo=2001,sA={COMPUTE:"compute",RENDER:"render"},rA={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},oA={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};class ym{constructor(e,n,i=null,s=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=i,this.blendMode=s;const o=n.tracks,a=o.length,h=new Array(a),c={endingStart:ws,endingEnd:ws};for(let l=0;l!==a;++l){const u=o[l].createInterpolant(null);h[l]=u,u.settings=c}this._interpolantSettings=c,this._interpolants=h,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=dm,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,i=!1){if(e.fadeOut(n),this.fadeIn(n),i===!0){const s=this._clip.duration,o=e._clip.duration,a=o/s,h=s/o;e.warp(1,a,n),this.warp(h,1,n)}return this}crossFadeTo(e,n,i=!1){return e.crossFadeFrom(this,n,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,i){const s=this._mixer,o=s.time,a=this.timeScale;let h=this._timeScaleInterpolant;h===null&&(h=s._lendControlInterpolant(),this._timeScaleInterpolant=h);const c=h.parameterPositions,l=h.sampleValues;return c[0]=o,c[1]=o+i,l[0]=e/a,l[1]=n/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,i,s){if(!this.enabled){this._updateWeight(e);return}const o=this._startTime;if(o!==null){const c=(e-o)*i;c<0||i===0?n=0:(this._startTime=null,n=i*c)}n*=this._updateTimeScale(e);const a=this._updateTime(n),h=this._updateWeight(e);if(h>0){const c=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case yu:for(let u=0,f=c.length;u!==f;++u)c[u].evaluate(a),l[u].accumulateAdditive(h);break;case _h:default:for(let u=0,f=c.length;u!==f;++u)c[u].evaluate(a),l[u].accumulate(s,h)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const i=this._weightInterpolant;if(i!==null){const s=i.evaluate(e)[0];n*=s,e>i.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const s=i.evaluate(e)[0];n*=s,e>i.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,i=this.loop;let s=this.time+e,o=this._loopCount;const a=i===pm;if(e===0)return o===-1?s:a&&(o&1)===1?n-s:s;if(i===fm){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(s>=n)s=n;else if(s<0)s=0;else{this.time=s;break t}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(o===-1&&(e>=0?(o=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),s>=n||s<0){const h=Math.floor(s/n);s-=n*h,o+=Math.abs(h);const c=this.repetitions-o;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?n:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(c===1){const l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=o,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:h})}}else this.time=s;if(a&&(o&1)===1)return n-s}return s}_setEndings(e,n,i){const s=this._interpolantSettings;i?(s.endingStart=bs,s.endingEnd=bs):(e?s.endingStart=this.zeroSlopeAtStart?bs:ws:s.endingStart=To,n?s.endingEnd=this.zeroSlopeAtEnd?bs:ws:s.endingEnd=To)}_scheduleFading(e,n,i){const s=this._mixer,o=s.time;let a=this._weightInterpolant;a===null&&(a=s._lendControlInterpolant(),this._weightInterpolant=a);const h=a.parameterPositions,c=a.sampleValues;return h[0]=o,c[0]=n,h[1]=o+e,c[1]=i,this}}const ge=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let xm=1234567;const vs=Math.PI/180,Th=180/Math.PI;function Sn(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(ge[r&255]+ge[r>>8&255]+ge[r>>16&255]+ge[r>>24&255]+"-"+ge[e&255]+ge[e>>8&255]+"-"+ge[e>>16&15|64]+ge[e>>24&255]+"-"+ge[n&63|128]+ge[n>>8&255]+"-"+ge[n>>16&255]+ge[n>>24&255]+ge[i&255]+ge[i>>8&255]+ge[i>>16&255]+ge[i>>24&255]).toLowerCase()}function Mt(r,e,n){return Math.max(e,Math.min(n,r))}function wu(r,e){return(r%e+e)%e}function aA(r,e,n,i,s){return i+(r-e)*(s-i)/(n-e)}function hA(r,e,n){return r!==e?(n-r)/(e-r):0}function Ao(r,e,n){return(1-n)*r+n*e}function cA(r,e,n,i){return Ao(r,e,1-Math.exp(-n*i))}function lA(r,e=1){return e-Math.abs(wu(r,e*2)-e)}function uA(r,e,n){return r<=e?0:r>=n?1:(r=(r-e)/(n-e),r*r*(3-2*r))}function fA(r,e,n){return r<=e?0:r>=n?1:(r=(r-e)/(n-e),r*r*r*(r*(r*6-15)+10))}function dA(r,e){return r+Math.floor(Math.random()*(e-r+1))}function pA(r,e){return r+Math.random()*(e-r)}function yA(r){return r*(.5-Math.random())}function xA(r){r!==void 0&&(xm=r);let e=xm+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function mA(r){return r*vs}function gA(r){return r*Th}function wA(r){return(r&r-1)===0&&r!==0}function bA(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function vA(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function MA(r,e,n,i,s){const o=Math.cos,a=Math.sin,h=o(n/2),c=a(n/2),l=o((e+i)/2),u=a((e+i)/2),f=o((e-i)/2),d=a((e-i)/2),p=o((i-e)/2),y=a((i-e)/2);switch(s){case"XYX":r.set(h*u,c*f,c*d,h*l);break;case"YZY":r.set(c*d,h*u,c*f,h*l);break;case"ZXZ":r.set(c*f,c*d,h*u,h*l);break;case"XZX":r.set(h*u,c*y,c*p,h*l);break;case"YXY":r.set(c*p,h*u,c*y,h*l);break;case"ZYZ":r.set(c*y,c*p,h*u,h*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function Pe(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return r/4294967295;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int32Array:return Math.max(r/2147483647,-1);case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function _t(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return Math.round(r*4294967295);case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int32Array:return Math.round(r*2147483647);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}const _A={DEG2RAD:vs,RAD2DEG:Th,generateUUID:Sn,clamp:Mt,euclideanModulo:wu,mapLinear:aA,inverseLerp:hA,lerp:Ao,damp:cA,pingpong:lA,smoothstep:uA,smootherstep:fA,randInt:dA,randFloat:pA,randFloatSpread:yA,seededRandom:xA,degToRad:mA,radToDeg:gA,isPowerOfTwo:wA,ceilPowerOfTwo:bA,floorPowerOfTwo:vA,setQuaternionFromProperEuler:MA,normalize:_t,denormalize:Pe};class Ne{constructor(e=0,n=0,i=0,s=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=s}static slerpFlat(e,n,i,s,o,a,h){let c=i[s+0],l=i[s+1],u=i[s+2],f=i[s+3];const d=o[a+0],p=o[a+1],y=o[a+2],x=o[a+3];if(h===0){e[n+0]=c,e[n+1]=l,e[n+2]=u,e[n+3]=f;return}if(h===1){e[n+0]=d,e[n+1]=p,e[n+2]=y,e[n+3]=x;return}if(f!==x||c!==d||l!==p||u!==y){let m=1-h;const g=c*d+l*p+u*y+f*x,w=g>=0?1:-1,M=1-g*g;if(M>Number.EPSILON){const E=Math.sqrt(M),A=Math.atan2(E,g*w);m=Math.sin(m*A)/E,h=Math.sin(h*A)/E}const S=h*w;if(c=c*m+d*S,l=l*m+p*S,u=u*m+y*S,f=f*m+x*S,m===1-h){const E=1/Math.sqrt(c*c+l*l+u*u+f*f);c*=E,l*=E,u*=E,f*=E}}e[n]=c,e[n+1]=l,e[n+2]=u,e[n+3]=f}static multiplyQuaternionsFlat(e,n,i,s,o,a){const h=i[s],c=i[s+1],l=i[s+2],u=i[s+3],f=o[a],d=o[a+1],p=o[a+2],y=o[a+3];return e[n]=h*y+u*f+c*p-l*d,e[n+1]=c*y+u*d+l*f-h*p,e[n+2]=l*y+u*p+h*d-c*f,e[n+3]=u*y-h*f-c*d-l*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,s){return this._x=e,this._y=n,this._z=i,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const i=e._x,s=e._y,o=e._z,a=e._order,h=Math.cos,c=Math.sin,l=h(i/2),u=h(s/2),f=h(o/2),d=c(i/2),p=c(s/2),y=c(o/2);switch(a){case"XYZ":this._x=d*u*f+l*p*y,this._y=l*p*f-d*u*y,this._z=l*u*y+d*p*f,this._w=l*u*f-d*p*y;break;case"YXZ":this._x=d*u*f+l*p*y,this._y=l*p*f-d*u*y,this._z=l*u*y-d*p*f,this._w=l*u*f+d*p*y;break;case"ZXY":this._x=d*u*f-l*p*y,this._y=l*p*f+d*u*y,this._z=l*u*y+d*p*f,this._w=l*u*f-d*p*y;break;case"ZYX":this._x=d*u*f-l*p*y,this._y=l*p*f+d*u*y,this._z=l*u*y-d*p*f,this._w=l*u*f+d*p*y;break;case"YZX":this._x=d*u*f+l*p*y,this._y=l*p*f+d*u*y,this._z=l*u*y-d*p*f,this._w=l*u*f-d*p*y;break;case"XZY":this._x=d*u*f-l*p*y,this._y=l*p*f-d*u*y,this._z=l*u*y+d*p*f,this._w=l*u*f+d*p*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,s=Math.sin(i);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],s=n[4],o=n[8],a=n[1],h=n[5],c=n[9],l=n[2],u=n[6],f=n[10],d=i+h+f;if(d>0){const p=.5/Math.sqrt(d+1);this._w=.25/p,this._x=(u-c)*p,this._y=(o-l)*p,this._z=(a-s)*p}else if(i>h&&i>f){const p=2*Math.sqrt(1+i-h-f);this._w=(u-c)/p,this._x=.25*p,this._y=(s+a)/p,this._z=(o+l)/p}else if(h>f){const p=2*Math.sqrt(1+h-i-f);this._w=(o-l)/p,this._x=(s+a)/p,this._y=.25*p,this._z=(c+u)/p}else{const p=2*Math.sqrt(1+f-i-h);this._w=(a-s)/p,this._x=(o+l)/p,this._y=(c+u)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<1e-8?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Mt(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const s=Math.min(1,n/i);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,s=e._y,o=e._z,a=e._w,h=n._x,c=n._y,l=n._z,u=n._w;return this._x=i*u+a*h+s*l-o*c,this._y=s*u+a*c+o*h-i*l,this._z=o*u+a*l+i*c-s*h,this._w=a*u-i*h-s*c-o*l,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,s=this._y,o=this._z,a=this._w;let h=a*e._w+i*e._x+s*e._y+o*e._z;if(h<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,h=-h):this.copy(e),h>=1)return this._w=a,this._x=i,this._y=s,this._z=o,this;const c=1-h*h;if(c<=Number.EPSILON){const p=1-n;return this._w=p*a+n*this._w,this._x=p*i+n*this._x,this._y=p*s+n*this._y,this._z=p*o+n*this._z,this.normalize(),this}const l=Math.sqrt(c),u=Math.atan2(l,h),f=Math.sin((1-n)*u)/l,d=Math.sin(n*u)/l;return this._w=a*f+this._w*d,this._x=i*f+this._x*d,this._y=s*f+this._y*d,this._z=o*f+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),i=Math.random(),s=Math.sqrt(1-i),o=Math.sqrt(i);return this.set(s*Math.sin(e),s*Math.cos(e),o*Math.sin(n),o*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}function Ms(r,e){return!r||r.constructor===e?r:typeof e.BYTES_PER_ELEMENT=="number"?new e(r):Array.prototype.slice.call(r)}function mm(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function gm(r){function e(s,o){return r[s]-r[o]}const n=r.length,i=new Array(n);for(let s=0;s!==n;++s)i[s]=s;return i.sort(e),i}function bu(r,e,n){const i=r.length,s=new r.constructor(i);for(let o=0,a=0;a!==i;++o){const h=n[o]*e;for(let c=0;c!==e;++c)s[a++]=r[h+c]}return s}function vu(r,e,n,i){let s=1,o=r[0];for(;o!==void 0&&o[i]===void 0;)o=r[s++];if(o===void 0)return;let a=o[i];if(a!==void 0)if(Array.isArray(a))do a=o[i],a!==void 0&&(e.push(o.time),n.push(...a)),o=r[s++];while(o!==void 0);else if(a.toArray!==void 0)do a=o[i],a!==void 0&&(e.push(o.time),a.toArray(n,n.length)),o=r[s++];while(o!==void 0);else do a=o[i],a!==void 0&&(e.push(o.time),n.push(a)),o=r[s++];while(o!==void 0)}function SA(r,e,n,i,s=30){const o=r.clone();o.name=e;const a=[];for(let c=0;c<o.tracks.length;++c){const l=o.tracks[c],u=l.getValueSize(),f=[],d=[];for(let p=0;p<l.times.length;++p){const y=l.times[p]*s;if(!(y<n||y>=i)){f.push(l.times[p]);for(let x=0;x<u;++x)d.push(l.values[p*u+x])}}f.length!==0&&(l.times=Ms(f,l.times.constructor),l.values=Ms(d,l.values.constructor),a.push(l))}o.tracks=a;let h=1/0;for(let c=0;c<o.tracks.length;++c)h>o.tracks[c].times[0]&&(h=o.tracks[c].times[0]);for(let c=0;c<o.tracks.length;++c)o.tracks[c].shift(-1*h);return o.resetDuration(),o}function TA(r,e=0,n=r,i=30){i<=0&&(i=30);const s=n.tracks.length,o=e/i;for(let a=0;a<s;++a){const h=n.tracks[a],c=h.ValueTypeName;if(c==="bool"||c==="string")continue;const l=r.tracks.find(function(g){return g.name===h.name&&g.ValueTypeName===c});if(l===void 0)continue;let u=0;const f=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=f/3);let d=0;const p=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=p/3);const y=h.times.length-1;let x;if(o<=h.times[0]){const g=u,w=f-u;x=h.values.slice(g,w)}else if(o>=h.times[y]){const g=y*f+u,w=g+f-u;x=h.values.slice(g,w)}else{const g=h.createInterpolant(),w=u,M=f-u;g.evaluate(o),x=g.resultBuffer.slice(w,M)}c==="quaternion"&&new Ne().fromArray(x).normalize().conjugate().toArray(x);const m=l.times.length;for(let g=0;g<m;++g){const w=g*p+d;if(c==="quaternion")Ne.multiplyQuaternionsFlat(l.values,w,x,0,l.values,w);else{const M=p-d*2;for(let S=0;S<M;++S)l.values[w+S]-=x[S]}}}return r.blendMode=yu,r}class EA{static convertArray(e,n){return Ms(e,n)}static isTypedArray(e){return mm(e)}static getKeyframeOrder(e){return gm(e)}static sortedArray(e,n,i){return bu(e,n,i)}static flattenJSON(e,n,i,s){vu(e,n,i,s)}static subclip(e,n,i,s,o=30){return SA(e,n,i,s,o)}static makeClipAdditive(e,n=0,i=e,s=30){return TA(e,n,i,s)}}class Co{constructor(e,n,i,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let i=this._cachedIndex,s=n[i],o=n[i-1];t:{e:{let a;n:{i:if(!(e<s)){for(let h=i+2;;){if(s===void 0){if(e<o)break i;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===h)break;if(o=s,s=n[++i],e<s)break e}a=n.length;break n}if(!(e>=o)){const h=n[1];e<h&&(i=2,o=h);for(let c=i-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(s=o,o=n[--i-1],e>=o)break e}a=i,i=0;break n}break t}for(;i<a;){const h=i+a>>>1;e<n[h]?a=h:i=h+1}if(s=n[i],o=n[i-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,o,s)}return this.interpolate_(i,o,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,s=this.valueSize,o=e*s;for(let a=0;a!==s;++a)n[a]=i[o+a];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class wm extends Co{constructor(e,n,i,s){super(e,n,i,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ws,endingEnd:ws}}intervalChanged_(e,n,i){const s=this.parameterPositions;let o=e-2,a=e+1,h=s[o],c=s[a];if(h===void 0)switch(this.getSettings_().endingStart){case bs:o=e,h=2*n-i;break;case To:o=s.length-2,h=n+s[o]-s[o+1];break;default:o=e,h=i}if(c===void 0)switch(this.getSettings_().endingEnd){case bs:a=e,c=2*i-n;break;case To:a=1,c=i+s[1]-s[0];break;default:a=e-1,c=n}const l=(i-n)*.5,u=this.valueSize;this._weightPrev=l/(n-h),this._weightNext=l/(c-i),this._offsetPrev=o*u,this._offsetNext=a*u}interpolate_(e,n,i,s){const o=this.resultBuffer,a=this.sampleValues,h=this.valueSize,c=e*h,l=c-h,u=this._offsetPrev,f=this._offsetNext,d=this._weightPrev,p=this._weightNext,y=(i-n)/(s-n),x=y*y,m=x*y,g=-d*m+2*d*x-d*y,w=(1+d)*m+(-1.5-2*d)*x+(-.5+d)*y+1,M=(-1-p)*m+(1.5+p)*x+.5*y,S=p*m-p*x;for(let E=0;E!==h;++E)o[E]=g*a[u+E]+w*a[l+E]+M*a[c+E]+S*a[f+E];return o}}class Mu extends Co{constructor(e,n,i,s){super(e,n,i,s)}interpolate_(e,n,i,s){const o=this.resultBuffer,a=this.sampleValues,h=this.valueSize,c=e*h,l=c-h,u=(i-n)/(s-n),f=1-u;for(let d=0;d!==h;++d)o[d]=a[l+d]*f+a[c+d]*u;return o}}class bm extends Co{constructor(e,n,i,s){super(e,n,i,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class hn{constructor(e,n,i,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ms(n,this.TimeBufferType),this.values=Ms(i,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:Ms(e.times,Array),values:Ms(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(i.interpolation=s)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new bm(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Mu(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new wm(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case So:n=this.InterpolantFactoryMethodDiscrete;break;case vh:n=this.InterpolantFactoryMethodLinear;break;case Mh:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return So;case this.InterpolantFactoryMethodLinear:return vh;case this.InterpolantFactoryMethodSmooth:return Mh}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let i=0,s=n.length;i!==s;++i)n[i]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let i=0,s=n.length;i!==s;++i)n[i]*=e}return this}trim(e,n){const i=this.times,s=i.length;let o=0,a=s-1;for(;o!==s&&i[o]<e;)++o;for(;a!==-1&&i[a]>n;)--a;if(++a,o!==0||a!==s){o>=a&&(a=Math.max(a,1),o=a-1);const h=this.getValueSize();this.times=i.slice(o,a),this.values=this.values.slice(o*h,a*h)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,s=this.values,o=i.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let h=0;h!==o;h++){const c=i[h];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,h,c),e=!1;break}if(a!==null&&a>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,h,c,a),e=!1;break}a=c}if(s!==void 0&&mm(s))for(let h=0,c=s.length;h!==c;++h){const l=s[h];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,h,l),e=!1;break}}return e}optimize(){const e=this.times.slice(),n=this.values.slice(),i=this.getValueSize(),s=this.getInterpolation()===Mh,o=e.length-1;let a=1;for(let h=1;h<o;++h){let c=!1;const l=e[h],u=e[h+1];if(l!==u&&(h!==1||l!==e[0]))if(s)c=!0;else{const f=h*i,d=f-i,p=f+i;for(let y=0;y!==i;++y){const x=n[f+y];if(x!==n[d+y]||x!==n[p+y]){c=!0;break}}}if(c){if(h!==a){e[a]=e[h];const f=h*i,d=a*i;for(let p=0;p!==i;++p)n[d+p]=n[f+p]}++a}}if(o>0){e[a]=e[o];for(let h=o*i,c=a*i,l=0;l!==i;++l)n[c+l]=n[h+l];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=n.slice(0,a*i)):(this.times=e,this.values=n),this}clone(){const e=this.times.slice(),n=this.values.slice(),i=this.constructor,s=new i(this.name,e,n);return s.createInterpolant=this.createInterpolant,s}}hn.prototype.ValueTypeName="",hn.prototype.TimeBufferType=Float32Array,hn.prototype.ValueBufferType=Float32Array,hn.prototype.DefaultInterpolation=vh;class _s extends hn{constructor(e,n,i){super(e,n,i)}}_s.prototype.ValueTypeName="bool",_s.prototype.ValueBufferType=Array,_s.prototype.DefaultInterpolation=So,_s.prototype.InterpolantFactoryMethodLinear=void 0,_s.prototype.InterpolantFactoryMethodSmooth=void 0;class _u extends hn{constructor(e,n,i,s){super(e,n,i,s)}}_u.prototype.ValueTypeName="color";class Po extends hn{constructor(e,n,i,s){super(e,n,i,s)}}Po.prototype.ValueTypeName="number";class vm extends Co{constructor(e,n,i,s){super(e,n,i,s)}interpolate_(e,n,i,s){const o=this.resultBuffer,a=this.sampleValues,h=this.valueSize,c=(i-n)/(s-n);let l=e*h;for(let u=l+h;l!==u;l+=4)Ne.slerpFlat(o,0,a,l-h,a,l,c);return o}}class Io extends hn{constructor(e,n,i,s){super(e,n,i,s)}InterpolantFactoryMethodLinear(e){return new vm(this.times,this.values,this.getValueSize(),e)}}Io.prototype.ValueTypeName="quaternion",Io.prototype.InterpolantFactoryMethodSmooth=void 0;class Ss extends hn{constructor(e,n,i){super(e,n,i)}}Ss.prototype.ValueTypeName="string",Ss.prototype.ValueBufferType=Array,Ss.prototype.DefaultInterpolation=So,Ss.prototype.InterpolantFactoryMethodLinear=void 0,Ss.prototype.InterpolantFactoryMethodSmooth=void 0;class ko extends hn{constructor(e,n,i,s){super(e,n,i,s)}}ko.prototype.ValueTypeName="vector";class Su{constructor(e="",n=-1,i=[],s=_h){this.name=e,this.tracks=i,this.duration=n,this.blendMode=s,this.uuid=Sn(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],i=e.tracks,s=1/(e.fps||1);for(let a=0,h=i.length;a!==h;++a)n.push(AA(i[a]).scale(s));const o=new this(e.name,e.duration,n,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){const n=[],i=e.tracks,s={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,a=i.length;o!==a;++o)n.push(hn.toJSON(i[o]));return s}static CreateFromMorphTargetSequence(e,n,i,s){const o=n.length,a=[];for(let h=0;h<o;h++){let c=[],l=[];c.push((h+o-1)%o,h,(h+1)%o),l.push(0,1,0);const u=gm(c);c=bu(c,1,u),l=bu(l,1,u),!s&&c[0]===0&&(c.push(o),l.push(l[0])),a.push(new Po(".morphTargetInfluences["+n[h].name+"]",c,l).scale(1/i))}return new this(e,-1,a)}static findByName(e,n){let i=e;if(!Array.isArray(e)){const s=e;i=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<i.length;s++)if(i[s].name===n)return i[s];return null}static CreateClipsFromMorphTargetSequences(e,n,i){const s={},o=/^([\w-]*?)([\d]+)$/;for(let h=0,c=e.length;h<c;h++){const l=e[h],u=l.name.match(o);if(u&&u.length>1){const f=u[1];let d=s[f];d||(s[f]=d=[]),d.push(l)}}const a=[];for(const h in s)a.push(this.CreateFromMorphTargetSequence(h,s[h],n,i));return a}static parseAnimation(e,n){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(f,d,p,y,x){if(p.length!==0){const m=[],g=[];vu(p,m,g,y),m.length!==0&&x.push(new f(d,m,g))}},s=[],o=e.name||"default",a=e.fps||30,h=e.blendMode;let c=e.length||-1;const l=e.hierarchy||[];for(let f=0;f<l.length;f++){const d=l[f].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const p={};let y;for(y=0;y<d.length;y++)if(d[y].morphTargets)for(let x=0;x<d[y].morphTargets.length;x++)p[d[y].morphTargets[x]]=-1;for(const x in p){const m=[],g=[];for(let w=0;w!==d[y].morphTargets.length;++w){const M=d[y];m.push(M.time),g.push(M.morphTarget===x?1:0)}s.push(new Po(".morphTargetInfluence["+x+"]",m,g))}c=p.length*a}else{const p=".bones["+n[f].name+"]";i(ko,p+".position",d,"pos",s),i(Io,p+".quaternion",d,"rot",s),i(ko,p+".scale",d,"scl",s)}}return s.length===0?null:new this(o,c,s,h)}resetDuration(){const e=this.tracks;let n=0;for(let i=0,s=e.length;i!==s;++i){const o=this.tracks[i];n=Math.max(n,o.times[o.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function zA(r){switch(r.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Po;case"vector":case"vector2":case"vector3":case"vector4":return ko;case"color":return _u;case"quaternion":return Io;case"bool":case"boolean":return _s;case"string":return Ss}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+r)}function AA(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=zA(r.type);if(r.times===void 0){const n=[],i=[];vu(r.keys,n,i,"value"),r.times=n,r.values=i}return e.parse!==void 0?e.parse(r):new e(r.name,r.times,r.values,r.interpolation)}class Ci{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){const i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){const i=this._listeners;if(i===void 0)return;const s=i[e];if(s!==void 0){const o=s.indexOf(n);o!==-1&&s.splice(o,1)}}dispatchEvent(e){const n=this._listeners;if(n===void 0)return;const i=n[e.type];if(i!==void 0){e.target=this;const s=i.slice(0);for(let o=0,a=s.length;o<a;o++)s[o].call(this,e);e.target=null}}}const Tu="\\[\\]\\.:\\/",CA=new RegExp("["+Tu+"]","g"),Eu="[^"+Tu+"]",PA="[^"+Tu.replace("\\.","")+"]",IA=/((?:WC+[\/:])*)/.source.replace("WC",Eu),kA=/(WCOD+)?/.source.replace("WCOD",PA),RA=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Eu),OA=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Eu),LA=new RegExp("^"+IA+kA+RA+OA+"$"),BA=["material","materials","bones","map"];class FA{constructor(e,n,i){const s=i||kt.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,s)}getValue(e,n){this.bind();const i=this._targetGroup.nCachedObjects_,s=this._bindings[i];s!==void 0&&s.getValue(e,n)}setValue(e,n){const i=this._bindings;for(let s=this._targetGroup.nCachedObjects_,o=i.length;s!==o;++s)i[s].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}}class kt{constructor(e,n,i){this.path=n,this.parsedPath=i||kt.parseTrackName(n),this.node=kt.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,i){return e&&e.isAnimationObjectGroup?new kt.Composite(e,n,i):new kt(e,n,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(CA,"")}static parseTrackName(e){const n=LA.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=i.nodeName&&i.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const o=i.nodeName.substring(s+1);BA.indexOf(o)!==-1&&(i.nodeName=i.nodeName.substring(0,s),i.objectName=o)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(n);if(i!==void 0)return i}if(e.children){const i=function(o){for(let a=0;a<o.length;a++){const h=o[a];if(h.name===n||h.uuid===n)return h;const c=i(h.children);if(c)return c}return null},s=i(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const i=this.resolvedProperty;for(let s=0,o=i.length;s!==o;++s)e[n++]=i[s]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const i=this.resolvedProperty;for(let s=0,o=i.length;s!==o;++s)i[s]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const i=this.resolvedProperty;for(let s=0,o=i.length;s!==o;++s)i[s]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const i=this.resolvedProperty;for(let s=0,o=i.length;s!==o;++s)i[s]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,i=n.objectName,s=n.propertyName;let o=n.propertyIndex;if(e||(e=kt.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let l=n.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===l){l=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(l!==void 0){if(e[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[l]}}const a=e[s];if(a===void 0){const l=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+s+" but it wasn't found.",e);return}let h=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?h=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(h=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(o!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[o]!==void 0&&(o=e.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else a.fromArray!==void 0&&a.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][h]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}kt.Composite=FA,kt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},kt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},kt.prototype.GetterByBindingType=[kt.prototype._getValue_direct,kt.prototype._getValue_array,kt.prototype._getValue_arrayElement,kt.prototype._getValue_toArray],kt.prototype.SetterByBindingTypeAndVersioning=[[kt.prototype._setValue_direct,kt.prototype._setValue_direct_setNeedsUpdate,kt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[kt.prototype._setValue_array,kt.prototype._setValue_array_setNeedsUpdate,kt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[kt.prototype._setValue_arrayElement,kt.prototype._setValue_arrayElement_setNeedsUpdate,kt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[kt.prototype._setValue_fromArray,kt.prototype._setValue_fromArray_setNeedsUpdate,kt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Mm{constructor(e,n,i){this.binding=e,this.valueSize=i;let s,o,a;switch(n){case"quaternion":s=this._slerp,o=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":s=this._select,o=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:s=this._lerp,o=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=o,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const i=this.buffer,s=this.valueSize,o=e*s+s;let a=this.cumulativeWeight;if(a===0){for(let h=0;h!==s;++h)i[o+h]=i[h];a=n}else{a+=n;const h=n/a;this._mixBufferRegion(i,o,0,h,s)}this.cumulativeWeight=a}accumulateAdditive(e){const n=this.buffer,i=this.valueSize,s=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,s,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,i=this.buffer,s=e*n+n,o=this.cumulativeWeight,a=this.cumulativeWeightAdditive,h=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){const c=n*this._origIndex;this._mixBufferRegion(i,s,c,1-o,n)}a>0&&this._mixBufferRegionAdditive(i,s,this._addIndex*n,1,n);for(let c=n,l=n+n;c!==l;++c)if(i[c]!==i[c+n]){h.setValue(i,s);break}}saveOriginalState(){const e=this.binding,n=this.buffer,i=this.valueSize,s=i*this._origIndex;e.getValue(n,s);for(let o=i,a=s;o!==a;++o)n[o]=n[s+o%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let i=e;i<n;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[n+i]=this.buffer[e+i]}_select(e,n,i,s,o){if(s>=.5)for(let a=0;a!==o;++a)e[n+a]=e[i+a]}_slerp(e,n,i,s){Ne.slerpFlat(e,n,e,n,e,i,s)}_slerpAdditive(e,n,i,s,o){const a=this._workIndex*o;Ne.multiplyQuaternionsFlat(e,a,e,n,e,i),Ne.slerpFlat(e,n,e,n,e,a,s)}_lerp(e,n,i,s,o){const a=1-s;for(let h=0;h!==o;++h){const c=n+h;e[c]=e[c]*a+e[i+h]*s}}_lerpAdditive(e,n,i,s,o){for(let a=0;a!==o;++a){const h=n+a;e[h]=e[h]+e[i+a]*s}}}const NA=new Float32Array(1);class qA extends Ci{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const i=e._localRoot||this._root,s=e._clip.tracks,o=s.length,a=e._propertyBindings,h=e._interpolants,c=i.uuid,l=this._bindingsByRootAndName;let u=l[c];u===void 0&&(u={},l[c]=u);for(let f=0;f!==o;++f){const d=s[f],p=d.name;let y=u[p];if(y!==void 0)++y.referenceCount,a[f]=y;else{if(y=a[f],y!==void 0){y._cacheIndex===null&&(++y.referenceCount,this._addInactiveBinding(y,c,p));continue}const x=n&&n._propertyBindings[f].binding.parsedPath;y=new Mm(kt.create(i,p,x),d.ValueTypeName,d.getValueSize()),++y.referenceCount,this._addInactiveBinding(y,c,p),a[f]=y}h[f].resultBuffer=y.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,s=e._clip.uuid,o=this._actionsByClip[s];this._bindAction(e,o&&o.knownActions[0]),this._addInactiveAction(e,s,i)}const n=e._propertyBindings;for(let i=0,s=n.length;i!==s;++i){const o=n[i];o.useCount++===0&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let i=0,s=n.length;i!==s;++i){const o=n[i];--o.useCount===0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,i){const s=this._actions,o=this._actionsByClip;let a=o[n];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[n]=a;else{const h=a.knownActions;e._byClipCacheIndex=h.length,h.push(e)}e._cacheIndex=s.length,s.push(e),a.actionByRoot[i]=e}_removeInactiveAction(e){const n=this._actions,i=n[n.length-1],s=e._cacheIndex;i._cacheIndex=s,n[s]=i,n.pop(),e._cacheIndex=null;const o=e._clip.uuid,a=this._actionsByClip,h=a[o],c=h.knownActions,l=c[c.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,c[u]=l,c.pop(),e._byClipCacheIndex=null;const f=h.actionByRoot,d=(e._localRoot||this._root).uuid;delete f[d],c.length===0&&delete a[o],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let i=0,s=n.length;i!==s;++i){const o=n[i];--o.referenceCount===0&&this._removeInactiveBinding(o)}}_lendAction(e){const n=this._actions,i=e._cacheIndex,s=this._nActiveActions++,o=n[s];e._cacheIndex=s,n[s]=e,o._cacheIndex=i,n[i]=o}_takeBackAction(e){const n=this._actions,i=e._cacheIndex,s=--this._nActiveActions,o=n[s];e._cacheIndex=s,n[s]=e,o._cacheIndex=i,n[i]=o}_addInactiveBinding(e,n,i){const s=this._bindingsByRootAndName,o=this._bindings;let a=s[n];a===void 0&&(a={},s[n]=a),a[i]=e,e._cacheIndex=o.length,o.push(e)}_removeInactiveBinding(e){const n=this._bindings,i=e.binding,s=i.rootNode.uuid,o=i.path,a=this._bindingsByRootAndName,h=a[s],c=n[n.length-1],l=e._cacheIndex;c._cacheIndex=l,n[l]=c,n.pop(),delete h[o],Object.keys(h).length===0&&delete a[s]}_lendBinding(e){const n=this._bindings,i=e._cacheIndex,s=this._nActiveBindings++,o=n[s];e._cacheIndex=s,n[s]=e,o._cacheIndex=i,n[i]=o}_takeBackBinding(e){const n=this._bindings,i=e._cacheIndex,s=--this._nActiveBindings,o=n[s];e._cacheIndex=s,n[s]=e,o._cacheIndex=i,n[i]=o}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let i=e[n];return i===void 0&&(i=new Mu(new Float32Array(2),new Float32Array(2),1,NA),i.__cacheIndex=n,e[n]=i),i}_takeBackControlInterpolant(e){const n=this._controlInterpolants,i=e.__cacheIndex,s=--this._nActiveControlInterpolants,o=n[s];e.__cacheIndex=s,n[s]=e,o.__cacheIndex=i,n[i]=o}clipAction(e,n,i){const s=n||this._root,o=s.uuid;let a=typeof e=="string"?Su.findByName(s,e):e;const h=a!==null?a.uuid:e,c=this._actionsByClip[h];let l=null;if(i===void 0&&(a!==null?i=a.blendMode:i=_h),c!==void 0){const f=c.actionByRoot[o];if(f!==void 0&&f.blendMode===i)return f;l=c.knownActions[0],a===null&&(a=l._clip)}if(a===null)return null;const u=new ym(this,a,n,i);return this._bindAction(u,l),this._addInactiveAction(u,h,o),u}existingAction(e,n){const i=n||this._root,s=i.uuid,o=typeof e=="string"?Su.findByName(i,e):e,a=o?o.uuid:e,h=this._actionsByClip[a];return h!==void 0&&h.actionByRoot[s]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let i=n-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const n=this._actions,i=this._nActiveActions,s=this.time+=e,o=Math.sign(e),a=this._accuIndex^=1;for(let l=0;l!==i;++l)n[l]._update(s,e,o,a);const h=this._bindings,c=this._nActiveBindings;for(let l=0;l!==c;++l)h[l].apply(a);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,i=e.uuid,s=this._actionsByClip,o=s[i];if(o!==void 0){const a=o.knownActions;for(let h=0,c=a.length;h!==c;++h){const l=a[h];this._deactivateAction(l);const u=l._cacheIndex,f=n[n.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,f._cacheIndex=u,n[u]=f,n.pop(),this._removeInactiveBindingsForAction(l)}delete s[i]}}uncacheRoot(e){const n=e.uuid,i=this._actionsByClip;for(const a in i){const h=i[a].actionByRoot,c=h[n];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}const s=this._bindingsByRootAndName,o=s[n];if(o!==void 0)for(const a in o){const h=o[a];h.restoreOriginalState(),this._removeInactiveBinding(h)}}uncacheAction(e,n){const i=this.existingAction(e,n);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class DA{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Sn(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,s=arguments.length;i!==s;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,i=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length;let h,c=e.length,l=this.nCachedObjects_;for(let u=0,f=arguments.length;u!==f;++u){const d=arguments[u],p=d.uuid;let y=n[p];if(y===void 0){y=c++,n[p]=y,e.push(d);for(let x=0,m=a;x!==m;++x)o[x].push(new kt(d,i[x],s[x]))}else if(y<l){h=e[y];const x=--l,m=e[x];n[m.uuid]=y,e[y]=m,n[p]=x,e[x]=d;for(let g=0,w=a;g!==w;++g){const M=o[g],S=M[x];let E=M[y];M[y]=S,E===void 0&&(E=new kt(d,i[g],s[g])),M[x]=E}}else e[y]!==h&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,s=i.length;let o=this.nCachedObjects_;for(let a=0,h=arguments.length;a!==h;++a){const c=arguments[a],l=c.uuid,u=n[l];if(u!==void 0&&u>=o){const f=o++,d=e[f];n[d.uuid]=u,e[u]=d,n[l]=f,e[f]=c;for(let p=0,y=s;p!==y;++p){const x=i[p],m=x[f],g=x[u];x[u]=m,x[f]=g}}}this.nCachedObjects_=o}uncache(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,s=i.length;let o=this.nCachedObjects_,a=e.length;for(let h=0,c=arguments.length;h!==c;++h){const l=arguments[h],u=l.uuid,f=n[u];if(f!==void 0)if(delete n[u],f<o){const d=--o,p=e[d],y=--a,x=e[y];n[p.uuid]=f,e[f]=p,n[x.uuid]=d,e[d]=x,e.pop();for(let m=0,g=s;m!==g;++m){const w=i[m],M=w[d],S=w[y];w[f]=M,w[d]=S,w.pop()}}else{const d=--a,p=e[d];d>0&&(n[p.uuid]=f),e[f]=p,e.pop();for(let y=0,x=s;y!==x;++y){const m=i[y];m[f]=m[d],m.pop()}}}this.nCachedObjects_=o}subscribe_(e,n){const i=this._bindingsIndicesByPath;let s=i[e];const o=this._bindings;if(s!==void 0)return o[s];const a=this._paths,h=this._parsedPaths,c=this._objects,l=c.length,u=this.nCachedObjects_,f=new Array(l);s=o.length,i[e]=s,a.push(e),h.push(n),o.push(f);for(let d=u,p=c.length;d!==p;++d){const y=c[d];f[d]=new kt(y,e,n)}return f}unsubscribe_(e){const n=this._bindingsIndicesByPath,i=n[e];if(i!==void 0){const s=this._paths,o=this._parsedPaths,a=this._bindings,h=a.length-1,c=a[h],l=e[h];n[l]=i,a[i]=c,a.pop(),o[i]=o[h],o.pop(),s[i]=s[h],s.pop()}}}class ${constructor(e=0,n=0,i=0){$.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(_m.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(_m.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,s=this.z,o=e.elements;return this.x=o[0]*n+o[3]*i+o[6]*s,this.y=o[1]*n+o[4]*i+o[7]*s,this.z=o[2]*n+o[5]*i+o[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,s=this.z,o=e.elements,a=1/(o[3]*n+o[7]*i+o[11]*s+o[15]);return this.x=(o[0]*n+o[4]*i+o[8]*s+o[12])*a,this.y=(o[1]*n+o[5]*i+o[9]*s+o[13])*a,this.z=(o[2]*n+o[6]*i+o[10]*s+o[14])*a,this}applyQuaternion(e){const n=this.x,i=this.y,s=this.z,o=e.x,a=e.y,h=e.z,c=e.w,l=2*(a*s-h*i),u=2*(h*n-o*s),f=2*(o*i-a*n);return this.x=n+c*l+a*f-h*u,this.y=i+c*u+h*l-o*f,this.z=s+c*f+o*u-a*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,s=this.z,o=e.elements;return this.x=o[0]*n+o[4]*i+o[8]*s,this.y=o[1]*n+o[5]*i+o[9]*s,this.z=o[2]*n+o[6]*i+o[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Mt(this.x,e.x,n.x),this.y=Mt(this.y,e.y,n.y),this.z=Mt(this.z,e.z,n.z),this}clampScalar(e,n){return this.x=Mt(this.x,e,n),this.y=Mt(this.y,e,n),this.z=Mt(this.z,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Mt(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,s=e.y,o=e.z,a=n.x,h=n.y,c=n.z;return this.x=s*c-o*h,this.y=o*a-i*c,this.z=i*h-s*a,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return zu.copy(this).projectOnVector(e),this.sub(zu)}reflect(e){return this.sub(zu.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Mt(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,s=this.z-e.z;return n*n+i*i+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const s=Math.sin(n)*e;return this.x=s*Math.sin(i),this.y=Math.cos(n)*e,this.z=s*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=s,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,i=Math.sqrt(1-n*n);return this.x=i*Math.cos(e),this.y=n,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const zu=new $,_m=new Ne;class Qt{constructor(e,n,i,s,o,a,h,c,l,u,f,d,p,y,x,m){Qt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,s,o,a,h,c,l,u,f,d,p,y,x,m)}set(e,n,i,s,o,a,h,c,l,u,f,d,p,y,x,m){const g=this.elements;return g[0]=e,g[4]=n,g[8]=i,g[12]=s,g[1]=o,g[5]=a,g[9]=h,g[13]=c,g[2]=l,g[6]=u,g[10]=f,g[14]=d,g[3]=p,g[7]=y,g[11]=x,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Qt().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,s=1/dr.setFromMatrixColumn(e,0).length(),o=1/dr.setFromMatrixColumn(e,1).length(),a=1/dr.setFromMatrixColumn(e,2).length();return n[0]=i[0]*s,n[1]=i[1]*s,n[2]=i[2]*s,n[3]=0,n[4]=i[4]*o,n[5]=i[5]*o,n[6]=i[6]*o,n[7]=0,n[8]=i[8]*a,n[9]=i[9]*a,n[10]=i[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,s=e.y,o=e.z,a=Math.cos(i),h=Math.sin(i),c=Math.cos(s),l=Math.sin(s),u=Math.cos(o),f=Math.sin(o);if(e.order==="XYZ"){const d=a*u,p=a*f,y=h*u,x=h*f;n[0]=c*u,n[4]=-c*f,n[8]=l,n[1]=p+y*l,n[5]=d-x*l,n[9]=-h*c,n[2]=x-d*l,n[6]=y+p*l,n[10]=a*c}else if(e.order==="YXZ"){const d=c*u,p=c*f,y=l*u,x=l*f;n[0]=d+x*h,n[4]=y*h-p,n[8]=a*l,n[1]=a*f,n[5]=a*u,n[9]=-h,n[2]=p*h-y,n[6]=x+d*h,n[10]=a*c}else if(e.order==="ZXY"){const d=c*u,p=c*f,y=l*u,x=l*f;n[0]=d-x*h,n[4]=-a*f,n[8]=y+p*h,n[1]=p+y*h,n[5]=a*u,n[9]=x-d*h,n[2]=-a*l,n[6]=h,n[10]=a*c}else if(e.order==="ZYX"){const d=a*u,p=a*f,y=h*u,x=h*f;n[0]=c*u,n[4]=y*l-p,n[8]=d*l+x,n[1]=c*f,n[5]=x*l+d,n[9]=p*l-y,n[2]=-l,n[6]=h*c,n[10]=a*c}else if(e.order==="YZX"){const d=a*c,p=a*l,y=h*c,x=h*l;n[0]=c*u,n[4]=x-d*f,n[8]=y*f+p,n[1]=f,n[5]=a*u,n[9]=-h*u,n[2]=-l*u,n[6]=p*f+y,n[10]=d-x*f}else if(e.order==="XZY"){const d=a*c,p=a*l,y=h*c,x=h*l;n[0]=c*u,n[4]=-f,n[8]=l*u,n[1]=d*f+x,n[5]=a*u,n[9]=p*f-y,n[2]=y*f-p,n[6]=h*u,n[10]=x*f+d}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose($A,e,VA)}lookAt(e,n,i){const s=this.elements;return Ye.subVectors(e,n),Ye.lengthSq()===0&&(Ye.z=1),Ye.normalize(),Pi.crossVectors(i,Ye),Pi.lengthSq()===0&&(Math.abs(i.z)===1?Ye.x+=1e-4:Ye.z+=1e-4,Ye.normalize(),Pi.crossVectors(i,Ye)),Pi.normalize(),Eh.crossVectors(Ye,Pi),s[0]=Pi.x,s[4]=Eh.x,s[8]=Ye.x,s[1]=Pi.y,s[5]=Eh.y,s[9]=Ye.y,s[2]=Pi.z,s[6]=Eh.z,s[10]=Ye.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,s=n.elements,o=this.elements,a=i[0],h=i[4],c=i[8],l=i[12],u=i[1],f=i[5],d=i[9],p=i[13],y=i[2],x=i[6],m=i[10],g=i[14],w=i[3],M=i[7],S=i[11],E=i[15],A=s[0],I=s[4],b=s[8],v=s[12],_=s[1],z=s[5],P=s[9],k=s[13],B=s[2],R=s[6],L=s[10],N=s[14],q=s[3],U=s[7],J=s[11],X=s[15];return o[0]=a*A+h*_+c*B+l*q,o[4]=a*I+h*z+c*R+l*U,o[8]=a*b+h*P+c*L+l*J,o[12]=a*v+h*k+c*N+l*X,o[1]=u*A+f*_+d*B+p*q,o[5]=u*I+f*z+d*R+p*U,o[9]=u*b+f*P+d*L+p*J,o[13]=u*v+f*k+d*N+p*X,o[2]=y*A+x*_+m*B+g*q,o[6]=y*I+x*z+m*R+g*U,o[10]=y*b+x*P+m*L+g*J,o[14]=y*v+x*k+m*N+g*X,o[3]=w*A+M*_+S*B+E*q,o[7]=w*I+M*z+S*R+E*U,o[11]=w*b+M*P+S*L+E*J,o[15]=w*v+M*k+S*N+E*X,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],s=e[8],o=e[12],a=e[1],h=e[5],c=e[9],l=e[13],u=e[2],f=e[6],d=e[10],p=e[14],y=e[3],x=e[7],m=e[11],g=e[15];return y*(+o*c*f-s*l*f-o*h*d+i*l*d+s*h*p-i*c*p)+x*(+n*c*p-n*l*d+o*a*d-s*a*p+s*l*u-o*c*u)+m*(+n*l*f-n*h*p-o*a*f+i*a*p+o*h*u-i*l*u)+g*(-s*h*u-n*c*f+n*h*d+s*a*f-i*a*d+i*c*u)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=n,s[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],h=e[5],c=e[6],l=e[7],u=e[8],f=e[9],d=e[10],p=e[11],y=e[12],x=e[13],m=e[14],g=e[15],w=f*m*l-x*d*l+x*c*p-h*m*p-f*c*g+h*d*g,M=y*d*l-u*m*l-y*c*p+a*m*p+u*c*g-a*d*g,S=u*x*l-y*f*l+y*h*p-a*x*p-u*h*g+a*f*g,E=y*f*c-u*x*c-y*h*d+a*x*d+u*h*m-a*f*m,A=n*w+i*M+s*S+o*E;if(A===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/A;return e[0]=w*I,e[1]=(x*d*o-f*m*o-x*s*p+i*m*p+f*s*g-i*d*g)*I,e[2]=(h*m*o-x*c*o+x*s*l-i*m*l-h*s*g+i*c*g)*I,e[3]=(f*c*o-h*d*o-f*s*l+i*d*l+h*s*p-i*c*p)*I,e[4]=M*I,e[5]=(u*m*o-y*d*o+y*s*p-n*m*p-u*s*g+n*d*g)*I,e[6]=(y*c*o-a*m*o-y*s*l+n*m*l+a*s*g-n*c*g)*I,e[7]=(a*d*o-u*c*o+u*s*l-n*d*l-a*s*p+n*c*p)*I,e[8]=S*I,e[9]=(y*f*o-u*x*o-y*i*p+n*x*p+u*i*g-n*f*g)*I,e[10]=(a*x*o-y*h*o+y*i*l-n*x*l-a*i*g+n*h*g)*I,e[11]=(u*h*o-a*f*o-u*i*l+n*f*l+a*i*p-n*h*p)*I,e[12]=E*I,e[13]=(u*x*s-y*f*s+y*i*d-n*x*d-u*i*m+n*f*m)*I,e[14]=(y*h*s-a*x*s-y*i*c+n*x*c+a*i*m-n*h*m)*I,e[15]=(a*f*s-u*h*s+u*i*c-n*f*c-a*i*d+n*h*d)*I,this}scale(e){const n=this.elements,i=e.x,s=e.y,o=e.z;return n[0]*=i,n[4]*=s,n[8]*=o,n[1]*=i,n[5]*=s,n[9]*=o,n[2]*=i,n[6]*=s,n[10]*=o,n[3]*=i,n[7]*=s,n[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,s))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),s=Math.sin(n),o=1-i,a=e.x,h=e.y,c=e.z,l=o*a,u=o*h;return this.set(l*a+i,l*h-s*c,l*c+s*h,0,l*h+s*c,u*h+i,u*c-s*a,0,l*c-s*h,u*c+s*a,o*c*c+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,s,o,a){return this.set(1,i,o,0,e,1,a,0,n,s,1,0,0,0,0,1),this}compose(e,n,i){const s=this.elements,o=n._x,a=n._y,h=n._z,c=n._w,l=o+o,u=a+a,f=h+h,d=o*l,p=o*u,y=o*f,x=a*u,m=a*f,g=h*f,w=c*l,M=c*u,S=c*f,E=i.x,A=i.y,I=i.z;return s[0]=(1-(x+g))*E,s[1]=(p+S)*E,s[2]=(y-M)*E,s[3]=0,s[4]=(p-S)*A,s[5]=(1-(d+g))*A,s[6]=(m+w)*A,s[7]=0,s[8]=(y+M)*I,s[9]=(m-w)*I,s[10]=(1-(d+x))*I,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,n,i){const s=this.elements;let o=dr.set(s[0],s[1],s[2]).length();const a=dr.set(s[4],s[5],s[6]).length(),h=dr.set(s[8],s[9],s[10]).length();this.determinant()<0&&(o=-o),e.x=s[12],e.y=s[13],e.z=s[14],Tn.copy(this);const l=1/o,u=1/a,f=1/h;return Tn.elements[0]*=l,Tn.elements[1]*=l,Tn.elements[2]*=l,Tn.elements[4]*=u,Tn.elements[5]*=u,Tn.elements[6]*=u,Tn.elements[8]*=f,Tn.elements[9]*=f,Tn.elements[10]*=f,n.setFromRotationMatrix(Tn),i.x=o,i.y=a,i.z=h,this}makePerspective(e,n,i,s,o,a,h=$n){const c=this.elements,l=2*o/(n-e),u=2*o/(i-s),f=(n+e)/(n-e),d=(i+s)/(i-s);let p,y;if(h===$n)p=-(a+o)/(a-o),y=-2*a*o/(a-o);else if(h===zo)p=-a/(a-o),y=-a*o/(a-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+h);return c[0]=l,c[4]=0,c[8]=f,c[12]=0,c[1]=0,c[5]=u,c[9]=d,c[13]=0,c[2]=0,c[6]=0,c[10]=p,c[14]=y,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,n,i,s,o,a,h=$n){const c=this.elements,l=1/(n-e),u=1/(i-s),f=1/(a-o),d=(n+e)*l,p=(i+s)*u;let y,x;if(h===$n)y=(a+o)*f,x=-2*f;else if(h===zo)y=o*f,x=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+h);return c[0]=2*l,c[4]=0,c[8]=0,c[12]=-d,c[1]=0,c[5]=2*u,c[9]=0,c[13]=-p,c[2]=0,c[6]=0,c[10]=x,c[14]=-y,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let s=0;s<16;s++)if(n[s]!==i[s])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const dr=new $,Tn=new Qt,$A=new $(0,0,0),VA=new $(1,1,1),Pi=new $,Eh=new $,Ye=new $,Sm=new Qt,Tm=new Ne;class Ts{constructor(e=0,n=0,i=0,s=Ts.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,s=this._order){return this._x=e,this._y=n,this._z=i,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const s=e.elements,o=s[0],a=s[4],h=s[8],c=s[1],l=s[5],u=s[9],f=s[2],d=s[6],p=s[10];switch(n){case"XYZ":this._y=Math.asin(Mt(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Mt(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(h,p),this._z=Math.atan2(c,l)):(this._y=Math.atan2(-f,o),this._z=0);break;case"ZXY":this._x=Math.asin(Mt(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-f,p),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-Mt(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(Mt(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-f,o)):(this._x=0,this._y=Math.atan2(h,p));break;case"XZY":this._z=Math.asin(-Mt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(h,o)):(this._x=Math.atan2(-u,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return Sm.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Sm,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return Tm.setFromEuler(this),this.setFromQuaternion(Tm,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Ts.DEFAULT_ORDER="XYZ";class Au{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}class Vn{constructor(e,n,i,s,o,a,h,c,l){Vn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,s,o,a,h,c,l)}set(e,n,i,s,o,a,h,c,l){const u=this.elements;return u[0]=e,u[1]=s,u[2]=h,u[3]=n,u[4]=o,u[5]=c,u[6]=i,u[7]=a,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,s=n.elements,o=this.elements,a=i[0],h=i[3],c=i[6],l=i[1],u=i[4],f=i[7],d=i[2],p=i[5],y=i[8],x=s[0],m=s[3],g=s[6],w=s[1],M=s[4],S=s[7],E=s[2],A=s[5],I=s[8];return o[0]=a*x+h*w+c*E,o[3]=a*m+h*M+c*A,o[6]=a*g+h*S+c*I,o[1]=l*x+u*w+f*E,o[4]=l*m+u*M+f*A,o[7]=l*g+u*S+f*I,o[2]=d*x+p*w+y*E,o[5]=d*m+p*M+y*A,o[8]=d*g+p*S+y*I,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],h=e[5],c=e[6],l=e[7],u=e[8];return n*a*u-n*h*l-i*o*u+i*h*c+s*o*l-s*a*c}invert(){const e=this.elements,n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],h=e[5],c=e[6],l=e[7],u=e[8],f=u*a-h*l,d=h*c-u*o,p=l*o-a*c,y=n*f+i*d+s*p;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/y;return e[0]=f*x,e[1]=(s*l-u*i)*x,e[2]=(h*i-s*a)*x,e[3]=d*x,e[4]=(u*n-s*c)*x,e[5]=(s*o-h*n)*x,e[6]=p*x,e[7]=(i*c-l*n)*x,e[8]=(a*n-i*o)*x,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,s,o,a,h){const c=Math.cos(o),l=Math.sin(o);return this.set(i*c,i*l,-i*(c*a+l*h)+a+e,-s*l,s*c,-s*(-l*a+c*h)+h+n,0,0,1),this}scale(e,n){return this.premultiply(Cu.makeScale(e,n)),this}rotate(e){return this.premultiply(Cu.makeRotation(-e)),this}translate(e,n){return this.premultiply(Cu.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let s=0;s<9;s++)if(n[s]!==i[s])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Cu=new Vn;let UA=0;const Em=new $,pr=new Ne,oi=new Qt,zh=new $,Ro=new $,WA=new $,jA=new Ne,zm=new $(1,0,0),Am=new $(0,1,0),Cm=new $(0,0,1),Pm={type:"added"},YA={type:"removed"},yr={type:"childadded",child:null},Pu={type:"childremoved",child:null};class qe extends Ci{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:UA++}),this.uuid=Sn(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=qe.DEFAULT_UP.clone();const e=new $,n=new Ts,i=new Ne,s=new $(1,1,1);function o(){i.setFromEuler(n,!1)}function a(){n.setFromQuaternion(i,void 0,!1)}n._onChange(o),i._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Qt},normalMatrix:{value:new Vn}}),this.matrix=new Qt,this.matrixWorld=new Qt,this.matrixAutoUpdate=qe.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=qe.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Au,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return pr.setFromAxisAngle(e,n),this.quaternion.multiply(pr),this}rotateOnWorldAxis(e,n){return pr.setFromAxisAngle(e,n),this.quaternion.premultiply(pr),this}rotateX(e){return this.rotateOnAxis(zm,e)}rotateY(e){return this.rotateOnAxis(Am,e)}rotateZ(e){return this.rotateOnAxis(Cm,e)}translateOnAxis(e,n){return Em.copy(e).applyQuaternion(this.quaternion),this.position.add(Em.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(zm,e)}translateY(e){return this.translateOnAxis(Am,e)}translateZ(e){return this.translateOnAxis(Cm,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(oi.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?zh.copy(e):zh.set(e,n,i);const s=this.parent;this.updateWorldMatrix(!0,!1),Ro.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?oi.lookAt(Ro,zh,this.up):oi.lookAt(zh,Ro,this.up),this.quaternion.setFromRotationMatrix(oi),s&&(oi.extractRotation(s.matrixWorld),pr.setFromRotationMatrix(oi),this.quaternion.premultiply(pr.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Pm),yr.child=e,this.dispatchEvent(yr),yr.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(YA),Pu.child=e,this.dispatchEvent(Pu),Pu.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),oi.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),oi.multiply(e.parent.matrixWorld)),e.applyMatrix4(oi),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Pm),yr.child=e,this.dispatchEvent(yr),yr.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,s=this.children.length;i<s;i++){const a=this.children[i].getObjectByProperty(e,n);if(a!==void 0)return a}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);const s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ro,e,WA),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ro,jA,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,s=n.length;i<s;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,s=n.length;i<s;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,s=n.length;i<s;i++)n[i].updateMatrixWorld(e)}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.geometryInfo=this._geometryInfo.map(h=>({...h,boundingBox:h.boundingBox?h.boundingBox.toJSON():void 0,boundingSphere:h.boundingSphere?h.boundingSphere.toJSON():void 0})),s.instanceInfo=this._instanceInfo.map(h=>({...h})),s.availableInstanceIds=this._availableInstanceIds.slice(),s.availableGeometryIds=this._availableGeometryIds.slice(),s.nextIndexStart=this._nextIndexStart,s.nextVertexStart=this._nextVertexStart,s.geometryCount=this._geometryCount,s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.matricesTexture=this._matricesTexture.toJSON(e),s.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(s.boundingBox=this.boundingBox.toJSON()));function o(h,c){return h[c.uuid]===void 0&&(h[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(e.geometries,this.geometry);const h=this.geometry.parameters;if(h!==void 0&&h.shapes!==void 0){const c=h.shapes;if(Array.isArray(c))for(let l=0,u=c.length;l<u;l++){const f=c[l];o(e.shapes,f)}else o(e.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const h=[];for(let c=0,l=this.material.length;c<l;c++)h.push(o(e.materials,this.material[c]));s.material=h}else s.material=o(e.materials,this.material);if(this.children.length>0){s.children=[];for(let h=0;h<this.children.length;h++)s.children.push(this.children[h].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let h=0;h<this.animations.length;h++){const c=this.animations[h];s.animations.push(o(e.animations,c))}}if(n){const h=a(e.geometries),c=a(e.materials),l=a(e.textures),u=a(e.images),f=a(e.shapes),d=a(e.skeletons),p=a(e.animations),y=a(e.nodes);h.length>0&&(i.geometries=h),c.length>0&&(i.materials=c),l.length>0&&(i.textures=l),u.length>0&&(i.images=u),f.length>0&&(i.shapes=f),d.length>0&&(i.skeletons=d),p.length>0&&(i.animations=p),y.length>0&&(i.nodes=y)}return i.object=s,i;function a(h){const c=[];for(const l in h){const u=h[l];delete u.metadata,c.push(u)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const s=e.children[i];this.add(s.clone())}return this}}qe.DEFAULT_UP=new $(0,1,0),qe.DEFAULT_MATRIX_AUTO_UPDATE=!0,qe.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;class Im extends qe{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,n){return super.copy(e,n),e.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}class HA{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let i=0;i<n.length;i++)e+=n[i];return e/n.length}}let Ah;class km{static getContext(){return Ah===void 0&&(Ah=new(window.AudioContext||window.webkitAudioContext)),Ah}static setContext(e){Ah=e}}class Rm{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=performance.now();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}const Es=new $,Iu=new Ne,XA=new $,zs=new $,As=new $;class ZA extends qe{constructor(){super(),this.type="AudioListener",this.context=km.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Rm}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Es,Iu,XA),zs.set(0,0,-1).applyQuaternion(Iu),As.set(0,1,0).applyQuaternion(Iu),n.positionX){const i=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(Es.x,i),n.positionY.linearRampToValueAtTime(Es.y,i),n.positionZ.linearRampToValueAtTime(Es.z,i),n.forwardX.linearRampToValueAtTime(zs.x,i),n.forwardY.linearRampToValueAtTime(zs.y,i),n.forwardZ.linearRampToValueAtTime(zs.z,i),n.upX.linearRampToValueAtTime(As.x,i),n.upY.linearRampToValueAtTime(As.y,i),n.upZ.linearRampToValueAtTime(As.z,i)}else n.setPosition(Es.x,Es.y,Es.z),n.setOrientation(zs.x,zs.y,zs.z,As.x,As.y,As.z)}}const Cs=new $,Om=new Ne,GA=new $,Ps=new $;class JA extends Im{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Cs,Om,GA),Ps.set(0,0,1).applyQuaternion(Om);const n=this.panner;if(n.positionX){const i=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(Cs.x,i),n.positionY.linearRampToValueAtTime(Cs.y,i),n.positionZ.linearRampToValueAtTime(Cs.z,i),n.orientationX.linearRampToValueAtTime(Ps.x,i),n.orientationY.linearRampToValueAtTime(Ps.y,i),n.orientationZ.linearRampToValueAtTime(Ps.z,i)}else n.setPosition(Cs.x,Cs.y,Cs.z),n.setOrientation(Ps.x,Ps.y,Ps.z)}}class ku extends qe{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Qt,this.projectionMatrix=new Qt,this.projectionMatrixInverse=new Qt,this.coordinateSystem=$n}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class nt{constructor(e=0,n=0){nt.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6],this.y=s[1]*n+s[4]*i+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Mt(this.x,e.x,n.x),this.y=Mt(this.y,e.y,n.y),this}clampScalar(e,n){return this.x=Mt(this.x,e,n),this.y=Mt(this.y,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Mt(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Mt(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),s=Math.sin(n),o=this.x-e.x,a=this.y-e.y;return this.x=o*i-a*s+e.x,this.y=o*s+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}const Ii=new $,Lm=new nt,Bm=new nt;class Un extends ku{constructor(e=50,n=1,i=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=s,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=Th*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(vs*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Th*2*Math.atan(Math.tan(vs*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,i){Ii.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Ii.x,Ii.y).multiplyScalar(-e/Ii.z),Ii.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Ii.x,Ii.y).multiplyScalar(-e/Ii.z)}getViewSize(e,n){return this.getViewBounds(e,Lm,Bm),n.subVectors(Bm,Lm)}setViewOffset(e,n,i,s,o,a){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=s,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(vs*.5*this.fov)/this.zoom,i=2*n,s=this.aspect*i,o=-.5*s;const a=this.view;if(this.view!==null&&this.view.enabled){const c=a.fullWidth,l=a.fullHeight;o+=a.offsetX*s/c,n-=a.offsetY*i/l,s*=a.width/c,i*=a.height/l}const h=this.filmOffset;h!==0&&(o+=e*h/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+s,n,n-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}class QA extends Un{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}const xr=-90,mr=1;class KA extends qe{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new Un(xr,mr,e,n);s.layers=this.layers,this.add(s);const o=new Un(xr,mr,e,n);o.layers=this.layers,this.add(o);const a=new Un(xr,mr,e,n);a.layers=this.layers,this.add(a);const h=new Un(xr,mr,e,n);h.layers=this.layers,this.add(h);const c=new Un(xr,mr,e,n);c.layers=this.layers,this.add(c);const l=new Un(xr,mr,e,n);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[i,s,o,a,h,c]=n;for(const l of n)this.remove(l);if(e===$n)i.up.set(0,1,0),i.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),h.up.set(0,1,0),h.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===zo)i.up.set(0,-1,0),i.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),h.up.set(0,-1,0),h.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const l of n)this.add(l),l.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[o,a,h,c,l,u]=this.children,f=e.getRenderTarget(),d=e.getActiveCubeFace(),p=e.getActiveMipmapLevel(),y=e.xr.enabled;e.xr.enabled=!1;const x=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,s),e.render(n,o),e.setRenderTarget(i,1,s),e.render(n,a),e.setRenderTarget(i,2,s),e.render(n,h),e.setRenderTarget(i,3,s),e.render(n,c),e.setRenderTarget(i,4,s),e.render(n,l),i.texture.generateMipmaps=x,e.setRenderTarget(i,5,s),e.render(n,u),e.setRenderTarget(f,d,p),e.xr.enabled=y,i.texture.needsPMREMUpdate=!0}}class tC extends ku{constructor(e=-1,n=1,i=1,s=-1,o=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=s,this.near=o,this.far=a,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,s,o,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=s,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let o=i-e,a=i+e,h=s+n,c=s-n;if(this.view!==null&&this.view.enabled){const l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=l*this.view.offsetX,a=o+l*this.view.width,h-=u*this.view.offsetY,c=h-u*this.view.height}this.projectionMatrix.makeOrthographic(o,a,h,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}const Fm=new Qt,Nm=new Qt,Is=new Qt;class eC{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Un,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Un,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,Is.copy(e.projectionMatrix);const s=n.eyeSep/2,o=s*n.near/n.focus,a=n.near*Math.tan(vs*n.fov*.5)/n.zoom;let h,c;Nm.elements[12]=-s,Fm.elements[12]=s,h=-a*n.aspect+o,c=a*n.aspect+o,Is.elements[0]=2*n.near/(c-h),Is.elements[8]=(c+h)/(c-h),this.cameraL.projectionMatrix.copy(Is),h=-a*n.aspect-o,c=a*n.aspect-o,Is.elements[0]=2*n.near/(c-h),Is.elements[8]=(c+h)/(c-h),this.cameraR.projectionMatrix.copy(Is)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Nm),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Fm)}}const ai=nC();function nC(){const r=new ArrayBuffer(4),e=new Float32Array(r),n=new Uint32Array(r),i=new Uint32Array(512),s=new Uint32Array(512);for(let c=0;c<256;++c){const l=c-127;l<-27?(i[c]=0,i[c|256]=32768,s[c]=24,s[c|256]=24):l<-14?(i[c]=1024>>-l-14,i[c|256]=1024>>-l-14|32768,s[c]=-l-1,s[c|256]=-l-1):l<=15?(i[c]=l+15<<10,i[c|256]=l+15<<10|32768,s[c]=13,s[c|256]=13):l<128?(i[c]=31744,i[c|256]=64512,s[c]=24,s[c|256]=24):(i[c]=31744,i[c|256]=64512,s[c]=13,s[c|256]=13)}const o=new Uint32Array(2048),a=new Uint32Array(64),h=new Uint32Array(64);for(let c=1;c<1024;++c){let l=c<<13,u=0;for(;(l&8388608)===0;)l<<=1,u-=8388608;l&=-8388609,u+=947912704,o[c]=l|u}for(let c=1024;c<2048;++c)o[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)a[c]=c<<23;a[31]=1199570944,a[32]=2147483648;for(let c=33;c<63;++c)a[c]=2147483648+(c-32<<23);a[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(h[c]=1024);return{floatView:e,uint32View:n,baseTable:i,shiftTable:s,mantissaTable:o,exponentTable:a,offsetTable:h}}function De(r){Math.abs(r)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),r=Mt(r,-65504,65504),ai.floatView[0]=r;const e=ai.uint32View[0],n=e>>23&511;return ai.baseTable[n]+((e&8388607)>>ai.shiftTable[n])}function Oo(r){const e=r>>10;return ai.uint32View[0]=ai.mantissaTable[ai.offsetTable[e]+(r&1023)]+ai.exponentTable[e],ai.floatView[0]}class iC{static toHalfFloat(e){return De(e)}static fromHalfFloat(e){return Oo(e)}}const Kt=new $,Ch=new nt;let sC=0;class Ie{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:sC++}),this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=Eo,this.updateRanges=[],this.gpuType=fu,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let s=0,o=this.itemSize;s<o;s++)this.array[e+s]=n.array[i+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)Ch.fromBufferAttribute(this,n),Ch.applyMatrix3(e),this.setXY(n,Ch.x,Ch.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)Kt.fromBufferAttribute(this,n),Kt.applyMatrix3(e),this.setXYZ(n,Kt.x,Kt.y,Kt.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)Kt.fromBufferAttribute(this,n),Kt.applyMatrix4(e),this.setXYZ(n,Kt.x,Kt.y,Kt.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)Kt.fromBufferAttribute(this,n),Kt.applyNormalMatrix(e),this.setXYZ(n,Kt.x,Kt.y,Kt.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)Kt.fromBufferAttribute(this,n),Kt.transformDirection(e),this.setXYZ(n,Kt.x,Kt.y,Kt.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=Pe(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=_t(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Pe(n,this.array)),n}setX(e,n){return this.normalized&&(n=_t(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Pe(n,this.array)),n}setY(e,n){return this.normalized&&(n=_t(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Pe(n,this.array)),n}setZ(e,n){return this.normalized&&(n=_t(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Pe(n,this.array)),n}setW(e,n){return this.normalized&&(n=_t(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=_t(n,this.array),i=_t(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,s){return e*=this.itemSize,this.normalized&&(n=_t(n,this.array),i=_t(i,this.array),s=_t(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=s,this}setXYZW(e,n,i,s,o){return e*=this.itemSize,this.normalized&&(n=_t(n,this.array),i=_t(i,this.array),s=_t(s,this.array),o=_t(o,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=s,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Eo&&(e.usage=this.usage),e}}class rC extends Ie{constructor(e,n,i){super(new Int8Array(e),n,i)}}class oC extends Ie{constructor(e,n,i){super(new Uint8Array(e),n,i)}}class aC extends Ie{constructor(e,n,i){super(new Uint8ClampedArray(e),n,i)}}class hC extends Ie{constructor(e,n,i){super(new Int16Array(e),n,i)}}class qm extends Ie{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class cC extends Ie{constructor(e,n,i){super(new Int32Array(e),n,i)}}class Dm extends Ie{constructor(e,n,i){super(new Uint32Array(e),n,i)}}class lC extends Ie{constructor(e,n,i){super(new Uint16Array(e),n,i),this.isFloat16BufferAttribute=!0}getX(e){let n=Oo(this.array[e*this.itemSize]);return this.normalized&&(n=Pe(n,this.array)),n}setX(e,n){return this.normalized&&(n=_t(n,this.array)),this.array[e*this.itemSize]=De(n),this}getY(e){let n=Oo(this.array[e*this.itemSize+1]);return this.normalized&&(n=Pe(n,this.array)),n}setY(e,n){return this.normalized&&(n=_t(n,this.array)),this.array[e*this.itemSize+1]=De(n),this}getZ(e){let n=Oo(this.array[e*this.itemSize+2]);return this.normalized&&(n=Pe(n,this.array)),n}setZ(e,n){return this.normalized&&(n=_t(n,this.array)),this.array[e*this.itemSize+2]=De(n),this}getW(e){let n=Oo(this.array[e*this.itemSize+3]);return this.normalized&&(n=Pe(n,this.array)),n}setW(e,n){return this.normalized&&(n=_t(n,this.array)),this.array[e*this.itemSize+3]=De(n),this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=_t(n,this.array),i=_t(i,this.array)),this.array[e+0]=De(n),this.array[e+1]=De(i),this}setXYZ(e,n,i,s){return e*=this.itemSize,this.normalized&&(n=_t(n,this.array),i=_t(i,this.array),s=_t(s,this.array)),this.array[e+0]=De(n),this.array[e+1]=De(i),this.array[e+2]=De(s),this}setXYZW(e,n,i,s,o){return e*=this.itemSize,this.normalized&&(n=_t(n,this.array),i=_t(i,this.array),s=_t(s,this.array),o=_t(o,this.array)),this.array[e+0]=De(n),this.array[e+1]=De(i),this.array[e+2]=De(s),this.array[e+3]=De(o),this}}class wt extends Ie{constructor(e,n,i){super(new Float32Array(e),n,i)}}class gr{constructor(e=new $(1/0,1/0,1/0),n=new $(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(En.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(En.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=En.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const o=i.getAttribute("position");if(n===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let a=0,h=o.count;a<h;a++)e.isMesh===!0?e.getVertexPosition(a,En):En.fromBufferAttribute(o,a),En.applyMatrix4(e.matrixWorld),this.expandByPoint(En);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Ph.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),Ph.copy(i.boundingBox)),Ph.applyMatrix4(e.matrixWorld),this.union(Ph)}const s=e.children;for(let o=0,a=s.length;o<a;o++)this.expandByObject(s[o],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,En),En.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Lo),Ih.subVectors(this.max,Lo),wr.subVectors(e.a,Lo),br.subVectors(e.b,Lo),vr.subVectors(e.c,Lo),ki.subVectors(br,wr),Ri.subVectors(vr,br),ks.subVectors(wr,vr);let n=[0,-ki.z,ki.y,0,-Ri.z,Ri.y,0,-ks.z,ks.y,ki.z,0,-ki.x,Ri.z,0,-Ri.x,ks.z,0,-ks.x,-ki.y,ki.x,0,-Ri.y,Ri.x,0,-ks.y,ks.x,0];return!Ru(n,wr,br,vr,Ih)||(n=[1,0,0,0,1,0,0,0,1],!Ru(n,wr,br,vr,Ih))?!1:(kh.crossVectors(ki,Ri),n=[kh.x,kh.y,kh.z],Ru(n,wr,br,vr,Ih))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,En).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(En).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(hi[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),hi[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),hi[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),hi[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),hi[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),hi[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),hi[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),hi[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(hi),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const hi=[new $,new $,new $,new $,new $,new $,new $,new $],En=new $,Ph=new gr,wr=new $,br=new $,vr=new $,ki=new $,Ri=new $,ks=new $,Lo=new $,Ih=new $,kh=new $,Rs=new $;function Ru(r,e,n,i,s){for(let o=0,a=r.length-3;o<=a;o+=3){Rs.fromArray(r,o);const h=s.x*Math.abs(Rs.x)+s.y*Math.abs(Rs.y)+s.z*Math.abs(Rs.z),c=e.dot(Rs),l=n.dot(Rs),u=i.dot(Rs);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>h)return!1}return!0}const uC=new gr,Bo=new $,Ou=new $;class Lu{constructor(e=new $,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):uC.setFromPoints(e).getCenter(i);let s=0;for(let o=0,a=e.length;o<a;o++)s=Math.max(s,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Bo.subVectors(e,this.center);const n=Bo.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),s=(i-this.radius)*.5;this.center.addScaledVector(Bo,s/i),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Ou.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Bo.copy(e.center).add(Ou)),this.expandByPoint(Bo.copy(e.center).sub(Ou))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}function fC(r){for(let e=r.length-1;e>=0;--e)if(r[e]>=65535)return!0;return!1}function Bu(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}function dC(){const r=Bu("canvas");return r.style.display="block",r}const $m={};function Vm(r){r in $m||($m[r]=!0,console.warn(r))}let pC=0;const cn=new Qt,Fu=new qe,Mr=new $,He=new gr,Fo=new gr,ue=new $;class te extends Ci{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:pC++}),this.uuid=Sn(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(fC(e)?Dm:qm)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const o=new Vn().getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return cn.makeRotationFromQuaternion(e),this.applyMatrix4(cn),this}rotateX(e){return cn.makeRotationX(e),this.applyMatrix4(cn),this}rotateY(e){return cn.makeRotationY(e),this.applyMatrix4(cn),this}rotateZ(e){return cn.makeRotationZ(e),this.applyMatrix4(cn),this}translate(e,n,i){return cn.makeTranslation(e,n,i),this.applyMatrix4(cn),this}scale(e,n,i){return cn.makeScale(e,n,i),this.applyMatrix4(cn),this}lookAt(e){return Fu.lookAt(e),Fu.updateMatrix(),this.applyMatrix4(Fu.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Mr).negate(),this.translate(Mr.x,Mr.y,Mr.z),this}setFromPoints(e){const n=this.getAttribute("position");if(n===void 0){const i=[];for(let s=0,o=e.length;s<o;s++){const a=e[s];i.push(a.x,a.y,a.z||0)}this.setAttribute("position",new wt(i,3))}else{const i=Math.min(e.length,n.count);for(let s=0;s<i;s++){const o=e[s];n.setXYZ(s,o.x,o.y,o.z||0)}e.length>n.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new gr);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new $(-1/0,-1/0,-1/0),new $(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,s=n.length;i<s;i++){const o=n[i];He.setFromBufferAttribute(o),this.morphTargetsRelative?(ue.addVectors(this.boundingBox.min,He.min),this.boundingBox.expandByPoint(ue),ue.addVectors(this.boundingBox.max,He.max),this.boundingBox.expandByPoint(ue)):(this.boundingBox.expandByPoint(He.min),this.boundingBox.expandByPoint(He.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Lu);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new $,1/0);return}if(e){const i=this.boundingSphere.center;if(He.setFromBufferAttribute(e),n)for(let o=0,a=n.length;o<a;o++){const h=n[o];Fo.setFromBufferAttribute(h),this.morphTargetsRelative?(ue.addVectors(He.min,Fo.min),He.expandByPoint(ue),ue.addVectors(He.max,Fo.max),He.expandByPoint(ue)):(He.expandByPoint(Fo.min),He.expandByPoint(Fo.max))}He.getCenter(i);let s=0;for(let o=0,a=e.count;o<a;o++)ue.fromBufferAttribute(e,o),s=Math.max(s,i.distanceToSquared(ue));if(n)for(let o=0,a=n.length;o<a;o++){const h=n[o],c=this.morphTargetsRelative;for(let l=0,u=h.count;l<u;l++)ue.fromBufferAttribute(h,l),c&&(Mr.fromBufferAttribute(e,l),ue.add(Mr)),s=Math.max(s,i.distanceToSquared(ue))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=n.position,s=n.normal,o=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ie(new Float32Array(4*i.count),4));const a=this.getAttribute("tangent"),h=[],c=[];for(let b=0;b<i.count;b++)h[b]=new $,c[b]=new $;const l=new $,u=new $,f=new $,d=new nt,p=new nt,y=new nt,x=new $,m=new $;function g(b,v,_){l.fromBufferAttribute(i,b),u.fromBufferAttribute(i,v),f.fromBufferAttribute(i,_),d.fromBufferAttribute(o,b),p.fromBufferAttribute(o,v),y.fromBufferAttribute(o,_),u.sub(l),f.sub(l),p.sub(d),y.sub(d);const z=1/(p.x*y.y-y.x*p.y);isFinite(z)&&(x.copy(u).multiplyScalar(y.y).addScaledVector(f,-p.y).multiplyScalar(z),m.copy(f).multiplyScalar(p.x).addScaledVector(u,-y.x).multiplyScalar(z),h[b].add(x),h[v].add(x),h[_].add(x),c[b].add(m),c[v].add(m),c[_].add(m))}let w=this.groups;w.length===0&&(w=[{start:0,count:e.count}]);for(let b=0,v=w.length;b<v;++b){const _=w[b],z=_.start,P=_.count;for(let k=z,B=z+P;k<B;k+=3)g(e.getX(k+0),e.getX(k+1),e.getX(k+2))}const M=new $,S=new $,E=new $,A=new $;function I(b){E.fromBufferAttribute(s,b),A.copy(E);const v=h[b];M.copy(v),M.sub(E.multiplyScalar(E.dot(v))).normalize(),S.crossVectors(A,v);const z=S.dot(c[b])<0?-1:1;a.setXYZW(b,M.x,M.y,M.z,z)}for(let b=0,v=w.length;b<v;++b){const _=w[b],z=_.start,P=_.count;for(let k=z,B=z+P;k<B;k+=3)I(e.getX(k+0)),I(e.getX(k+1)),I(e.getX(k+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Ie(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let d=0,p=i.count;d<p;d++)i.setXYZ(d,0,0,0);const s=new $,o=new $,a=new $,h=new $,c=new $,l=new $,u=new $,f=new $;if(e)for(let d=0,p=e.count;d<p;d+=3){const y=e.getX(d+0),x=e.getX(d+1),m=e.getX(d+2);s.fromBufferAttribute(n,y),o.fromBufferAttribute(n,x),a.fromBufferAttribute(n,m),u.subVectors(a,o),f.subVectors(s,o),u.cross(f),h.fromBufferAttribute(i,y),c.fromBufferAttribute(i,x),l.fromBufferAttribute(i,m),h.add(u),c.add(u),l.add(u),i.setXYZ(y,h.x,h.y,h.z),i.setXYZ(x,c.x,c.y,c.z),i.setXYZ(m,l.x,l.y,l.z)}else for(let d=0,p=n.count;d<p;d+=3)s.fromBufferAttribute(n,d+0),o.fromBufferAttribute(n,d+1),a.fromBufferAttribute(n,d+2),u.subVectors(a,o),f.subVectors(s,o),u.cross(f),i.setXYZ(d+0,u.x,u.y,u.z),i.setXYZ(d+1,u.x,u.y,u.z),i.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)ue.fromBufferAttribute(e,n),ue.normalize(),e.setXYZ(n,ue.x,ue.y,ue.z)}toNonIndexed(){function e(h,c){const l=h.array,u=h.itemSize,f=h.normalized,d=new l.constructor(c.length*u);let p=0,y=0;for(let x=0,m=c.length;x<m;x++){h.isInterleavedBufferAttribute?p=c[x]*h.data.stride+h.offset:p=c[x]*u;for(let g=0;g<u;g++)d[y++]=l[p++]}return new Ie(d,u,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new te,i=this.index.array,s=this.attributes;for(const h in s){const c=s[h],l=e(c,i);n.setAttribute(h,l)}const o=this.morphAttributes;for(const h in o){const c=[],l=o[h];for(let u=0,f=l.length;u<f;u++){const d=l[u],p=e(d,i);c.push(p)}n.morphAttributes[h]=c}n.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let h=0,c=a.length;h<c;h++){const l=a[h];n.addGroup(l.start,l.count,l.materialIndex)}return n}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const l in c)c[l]!==void 0&&(e[l]=c[l]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const c in i){const l=i[c];e.data.attributes[c]=l.toJSON(e.data)}const s={};let o=!1;for(const c in this.morphAttributes){const l=this.morphAttributes[c],u=[];for(let f=0,d=l.length;f<d;f++){const p=l[f];u.push(p.toJSON(e.data))}u.length>0&&(s[c]=u,o=!0)}o&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const h=this.boundingSphere;return h!==null&&(e.data.boundingSphere=h.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone());const s=e.attributes;for(const l in s){const u=s[l];this.setAttribute(l,u.clone(n))}const o=e.morphAttributes;for(const l in o){const u=[],f=o[l];for(let d=0,p=f.length;d<p;d++)u.push(f[d].clone(n));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let l=0,u=a.length;l<u;l++){const f=a[l];this.addGroup(f.start,f.count,f.materialIndex)}const h=e.boundingBox;h!==null&&(this.boundingBox=h.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}class yC{constructor(e,n,i,s,o,a=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=i,this.elementSize=s,this.count=o,this.normalized=a,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class xC extends Ie{constructor(e,n,i,s=1){super(e,n,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}class mC extends te{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Um{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=Eo,this.updateRanges=[],this.version=0,this.uuid=Sn()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let s=0,o=this.stride;s<o;s++)this.array[e+s]=n.array[i+s];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Sn()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Sn()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}class gC extends Um{constructor(e,n,i=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}const ke=new $;class Nu{constructor(e,n,i,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)ke.fromBufferAttribute(this,n),ke.applyMatrix4(e),this.setXYZ(n,ke.x,ke.y,ke.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)ke.fromBufferAttribute(this,n),ke.applyNormalMatrix(e),this.setXYZ(n,ke.x,ke.y,ke.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)ke.fromBufferAttribute(this,n),ke.transformDirection(e),this.setXYZ(n,ke.x,ke.y,ke.z);return this}getComponent(e,n){let i=this.array[e*this.data.stride+this.offset+n];return this.normalized&&(i=Pe(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=_t(i,this.array)),this.data.array[e*this.data.stride+this.offset+n]=i,this}setX(e,n){return this.normalized&&(n=_t(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=_t(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=_t(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=_t(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=Pe(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=Pe(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=Pe(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=Pe(n,this.array)),n}setXY(e,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=_t(n,this.array),i=_t(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=_t(n,this.array),i=_t(i,this.array),s=_t(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=s,this}setXYZW(e,n,i,s,o){return e=e*this.data.stride+this.offset,this.normalized&&(n=_t(n,this.array),i=_t(i,this.array),s=_t(s,this.array),o=_t(o,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=s,this.data.array[e+3]=o,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)n.push(this.data.array[s+o])}return new Ie(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Nu(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)n.push(this.data.array[s+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const ci=new $,qu=new $,Rh=new $,Oi=new $,Du=new $,Oh=new $,$u=new $;class Wm{constructor(e=new $,n=new $(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ci)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=ci.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(ci.copy(this.origin).addScaledVector(this.direction,n),ci.distanceToSquared(e))}distanceSqToSegment(e,n,i,s){qu.copy(e).add(n).multiplyScalar(.5),Rh.copy(n).sub(e).normalize(),Oi.copy(this.origin).sub(qu);const o=e.distanceTo(n)*.5,a=-this.direction.dot(Rh),h=Oi.dot(this.direction),c=-Oi.dot(Rh),l=Oi.lengthSq(),u=Math.abs(1-a*a);let f,d,p,y;if(u>0)if(f=a*c-h,d=a*h-c,y=o*u,f>=0)if(d>=-y)if(d<=y){const x=1/u;f*=x,d*=x,p=f*(f+a*d+2*h)+d*(a*f+d+2*c)+l}else d=o,f=Math.max(0,-(a*d+h)),p=-f*f+d*(d+2*c)+l;else d=-o,f=Math.max(0,-(a*d+h)),p=-f*f+d*(d+2*c)+l;else d<=-y?(f=Math.max(0,-(-a*o+h)),d=f>0?-o:Math.min(Math.max(-o,-c),o),p=-f*f+d*(d+2*c)+l):d<=y?(f=0,d=Math.min(Math.max(-o,-c),o),p=d*(d+2*c)+l):(f=Math.max(0,-(a*o+h)),d=f>0?o:Math.min(Math.max(-o,-c),o),p=-f*f+d*(d+2*c)+l);else d=a>0?-o:o,f=Math.max(0,-(a*d+h)),p=-f*f+d*(d+2*c)+l;return i&&i.copy(this.origin).addScaledVector(this.direction,f),s&&s.copy(qu).addScaledVector(Rh,d),p}intersectSphere(e,n){ci.subVectors(e.center,this.origin);const i=ci.dot(this.direction),s=ci.dot(ci)-i*i,o=e.radius*e.radius;if(s>o)return null;const a=Math.sqrt(o-s),h=i-a,c=i+a;return c<0?null:h<0?this.at(c,n):this.at(h,n)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,s,o,a,h,c;const l=1/this.direction.x,u=1/this.direction.y,f=1/this.direction.z,d=this.origin;return l>=0?(i=(e.min.x-d.x)*l,s=(e.max.x-d.x)*l):(i=(e.max.x-d.x)*l,s=(e.min.x-d.x)*l),u>=0?(o=(e.min.y-d.y)*u,a=(e.max.y-d.y)*u):(o=(e.max.y-d.y)*u,a=(e.min.y-d.y)*u),i>a||o>s||((o>i||isNaN(i))&&(i=o),(a<s||isNaN(s))&&(s=a),f>=0?(h=(e.min.z-d.z)*f,c=(e.max.z-d.z)*f):(h=(e.max.z-d.z)*f,c=(e.min.z-d.z)*f),i>c||h>s)||((h>i||i!==i)&&(i=h),(c<s||s!==s)&&(s=c),s<0)?null:this.at(i>=0?i:s,n)}intersectsBox(e){return this.intersectBox(e,ci)!==null}intersectTriangle(e,n,i,s,o){Du.subVectors(n,e),Oh.subVectors(i,e),$u.crossVectors(Du,Oh);let a=this.direction.dot($u),h;if(a>0){if(s)return null;h=1}else if(a<0)h=-1,a=-a;else return null;Oi.subVectors(this.origin,e);const c=h*this.direction.dot(Oh.crossVectors(Oi,Oh));if(c<0)return null;const l=h*this.direction.dot(Du.cross(Oi));if(l<0||c+l>a)return null;const u=-h*Oi.dot($u);return u<0?null:this.at(u/a,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}const jm=new Qt;class wC{constructor(e,n,i=0,s=1/0){this.ray=new Wm(e,n),this.near=i,this.far=s,this.camera=null,this.layers=new Au,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return jm.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(jm),this}intersectObject(e,n=!0,i=[]){return Vu(e,this,i,n),i.sort(Ym),i}intersectObjects(e,n=!0,i=[]){for(let s=0,o=e.length;s<o;s++)Vu(e[s],this,i,n);return i.sort(Ym),i}}function Ym(r,e){return r.distance-e.distance}function Vu(r,e,n,i){let s=!0;if(r.layers.test(e.layers)&&r.raycast(e,n)===!1&&(s=!1),s===!0&&i===!0){const o=r.children;for(let a=0,h=o.length;a<h;a++)Vu(o[a],e,n,!0)}}const Hm=new Vn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Xm=new Vn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function bC(){const r={enabled:!0,workingColorSpace:mu,spaces:{},convert:function(s,o,a){return this.enabled===!1||o===a||!o||!a||(this.spaces[o].transfer===Sh&&(s.r=li(s.r),s.g=li(s.g),s.b=li(s.b)),this.spaces[o].primaries!==this.spaces[a].primaries&&(s.applyMatrix3(this.spaces[o].toXYZ),s.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Sh&&(s.r=_r(s.r),s.g=_r(s.g),s.b=_r(s.b))),s},workingToColorSpace:function(s,o){return this.convert(s,this.workingColorSpace,o)},colorSpaceToWorking:function(s,o){return this.convert(s,o,this.workingColorSpace)},getPrimaries:function(s){return this.spaces[s].primaries},getTransfer:function(s){return s===xu?gu:this.spaces[s].transfer},getLuminanceCoefficients:function(s,o=this.workingColorSpace){return s.fromArray(this.spaces[o].luminanceCoefficients)},define:function(s){Object.assign(this.spaces,s)},_getMatrix:function(s,o,a){return s.copy(this.spaces[o].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(s){return this.spaces[s].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(s=this.workingColorSpace){return this.spaces[s].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(s,o){return Vm("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),r.workingToColorSpace(s,o)},toWorkingColorSpace:function(s,o){return Vm("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),r.colorSpaceToWorking(s,o)}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],i=[.3127,.329];return r.define({[mu]:{primaries:e,whitePoint:i,transfer:gu,toXYZ:Hm,fromXYZ:Xm,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:an},outputColorSpaceConfig:{drawingBufferColorSpace:an}},[an]:{primaries:e,whitePoint:i,transfer:Sh,toXYZ:Hm,fromXYZ:Xm,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:an}}}),r}const ln=bC();function li(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function _r(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}let Sr;class Zm{static getDataURL(e,n="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{Sr===void 0&&(Sr=Bu("canvas")),Sr.width=e.width,Sr.height=e.height;const s=Sr.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),i=Sr}return i.toDataURL(n)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=Bu("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const s=i.getImageData(0,0,e.width,e.height),o=s.data;for(let a=0;a<o.length;a++)o[a]=li(o[a]/255)*255;return i.putImageData(s,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(li(n[i]/255)*255):n[i]=li(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let vC=0;class Lh{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:vC++}),this.uuid=Sn(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const n=this.data;return n instanceof HTMLVideoElement?e.set(n.videoWidth,n.videoHeight):n!==null?e.set(n.width,n.height,n.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},s=this.data;if(s!==null){let o;if(Array.isArray(s)){o=[];for(let a=0,h=s.length;a<h;a++)s[a].isDataTexture?o.push(Uu(s[a].image)):o.push(Uu(s[a]))}else o=Uu(s);i.url=o}return n||(e.images[this.uuid]=i),i}}function Uu(r){return typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap?Zm.getDataURL(r):r.data?{data:Array.from(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let MC=0;const Wu=new $;class fe extends Ci{constructor(e=fe.DEFAULT_IMAGE,n=fe.DEFAULT_MAPPING,i=Ai,s=Ai,o=fr,a=mx,h=du,c=lu,l=fe.DEFAULT_ANISOTROPY,u=xu){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:MC++}),this.uuid=Sn(),this.name="",this.source=new Lh(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=l,this.format=h,this.internalFormat=null,this.type=c,this.offset=new nt(0,0),this.repeat=new nt(1,1),this.center=new nt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Vn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(Wu).x}get height(){return this.source.getSize(Wu).y}get depth(){return this.source.getSize(Wu).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Texture.setValues(): parameter '${n}' has value of undefined.`);continue}const s=this[n];if(s===void 0){console.warn(`THREE.Texture.setValues(): property '${n}' does not exist.`);continue}s&&i&&s.isVector2&&i.isVector2||s&&i&&s.isVector3&&i.isVector3||s&&i&&s.isMatrix3&&i.isMatrix3?s.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==ou)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case hu:e.x=e.x-Math.floor(e.x);break;case Ai:e.x=e.x<0?0:1;break;case cu:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case hu:e.y=e.y-Math.floor(e.y);break;case Ai:e.y=e.y<0?0:1;break;case cu:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}fe.DEFAULT_IMAGE=null,fe.DEFAULT_MAPPING=ou,fe.DEFAULT_ANISOTROPY=1;class Li{constructor(e=0,n=0,i=0,s=1){Li.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,s){return this.x=e,this.y=n,this.z=i,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,s=this.z,o=this.w,a=e.elements;return this.x=a[0]*n+a[4]*i+a[8]*s+a[12]*o,this.y=a[1]*n+a[5]*i+a[9]*s+a[13]*o,this.z=a[2]*n+a[6]*i+a[10]*s+a[14]*o,this.w=a[3]*n+a[7]*i+a[11]*s+a[15]*o,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,s,o;const c=e.elements,l=c[0],u=c[4],f=c[8],d=c[1],p=c[5],y=c[9],x=c[2],m=c[6],g=c[10];if(Math.abs(u-d)<.01&&Math.abs(f-x)<.01&&Math.abs(y-m)<.01){if(Math.abs(u+d)<.1&&Math.abs(f+x)<.1&&Math.abs(y+m)<.1&&Math.abs(l+p+g-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const M=(l+1)/2,S=(p+1)/2,E=(g+1)/2,A=(u+d)/4,I=(f+x)/4,b=(y+m)/4;return M>S&&M>E?M<.01?(i=0,s=.707106781,o=.707106781):(i=Math.sqrt(M),s=A/i,o=I/i):S>E?S<.01?(i=.707106781,s=0,o=.707106781):(s=Math.sqrt(S),i=A/s,o=b/s):E<.01?(i=.707106781,s=.707106781,o=0):(o=Math.sqrt(E),i=I/o,s=b/o),this.set(i,s,o,n),this}let w=Math.sqrt((m-y)*(m-y)+(f-x)*(f-x)+(d-u)*(d-u));return Math.abs(w)<.001&&(w=1),this.x=(m-y)/w,this.y=(f-x)/w,this.z=(d-u)/w,this.w=Math.acos((l+p+g-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Mt(this.x,e.x,n.x),this.y=Mt(this.y,e.y,n.y),this.z=Mt(this.z,e.z,n.z),this.w=Mt(this.w,e.w,n.w),this}clampScalar(e,n){return this.x=Mt(this.x,e,n),this.y=Mt(this.y,e,n),this.z=Mt(this.z,e,n),this.w=Mt(this.w,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Mt(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Gm extends Ci{constructor(e=1,n=1,i={}){super(),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:fr,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},i),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=i.depth,this.scissor=new Li(0,0,e,n),this.scissorTest=!1,this.viewport=new Li(0,0,e,n);const s={width:e,height:n,depth:i.depth},o=new fe(s);this.textures=[];const a=i.count;for(let h=0;h<a;h++)this.textures[h]=o.clone(),this.textures[h].isRenderTargetTexture=!0,this.textures[h].renderTarget=this;this._setTextureOptions(i),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}_setTextureOptions(e={}){const n={minFilter:fr,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(n.mapping=e.mapping),e.wrapS!==void 0&&(n.wrapS=e.wrapS),e.wrapT!==void 0&&(n.wrapT=e.wrapT),e.wrapR!==void 0&&(n.wrapR=e.wrapR),e.magFilter!==void 0&&(n.magFilter=e.magFilter),e.minFilter!==void 0&&(n.minFilter=e.minFilter),e.format!==void 0&&(n.format=e.format),e.type!==void 0&&(n.type=e.type),e.anisotropy!==void 0&&(n.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(n.colorSpace=e.colorSpace),e.flipY!==void 0&&(n.flipY=e.flipY),e.generateMipmaps!==void 0&&(n.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(n.internalFormat=e.internalFormat);for(let i=0;i<this.textures.length;i++)this.textures[i].setValues(n)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let s=0,o=this.textures.length;s<o;s++)this.textures[s].image.width=e,this.textures[s].image.height=n,this.textures[s].image.depth=i,this.textures[s].isArrayTexture=this.textures[s].image.depth>1;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++){this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const s=Object.assign({},e.textures[n].image);this.textures[n].source=new Lh(s)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Jm extends fe{constructor(e=null,n=1,i=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:s},this.magFilter=_n,this.minFilter=_n,this.wrapR=Ai,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class _C extends Gm{constructor(e=1,n=1,i=1,s={}){super(e,n,s),this.isRenderTarget3D=!0,this.depth=i,this.texture=new Jm(null,e,n,i),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class ju{constructor(e){this.value=e}clone(){return new ju(this.value.clone===void 0?this.value:this.value.clone())}}let SC=0;class TC extends Ci{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:SC++}),this.name="",this.usage=Eo,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let i=0,s=n.length;i<s;i++){const o=Array.isArray(n[i])?n[i]:[n[i]];for(let a=0;a<o.length;a++)this.uniforms.push(o[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class EC extends Ci{constructor(e,n=null){super(),this.object=e,this.domElement=n,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}class zn{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,s=this.getPoint(0),o=0;n.push(0);for(let a=1;a<=e;a++)i=this.getPoint(a/e),o+=i.distanceTo(s),n.push(o),s=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n=null){const i=this.getLengths();let s=0;const o=i.length;let a;n?a=n:a=e*i[o-1];let h=0,c=o-1,l;for(;h<=c;)if(s=Math.floor(h+(c-h)/2),l=i[s]-a,l<0)h=s+1;else if(l>0)c=s-1;else{c=s;break}if(s=c,i[s]===a)return s/(o-1);const u=i[s],d=i[s+1]-u,p=(a-u)/d;return(s+p)/(o-1)}getTangent(e,n){let s=e-1e-4,o=e+1e-4;s<0&&(s=0),o>1&&(o=1);const a=this.getPoint(s),h=this.getPoint(o),c=n||(a.isVector2?new nt:new $);return c.copy(h).sub(a).normalize(),c}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n=!1){const i=new $,s=[],o=[],a=[],h=new $,c=new Qt;for(let p=0;p<=e;p++){const y=p/e;s[p]=this.getTangentAt(y,new $)}o[0]=new $,a[0]=new $;let l=Number.MAX_VALUE;const u=Math.abs(s[0].x),f=Math.abs(s[0].y),d=Math.abs(s[0].z);u<=l&&(l=u,i.set(1,0,0)),f<=l&&(l=f,i.set(0,1,0)),d<=l&&i.set(0,0,1),h.crossVectors(s[0],i).normalize(),o[0].crossVectors(s[0],h),a[0].crossVectors(s[0],o[0]);for(let p=1;p<=e;p++){if(o[p]=o[p-1].clone(),a[p]=a[p-1].clone(),h.crossVectors(s[p-1],s[p]),h.length()>Number.EPSILON){h.normalize();const y=Math.acos(Mt(s[p-1].dot(s[p]),-1,1));o[p].applyMatrix4(c.makeRotationAxis(h,y))}a[p].crossVectors(s[p],o[p])}if(n===!0){let p=Math.acos(Mt(o[0].dot(o[e]),-1,1));p/=e,s[0].dot(h.crossVectors(o[0],o[e]))>0&&(p=-p);for(let y=1;y<=e;y++)o[y].applyMatrix4(c.makeRotationAxis(s[y],p*y)),a[y].crossVectors(s[y],o[y])}return{tangents:s,normals:o,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Bh extends zn{constructor(e=0,n=0,i=1,s=1,o=0,a=Math.PI*2,h=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=s,this.aStartAngle=o,this.aEndAngle=a,this.aClockwise=h,this.aRotation=c}getPoint(e,n=new nt){const i=n,s=Math.PI*2;let o=this.aEndAngle-this.aStartAngle;const a=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=s;for(;o>s;)o-=s;o<Number.EPSILON&&(a?o=0:o=s),this.aClockwise===!0&&!a&&(o===s?o=-s:o=o-s);const h=this.aStartAngle+e*o;let c=this.aX+this.xRadius*Math.cos(h),l=this.aY+this.yRadius*Math.sin(h);if(this.aRotation!==0){const u=Math.cos(this.aRotation),f=Math.sin(this.aRotation),d=c-this.aX,p=l-this.aY;c=d*u-p*f+this.aX,l=d*f+p*u+this.aY}return i.set(c,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Qm extends Bh{constructor(e,n,i,s,o,a){super(e,n,i,i,s,o,a),this.isArcCurve=!0,this.type="ArcCurve"}}function Yu(){let r=0,e=0,n=0,i=0;function s(o,a,h,c){r=o,e=h,n=-3*o+3*a-2*h-c,i=2*o-2*a+h+c}return{initCatmullRom:function(o,a,h,c,l){s(a,h,l*(h-o),l*(c-a))},initNonuniformCatmullRom:function(o,a,h,c,l,u,f){let d=(a-o)/l-(h-o)/(l+u)+(h-a)/u,p=(h-a)/u-(c-a)/(u+f)+(c-h)/f;d*=u,p*=u,s(a,h,d,p)},calc:function(o){const a=o*o,h=a*o;return r+e*o+n*a+i*h}}}const Fh=new $,Hu=new Yu,Xu=new Yu,Zu=new Yu;class Km extends zn{constructor(e=[],n=!1,i="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=s}getPoint(e,n=new $){const i=n,s=this.points,o=s.length,a=(o-(this.closed?0:1))*e;let h=Math.floor(a),c=a-h;this.closed?h+=h>0?0:(Math.floor(Math.abs(h)/o)+1)*o:c===0&&h===o-1&&(h=o-2,c=1);let l,u;this.closed||h>0?l=s[(h-1)%o]:(Fh.subVectors(s[0],s[1]).add(s[0]),l=Fh);const f=s[h%o],d=s[(h+1)%o];if(this.closed||h+2<o?u=s[(h+2)%o]:(Fh.subVectors(s[o-1],s[o-2]).add(s[o-1]),u=Fh),this.curveType==="centripetal"||this.curveType==="chordal"){const p=this.curveType==="chordal"?.5:.25;let y=Math.pow(l.distanceToSquared(f),p),x=Math.pow(f.distanceToSquared(d),p),m=Math.pow(d.distanceToSquared(u),p);x<1e-4&&(x=1),y<1e-4&&(y=x),m<1e-4&&(m=x),Hu.initNonuniformCatmullRom(l.x,f.x,d.x,u.x,y,x,m),Xu.initNonuniformCatmullRom(l.y,f.y,d.y,u.y,y,x,m),Zu.initNonuniformCatmullRom(l.z,f.z,d.z,u.z,y,x,m)}else this.curveType==="catmullrom"&&(Hu.initCatmullRom(l.x,f.x,d.x,u.x,this.tension),Xu.initCatmullRom(l.y,f.y,d.y,u.y,this.tension),Zu.initCatmullRom(l.z,f.z,d.z,u.z,this.tension));return i.set(Hu.calc(c),Xu.calc(c),Zu.calc(c)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const s=e.points[n];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const s=this.points[n];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const s=e.points[n];this.points.push(new $().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function tg(r,e,n,i,s){const o=(i-e)*.5,a=(s-n)*.5,h=r*r,c=r*h;return(2*n-2*i+o+a)*c+(-3*n+3*i-2*o-a)*h+o*r+n}function zC(r,e){const n=1-r;return n*n*e}function AC(r,e){return 2*(1-r)*r*e}function CC(r,e){return r*r*e}function No(r,e,n,i){return zC(r,e)+AC(r,n)+CC(r,i)}function PC(r,e){const n=1-r;return n*n*n*e}function IC(r,e){const n=1-r;return 3*n*n*r*e}function kC(r,e){return 3*(1-r)*r*r*e}function RC(r,e){return r*r*r*e}function qo(r,e,n,i,s){return PC(r,e)+IC(r,n)+kC(r,i)+RC(r,s)}class Gu extends zn{constructor(e=new nt,n=new nt,i=new nt,s=new nt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=s}getPoint(e,n=new nt){const i=n,s=this.v0,o=this.v1,a=this.v2,h=this.v3;return i.set(qo(e,s.x,o.x,a.x,h.x),qo(e,s.y,o.y,a.y,h.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class eg extends zn{constructor(e=new $,n=new $,i=new $,s=new $){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=s}getPoint(e,n=new $){const i=n,s=this.v0,o=this.v1,a=this.v2,h=this.v3;return i.set(qo(e,s.x,o.x,a.x,h.x),qo(e,s.y,o.y,a.y,h.y),qo(e,s.z,o.z,a.z,h.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Ju extends zn{constructor(e=new nt,n=new nt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new nt){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new nt){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ng extends zn{constructor(e=new $,n=new $){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new $){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new $){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Qu extends zn{constructor(e=new nt,n=new nt,i=new nt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new nt){const i=n,s=this.v0,o=this.v1,a=this.v2;return i.set(No(e,s.x,o.x,a.x),No(e,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Ku extends zn{constructor(e=new $,n=new $,i=new $){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new $){const i=n,s=this.v0,o=this.v1,a=this.v2;return i.set(No(e,s.x,o.x,a.x),No(e,s.y,o.y,a.y),No(e,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class tf extends zn{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new nt){const i=n,s=this.points,o=(s.length-1)*e,a=Math.floor(o),h=o-a,c=s[a===0?a:a-1],l=s[a],u=s[a>s.length-2?s.length-1:a+1],f=s[a>s.length-3?s.length-1:a+2];return i.set(tg(h,c.x,l.x,u.x,f.x),tg(h,c.y,l.y,u.y,f.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const s=e.points[n];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const s=this.points[n];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const s=e.points[n];this.points.push(new nt().fromArray(s))}return this}}const Nh=Object.freeze(Object.defineProperty({__proto__:null,ArcCurve:Qm,CatmullRomCurve3:Km,CubicBezierCurve:Gu,CubicBezierCurve3:eg,EllipseCurve:Bh,LineCurve:Ju,LineCurve3:ng,QuadraticBezierCurve:Qu,QuadraticBezierCurve3:Ku,SplineCurve:tf},Symbol.toStringTag,{value:"Module"}));class ig extends zn{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(n)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Nh[i](n,e))}return this}getPoint(e,n){const i=e*this.getLength(),s=this.getCurveLengths();let o=0;for(;o<s.length;){if(s[o]>=i){const a=s[o]-i,h=this.curves[o],c=h.getLength(),l=c===0?0:1-a/c;return h.getPointAt(l,n)}o++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let i=0,s=this.curves.length;i<s;i++)n+=this.curves[i].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let i;for(let s=0,o=this.curves;s<o.length;s++){const a=o[s],h=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,c=a.getPoints(h);for(let l=0;l<c.length;l++){const u=c[l];i&&i.equals(u)||(n.push(u),i=u)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const s=e.curves[n];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,i=this.curves.length;n<i;n++){const s=this.curves[n];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const s=e.curves[n];this.curves.push(new Nh[s.type]().fromJSON(s))}return this}}class qh extends ig{constructor(e){super(),this.type="Path",this.currentPoint=new nt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,i=e.length;n<i;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const i=new Ju(this.currentPoint.clone(),new nt(e,n));return this.curves.push(i),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,i,s){const o=new Qu(this.currentPoint.clone(),new nt(e,n),new nt(i,s));return this.curves.push(o),this.currentPoint.set(i,s),this}bezierCurveTo(e,n,i,s,o,a){const h=new Gu(this.currentPoint.clone(),new nt(e,n),new nt(i,s),new nt(o,a));return this.curves.push(h),this.currentPoint.set(o,a),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),i=new tf(n);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,i,s,o,a){const h=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+h,n+c,i,s,o,a),this}absarc(e,n,i,s,o,a){return this.absellipse(e,n,i,i,s,o,a),this}ellipse(e,n,i,s,o,a,h,c){const l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,n+u,i,s,o,a,h,c),this}absellipse(e,n,i,s,o,a,h,c){const l=new Bh(e,n,i,s,o,a,h,c);if(this.curves.length>0){const f=l.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(l);const u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Tr extends qh{constructor(e){super(e),this.uuid=Sn(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let i=0,s=this.holes.length;i<s;i++)n[i]=this.holes[i].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const s=e.holes[n];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,i=this.holes.length;n<i;n++){const s=this.holes[n];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const s=e.holes[n];this.holes.push(new qh().fromJSON(s))}return this}}const sg={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Bi={h:0,s:0,l:0},Dh={h:0,s:0,l:0};function ef(r,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?r+(e-r)*6*n:n<1/2?e:n<2/3?r+(e-r)*6*(2/3-n):r}class Er{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=an){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,ln.colorSpaceToWorking(this,n),this}setRGB(e,n,i,s=ln.workingColorSpace){return this.r=e,this.g=n,this.b=i,ln.colorSpaceToWorking(this,s),this}setHSL(e,n,i,s=ln.workingColorSpace){if(e=wu(e,1),n=Mt(n,0,1),i=Mt(i,0,1),n===0)this.r=this.g=this.b=i;else{const o=i<=.5?i*(1+n):i+n-i*n,a=2*i-o;this.r=ef(a,o,e+1/3),this.g=ef(a,o,e),this.b=ef(a,o,e-1/3)}return ln.colorSpaceToWorking(this,s),this}setStyle(e,n=an){function i(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const a=s[1],h=s[2];switch(a){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return i(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,n);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return i(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,n);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return i(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=s[1],a=o.length;if(a===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,n);if(a===6)return this.setHex(parseInt(o,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=an){const i=sg[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=li(e.r),this.g=li(e.g),this.b=li(e.b),this}copyLinearToSRGB(e){return this.r=_r(e.r),this.g=_r(e.g),this.b=_r(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=an){return ln.workingToColorSpace(we.copy(this),e),Math.round(Mt(we.r*255,0,255))*65536+Math.round(Mt(we.g*255,0,255))*256+Math.round(Mt(we.b*255,0,255))}getHexString(e=an){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=ln.workingColorSpace){ln.workingToColorSpace(we.copy(this),n);const i=we.r,s=we.g,o=we.b,a=Math.max(i,s,o),h=Math.min(i,s,o);let c,l;const u=(h+a)/2;if(h===a)c=0,l=0;else{const f=a-h;switch(l=u<=.5?f/(a+h):f/(2-a-h),a){case i:c=(s-o)/f+(s<o?6:0);break;case s:c=(o-i)/f+2;break;case o:c=(i-s)/f+4;break}c/=6}return e.h=c,e.s=l,e.l=u,e}getRGB(e,n=ln.workingColorSpace){return ln.workingToColorSpace(we.copy(this),n),e.r=we.r,e.g=we.g,e.b=we.b,e}getStyle(e=an){ln.workingToColorSpace(we.copy(this),e);const n=we.r,i=we.g,s=we.b;return e!==an?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(s*255)})`}offsetHSL(e,n,i){return this.getHSL(Bi),this.setHSL(Bi.h+e,Bi.s+n,Bi.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(Bi),e.getHSL(Dh);const i=Ao(Bi.h,Dh.h,n),s=Ao(Bi.s,Dh.s,n),o=Ao(Bi.l,Dh.l,n);return this.setHSL(i,s,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,s=this.b,o=e.elements;return this.r=o[0]*n+o[3]*i+o[6]*s,this.g=o[1]*n+o[4]*i+o[7]*s,this.b=o[2]*n+o[5]*i+o[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const we=new Er;Er.NAMES=sg;function OC(r,e,n=2){const i=e&&e.length,s=i?e[0]*n:r.length;let o=rg(r,0,s,n,!0);const a=[];if(!o||o.next===o.prev)return a;let h,c,l;if(i&&(o=qC(r,e,o,n)),r.length>80*n){h=1/0,c=1/0;let u=-1/0,f=-1/0;for(let d=n;d<s;d+=n){const p=r[d],y=r[d+1];p<h&&(h=p),y<c&&(c=y),p>u&&(u=p),y>f&&(f=y)}l=Math.max(u-h,f-c),l=l!==0?32767/l:0}return Do(o,a,n,h,c,l,0),a}function rg(r,e,n,i,s){let o;if(s===rf(r,e,n,i)>0)for(let a=e;a<n;a+=i)o=cg(a/i|0,r[a],r[a+1],o);else for(let a=n-i;a>=e;a-=i)o=cg(a/i|0,r[a],r[a+1],o);return o&&zr(o,o.next)&&(Uo(o),o=o.next),o}function Os(r,e){if(!r)return r;e||(e=r);let n=r,i;do if(i=!1,!n.steiner&&(zr(n,n.next)||Xt(n.prev,n,n.next)===0)){if(Uo(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function Do(r,e,n,i,s,o,a){if(!r)return;!a&&o&&WC(r,i,s,o);let h=r;for(;r.prev!==r.next;){const c=r.prev,l=r.next;if(o?BC(r,i,s,o):LC(r)){e.push(c.i,r.i,l.i),Uo(r),r=l.next,h=l.next;continue}if(r=l,r===h){a?a===1?(r=FC(Os(r),e),Do(r,e,n,i,s,o,2)):a===2&&NC(r,e,n,i,s,o):Do(Os(r),e,n,i,s,o,1);break}}}function LC(r){const e=r.prev,n=r,i=r.next;if(Xt(e,n,i)>=0)return!1;const s=e.x,o=n.x,a=i.x,h=e.y,c=n.y,l=i.y,u=Math.min(s,o,a),f=Math.min(h,c,l),d=Math.max(s,o,a),p=Math.max(h,c,l);let y=i.next;for(;y!==e;){if(y.x>=u&&y.x<=d&&y.y>=f&&y.y<=p&&$o(s,h,o,c,a,l,y.x,y.y)&&Xt(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function BC(r,e,n,i){const s=r.prev,o=r,a=r.next;if(Xt(s,o,a)>=0)return!1;const h=s.x,c=o.x,l=a.x,u=s.y,f=o.y,d=a.y,p=Math.min(h,c,l),y=Math.min(u,f,d),x=Math.max(h,c,l),m=Math.max(u,f,d),g=nf(p,y,e,n,i),w=nf(x,m,e,n,i);let M=r.prevZ,S=r.nextZ;for(;M&&M.z>=g&&S&&S.z<=w;){if(M.x>=p&&M.x<=x&&M.y>=y&&M.y<=m&&M!==s&&M!==a&&$o(h,u,c,f,l,d,M.x,M.y)&&Xt(M.prev,M,M.next)>=0||(M=M.prevZ,S.x>=p&&S.x<=x&&S.y>=y&&S.y<=m&&S!==s&&S!==a&&$o(h,u,c,f,l,d,S.x,S.y)&&Xt(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;M&&M.z>=g;){if(M.x>=p&&M.x<=x&&M.y>=y&&M.y<=m&&M!==s&&M!==a&&$o(h,u,c,f,l,d,M.x,M.y)&&Xt(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;S&&S.z<=w;){if(S.x>=p&&S.x<=x&&S.y>=y&&S.y<=m&&S!==s&&S!==a&&$o(h,u,c,f,l,d,S.x,S.y)&&Xt(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function FC(r,e){let n=r;do{const i=n.prev,s=n.next.next;!zr(i,s)&&ag(i,n,n.next,s)&&Vo(i,s)&&Vo(s,i)&&(e.push(i.i,n.i,s.i),Uo(n),Uo(n.next),n=r=s),n=n.next}while(n!==r);return Os(n)}function NC(r,e,n,i,s,o){let a=r;do{let h=a.next.next;for(;h!==a.prev;){if(a.i!==h.i&&HC(a,h)){let c=hg(a,h);a=Os(a,a.next),c=Os(c,c.next),Do(a,e,n,i,s,o,0),Do(c,e,n,i,s,o,0);return}h=h.next}a=a.next}while(a!==r)}function qC(r,e,n,i){const s=[];for(let o=0,a=e.length;o<a;o++){const h=e[o]*i,c=o<a-1?e[o+1]*i:r.length,l=rg(r,h,c,i,!1);l===l.next&&(l.steiner=!0),s.push(YC(l))}s.sort(DC);for(let o=0;o<s.length;o++)n=$C(s[o],n);return n}function DC(r,e){let n=r.x-e.x;if(n===0&&(n=r.y-e.y,n===0)){const i=(r.next.y-r.y)/(r.next.x-r.x),s=(e.next.y-e.y)/(e.next.x-e.x);n=i-s}return n}function $C(r,e){const n=VC(r,e);if(!n)return e;const i=hg(n,r);return Os(i,i.next),Os(n,n.next)}function VC(r,e){let n=e;const i=r.x,s=r.y;let o=-1/0,a;if(zr(r,n))return n;do{if(zr(r,n.next))return n.next;if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){const f=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(f<=i&&f>o&&(o=f,a=n.x<n.next.x?n:n.next,f===i))return a}n=n.next}while(n!==e);if(!a)return null;const h=a,c=a.x,l=a.y;let u=1/0;n=a;do{if(i>=n.x&&n.x>=c&&i!==n.x&&og(s<l?i:o,s,c,l,s<l?o:i,s,n.x,n.y)){const f=Math.abs(s-n.y)/(i-n.x);Vo(n,r)&&(f<u||f===u&&(n.x>a.x||n.x===a.x&&UC(a,n)))&&(a=n,u=f)}n=n.next}while(n!==h);return a}function UC(r,e){return Xt(r.prev,r,e.prev)<0&&Xt(e.next,r,r.next)<0}function WC(r,e,n,i){let s=r;do s.z===0&&(s.z=nf(s.x,s.y,e,n,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==r);s.prevZ.nextZ=null,s.prevZ=null,jC(s)}function jC(r){let e,n=1;do{let i=r,s;r=null;let o=null;for(e=0;i;){e++;let a=i,h=0;for(let l=0;l<n&&(h++,a=a.nextZ,!!a);l++);let c=n;for(;h>0||c>0&&a;)h!==0&&(c===0||!a||i.z<=a.z)?(s=i,i=i.nextZ,h--):(s=a,a=a.nextZ,c--),o?o.nextZ=s:r=s,s.prevZ=o,o=s;i=a}o.nextZ=null,n*=2}while(e>1);return r}function nf(r,e,n,i,s){return r=(r-n)*s|0,e=(e-i)*s|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function YC(r){let e=r,n=r;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==r);return n}function og(r,e,n,i,s,o,a,h){return(s-a)*(e-h)>=(r-a)*(o-h)&&(r-a)*(i-h)>=(n-a)*(e-h)&&(n-a)*(o-h)>=(s-a)*(i-h)}function $o(r,e,n,i,s,o,a,h){return!(r===a&&e===h)&&og(r,e,n,i,s,o,a,h)}function HC(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!XC(r,e)&&(Vo(r,e)&&Vo(e,r)&&ZC(r,e)&&(Xt(r.prev,r,e.prev)||Xt(r,e.prev,e))||zr(r,e)&&Xt(r.prev,r,r.next)>0&&Xt(e.prev,e,e.next)>0)}function Xt(r,e,n){return(e.y-r.y)*(n.x-e.x)-(e.x-r.x)*(n.y-e.y)}function zr(r,e){return r.x===e.x&&r.y===e.y}function ag(r,e,n,i){const s=Vh(Xt(r,e,n)),o=Vh(Xt(r,e,i)),a=Vh(Xt(n,i,r)),h=Vh(Xt(n,i,e));return!!(s!==o&&a!==h||s===0&&$h(r,n,e)||o===0&&$h(r,i,e)||a===0&&$h(n,r,i)||h===0&&$h(n,e,i))}function $h(r,e,n){return e.x<=Math.max(r.x,n.x)&&e.x>=Math.min(r.x,n.x)&&e.y<=Math.max(r.y,n.y)&&e.y>=Math.min(r.y,n.y)}function Vh(r){return r>0?1:r<0?-1:0}function XC(r,e){let n=r;do{if(n.i!==r.i&&n.next.i!==r.i&&n.i!==e.i&&n.next.i!==e.i&&ag(n,n.next,r,e))return!0;n=n.next}while(n!==r);return!1}function Vo(r,e){return Xt(r.prev,r,r.next)<0?Xt(r,e,r.next)>=0&&Xt(r,r.prev,e)>=0:Xt(r,e,r.prev)<0||Xt(r,r.next,e)<0}function ZC(r,e){let n=r,i=!1;const s=(r.x+e.x)/2,o=(r.y+e.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&s<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==r);return i}function hg(r,e){const n=sf(r.i,r.x,r.y),i=sf(e.i,e.x,e.y),s=r.next,o=e.prev;return r.next=e,e.prev=r,n.next=s,s.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function cg(r,e,n,i){const s=sf(r,e,n);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function Uo(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function sf(r,e,n){return{i:r,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function GC(r,e,n,i){const s=e&&e.length,o=s?e[0]*n:r.length;let a=Math.abs(rf(r,0,o,n));if(s)for(let c=0,l=e.length;c<l;c++){const u=e[c]*n,f=c<l-1?e[c+1]*n:r.length;a-=Math.abs(rf(r,u,f,n))}let h=0;for(let c=0;c<i.length;c+=3){const l=i[c]*n,u=i[c+1]*n,f=i[c+2]*n;h+=Math.abs((r[l]-r[f])*(r[u+1]-r[l+1])-(r[l]-r[u])*(r[f+1]-r[l+1]))}return a===0&&h===0?0:Math.abs((h-a)/a)}function rf(r,e,n,i){let s=0;for(let o=e,a=n-i;o<n;o+=i)s+=(r[a]-r[o])*(r[o+1]+r[a+1]),a=o;return s}function JC(r){const e=[],n=[],i=r[0][0].length;let s=0,o=0;for(const a of r){for(const h of a)for(let c=0;c<i;c++)e.push(h[c]);o&&(s+=o,n.push(s)),o=a.length}return{vertices:e,holes:n,dimensions:i}}class QC{static triangulate(e,n,i=2){return OC(e,n,i)}}class An{static area(e){const n=e.length;let i=0;for(let s=n-1,o=0;o<n;s=o++)i+=e[s].x*e[o].y-e[o].x*e[s].y;return i*.5}static isClockWise(e){return An.area(e)<0}static triangulateShape(e,n){const i=[],s=[],o=[];lg(e),ug(i,e);let a=e.length;n.forEach(lg);for(let c=0;c<n.length;c++)s.push(a),a+=n[c].length,ug(i,n[c]);const h=QC.triangulate(i,s);for(let c=0;c<h.length;c+=3)o.push(h.slice(c,c+3));return o}}function lg(r){const e=r.length;e>2&&r[e-1].equals(r[0])&&r.pop()}function ug(r,e){for(let n=0;n<e.length;n++)r.push(e[n].x),r.push(e[n].y)}class KC{constructor(){this.type="ShapePath",this.color=new Er,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new qh,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,i,s){return this.currentPath.quadraticCurveTo(e,n,i,s),this}bezierCurveTo(e,n,i,s,o,a){return this.currentPath.bezierCurveTo(e,n,i,s,o,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(g){const w=[];for(let M=0,S=g.length;M<S;M++){const E=g[M],A=new Tr;A.curves=E.curves,w.push(A)}return w}function i(g,w){const M=w.length;let S=!1;for(let E=M-1,A=0;A<M;E=A++){let I=w[E],b=w[A],v=b.x-I.x,_=b.y-I.y;if(Math.abs(_)>Number.EPSILON){if(_<0&&(I=w[A],v=-v,b=w[E],_=-_),g.y<I.y||g.y>b.y)continue;if(g.y===I.y){if(g.x===I.x)return!0}else{const z=_*(g.x-I.x)-v*(g.y-I.y);if(z===0)return!0;if(z<0)continue;S=!S}}else{if(g.y!==I.y)continue;if(b.x<=g.x&&g.x<=I.x||I.x<=g.x&&g.x<=b.x)return!0}}return S}const s=An.isClockWise,o=this.subPaths;if(o.length===0)return[];let a,h,c;const l=[];if(o.length===1)return h=o[0],c=new Tr,c.curves=h.curves,l.push(c),l;let u=!s(o[0].getPoints());u=e?!u:u;const f=[],d=[];let p=[],y=0,x;d[y]=void 0,p[y]=[];for(let g=0,w=o.length;g<w;g++)h=o[g],x=h.getPoints(),a=s(x),a=e?!a:a,a?(!u&&d[y]&&y++,d[y]={s:new Tr,p:x},d[y].s.curves=h.curves,u&&y++,p[y]=[]):p[y].push({h,p:x[0]});if(!d[0])return n(o);if(d.length>1){let g=!1,w=0;for(let M=0,S=d.length;M<S;M++)f[M]=[];for(let M=0,S=d.length;M<S;M++){const E=p[M];for(let A=0;A<E.length;A++){const I=E[A];let b=!0;for(let v=0;v<d.length;v++)i(I.p,d[v].p)&&(M!==v&&w++,b?(b=!1,f[v].push(I)):g=!0);b&&f[M].push(I)}}w>0&&g===!1&&(p=f)}let m;for(let g=0,w=d.length;g<w;g++){c=d[g].s,l.push(c),m=p[g];for(let M=0,S=m.length;M<S;M++)c.holes.push(m[M].h)}return l}}function t5(r,e){const n=r.image&&r.image.width?r.image.width/r.image.height:1;return n>e?(r.repeat.x=1,r.repeat.y=n/e,r.offset.x=0,r.offset.y=(1-r.repeat.y)/2):(r.repeat.x=e/n,r.repeat.y=1,r.offset.x=(1-r.repeat.x)/2,r.offset.y=0),r}function e5(r,e){const n=r.image&&r.image.width?r.image.width/r.image.height:1;return n>e?(r.repeat.x=e/n,r.repeat.y=1,r.offset.x=(1-r.repeat.x)/2,r.offset.y=0):(r.repeat.x=1,r.repeat.y=n/e,r.offset.x=0,r.offset.y=(1-r.repeat.y)/2),r}function n5(r){return r.repeat.x=1,r.repeat.y=1,r.offset.x=0,r.offset.y=0,r}function i5(r,e,n,i){const s=s5(i);switch(n){case Ex:return r*e;case Cx:return r*e/s.components*s.byteLength;case Px:return r*e/s.components*s.byteLength;case Ix:return r*e*2/s.components*s.byteLength;case kx:return r*e*2/s.components*s.byteLength;case zx:return r*e*3/s.components*s.byteLength;case du:return r*e*4/s.components*s.byteLength;case Rx:return r*e*4/s.components*s.byteLength;case Ox:case Lx:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*8;case Bx:case Fx:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case qx:case $x:return Math.max(r,16)*Math.max(e,8)/4;case Nx:case Dx:return Math.max(r,8)*Math.max(e,8)/2;case Vx:case Ux:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*8;case Wx:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case jx:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case Yx:return Math.floor((r+4)/5)*Math.floor((e+3)/4)*16;case Hx:return Math.floor((r+4)/5)*Math.floor((e+4)/5)*16;case Xx:return Math.floor((r+5)/6)*Math.floor((e+4)/5)*16;case Zx:return Math.floor((r+5)/6)*Math.floor((e+5)/6)*16;case Gx:return Math.floor((r+7)/8)*Math.floor((e+4)/5)*16;case Jx:return Math.floor((r+7)/8)*Math.floor((e+5)/6)*16;case Qx:return Math.floor((r+7)/8)*Math.floor((e+7)/8)*16;case Kx:return Math.floor((r+9)/10)*Math.floor((e+4)/5)*16;case tm:return Math.floor((r+9)/10)*Math.floor((e+5)/6)*16;case em:return Math.floor((r+9)/10)*Math.floor((e+7)/8)*16;case nm:return Math.floor((r+9)/10)*Math.floor((e+9)/10)*16;case im:return Math.floor((r+11)/12)*Math.floor((e+9)/10)*16;case sm:return Math.floor((r+11)/12)*Math.floor((e+11)/12)*16;case rm:case om:case am:return Math.ceil(r/4)*Math.ceil(e/4)*16;case hm:case cm:return Math.ceil(r/4)*Math.ceil(e/4)*8;case lm:case um:return Math.ceil(r/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function s5(r){switch(r){case lu:case gx:return{byteLength:1,components:1};case bx:case wx:case Mx:return{byteLength:2,components:1};case _x:case Sx:return{byteLength:2,components:4};case uu:case vx:case fu:return{byteLength:4,components:1};case Tx:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${r}.`)}class r5{static contain(e,n){return t5(e,n)}static cover(e,n){return e5(e,n)}static fill(e){return n5(e)}static getByteLength(e,n,i,s){return i5(e,n,i,s)}}class of extends te{constructor(e=1,n=1,i=1,s=1,o=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:s,heightSegments:o,depthSegments:a};const h=this;s=Math.floor(s),o=Math.floor(o),a=Math.floor(a);const c=[],l=[],u=[],f=[];let d=0,p=0;y("z","y","x",-1,-1,i,n,e,a,o,0),y("z","y","x",1,-1,i,n,-e,a,o,1),y("x","z","y",1,1,e,i,n,s,a,2),y("x","z","y",1,-1,e,i,-n,s,a,3),y("x","y","z",1,-1,e,n,i,s,o,4),y("x","y","z",-1,-1,e,n,-i,s,o,5),this.setIndex(c),this.setAttribute("position",new wt(l,3)),this.setAttribute("normal",new wt(u,3)),this.setAttribute("uv",new wt(f,2));function y(x,m,g,w,M,S,E,A,I,b,v){const _=S/I,z=E/b,P=S/2,k=E/2,B=A/2,R=I+1,L=b+1;let N=0,q=0;const U=new $;for(let J=0;J<L;J++){const X=J*z-k;for(let lt=0;lt<R;lt++){const ot=lt*_-P;U[x]=ot*w,U[m]=X*M,U[g]=B,l.push(U.x,U.y,U.z),U[x]=0,U[m]=0,U[g]=A>0?1:-1,u.push(U.x,U.y,U.z),f.push(lt/I),f.push(1-J/b),N+=1}}for(let J=0;J<b;J++)for(let X=0;X<I;X++){const lt=d+X+R*J,ot=d+X+R*(J+1),ut=d+(X+1)+R*(J+1),ct=d+(X+1)+R*J;c.push(lt,ot,ct),c.push(ot,ut,ct),q+=6}h.addGroup(p,q,v),p+=q,d+=N}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new of(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}class af extends te{constructor(e=1,n=1,i=4,s=8,o=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:n,capSegments:i,radialSegments:s,heightSegments:o},n=Math.max(0,n),i=Math.max(1,Math.floor(i)),s=Math.max(3,Math.floor(s)),o=Math.max(1,Math.floor(o));const a=[],h=[],c=[],l=[],u=n/2,f=Math.PI/2*e,d=n,p=2*f+d,y=i*2+o,x=s+1,m=new $,g=new $;for(let w=0;w<=y;w++){let M=0,S=0,E=0,A=0;if(w<=i){const v=w/i,_=v*Math.PI/2;S=-u-e*Math.cos(_),E=e*Math.sin(_),A=-e*Math.cos(_),M=v*f}else if(w<=i+o){const v=(w-i)/o;S=-u+v*n,E=e,A=0,M=f+v*d}else{const v=(w-i-o)/i,_=v*Math.PI/2;S=u+e*Math.sin(_),E=e*Math.cos(_),A=e*Math.sin(_),M=f+d+v*f}const I=Math.max(0,Math.min(1,M/p));let b=0;w===0?b=.5/s:w===y&&(b=-.5/s);for(let v=0;v<=s;v++){const _=v/s,z=_*Math.PI*2,P=Math.sin(z),k=Math.cos(z);g.x=-E*k,g.y=S,g.z=E*P,h.push(g.x,g.y,g.z),m.set(-E*k,A,E*P),m.normalize(),c.push(m.x,m.y,m.z),l.push(_+b,I)}if(w>0){const v=(w-1)*x;for(let _=0;_<s;_++){const z=v+_,P=v+_+1,k=w*x+_,B=w*x+_+1;a.push(z,P,k),a.push(P,B,k)}}}this.setIndex(a),this.setAttribute("position",new wt(h,3)),this.setAttribute("normal",new wt(c,3)),this.setAttribute("uv",new wt(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new af(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class hf extends te{constructor(e=1,n=32,i=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:i,thetaLength:s},n=Math.max(3,n);const o=[],a=[],h=[],c=[],l=new $,u=new nt;a.push(0,0,0),h.push(0,0,1),c.push(.5,.5);for(let f=0,d=3;f<=n;f++,d+=3){const p=i+f/n*s;l.x=e*Math.cos(p),l.y=e*Math.sin(p),a.push(l.x,l.y,l.z),h.push(0,0,1),u.x=(a[d]/e+1)/2,u.y=(a[d+1]/e+1)/2,c.push(u.x,u.y)}for(let f=1;f<=n;f++)o.push(f,f+1,0);this.setIndex(o),this.setAttribute("position",new wt(a,3)),this.setAttribute("normal",new wt(h,3)),this.setAttribute("uv",new wt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hf(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Uh extends te{constructor(e=1,n=1,i=1,s=32,o=1,a=!1,h=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:s,heightSegments:o,openEnded:a,thetaStart:h,thetaLength:c};const l=this;s=Math.floor(s),o=Math.floor(o);const u=[],f=[],d=[],p=[];let y=0;const x=[],m=i/2;let g=0;w(),a===!1&&(e>0&&M(!0),n>0&&M(!1)),this.setIndex(u),this.setAttribute("position",new wt(f,3)),this.setAttribute("normal",new wt(d,3)),this.setAttribute("uv",new wt(p,2));function w(){const S=new $,E=new $;let A=0;const I=(n-e)/i;for(let b=0;b<=o;b++){const v=[],_=b/o,z=_*(n-e)+e;for(let P=0;P<=s;P++){const k=P/s,B=k*c+h,R=Math.sin(B),L=Math.cos(B);E.x=z*R,E.y=-_*i+m,E.z=z*L,f.push(E.x,E.y,E.z),S.set(R,I,L).normalize(),d.push(S.x,S.y,S.z),p.push(k,1-_),v.push(y++)}x.push(v)}for(let b=0;b<s;b++)for(let v=0;v<o;v++){const _=x[v][b],z=x[v+1][b],P=x[v+1][b+1],k=x[v][b+1];(e>0||v!==0)&&(u.push(_,z,k),A+=3),(n>0||v!==o-1)&&(u.push(z,P,k),A+=3)}l.addGroup(g,A,0),g+=A}function M(S){const E=y,A=new nt,I=new $;let b=0;const v=S===!0?e:n,_=S===!0?1:-1;for(let P=1;P<=s;P++)f.push(0,m*_,0),d.push(0,_,0),p.push(.5,.5),y++;const z=y;for(let P=0;P<=s;P++){const B=P/s*c+h,R=Math.cos(B),L=Math.sin(B);I.x=v*L,I.y=m*_,I.z=v*R,f.push(I.x,I.y,I.z),d.push(0,_,0),A.x=R*.5+.5,A.y=L*.5*_+.5,p.push(A.x,A.y),y++}for(let P=0;P<s;P++){const k=E+P,B=z+P;S===!0?u.push(B,B+1,k):u.push(B+1,B,k),b+=3}l.addGroup(g,b,S===!0?1:2),g+=b}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Uh(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class cf extends Uh{constructor(e=1,n=1,i=32,s=1,o=!1,a=0,h=Math.PI*2){super(0,e,n,i,s,o,a,h),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:h}}static fromJSON(e){return new cf(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Ls extends te{constructor(e=[],n=[],i=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:i,detail:s};const o=[],a=[];h(s),l(i),u(),this.setAttribute("position",new wt(o,3)),this.setAttribute("normal",new wt(o.slice(),3)),this.setAttribute("uv",new wt(a,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function h(w){const M=new $,S=new $,E=new $;for(let A=0;A<n.length;A+=3)p(n[A+0],M),p(n[A+1],S),p(n[A+2],E),c(M,S,E,w)}function c(w,M,S,E){const A=E+1,I=[];for(let b=0;b<=A;b++){I[b]=[];const v=w.clone().lerp(S,b/A),_=M.clone().lerp(S,b/A),z=A-b;for(let P=0;P<=z;P++)P===0&&b===A?I[b][P]=v:I[b][P]=v.clone().lerp(_,P/z)}for(let b=0;b<A;b++)for(let v=0;v<2*(A-b)-1;v++){const _=Math.floor(v/2);v%2===0?(d(I[b][_+1]),d(I[b+1][_]),d(I[b][_])):(d(I[b][_+1]),d(I[b+1][_+1]),d(I[b+1][_]))}}function l(w){const M=new $;for(let S=0;S<o.length;S+=3)M.x=o[S+0],M.y=o[S+1],M.z=o[S+2],M.normalize().multiplyScalar(w),o[S+0]=M.x,o[S+1]=M.y,o[S+2]=M.z}function u(){const w=new $;for(let M=0;M<o.length;M+=3){w.x=o[M+0],w.y=o[M+1],w.z=o[M+2];const S=m(w)/2/Math.PI+.5,E=g(w)/Math.PI+.5;a.push(S,1-E)}y(),f()}function f(){for(let w=0;w<a.length;w+=6){const M=a[w+0],S=a[w+2],E=a[w+4],A=Math.max(M,S,E),I=Math.min(M,S,E);A>.9&&I<.1&&(M<.2&&(a[w+0]+=1),S<.2&&(a[w+2]+=1),E<.2&&(a[w+4]+=1))}}function d(w){o.push(w.x,w.y,w.z)}function p(w,M){const S=w*3;M.x=e[S+0],M.y=e[S+1],M.z=e[S+2]}function y(){const w=new $,M=new $,S=new $,E=new $,A=new nt,I=new nt,b=new nt;for(let v=0,_=0;v<o.length;v+=9,_+=6){w.set(o[v+0],o[v+1],o[v+2]),M.set(o[v+3],o[v+4],o[v+5]),S.set(o[v+6],o[v+7],o[v+8]),A.set(a[_+0],a[_+1]),I.set(a[_+2],a[_+3]),b.set(a[_+4],a[_+5]),E.copy(w).add(M).add(S).divideScalar(3);const z=m(E);x(A,_+0,w,z),x(I,_+2,M,z),x(b,_+4,S,z)}}function x(w,M,S,E){E<0&&w.x===1&&(a[M]=w.x-1),S.x===0&&S.z===0&&(a[M]=E/2/Math.PI+.5)}function m(w){return Math.atan2(w.z,-w.x)}function g(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ls(e.vertices,e.indices,e.radius,e.details)}}class lf extends Ls{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,s=1/i,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-i,0,-s,i,0,s,-i,0,s,i,-s,-i,0,-s,i,0,s,-i,0,s,i,0,-i,0,-s,i,0,-s,-i,0,s,i,0,s],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(o,a,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new lf(e.radius,e.detail)}}const Cn=new $,ui=new $,uf=new $,fi=new $,Ar=new $,Cr=new $,fg=new $,ff=new $,df=new $,pf=new $,yf=new Li,xf=new Li,mf=new Li;class Fi{constructor(e=new $,n=new $,i=new $){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,s){s.subVectors(i,n),Cn.subVectors(e,n),s.cross(Cn);const o=s.lengthSq();return o>0?s.multiplyScalar(1/Math.sqrt(o)):s.set(0,0,0)}static getBarycoord(e,n,i,s,o){Cn.subVectors(s,n),ui.subVectors(i,n),uf.subVectors(e,n);const a=Cn.dot(Cn),h=Cn.dot(ui),c=Cn.dot(uf),l=ui.dot(ui),u=ui.dot(uf),f=a*l-h*h;if(f===0)return o.set(0,0,0),null;const d=1/f,p=(l*c-h*u)*d,y=(a*u-h*c)*d;return o.set(1-p-y,y,p)}static containsPoint(e,n,i,s){return this.getBarycoord(e,n,i,s,fi)===null?!1:fi.x>=0&&fi.y>=0&&fi.x+fi.y<=1}static getInterpolation(e,n,i,s,o,a,h,c){return this.getBarycoord(e,n,i,s,fi)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(o,fi.x),c.addScaledVector(a,fi.y),c.addScaledVector(h,fi.z),c)}static getInterpolatedAttribute(e,n,i,s,o,a){return yf.setScalar(0),xf.setScalar(0),mf.setScalar(0),yf.fromBufferAttribute(e,n),xf.fromBufferAttribute(e,i),mf.fromBufferAttribute(e,s),a.setScalar(0),a.addScaledVector(yf,o.x),a.addScaledVector(xf,o.y),a.addScaledVector(mf,o.z),a}static isFrontFacing(e,n,i,s){return Cn.subVectors(i,n),ui.subVectors(e,n),Cn.cross(ui).dot(s)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,s){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,n,i,s){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Cn.subVectors(this.c,this.b),ui.subVectors(this.a,this.b),Cn.cross(ui).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Fi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return Fi.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,i,s,o){return Fi.getInterpolation(e,this.a,this.b,this.c,n,i,s,o)}containsPoint(e){return Fi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Fi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,s=this.b,o=this.c;let a,h;Ar.subVectors(s,i),Cr.subVectors(o,i),ff.subVectors(e,i);const c=Ar.dot(ff),l=Cr.dot(ff);if(c<=0&&l<=0)return n.copy(i);df.subVectors(e,s);const u=Ar.dot(df),f=Cr.dot(df);if(u>=0&&f<=u)return n.copy(s);const d=c*f-u*l;if(d<=0&&c>=0&&u<=0)return a=c/(c-u),n.copy(i).addScaledVector(Ar,a);pf.subVectors(e,o);const p=Ar.dot(pf),y=Cr.dot(pf);if(y>=0&&p<=y)return n.copy(o);const x=p*l-c*y;if(x<=0&&l>=0&&y<=0)return h=l/(l-y),n.copy(i).addScaledVector(Cr,h);const m=u*y-p*f;if(m<=0&&f-u>=0&&p-y>=0)return fg.subVectors(o,s),h=(f-u)/(f-u+(p-y)),n.copy(s).addScaledVector(fg,h);const g=1/(m+x+d);return a=x*g,h=d*g,n.copy(i).addScaledVector(Ar,a).addScaledVector(Cr,h)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Wh=new $,jh=new $,gf=new $,Yh=new Fi;class o5 extends te{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const s=Math.pow(10,4),o=Math.cos(vs*n),a=e.getIndex(),h=e.getAttribute("position"),c=a?a.count:h.count,l=[0,0,0],u=["a","b","c"],f=new Array(3),d={},p=[];for(let y=0;y<c;y+=3){a?(l[0]=a.getX(y),l[1]=a.getX(y+1),l[2]=a.getX(y+2)):(l[0]=y,l[1]=y+1,l[2]=y+2);const{a:x,b:m,c:g}=Yh;if(x.fromBufferAttribute(h,l[0]),m.fromBufferAttribute(h,l[1]),g.fromBufferAttribute(h,l[2]),Yh.getNormal(gf),f[0]=`${Math.round(x.x*s)},${Math.round(x.y*s)},${Math.round(x.z*s)}`,f[1]=`${Math.round(m.x*s)},${Math.round(m.y*s)},${Math.round(m.z*s)}`,f[2]=`${Math.round(g.x*s)},${Math.round(g.y*s)},${Math.round(g.z*s)}`,!(f[0]===f[1]||f[1]===f[2]||f[2]===f[0]))for(let w=0;w<3;w++){const M=(w+1)%3,S=f[w],E=f[M],A=Yh[u[w]],I=Yh[u[M]],b=`${S}_${E}`,v=`${E}_${S}`;v in d&&d[v]?(gf.dot(d[v].normal)<=o&&(p.push(A.x,A.y,A.z),p.push(I.x,I.y,I.z)),d[v]=null):b in d||(d[b]={index0:l[w],index1:l[M],normal:gf.clone()})}}for(const y in d)if(d[y]){const{index0:x,index1:m}=d[y];Wh.fromBufferAttribute(h,x),jh.fromBufferAttribute(h,m),p.push(Wh.x,Wh.y,Wh.z),p.push(jh.x,jh.y,jh.z)}this.setAttribute("position",new wt(p,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class wf extends te{constructor(e=new Tr([new nt(.5,.5),new nt(-.5,.5),new nt(-.5,-.5),new nt(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const i=this,s=[],o=[];for(let h=0,c=e.length;h<c;h++){const l=e[h];a(l)}this.setAttribute("position",new wt(s,3)),this.setAttribute("uv",new wt(o,2)),this.computeVertexNormals();function a(h){const c=[],l=n.curveSegments!==void 0?n.curveSegments:12,u=n.steps!==void 0?n.steps:1,f=n.depth!==void 0?n.depth:1;let d=n.bevelEnabled!==void 0?n.bevelEnabled:!0,p=n.bevelThickness!==void 0?n.bevelThickness:.2,y=n.bevelSize!==void 0?n.bevelSize:p-.1,x=n.bevelOffset!==void 0?n.bevelOffset:0,m=n.bevelSegments!==void 0?n.bevelSegments:3;const g=n.extrudePath,w=n.UVGenerator!==void 0?n.UVGenerator:a5;let M,S=!1,E,A,I,b;g&&(M=g.getSpacedPoints(u),S=!0,d=!1,E=g.computeFrenetFrames(u,!1),A=new $,I=new $,b=new $),d||(m=0,p=0,y=0,x=0);const v=h.extractPoints(l);let _=v.shape;const z=v.holes;if(!An.isClockWise(_)){_=_.reverse();for(let G=0,Q=z.length;G<Q;G++){const rt=z[G];An.isClockWise(rt)&&(z[G]=rt.reverse())}}function k(G){const rt=10000000000000001e-36;let ft=G[0];for(let at=1;at<=G.length;at++){const Pt=at%G.length,St=G[Pt],Vt=St.x-ft.x,it=St.y-ft.y,$t=Vt*Vt+it*it,T=Math.max(Math.abs(St.x),Math.abs(St.y),Math.abs(ft.x),Math.abs(ft.y)),C=rt*T*T;if($t<=C){G.splice(Pt,1),at--;continue}ft=St}}k(_),z.forEach(k);const B=z.length,R=_;for(let G=0;G<B;G++){const Q=z[G];_=_.concat(Q)}function L(G,Q,rt){return Q||console.error("THREE.ExtrudeGeometry: vec does not exist"),G.clone().addScaledVector(Q,rt)}const N=_.length;function q(G,Q,rt){let ft,at,Pt;const St=G.x-Q.x,Vt=G.y-Q.y,it=rt.x-G.x,$t=rt.y-G.y,T=St*St+Vt*Vt,C=St*$t-Vt*it;if(Math.abs(C)>Number.EPSILON){const F=Math.sqrt(T),D=Math.sqrt(it*it+$t*$t),W=Q.x-Vt/F,V=Q.y+St/F,j=rt.x-$t/D,Y=rt.y+it/D,Z=((j-W)*$t-(Y-V)*it)/(St*$t-Vt*it);ft=W+St*Z-G.x,at=V+Vt*Z-G.y;const mt=ft*ft+at*at;if(mt<=2)return new nt(ft,at);Pt=Math.sqrt(mt/2)}else{let F=!1;St>Number.EPSILON?it>Number.EPSILON&&(F=!0):St<-Number.EPSILON?it<-Number.EPSILON&&(F=!0):Math.sign(Vt)===Math.sign($t)&&(F=!0),F?(ft=-Vt,at=St,Pt=Math.sqrt(T)):(ft=St,at=Vt,Pt=Math.sqrt(T/2))}return new nt(ft/Pt,at/Pt)}const U=[];for(let G=0,Q=R.length,rt=Q-1,ft=G+1;G<Q;G++,rt++,ft++)rt===Q&&(rt=0),ft===Q&&(ft=0),U[G]=q(R[G],R[rt],R[ft]);const J=[];let X,lt=U.concat();for(let G=0,Q=B;G<Q;G++){const rt=z[G];X=[];for(let ft=0,at=rt.length,Pt=at-1,St=ft+1;ft<at;ft++,Pt++,St++)Pt===at&&(Pt=0),St===at&&(St=0),X[ft]=q(rt[ft],rt[Pt],rt[St]);J.push(X),lt=lt.concat(X)}let ot;if(m===0)ot=An.triangulateShape(R,z);else{const G=[],Q=[];for(let rt=0;rt<m;rt++){const ft=rt/m,at=p*Math.cos(ft*Math.PI/2),Pt=y*Math.sin(ft*Math.PI/2)+x;for(let St=0,Vt=R.length;St<Vt;St++){const it=L(R[St],U[St],Pt);ee(it.x,it.y,-at),ft===0&&G.push(it)}for(let St=0,Vt=B;St<Vt;St++){const it=z[St];X=J[St];const $t=[];for(let T=0,C=it.length;T<C;T++){const F=L(it[T],X[T],Pt);ee(F.x,F.y,-at),ft===0&&$t.push(F)}ft===0&&Q.push($t)}}ot=An.triangulateShape(G,Q)}const ut=ot.length,ct=y+x;for(let G=0;G<N;G++){const Q=d?L(_[G],lt[G],ct):_[G];S?(I.copy(E.normals[0]).multiplyScalar(Q.x),A.copy(E.binormals[0]).multiplyScalar(Q.y),b.copy(M[0]).add(I).add(A),ee(b.x,b.y,b.z)):ee(Q.x,Q.y,0)}for(let G=1;G<=u;G++)for(let Q=0;Q<N;Q++){const rt=d?L(_[Q],lt[Q],ct):_[Q];S?(I.copy(E.normals[G]).multiplyScalar(rt.x),A.copy(E.binormals[G]).multiplyScalar(rt.y),b.copy(M[G]).add(I).add(A),ee(b.x,b.y,b.z)):ee(rt.x,rt.y,f/u*G)}for(let G=m-1;G>=0;G--){const Q=G/m,rt=p*Math.cos(Q*Math.PI/2),ft=y*Math.sin(Q*Math.PI/2)+x;for(let at=0,Pt=R.length;at<Pt;at++){const St=L(R[at],U[at],ft);ee(St.x,St.y,f+rt)}for(let at=0,Pt=z.length;at<Pt;at++){const St=z[at];X=J[at];for(let Vt=0,it=St.length;Vt<it;Vt++){const $t=L(St[Vt],X[Vt],ft);S?ee($t.x,$t.y+M[u-1].y,M[u-1].x+rt):ee($t.x,$t.y,f+rt)}}}gt(),Nt();function gt(){const G=s.length/3;if(d){let Q=0,rt=N*Q;for(let ft=0;ft<ut;ft++){const at=ot[ft];$e(at[2]+rt,at[1]+rt,at[0]+rt)}Q=u+m*2,rt=N*Q;for(let ft=0;ft<ut;ft++){const at=ot[ft];$e(at[0]+rt,at[1]+rt,at[2]+rt)}}else{for(let Q=0;Q<ut;Q++){const rt=ot[Q];$e(rt[2],rt[1],rt[0])}for(let Q=0;Q<ut;Q++){const rt=ot[Q];$e(rt[0]+N*u,rt[1]+N*u,rt[2]+N*u)}}i.addGroup(G,s.length/3-G,0)}function Nt(){const G=s.length/3;let Q=0;se(R,Q),Q+=R.length;for(let rt=0,ft=z.length;rt<ft;rt++){const at=z[rt];se(at,Q),Q+=at.length}i.addGroup(G,s.length/3-G,1)}function se(G,Q){let rt=G.length;for(;--rt>=0;){const ft=rt;let at=rt-1;at<0&&(at=G.length-1);for(let Pt=0,St=u+m*2;Pt<St;Pt++){const Vt=N*Pt,it=N*(Pt+1),$t=Q+ft+Vt,T=Q+at+Vt,C=Q+at+it,F=Q+ft+it;be($t,T,C,F)}}}function ee(G,Q,rt){c.push(G),c.push(Q),c.push(rt)}function $e(G,Q,rt){de(G),de(Q),de(rt);const ft=s.length/3,at=w.generateTopUV(i,s,ft-3,ft-2,ft-1);Wt(at[0]),Wt(at[1]),Wt(at[2])}function be(G,Q,rt,ft){de(G),de(Q),de(ft),de(Q),de(rt),de(ft);const at=s.length/3,Pt=w.generateSideWallUV(i,s,at-6,at-3,at-2,at-1);Wt(Pt[0]),Wt(Pt[1]),Wt(Pt[3]),Wt(Pt[1]),Wt(Pt[2]),Wt(Pt[3])}function de(G){s.push(c[G*3+0]),s.push(c[G*3+1]),s.push(c[G*3+2])}function Wt(G){o.push(G.x),o.push(G.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,i=this.parameters.options;return h5(n,i,e)}static fromJSON(e,n){const i=[];for(let o=0,a=e.shapes.length;o<a;o++){const h=n[e.shapes[o]];i.push(h)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new Nh[s.type]().fromJSON(s)),new wf(i,e.options)}}const a5={generateTopUV:function(r,e,n,i,s){const o=e[n*3],a=e[n*3+1],h=e[i*3],c=e[i*3+1],l=e[s*3],u=e[s*3+1];return[new nt(o,a),new nt(h,c),new nt(l,u)]},generateSideWallUV:function(r,e,n,i,s,o){const a=e[n*3],h=e[n*3+1],c=e[n*3+2],l=e[i*3],u=e[i*3+1],f=e[i*3+2],d=e[s*3],p=e[s*3+1],y=e[s*3+2],x=e[o*3],m=e[o*3+1],g=e[o*3+2];return Math.abs(h-u)<Math.abs(a-l)?[new nt(a,1-c),new nt(l,1-f),new nt(d,1-y),new nt(x,1-g)]:[new nt(h,1-c),new nt(u,1-f),new nt(p,1-y),new nt(m,1-g)]}};function h5(r,e,n){if(n.shapes=[],Array.isArray(r))for(let i=0,s=r.length;i<s;i++){const o=r[i];n.shapes.push(o.uuid)}else n.shapes.push(r.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class bf extends Ls{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,s=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],o=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,o,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new bf(e.radius,e.detail)}}class vf extends te{constructor(e=[new nt(0,-.5),new nt(.5,0),new nt(0,.5)],n=12,i=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:s},n=Math.floor(n),s=Mt(s,0,Math.PI*2);const o=[],a=[],h=[],c=[],l=[],u=1/n,f=new $,d=new nt,p=new $,y=new $,x=new $;let m=0,g=0;for(let w=0;w<=e.length-1;w++)switch(w){case 0:m=e[w+1].x-e[w].x,g=e[w+1].y-e[w].y,p.x=g*1,p.y=-m,p.z=g*0,x.copy(p),p.normalize(),c.push(p.x,p.y,p.z);break;case e.length-1:c.push(x.x,x.y,x.z);break;default:m=e[w+1].x-e[w].x,g=e[w+1].y-e[w].y,p.x=g*1,p.y=-m,p.z=g*0,y.copy(p),p.x+=x.x,p.y+=x.y,p.z+=x.z,p.normalize(),c.push(p.x,p.y,p.z),x.copy(y)}for(let w=0;w<=n;w++){const M=i+w*u*s,S=Math.sin(M),E=Math.cos(M);for(let A=0;A<=e.length-1;A++){f.x=e[A].x*S,f.y=e[A].y,f.z=e[A].x*E,a.push(f.x,f.y,f.z),d.x=w/n,d.y=A/(e.length-1),h.push(d.x,d.y);const I=c[3*A+0]*S,b=c[3*A+1],v=c[3*A+0]*E;l.push(I,b,v)}}for(let w=0;w<n;w++)for(let M=0;M<e.length-1;M++){const S=M+w*e.length,E=S,A=S+e.length,I=S+e.length+1,b=S+1;o.push(E,A,b),o.push(I,b,A)}this.setIndex(o),this.setAttribute("position",new wt(a,3)),this.setAttribute("uv",new wt(h,2)),this.setAttribute("normal",new wt(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vf(e.points,e.segments,e.phiStart,e.phiLength)}}class Mf extends Ls{constructor(e=1,n=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,s,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new Mf(e.radius,e.detail)}}class _f extends te{constructor(e=1,n=1,i=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:s};const o=e/2,a=n/2,h=Math.floor(i),c=Math.floor(s),l=h+1,u=c+1,f=e/h,d=n/c,p=[],y=[],x=[],m=[];for(let g=0;g<u;g++){const w=g*d-a;for(let M=0;M<l;M++){const S=M*f-o;y.push(S,-w,0),x.push(0,0,1),m.push(M/h),m.push(1-g/c)}}for(let g=0;g<c;g++)for(let w=0;w<h;w++){const M=w+l*g,S=w+l*(g+1),E=w+1+l*(g+1),A=w+1+l*g;p.push(M,S,A),p.push(S,E,A)}this.setIndex(p),this.setAttribute("position",new wt(y,3)),this.setAttribute("normal",new wt(x,3)),this.setAttribute("uv",new wt(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _f(e.width,e.height,e.widthSegments,e.heightSegments)}}class Sf extends te{constructor(e=.5,n=1,i=32,s=1,o=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:i,phiSegments:s,thetaStart:o,thetaLength:a},i=Math.max(3,i),s=Math.max(1,s);const h=[],c=[],l=[],u=[];let f=e;const d=(n-e)/s,p=new $,y=new nt;for(let x=0;x<=s;x++){for(let m=0;m<=i;m++){const g=o+m/i*a;p.x=f*Math.cos(g),p.y=f*Math.sin(g),c.push(p.x,p.y,p.z),l.push(0,0,1),y.x=(p.x/n+1)/2,y.y=(p.y/n+1)/2,u.push(y.x,y.y)}f+=d}for(let x=0;x<s;x++){const m=x*(i+1);for(let g=0;g<i;g++){const w=g+m,M=w,S=w+i+1,E=w+i+2,A=w+1;h.push(M,S,A),h.push(S,E,A)}}this.setIndex(h),this.setAttribute("position",new wt(c,3)),this.setAttribute("normal",new wt(l,3)),this.setAttribute("uv",new wt(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Sf(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Tf extends te{constructor(e=new Tr([new nt(0,.5),new nt(-.5,-.5),new nt(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const i=[],s=[],o=[],a=[];let h=0,c=0;if(Array.isArray(e)===!1)l(e);else for(let u=0;u<e.length;u++)l(e[u]),this.addGroup(h,c,u),h+=c,c=0;this.setIndex(i),this.setAttribute("position",new wt(s,3)),this.setAttribute("normal",new wt(o,3)),this.setAttribute("uv",new wt(a,2));function l(u){const f=s.length/3,d=u.extractPoints(n);let p=d.shape;const y=d.holes;An.isClockWise(p)===!1&&(p=p.reverse());for(let m=0,g=y.length;m<g;m++){const w=y[m];An.isClockWise(w)===!0&&(y[m]=w.reverse())}const x=An.triangulateShape(p,y);for(let m=0,g=y.length;m<g;m++){const w=y[m];p=p.concat(w)}for(let m=0,g=p.length;m<g;m++){const w=p[m];s.push(w.x,w.y,0),o.push(0,0,1),a.push(w.x,w.y)}for(let m=0,g=x.length;m<g;m++){const w=x[m],M=w[0]+f,S=w[1]+f,E=w[2]+f;i.push(M,S,E),c+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return c5(n,e)}static fromJSON(e,n){const i=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=n[e.shapes[s]];i.push(a)}return new Tf(i,e.curveSegments)}}function c5(r,e){if(e.shapes=[],Array.isArray(r))for(let n=0,i=r.length;n<i;n++){const s=r[n];e.shapes.push(s.uuid)}else e.shapes.push(r.uuid);return e}class Ef extends te{constructor(e=1,n=32,i=16,s=0,o=Math.PI*2,a=0,h=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:s,phiLength:o,thetaStart:a,thetaLength:h},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const c=Math.min(a+h,Math.PI);let l=0;const u=[],f=new $,d=new $,p=[],y=[],x=[],m=[];for(let g=0;g<=i;g++){const w=[],M=g/i;let S=0;g===0&&a===0?S=.5/n:g===i&&c===Math.PI&&(S=-.5/n);for(let E=0;E<=n;E++){const A=E/n;f.x=-e*Math.cos(s+A*o)*Math.sin(a+M*h),f.y=e*Math.cos(a+M*h),f.z=e*Math.sin(s+A*o)*Math.sin(a+M*h),y.push(f.x,f.y,f.z),d.copy(f).normalize(),x.push(d.x,d.y,d.z),m.push(A+S,1-M),w.push(l++)}u.push(w)}for(let g=0;g<i;g++)for(let w=0;w<n;w++){const M=u[g][w+1],S=u[g][w],E=u[g+1][w],A=u[g+1][w+1];(g!==0||a>0)&&p.push(M,S,A),(g!==i-1||c<Math.PI)&&p.push(S,E,A)}this.setIndex(p),this.setAttribute("position",new wt(y,3)),this.setAttribute("normal",new wt(x,3)),this.setAttribute("uv",new wt(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ef(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class zf extends Ls{constructor(e=1,n=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,s,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new zf(e.radius,e.detail)}}class Af extends te{constructor(e=1,n=.4,i=12,s=48,o=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:i,tubularSegments:s,arc:o},i=Math.floor(i),s=Math.floor(s);const a=[],h=[],c=[],l=[],u=new $,f=new $,d=new $;for(let p=0;p<=i;p++)for(let y=0;y<=s;y++){const x=y/s*o,m=p/i*Math.PI*2;f.x=(e+n*Math.cos(m))*Math.cos(x),f.y=(e+n*Math.cos(m))*Math.sin(x),f.z=n*Math.sin(m),h.push(f.x,f.y,f.z),u.x=e*Math.cos(x),u.y=e*Math.sin(x),d.subVectors(f,u).normalize(),c.push(d.x,d.y,d.z),l.push(y/s),l.push(p/i)}for(let p=1;p<=i;p++)for(let y=1;y<=s;y++){const x=(s+1)*p+y-1,m=(s+1)*(p-1)+y-1,g=(s+1)*(p-1)+y,w=(s+1)*p+y;a.push(x,m,w),a.push(m,g,w)}this.setIndex(a),this.setAttribute("position",new wt(h,3)),this.setAttribute("normal",new wt(c,3)),this.setAttribute("uv",new wt(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Af(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Cf extends te{constructor(e=1,n=.4,i=64,s=8,o=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:i,radialSegments:s,p:o,q:a},i=Math.floor(i),s=Math.floor(s);const h=[],c=[],l=[],u=[],f=new $,d=new $,p=new $,y=new $,x=new $,m=new $,g=new $;for(let M=0;M<=i;++M){const S=M/i*o*Math.PI*2;w(S,o,a,e,p),w(S+.01,o,a,e,y),m.subVectors(y,p),g.addVectors(y,p),x.crossVectors(m,g),g.crossVectors(x,m),x.normalize(),g.normalize();for(let E=0;E<=s;++E){const A=E/s*Math.PI*2,I=-n*Math.cos(A),b=n*Math.sin(A);f.x=p.x+(I*g.x+b*x.x),f.y=p.y+(I*g.y+b*x.y),f.z=p.z+(I*g.z+b*x.z),c.push(f.x,f.y,f.z),d.subVectors(f,p).normalize(),l.push(d.x,d.y,d.z),u.push(M/i),u.push(E/s)}}for(let M=1;M<=i;M++)for(let S=1;S<=s;S++){const E=(s+1)*(M-1)+(S-1),A=(s+1)*M+(S-1),I=(s+1)*M+S,b=(s+1)*(M-1)+S;h.push(E,A,b),h.push(A,I,b)}this.setIndex(h),this.setAttribute("position",new wt(c,3)),this.setAttribute("normal",new wt(l,3)),this.setAttribute("uv",new wt(u,2));function w(M,S,E,A,I){const b=Math.cos(M),v=Math.sin(M),_=E/S*M,z=Math.cos(_);I.x=A*(2+z)*.5*b,I.y=A*(2+z)*v*.5,I.z=A*Math.sin(_)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Cf(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Pf extends te{constructor(e=new Ku(new $(-1,-1,0),new $(-1,1,0),new $(1,1,0)),n=64,i=1,s=8,o=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:s,closed:o};const a=e.computeFrenetFrames(n,o);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const h=new $,c=new $,l=new nt;let u=new $;const f=[],d=[],p=[],y=[];x(),this.setIndex(y),this.setAttribute("position",new wt(f,3)),this.setAttribute("normal",new wt(d,3)),this.setAttribute("uv",new wt(p,2));function x(){for(let M=0;M<n;M++)m(M);m(o===!1?n:0),w(),g()}function m(M){u=e.getPointAt(M/n,u);const S=a.normals[M],E=a.binormals[M];for(let A=0;A<=s;A++){const I=A/s*Math.PI*2,b=Math.sin(I),v=-Math.cos(I);c.x=v*S.x+b*E.x,c.y=v*S.y+b*E.y,c.z=v*S.z+b*E.z,c.normalize(),d.push(c.x,c.y,c.z),h.x=u.x+i*c.x,h.y=u.y+i*c.y,h.z=u.z+i*c.z,f.push(h.x,h.y,h.z)}}function g(){for(let M=1;M<=n;M++)for(let S=1;S<=s;S++){const E=(s+1)*(M-1)+(S-1),A=(s+1)*M+(S-1),I=(s+1)*M+S,b=(s+1)*(M-1)+S;y.push(E,A,b),y.push(A,I,b)}}function w(){for(let M=0;M<=n;M++)for(let S=0;S<=s;S++)l.x=M/n,l.y=S/s,p.push(l.x,l.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Pf(new Nh[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class l5 extends te{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],i=new Set,s=new $,o=new $;if(e.index!==null){const a=e.attributes.position,h=e.index;let c=e.groups;c.length===0&&(c=[{start:0,count:h.count,materialIndex:0}]);for(let l=0,u=c.length;l<u;++l){const f=c[l],d=f.start,p=f.count;for(let y=d,x=d+p;y<x;y+=3)for(let m=0;m<3;m++){const g=h.getX(y+m),w=h.getX(y+(m+1)%3);s.fromBufferAttribute(a,g),o.fromBufferAttribute(a,w),dg(s,o,i)===!0&&(n.push(s.x,s.y,s.z),n.push(o.x,o.y,o.z))}}}else{const a=e.attributes.position;for(let h=0,c=a.count/3;h<c;h++)for(let l=0;l<3;l++){const u=3*h+l,f=3*h+(l+1)%3;s.fromBufferAttribute(a,u),o.fromBufferAttribute(a,f),dg(s,o,i)===!0&&(n.push(s.x,s.y,s.z),n.push(o.x,o.y,o.z))}}this.setAttribute("position",new wt(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function dg(r,e,n){const i=`${r.x},${r.y},${r.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${r.x},${r.y},${r.z}`;return n.has(i)===!0||n.has(s)===!0?!1:(n.add(i),n.add(s),!0)}const pg=new nt;class u5{constructor(e=new nt(1/0,1/0),n=new nt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=pg.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,pg).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}class f5{constructor(e=1,n=0,i=0){this.radius=e,this.theta=n,this.y=i}set(e,n,i){return this.radius=e,this.theta=n,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=n,this}clone(){return new this.constructor().copy(this)}}const If=new $,d5=new $,p5=new Vn;class Bs{constructor(e=new $(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,s){return this.normal.set(e,n,i),this.constant=s,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const s=If.subVectors(i,n).cross(d5.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(If),s=this.normal.dot(i);if(s===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/s;return o<0||o>1?null:n.copy(e.start).addScaledVector(i,o)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||p5.getNormalMatrix(e),s=this.coplanarPoint(If).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-s.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Fs=new Lu,y5=new nt(.5,.5),Hh=new $;class yg{constructor(e=new Bs,n=new Bs,i=new Bs,s=new Bs,o=new Bs,a=new Bs){this.planes=[e,n,i,s,o,a]}set(e,n,i,s,o,a){const h=this.planes;return h[0].copy(e),h[1].copy(n),h[2].copy(i),h[3].copy(s),h[4].copy(o),h[5].copy(a),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=$n){const i=this.planes,s=e.elements,o=s[0],a=s[1],h=s[2],c=s[3],l=s[4],u=s[5],f=s[6],d=s[7],p=s[8],y=s[9],x=s[10],m=s[11],g=s[12],w=s[13],M=s[14],S=s[15];if(i[0].setComponents(c-o,d-l,m-p,S-g).normalize(),i[1].setComponents(c+o,d+l,m+p,S+g).normalize(),i[2].setComponents(c+a,d+u,m+y,S+w).normalize(),i[3].setComponents(c-a,d-u,m-y,S-w).normalize(),i[4].setComponents(c-h,d-f,m-x,S-M).normalize(),n===$n)i[5].setComponents(c+h,d+f,m+x,S+M).normalize();else if(n===zo)i[5].setComponents(h,f,x,M).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Fs.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),Fs.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Fs)}intersectsSprite(e){Fs.center.set(0,0,0);const n=y5.distanceTo(e.center);return Fs.radius=.7071067811865476+n,Fs.applyMatrix4(e.matrixWorld),this.intersectsSphere(Fs)}intersectsSphere(e){const n=this.planes,i=e.center,s=-e.radius;for(let o=0;o<6;o++)if(n[o].distanceToPoint(i)<s)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const s=n[i];if(Hh.x=s.normal.x>0?e.max.x:e.min.x,Hh.y=s.normal.y>0?e.max.y:e.min.y,Hh.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Hh)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Wn=new Qt,jn=new yg;class kf{constructor(){this.coordinateSystem=$n}intersectsObject(e,n){if(!n.isArrayCamera||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const s=n.cameras[i];if(Wn.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),jn.setFromProjectionMatrix(Wn,this.coordinateSystem),jn.intersectsObject(e))return!0}return!1}intersectsSprite(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const s=n.cameras[i];if(Wn.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),jn.setFromProjectionMatrix(Wn,this.coordinateSystem),jn.intersectsSprite(e))return!0}return!1}intersectsSphere(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const s=n.cameras[i];if(Wn.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),jn.setFromProjectionMatrix(Wn,this.coordinateSystem),jn.intersectsSphere(e))return!0}return!1}intersectsBox(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const s=n.cameras[i];if(Wn.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),jn.setFromProjectionMatrix(Wn,this.coordinateSystem),jn.intersectsBox(e))return!0}return!1}containsPoint(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const s=n.cameras[i];if(Wn.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),jn.setFromProjectionMatrix(Wn,this.coordinateSystem),jn.containsPoint(e))return!0}return!1}clone(){return new kf}}const xg=new $,Xh=new $;class x5{constructor(e=new $,n=new $){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){xg.subVectors(e,this.start),Xh.subVectors(this.end,this.start);const i=Xh.dot(Xh);let o=Xh.dot(xg)/i;return n&&(o=Mt(o,0,1)),o}closestPointToPoint(e,n,i){const s=this.closestPointToPointParameter(e,n);return this.delta(i).multiplyScalar(s).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}class Rf{constructor(e,n,i,s){Rf.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,n,i,s)}identity(){return this.set(1,0,0,1),this}fromArray(e,n=0){for(let i=0;i<4;i++)this.elements[i]=e[i+n];return this}set(e,n,i,s){const o=this.elements;return o[0]=e,o[2]=n,o[1]=i,o[3]=s,this}}class m5{constructor(e=1,n=0,i=0){this.radius=e,this.phi=n,this.theta=i}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Mt(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Mt(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class g5{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new $)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const i=e.x,s=e.y,o=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.282095),n.addScaledVector(a[1],.488603*s),n.addScaledVector(a[2],.488603*o),n.addScaledVector(a[3],.488603*i),n.addScaledVector(a[4],1.092548*(i*s)),n.addScaledVector(a[5],1.092548*(s*o)),n.addScaledVector(a[6],.315392*(3*o*o-1)),n.addScaledVector(a[7],1.092548*(i*o)),n.addScaledVector(a[8],.546274*(i*i-s*s)),n}getIrradianceAt(e,n){const i=e.x,s=e.y,o=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.886227),n.addScaledVector(a[1],2*.511664*s),n.addScaledVector(a[2],2*.511664*o),n.addScaledVector(a[3],2*.511664*i),n.addScaledVector(a[4],2*.429043*i*s),n.addScaledVector(a[5],2*.429043*s*o),n.addScaledVector(a[6],.743125*o*o-.247708),n.addScaledVector(a[7],2*.429043*i*o),n.addScaledVector(a[8],.429043*(i*i-s*s)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const i=this.coefficients;for(let s=0;s<9;s++)i[s].fromArray(e,n+s*3);return this}toArray(e=[],n=0){const i=this.coefficients;for(let s=0;s<9;s++)i[s].toArray(e,n+s*3);return e}static getBasisAt(e,n){const i=e.x,s=e.y,o=e.z;n[0]=.282095,n[1]=.488603*s,n[2]=.488603*o,n[3]=.488603*i,n[4]=1.092548*i*s,n[5]=1.092548*s*o,n[6]=.315392*(3*o*o-1),n[7]=1.092548*i*o,n[8]=.546274*(i*i-s*s)}}class Of{constructor(e,n=1,i=1e3){this.isFog=!0,this.name="",this.color=new Er(e),this.near=n,this.far=i}clone(){return new Of(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Lf{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new Er(e),this.density=n}clone(){return new Lf(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class w5 extends qe{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Ts,this.environmentIntensity=1,this.environmentRotation=new Ts,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}class b5 extends fe{constructor(e,n,i,s,o,a,h,c,l){super(e,n,i,s,o,a,h,c,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Bf extends fe{constructor(e,n,i,s,o,a,h,c,l,u,f,d){super(null,a,h,c,l,u,s,o,f,d),this.isCompressedTexture=!0,this.image={width:n,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class v5 extends Bf{constructor(e,n,i,s,o,a){super(e,n,i,o,a),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=Ai,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class M5 extends Bf{constructor(e,n,i){super(void 0,e[0].width,e[0].height,n,i,au),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class _5 extends fe{constructor(e=[],n=au,i,s,o,a,h,c,l,u){super(e,n,i,s,o,a,h,c,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class S5 extends fe{constructor(e=null,n=1,i=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:s},this.magFilter=_n,this.minFilter=_n,this.wrapR=Ai,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class T5 extends fe{constructor(e=null,n=1,i=1,s,o,a,h,c,l=_n,u=_n,f,d){super(null,a,h,c,l,u,s,o,f,d),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class E5 extends fe{constructor(e,n,i=uu,s,o,a,h=_n,c=_n,l,u=pu,f=1){if(u!==pu&&u!==Ax)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const d={width:e,height:n,depth:f};super(d,s,o,a,h,c,u,i,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Lh(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class z5 extends fe{constructor(e,n){super({width:e,height:n}),this.isFramebufferTexture=!0,this.magFilter=_n,this.minFilter=_n,this.generateMipmaps=!1,this.needsUpdate=!0}}class mg extends fe{constructor(e,n,i,s,o=fr,a=fr,h,c,l){super(e,n,i,s,o,a,h,c,l),this.isVideoTexture=!0,this.generateMipmaps=!1;const u=this;function f(){u.needsUpdate=!0,e.requestVideoFrameCallback(f)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(f)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class A5 extends mg{constructor(e,n,i,s,o,a,h,c){super({},e,n,i,s,o,a,h,c),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}const C5=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:GE,AddEquation:yE,AddOperation:jE,AdditiveAnimationBlendMode:yu,AdditiveBlending:uE,AgXToneMapping:QE,AlphaFormat:Ex,AlwaysCompare:Hz,AlwaysDepth:BE,AlwaysStencilFunc:qz,AnimationAction:ym,AnimationClip:Su,AnimationMixer:qA,AnimationObjectGroup:DA,AnimationUtils:EA,ArcCurve:Qm,ArrayCamera:QA,AttachedBindMode:tz,Audio:Im,AudioAnalyser:HA,AudioContext:km,AudioListener:ZA,BackSide:aE,BasicDepthPacking:gz,BasicShadowMap:nE,BooleanKeyframeTrack:_s,Box2:u5,Box3:gr,BoxGeometry:of,BufferAttribute:Ie,BufferGeometry:te,ByteType:gx,Camera:ku,CanvasTexture:b5,CapsuleGeometry:af,CatmullRomCurve3:Km,CineonToneMapping:ZE,CircleGeometry:hf,ClampToEdgeWrapping:Ai,Clock:Rm,Color:Er,ColorKeyframeTrack:_u,ColorManagement:ln,CompressedArrayTexture:v5,CompressedCubeTexture:M5,CompressedTexture:Bf,ConeGeometry:cf,ConstantAlphaFactor:RE,ConstantColorFactor:IE,Controls:EC,CubeCamera:KA,CubeReflectionMapping:au,CubeRefractionMapping:nz,CubeTexture:_5,CubeUVReflectionMapping:rz,CubicBezierCurve:Gu,CubicBezierCurve3:eg,CubicInterpolant:wm,CullFaceBack:KT,CullFaceFront:tE,CullFaceFrontBack:eE,CullFaceNone:QT,Curve:zn,CurvePath:ig,CustomBlending:pE,CustomToneMapping:JE,CylinderGeometry:Uh,Cylindrical:f5,Data3DTexture:Jm,DataArrayTexture:S5,DataTexture:T5,DataUtils:iC,DecrementStencilOp:Az,DecrementWrapStencilOp:Pz,DepthFormat:pu,DepthStencilFormat:Ax,DepthTexture:E5,DetachedBindMode:ez,DiscreteInterpolant:bm,DodecahedronGeometry:lf,DoubleSide:hE,DstAlphaFactor:EE,DstColorFactor:AE,DynamicCopyUsage:tA,DynamicDrawUsage:Xz,DynamicReadUsage:Jz,EdgesGeometry:o5,EllipseCurve:Bh,EqualCompare:Vz,EqualDepth:qE,EqualStencilFunc:Oz,EquirectangularReflectionMapping:iz,EquirectangularRefractionMapping:sz,Euler:Ts,EventDispatcher:Ci,ExtrudeGeometry:wf,Float16BufferAttribute:lC,Float32BufferAttribute:wt,FloatType:fu,Fog:Of,FogExp2:Lf,FramebufferTexture:z5,FrontSide:oE,Frustum:yg,FrustumArray:kf,GLBufferAttribute:yC,GLSL1:nA,GLSL3:iA,GreaterCompare:Wz,GreaterDepth:$E,GreaterEqualCompare:Yz,GreaterEqualDepth:DE,GreaterEqualStencilFunc:Nz,GreaterStencilFunc:Bz,HalfFloatType:Mx,IcosahedronGeometry:bf,ImageUtils:Zm,IncrementStencilOp:zz,IncrementWrapStencilOp:Cz,InstancedBufferAttribute:xC,InstancedBufferGeometry:mC,InstancedInterleavedBuffer:gC,Int16BufferAttribute:hC,Int32BufferAttribute:cC,Int8BufferAttribute:rC,IntType:vx,InterleavedBuffer:Um,InterleavedBufferAttribute:Nu,Interpolant:Co,InterpolateDiscrete:So,InterpolateLinear:vh,InterpolateSmooth:Mh,InterpolationSamplingMode:oA,InterpolationSamplingType:rA,InvertStencilOp:Iz,KeepStencilOp:Tz,KeyframeTrack:hn,LatheGeometry:vf,Layers:Au,LessCompare:$z,LessDepth:FE,LessEqualCompare:Uz,LessEqualDepth:NE,LessEqualStencilFunc:Lz,LessStencilFunc:Rz,Line3:x5,LineCurve:Ju,LineCurve3:ng,LinearFilter:fr,LinearInterpolant:Mu,LinearMipMapLinearFilter:fz,LinearMipMapNearestFilter:uz,LinearMipmapLinearFilter:mx,LinearMipmapNearestFilter:lz,LinearSRGBColorSpace:mu,LinearToneMapping:HE,LinearTransfer:gu,LoopOnce:fm,LoopPingPong:pm,LoopRepeat:dm,MOUSE:GT,MathUtils:_A,Matrix2:Rf,Matrix3:Vn,Matrix4:Qt,MaxEquation:wE,MinEquation:gE,MirroredRepeatWrapping:cu,MixOperation:WE,MultiplyBlending:dE,MultiplyOperation:UE,NearestFilter:_n,NearestMipMapLinearFilter:cz,NearestMipMapNearestFilter:az,NearestMipmapLinearFilter:hz,NearestMipmapNearestFilter:oz,NeutralToneMapping:KE,NeverCompare:Dz,NeverDepth:LE,NeverStencilFunc:kz,NoBlending:cE,NoColorSpace:xu,NoToneMapping:YE,NormalAnimationBlendMode:_h,NormalBlending:lE,NotEqualCompare:jz,NotEqualDepth:VE,NotEqualStencilFunc:Fz,NumberKeyframeTrack:Po,Object3D:qe,ObjectSpaceNormalMap:_z,OctahedronGeometry:Mf,OneFactor:vE,OneMinusConstantAlphaFactor:OE,OneMinusConstantColorFactor:kE,OneMinusDstAlphaFactor:zE,OneMinusDstColorFactor:CE,OneMinusSrcAlphaFactor:TE,OneMinusSrcColorFactor:_E,OrthographicCamera:tC,PCFShadowMap:iE,PCFSoftShadowMap:sE,Path:qh,PerspectiveCamera:Un,Plane:Bs,PlaneGeometry:_f,PolyhedronGeometry:Ls,PositionalAudio:JA,PropertyBinding:kt,PropertyMixer:Mm,QuadraticBezierCurve:Qu,QuadraticBezierCurve3:Ku,Quaternion:Ne,QuaternionKeyframeTrack:Io,QuaternionLinearInterpolant:vm,RED_GREEN_RGTC2_Format:lm,RED_RGTC1_Format:hm,REVISION:ZT,RGBADepthPacking:wz,RGBAFormat:du,RGBAIntegerFormat:Rx,RGBA_ASTC_10x10_Format:nm,RGBA_ASTC_10x5_Format:Kx,RGBA_ASTC_10x6_Format:tm,RGBA_ASTC_10x8_Format:em,RGBA_ASTC_12x10_Format:im,RGBA_ASTC_12x12_Format:sm,RGBA_ASTC_4x4_Format:jx,RGBA_ASTC_5x4_Format:Yx,RGBA_ASTC_5x5_Format:Hx,RGBA_ASTC_6x5_Format:Xx,RGBA_ASTC_6x6_Format:Zx,RGBA_ASTC_8x5_Format:Gx,RGBA_ASTC_8x6_Format:Jx,RGBA_ASTC_8x8_Format:Qx,RGBA_BPTC_Format:rm,RGBA_ETC2_EAC_Format:Wx,RGBA_PVRTC_2BPPV1_Format:$x,RGBA_PVRTC_4BPPV1_Format:Dx,RGBA_S3TC_DXT1_Format:Lx,RGBA_S3TC_DXT3_Format:Bx,RGBA_S3TC_DXT5_Format:Fx,RGBDepthPacking:bz,RGBFormat:zx,RGBIntegerFormat:pz,RGB_BPTC_SIGNED_Format:om,RGB_BPTC_UNSIGNED_Format:am,RGB_ETC1_Format:Vx,RGB_ETC2_Format:Ux,RGB_PVRTC_2BPPV1_Format:qx,RGB_PVRTC_4BPPV1_Format:Nx,RGB_S3TC_DXT1_Format:Ox,RGDepthPacking:vz,RGFormat:Ix,RGIntegerFormat:kx,Ray:Wm,Raycaster:wC,RedFormat:Cx,RedIntegerFormat:Px,ReinhardToneMapping:XE,RenderTarget:Gm,RenderTarget3D:_C,RepeatWrapping:hu,ReplaceStencilOp:Ez,ReverseSubtractEquation:mE,RingGeometry:Sf,SIGNED_RED_GREEN_RGTC2_Format:um,SIGNED_RED_RGTC1_Format:cm,SRGBColorSpace:an,SRGBTransfer:Sh,Scene:w5,Shape:Tr,ShapeGeometry:Tf,ShapePath:KC,ShapeUtils:An,ShortType:wx,Source:Lh,Sphere:Lu,SphereGeometry:Ef,Spherical:m5,SphericalHarmonics3:g5,SplineCurve:tf,SrcAlphaFactor:SE,SrcAlphaSaturateFactor:PE,SrcColorFactor:ME,StaticCopyUsage:Kz,StaticDrawUsage:Eo,StaticReadUsage:Gz,StereoCamera:eC,StreamCopyUsage:eA,StreamDrawUsage:Zz,StreamReadUsage:Qz,StringKeyframeTrack:Ss,SubtractEquation:xE,SubtractiveBlending:fE,TOUCH:JT,TangentSpaceNormalMap:Mz,TetrahedronGeometry:zf,Texture:fe,TextureUtils:r5,TimestampQuery:sA,TorusGeometry:Af,TorusKnotGeometry:Cf,Triangle:Fi,TriangleFanDrawMode:mz,TriangleStripDrawMode:xz,TrianglesDrawMode:yz,TubeGeometry:Pf,UVMapping:ou,Uint16BufferAttribute:qm,Uint32BufferAttribute:Dm,Uint8BufferAttribute:oC,Uint8ClampedBufferAttribute:aC,Uniform:ju,UniformsGroup:TC,UnsignedByteType:lu,UnsignedInt248Type:dz,UnsignedInt5999Type:Tx,UnsignedIntType:uu,UnsignedShort4444Type:_x,UnsignedShort5551Type:Sx,UnsignedShortType:bx,VSMShadowMap:rE,Vector2:nt,Vector3:$,Vector4:Li,VectorKeyframeTrack:ko,VideoFrameTexture:A5,VideoTexture:mg,WebGLCoordinateSystem:$n,WebGPUCoordinateSystem:zo,WireframeGeometry:l5,WrapAroundEnding:To,ZeroCurvatureEnding:ws,ZeroFactor:bE,ZeroSlopeEnding:bs,ZeroStencilOp:Sz,createCanvasElement:dC,deviation:GC,flatten:JC},Symbol.toStringTag,{value:"Module"})),P5=1e-5;function Zh(r,e,n=P5){return Math.abs(r-e)<n}function Re(r,e,n,i){const s=r-n,o=e-i;return Math.sqrt(s*s+o*o)}function Gh(r,e){const n=Math.min(...r),i=Math.min(...e),s=Math.max(...r),o=Math.max(...e);return{x:n,y:i,width:s-n,height:o-i}}function gg(r){return(r+Math.PI*2)%(Math.PI*2)}function wg(r,e){const n=Math.abs(r);return e>0?n:n*-1}function I5(r,e,n,i,s,o){const a=n,h=i;if(a===0||h===0)return{x:r,y:e};const c=s-r,l=o-e,u=Math.abs(c),f=Math.abs(l),d=a*a,p=h*h;let y=Math.PI/4,x=0,m=0;for(let g=0;g<4;g++){x=a*Math.cos(y),m=h*Math.sin(y);const w=(d-p)*Math.cos(y)**3/a,M=(p-d)*Math.sin(y)**3/h,S=x-w,E=m-M,A=u-w,I=f-M,b=Math.hypot(E,S),v=Math.hypot(I,A),z=b*Math.asin((S*I-E*A)/(b*v))/Math.sqrt(d+p-x*x-m*m);y+=z,y=Math.min(Math.PI/2,Math.max(0,y))}return{x:r+wg(x,c),y:e+wg(m,l)}}function k5(r,e,n,i,s,o,a,h){return-1*n*Math.cos(s)*Math.sin(h)-i*Math.sin(s)*Math.cos(h)}function R5(r,e,n,i,s,o,a,h){return-1*n*Math.sin(s)*Math.sin(h)+i*Math.cos(s)*Math.cos(h)}function O5(r,e,n){return Math.atan(-e/r*Math.tan(n))}function L5(r,e,n){return Math.atan(e/(r*Math.tan(n)))}function B5(r,e,n,i,s,o){return n*Math.cos(s)*Math.cos(o)-i*Math.sin(s)*Math.sin(o)+r}function F5(r,e,n,i,s,o){return n*Math.sin(s)*Math.cos(o)+i*Math.cos(s)*Math.sin(o)+e}function N5(r,e,n,i){return(Math.atan2(i*r,n*e)+Math.PI*2)%(Math.PI*2)}function bg(r,e,n){return{x:r*Math.cos(n),y:e*Math.sin(n)}}function vg(r,e,n){const i=Math.cos(n),s=Math.sin(n);return[r*i-e*s,r*s+e*i]}function q5(r,e,n,i,s,o,a){const h=O5(n,i,s);let c=1/0,l=-1/0;const u=[o,a];for(let x=-Math.PI*2;x<=Math.PI*2;x+=Math.PI){const m=h+x;o<a?o<m&&m<a&&u.push(m):a<m&&m<o&&u.push(m)}for(let x=0;x<u.length;x++){const m=B5(r,e,n,i,s,u[x]);m<c&&(c=m),m>l&&(l=m)}const f=L5(n,i,s);let d=1/0,p=-1/0;const y=[o,a];for(let x=-Math.PI*2;x<=Math.PI*2;x+=Math.PI){const m=f+x;o<a?o<m&&m<a&&y.push(m):a<m&&m<o&&y.push(m)}for(let x=0;x<y.length;x++){const m=F5(r,e,n,i,s,y[x]);m<d&&(d=m),m>p&&(p=m)}return{x:c,y:d,width:l-c,height:p-d}}function D5(r,e,n,i,s,o,a,h,c){const l=vg(h-r,c-e,-s),[u,f]=l;let d=I5(0,0,n,i,u,f);const p=N5(n,i,d.x,d.y);p<o?d=bg(n,i,o):p>a&&(d=bg(n,i,a));const y=vg(d.x,d.y,s);return{x:y[0]+r,y:y[1]+e}}function $5(r,e,n,i,s,o,a,h){const c=(a-o)*h+o,l=k5(r,e,n,i,s,o,a,c),u=R5(r,e,n,i,s,o,a,c);return gg(Math.atan2(u,l))}const V5=1e-4;function Mg(r,e,n,i,s,o){let a=-1,h=1/0;const c=[n,i];let l=20;o&&o>200&&(l=o/10);const u=1/l;let f=u/10;for(let d=0;d<=l;d++){const p=d*u,y=[s(...r.concat([p])),s(...e.concat([p]))],x=Re(c[0],c[1],y[0],y[1]);x<h&&(a=p,h=x)}if(a===0)return{x:r[0],y:e[0]};if(a===1){const d=r.length;return{x:r[d-1],y:e[d-1]}}h=1/0;for(let d=0;d<32&&!(f<V5);d++){const p=a-f,y=a+f,x=[s(...r.concat([p])),s(...e.concat([p]))],m=Re(c[0],c[1],x[0],x[1]);if(p>=0&&m<h)a=p,h=m;else{const g=[s(...r.concat([y])),s(...e.concat([y]))],w=Re(c[0],c[1],g[0],g[1]);y<=1&&w<h?(a=y,h=w):f*=.5}}return{x:s(...r.concat([a])),y:s(...e.concat([a]))}}function U5(r,e){let n=0;const i=r.length;for(let s=0;s<i;s++){const o=r[s],a=e[s],h=r[(s+1)%i],c=e[(s+1)%i];n+=Re(o,a,h,c)}return n/2}function W5(r,e,n,i){return Gh([r,n],[e,i])}function j5(r,e,n,i){return Re(r,e,n,i)}function di(r,e,n,i,s){return{x:(1-s)*r+s*n,y:(1-s)*e+s*i}}function _g(r,e,n,i,s,o){const a=(n-r)*(s-r)+(i-e)*(o-e);if(a<0)return Re(r,e,s,o);const h=(n-r)*(n-r)+(i-e)*(i-e);return a>h?Re(n,i,s,o):Sg(r,e,n,i,s,o)}function Sg(r,e,n,i,s,o){const a=[n-r,i-e];if(et.exactEquals(a,[0,0]))return Math.sqrt((s-r)*(s-r)+(o-e)*(o-e));const h=[-a[1],a[0]];et.normalize(h,h);const c=[s-r,o-e];return Math.abs(et.dot(c,h))}function Y5(r,e,n,i){return Math.atan2(i-e,n-r)}function Ns(r,e,n,i,s){const o=1-s;return o*o*o*r+3*e*s*o*o+3*n*s*s*o+i*s*s*s}function Tg(r,e,n,i,s){const o=1-s;return 3*(o*o*(e-r)+2*o*s*(n-e)+s*s*(i-n))}function Eg(r,e,n,i){const s=-3*r+9*e-9*n+3*i,o=6*r-12*e+6*n,a=3*e-3*r,h=[];let c,l,u;if(Zh(s,0))Zh(o,0)||(c=-a/o,c>=0&&c<=1&&h.push(c));else{const f=o*o-4*s*a;Zh(f,0)?h.push(-o/(2*s)):f>0&&(u=Math.sqrt(f),c=(-o+u)/(2*s),l=(-o-u)/(2*s),c>=0&&c<=1&&h.push(c),l>=0&&l<=1&&h.push(l))}return h}function H5(r,e,n,i,s,o,a,h,c){const l=Ns(r,n,s,a,c),u=Ns(e,i,o,h,c),f=di(r,e,n,i,c),d=di(n,i,s,o,c),p=di(s,o,a,h,c),y=di(f.x,f.y,d.x,d.y,c),x=di(d.x,d.y,p.x,p.y,c);return[[r,e,f.x,f.y,y.x,y.y,l,u],[l,u,x.x,x.y,p.x,p.y,a,h]]}function Ff(r,e,n,i,s,o,a,h,c){if(c===0)return U5([r,n,s,a],[e,i,o,h]);const l=H5(r,e,n,i,s,o,a,h,.5),u=[...l[0],c-1],f=[...l[1],c-1];return Ff(...u)+Ff(...f)}function X5(r,e,n,i,s,o,a,h){const c=[r,a],l=[e,h],u=Eg(r,n,s,a),f=Eg(e,i,o,h);for(let d=0;d<u.length;d++)c.push(Ns(r,n,s,a,u[d]));for(let d=0;d<f.length;d++)l.push(Ns(e,i,o,h,f[d]));return Gh(c,l)}function Z5(r,e,n,i,s,o,a,h){return Ff(r,e,n,i,s,o,a,h,3)}function zg(r,e,n,i,s,o,a,h,c,l,u){return Mg([r,n,s,a],[e,i,o,h],c,l,Ns,u)}function G5(r,e,n,i,s,o,a,h,c,l,u){const f=zg(r,e,n,i,s,o,a,h,c,l,u);return Re(f.x,f.y,c,l)}function J5(r,e,n,i,s,o,a,h,c){return{x:Ns(r,n,s,a,c),y:Ns(e,i,o,h,c)}}function Q5(r,e,n,i,s,o,a,h,c){const l=Tg(r,n,s,a,c),u=Tg(e,i,o,h,c);return gg(Math.atan2(u,l))}function Ag(r){let e=0;const n=[];for(let i=0;i<r.length-1;i++){const s=r[i],o=r[i+1],a=Re(s[0],s[1],o[0],o[1]),h={from:s,to:o,length:a};n.push(h),e+=a}return{segments:n,totalLength:e}}function Cg(r){if(r.length<2)return 0;let e=0;for(let n=0;n<r.length-1;n++){const i=r[n],s=r[n+1];e+=Re(i[0],i[1],s[0],s[1])}return e}function Pg(r,e){if(e>1||e<0||r.length<2)return null;const{segments:n,totalLength:i}=Ag(r);if(i===0)return{x:r[0][0],y:r[0][1]};let s=0,o=null;for(let a=0;a<n.length;a++){const h=n[a],{from:c,to:l}=h,u=h.length/i;if(e>=s&&e<=s+u){const f=(e-s)/u;o=di(c[0],c[1],l[0],l[1],f);break}s+=u}return o}function Ig(r,e){if(e>1||e<0||r.length<2)return 0;const{segments:n,totalLength:i}=Ag(r);let s=0,o=0;for(let a=0;a<n.length;a++){const h=n[a],{from:c,to:l}=h,u=h.length/i;if(e>=s&&e<=s+u){o=Math.atan2(l[1]-c[1],l[0]-c[0]);break}s+=u}return o}function kg(r,e,n){let i=1/0;for(let s=0;s<r.length-1;s++){const o=r[s],a=r[s+1],h=_g(o[0],o[1],a[0],a[1],e,n);h<i&&(i=h)}return i}function Rg(r){const e=[],n=[];for(let i=0;i<r.length;i++){const s=r[i];e.push(s[0]),n.push(s[1])}return Gh(e,n)}function K5(r){return Cg(r)}function tP(r,e){return Pg(r,e)}function eP(r,e,n){return kg(r,e,n)}function nP(r,e){return Ig(r,e)}function Jh(r){const e=r.slice(0);return r.length&&e.push(r[0]),e}function iP(r){return Rg(r)}function sP(r){return Cg(Jh(r))}function rP(r,e){return Pg(Jh(r),e)}function oP(r,e,n){return kg(Jh(r),e,n)}function aP(r,e){return Ig(Jh(r),e)}function Wo(r,e,n,i){const s=1-i;return s*s*r+2*i*s*e+i*i*n}function Og(r,e,n){const i=r+n-2*e;if(Zh(i,0))return[.5];const s=(r-e)/i;return s<=1&&s>=0?[s]:[]}function hP(r,e,n,i,s,o,a){const h=Wo(r,n,s,a),c=Wo(e,i,o,a),l=di(r,e,n,i,a),u=di(n,i,s,o,a);return[[r,e,l.x,l.y,h,c],[h,c,u.x,u.y,s,o]]}function Nf(r,e,n,i,s,o,a){if(a===0)return(Re(r,e,n,i)+Re(n,i,s,o)+Re(r,e,s,o))/2;const h=hP(r,e,n,i,s,o,.5),c=h[0],l=h[1];return c.push(a-1),l.push(a-1),Nf(...c)+Nf(...l)}function cP(r,e,n,i,s,o){const a=Og(r,n,s)[0],h=Og(e,i,o)[0],c=[r,s],l=[e,o];return a!==void 0&&c.push(Wo(r,n,s,a)),h!==void 0&&l.push(Wo(e,i,o,h)),Gh(c,l)}function lP(r,e,n,i,s,o){return Nf(r,e,n,i,s,o,3)}function Lg(r,e,n,i,s,o,a,h){return Mg([r,n,s],[e,i,o],a,h,Wo)}function uP(r,e,n,i,s,o,a,h){const c=Lg(r,e,n,i,s,o,a,h);return Re(c.x,c.y,a,h)}const fP=Object.freeze(Object.defineProperty({__proto__:null,arcBox:q5,arcNearestPoint:D5,arcTangentAngle:$5,cubicBox:X5,cubicLength:Z5,cubicNearestPoint:zg,cubicPointAt:J5,cubicPointDistance:G5,cubicTangentAngle:Q5,distance:Re,lineBox:W5,lineLength:j5,linePointAt:di,linePointDistance:_g,linePointToLine:Sg,lineTangentAngle:Y5,polygonBox:iP,polygonLength:sP,polygonPointAt:rP,polygonPointDistance:oP,polygonTangentAngle:aP,polylineBox:Rg,polylineLength:K5,polylinePointAt:tP,polylinePointDistance:eP,polylineTangentAngle:nP,quadBox:cP,quadLength:lP,quadNearestPoint:Lg,quadPointDistance:uP},Symbol.toStringTag,{value:"Module"}));Ze.gMath=fP,Ze.glMatrix=Sw,Ze.m2d=XT,Ze.m3d=C5,Object.defineProperty(Ze,Symbol.toStringTag,{value:"Module"})});
